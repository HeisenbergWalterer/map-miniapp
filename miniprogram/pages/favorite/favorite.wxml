<!--favorite.wxml-->
<view class="page">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <view class="custom-navbar">
    <view class="navbar-content">
      <view class="navbar-left" bindtap="goBack">
        <text class="back-text">â€¹</text>
      </view>
      <view class="navbar-title">æˆ‘çš„æ”¶è—</view>
      <view class="navbar-right"></view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>

  <!-- æ”¶è—å†…å®¹åŒºåŸŸ -->
  <view class="favorite-content" wx:else>
    
    <!-- æ”¶è—åˆ†ç±»æ ‡ç­¾ - ä¸€ç›´æ˜¾ç¤º -->
    <view class="category-tabs">
      <view class="tab-item {{selectedCategory === 'all' ? 'active' : ''}}" bindtap="selectCategory" data-category="all">
        <text class="tab-text">å…¨éƒ¨</text>
      </view>
      <view class="tab-item {{selectedCategory === 'toilet' ? 'active' : ''}}" bindtap="selectCategory" data-category="toilet">
        <text class="tab-text">å…¬å…±å•æ‰€</text>
      </view>
      <view class="tab-item {{selectedCategory === 'warm' ? 'active' : ''}}" bindtap="selectCategory" data-category="warm">
        <text class="tab-text">æš–å¿ƒæœåŠ¡ç«™</text>
      </view>
      <view class="tab-item {{selectedCategory === 'sinopec' ? 'active' : ''}}" bindtap="selectCategory" data-category="sinopec">
        <text class="tab-text">çˆ±å¿ƒé©¿ç«™</text>
      </view>
      <view class="tab-item {{selectedCategory === 'partner' ? 'active' : ''}}" bindtap="selectCategory" data-category="partner">
        <text class="tab-text">åˆä½œå•†æˆ·</text>
      </view>
      <view class="tab-item {{selectedCategory === 'relay' ? 'active' : ''}}" bindtap="selectCategory" data-category="relay">
        <text class="tab-text">æ¥åŠ›ç«™</text>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€æ˜¾ç¤º -->
    <view class="empty-state" wx:if="{{showEmpty}}">
      <view class="empty-icon">â¤ï¸</view>
      <text class="empty-title">æš‚æ— æ”¶è—</text>
      <text class="empty-desc">æ‚¨è¿˜æ²¡æœ‰æ”¶è—ä»»ä½•åœ°ç‚¹æˆ–æœåŠ¡</text>
      <view class="empty-action">
        <button class="browse-btn" bindtap="goToMap">å»å‘ç°æ›´å¤š</button>
      </view>
    </view>

            <!-- æ”¶è—é¡¹ç›®åˆ—è¡¨ -->
            <view class="favorite-items" wx:else>
              <view 
                class="favorite-card" 
                wx:for="{{favorites}}" 
                wx:key="_id"
                bindtap="viewFavoriteDetail"
                data-item="{{item}}"
              >
                <view class="card-content">
                  <view class="favorite-photo">
                    <image src="{{item.station_photoUrl || '../../images/default-station-photo.jpg'}}" class="photo-img" mode="aspectFill"></image>
                  </view>
                  <view class="favorite-info">
                    <view class="favorite-name">{{item.station_name}}</view>
                    <view class="favorite-type">{{item.typeName}}</view>
                    <view class="favorite-address">
                      <text class="address-icon">ğŸ“</text>
                      <text class="address-text">{{item.station_address}}</text>
                    </view>
                    <view class="favorite-time" wx:if="{{item.station_serviceTime}}">
                      <text class="time-icon">ğŸ•’</text>
                      <text class="time-text">{{item.station_serviceTime}}</text>
                    </view>
                  </view>
                  <view class="card-actions">
                    <view class="action-btn navigate-btn" catchtap="navigateToFavorite" data-item="{{item}}">
                      <image src="../../images/icons/navigate.png" class="action-icon" mode="aspectFit"></image>
                    </view>
                    <view class="action-btn remove-btn" catchtap="removeFavorite" data-id="{{item._id}}">
                      <image src="../../images/icons/close.png" class="action-icon" mode="aspectFit"></image>
                    </view>
                  </view>
                </view>
              </view>
            </view>
  </view>
</view> 