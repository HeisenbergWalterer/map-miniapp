<view class="page">
  <!-- 顶部切换按钮（活动/场馆） - 仅在“活动”视图显示 -->
  <view class="tabs" wx:if="{{activeTab2==='list'}}">
    <view class="tab {{activeTab==='venue' ? 'active' : ''}}" data-tag="venue" bindtap="switchTab">场馆预约</view>
    <view class="tab {{activeTab==='activity' ? 'active' : ''}}" data-tag="activity" bindtap="switchTab">活动报名</view>
  </view>

  <!-- 列表区域：活动/场馆 -->
  <view class="activity-list" wx:if="{{activeTab2==='list'}}">
    <!-- 加载状态提示（本地静态数据可不显示，这里保留占位） -->
    <view wx:if="{{(activeTab==='venue' && loadingVenues) || (activeTab==='activity' && loadingActivities)}}" class="loading">加载中...</view>

    <!-- 场馆预约列表 -->
    <block wx:if="{{activeTab==='venue' && !loadingVenues}}">
      <block wx:for="{{venues}}" wx:key="id">
        <view class="card has-action" bindtap="goVenueDetail" data-id="{{item.id}}">
          <view class="card-main">
            <view class="card-title">{{item.title}}</view>
            <view class="card-sub">地点：{{item.place}}</view>
            <view class="card-sub slots">{{item.slots}}</view>
          </view>
          <button class="reserve-btn" catchtap="goVenueDetail" data-id="{{item.id}}">去预约</button>
        </view>
      </block>
      <view wx:if="{{!venues || venues.length===0}}" class="empty">暂无可预约场馆</view>
    </block>

    <!-- 活动报名列表（移除右侧按钮，整卡可点击） -->
    <block wx:elif="{{activeTab==='activity' && !loadingActivities}}">
      <block wx:for="{{activity}}" wx:key="_id">
        <view class="card" bindtap="goDetail" data-_id="{{item._id}}" data-id="{{item.id}}">
          <view class="card-main">
            <view class="card-title">{{item.title}}</view>
            <view class="card-sub">地点：{{item.place}}</view>
            <view class="card-sub">时间：{{item.dates}}</view>
          </view>
        </view>
      </block>
      <view wx:if="{{!activity || activity.length===0}}" class="empty">暂无可报名活动</view>
    </block>
  </view>

  <!-- 我的报名记录列表 -->
  <view class="activity-list" wx:elif="{{activeTab2==='records'}}">
    <block wx:if="{{myRecords && myRecords.length>0}}">
      <block wx:for="{{myRecords}}" wx:key="_id">
        <view class="card" data-item="{{item}}" bindtap="openRecordDetail">
          <view class="card-main">
            <view class="card-title">{{item._activity ? item._activity.title : '活动'}}</view>
            <view class="card-sub">地点：{{item._activity ? item._activity.place : ''}}</view>
            <view class="card-sub">时间：{{item._activity ? item._activity.dates : ''}}</view>
            <view class="card-sub">状态：{{item.status==='registered' ? '已报名' : '已取消'}}</view>
          </view>
        </view>
      </block>
    </block>
    <view wx:else class="empty">暂无报名记录</view>
  </view>
  <!-- 底部导航栏：活动 / 订单 -->
  <view class="bottom-nav">
    <view class="bottom-item {{activeTab2==='list' ? 'active' : ''}}" data-tag="list" bindtap="switchTab2">
      <text class="bottom-text">活动</text>
    </view>
    <view class="bottom-item {{activeTab2==='records' ? 'active' : ''}}" data-tag="records" bindtap="switchTab2">
      <text class="bottom-text">订单</text>
    </view>
  </view>
</view>


