const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/VenueReservations-DAKaHPwp.js","assets/database-MEP5-vzU.js","assets/EventRegistrations-I1_4dBfM.js"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();/**
* @vue/shared v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Xl(e){const t=Object.create(null);for(const r of e.split(","))t[r]=1;return r=>r in t}const Fe={},Bi=[],qr=()=>{},eb=()=>!1,pu=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Zl=e=>e.startsWith("onUpdate:"),bt=Object.assign,ef=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},tb=Object.prototype.hasOwnProperty,$e=(e,t)=>tb.call(e,t),me=Array.isArray,ji=e=>As(e)==="[object Map]",vu=e=>As(e)==="[object Set]",Od=e=>As(e)==="[object Date]",we=e=>typeof e=="function",Je=e=>typeof e=="string",Wr=e=>typeof e=="symbol",qe=e=>e!==null&&typeof e=="object",cm=e=>(qe(e)||we(e))&&we(e.then)&&we(e.catch),lm=Object.prototype.toString,As=e=>lm.call(e),rb=e=>As(e).slice(8,-1),fm=e=>As(e)==="[object Object]",tf=e=>Je(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Ho=Xl(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),mu=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},nb=/-(\w)/g,sr=mu(e=>e.replace(nb,(t,r)=>r?r.toUpperCase():"")),ib=/\B([A-Z])/g,_i=mu(e=>e.replace(ib,"-$1").toLowerCase()),gu=mu(e=>e.charAt(0).toUpperCase()+e.slice(1)),ic=mu(e=>e?`on${gu(e)}`:""),Dn=(e,t)=>!Object.is(e,t),ia=(e,...t)=>{for(let r=0;r<e.length;r++)e[r](...t)},sl=(e,t,r,n=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:n,value:r})},Sa=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Td;const yu=()=>Td||(Td=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function rf(e){if(me(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],o=Je(n)?ub(n):rf(n);if(o)for(const i in o)t[i]=o[i]}return t}else if(Je(e)||qe(e))return e}const ob=/;(?![^(]*\))/g,sb=/:([^]+)/,ab=/\/\*[^]*?\*\//g;function ub(e){const t={};return e.replace(ab,"").split(ob).forEach(r=>{if(r){const n=r.split(sb);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function st(e){let t="";if(Je(e))t=e;else if(me(e))for(let r=0;r<e.length;r++){const n=st(e[r]);n&&(t+=n+" ")}else if(qe(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const cb="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",lb=Xl(cb);function dm(e){return!!e||e===""}function fb(e,t){if(e.length!==t.length)return!1;let r=!0;for(let n=0;r&&n<e.length;n++)r=_u(e[n],t[n]);return r}function _u(e,t){if(e===t)return!0;let r=Od(e),n=Od(t);if(r||n)return r&&n?e.getTime()===t.getTime():!1;if(r=Wr(e),n=Wr(t),r||n)return e===t;if(r=me(e),n=me(t),r||n)return r&&n?fb(e,t):!1;if(r=qe(e),n=qe(t),r||n){if(!r||!n)return!1;const o=Object.keys(e).length,i=Object.keys(t).length;if(o!==i)return!1;for(const a in e){const u=e.hasOwnProperty(a),l=t.hasOwnProperty(a);if(u&&!l||!u&&l||!_u(e[a],t[a]))return!1}}return String(e)===String(t)}function db(e,t){return e.findIndex(r=>_u(r,t))}const hm=e=>!!(e&&e.__v_isRef===!0),ge=e=>Je(e)?e:e==null?"":me(e)||qe(e)&&(e.toString===lm||!we(e.toString))?hm(e)?ge(e.value):JSON.stringify(e,pm,2):String(e),pm=(e,t)=>hm(t)?pm(e,t.value):ji(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[n,o],i)=>(r[oc(n,i)+" =>"]=o,r),{})}:vu(t)?{[`Set(${t.size})`]:[...t.values()].map(r=>oc(r))}:Wr(t)?oc(t):qe(t)&&!me(t)&&!fm(t)?String(t):t,oc=(e,t="")=>{var r;return Wr(e)?`Symbol(${(r=e.description)!=null?r:t})`:e};/**
* @vue/reactivity v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Mt;class hb{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Mt,!t&&Mt&&(this.index=(Mt.scopes||(Mt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,r;if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].pause();for(t=0,r=this.effects.length;t<r;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,r;if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].resume();for(t=0,r=this.effects.length;t<r;t++)this.effects[t].resume()}}run(t){if(this._active){const r=Mt;try{return Mt=this,t()}finally{Mt=r}}}on(){++this._on===1&&(this.prevScope=Mt,Mt=this)}off(){this._on>0&&--this._on===0&&(Mt=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(this.effects.length=0,r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.cleanups.length=0,this.scopes){for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0}}}function pb(){return Mt}let je;const sc=new WeakSet;class vm{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Mt&&Mt.active&&Mt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,sc.has(this)&&(sc.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||gm(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Ad(this),ym(this);const t=je,r=_r;je=this,_r=!0;try{return this.fn()}finally{_m(this),je=t,_r=r,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)sf(t);this.deps=this.depsTail=void 0,Ad(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?sc.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){al(this)&&this.run()}get dirty(){return al(this)}}let mm=0,Go,Vo;function gm(e,t=!1){if(e.flags|=8,t){e.next=Vo,Vo=e;return}e.next=Go,Go=e}function nf(){mm++}function of(){if(--mm>0)return;if(Vo){let t=Vo;for(Vo=void 0;t;){const r=t.next;t.next=void 0,t.flags&=-9,t=r}}let e;for(;Go;){let t=Go;for(Go=void 0;t;){const r=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(n){e||(e=n)}t=r}}if(e)throw e}function ym(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function _m(e){let t,r=e.depsTail,n=r;for(;n;){const o=n.prevDep;n.version===-1?(n===r&&(r=o),sf(n),vb(n)):t=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=o}e.deps=t,e.depsTail=r}function al(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(bm(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function bm(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===ss)||(e.globalVersion=ss,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!al(e))))return;e.flags|=2;const t=e.dep,r=je,n=_r;je=e,_r=!0;try{ym(e);const o=e.fn(e._value);(t.version===0||Dn(o,e._value))&&(e.flags|=128,e._value=o,t.version++)}catch(o){throw t.version++,o}finally{je=r,_r=n,_m(e),e.flags&=-3}}function sf(e,t=!1){const{dep:r,prevSub:n,nextSub:o}=e;if(n&&(n.nextSub=o,e.prevSub=void 0),o&&(o.prevSub=n,e.nextSub=void 0),r.subs===e&&(r.subs=n,!n&&r.computed)){r.computed.flags&=-5;for(let i=r.computed.deps;i;i=i.nextDep)sf(i,!0)}!t&&!--r.sc&&r.map&&r.map.delete(r.key)}function vb(e){const{prevDep:t,nextDep:r}=e;t&&(t.nextDep=r,e.prevDep=void 0),r&&(r.prevDep=t,e.nextDep=void 0)}let _r=!0;const wm=[];function dn(){wm.push(_r),_r=!1}function hn(){const e=wm.pop();_r=e===void 0?!0:e}function Ad(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const r=je;je=void 0;try{t()}finally{je=r}}}let ss=0;class mb{constructor(t,r){this.sub=t,this.dep=r,this.version=r.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class af{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!je||!_r||je===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==je)r=this.activeLink=new mb(je,this),je.deps?(r.prevDep=je.depsTail,je.depsTail.nextDep=r,je.depsTail=r):je.deps=je.depsTail=r,Em(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const n=r.nextDep;n.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=n),r.prevDep=je.depsTail,r.nextDep=void 0,je.depsTail.nextDep=r,je.depsTail=r,je.deps===r&&(je.deps=n)}return r}trigger(t){this.version++,ss++,this.notify(t)}notify(t){nf();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()&&r.sub.dep.notify()}finally{of()}}}function Em(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let n=t.deps;n;n=n.nextDep)Em(n)}const r=e.dep.subs;r!==e&&(e.prevSub=r,r&&(r.nextSub=e)),e.dep.subs=e}}const ul=new WeakMap,ui=Symbol(""),cl=Symbol(""),as=Symbol("");function mt(e,t,r){if(_r&&je){let n=ul.get(e);n||ul.set(e,n=new Map);let o=n.get(r);o||(n.set(r,o=new af),o.map=n,o.key=r),o.track()}}function rn(e,t,r,n,o,i){const a=ul.get(e);if(!a){ss++;return}const u=l=>{l&&l.trigger()};if(nf(),t==="clear")a.forEach(u);else{const l=me(e),s=l&&tf(r);if(l&&r==="length"){const c=Number(n);a.forEach((f,d)=>{(d==="length"||d===as||!Wr(d)&&d>=c)&&u(f)})}else switch((r!==void 0||a.has(void 0))&&u(a.get(r)),s&&u(a.get(as)),t){case"add":l?s&&u(a.get("length")):(u(a.get(ui)),ji(e)&&u(a.get(cl)));break;case"delete":l||(u(a.get(ui)),ji(e)&&u(a.get(cl)));break;case"set":ji(e)&&u(a.get(ui));break}}of()}function Si(e){const t=Ne(e);return t===e?t:(mt(t,"iterate",as),or(e)?t:t.map(ct))}function bu(e){return mt(e=Ne(e),"iterate",as),e}const gb={__proto__:null,[Symbol.iterator](){return ac(this,Symbol.iterator,ct)},concat(...e){return Si(this).concat(...e.map(t=>me(t)?Si(t):t))},entries(){return ac(this,"entries",e=>(e[1]=ct(e[1]),e))},every(e,t){return Kr(this,"every",e,t,void 0,arguments)},filter(e,t){return Kr(this,"filter",e,t,r=>r.map(ct),arguments)},find(e,t){return Kr(this,"find",e,t,ct,arguments)},findIndex(e,t){return Kr(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Kr(this,"findLast",e,t,ct,arguments)},findLastIndex(e,t){return Kr(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Kr(this,"forEach",e,t,void 0,arguments)},includes(...e){return uc(this,"includes",e)},indexOf(...e){return uc(this,"indexOf",e)},join(e){return Si(this).join(e)},lastIndexOf(...e){return uc(this,"lastIndexOf",e)},map(e,t){return Kr(this,"map",e,t,void 0,arguments)},pop(){return _o(this,"pop")},push(...e){return _o(this,"push",e)},reduce(e,...t){return Rd(this,"reduce",e,t)},reduceRight(e,...t){return Rd(this,"reduceRight",e,t)},shift(){return _o(this,"shift")},some(e,t){return Kr(this,"some",e,t,void 0,arguments)},splice(...e){return _o(this,"splice",e)},toReversed(){return Si(this).toReversed()},toSorted(e){return Si(this).toSorted(e)},toSpliced(...e){return Si(this).toSpliced(...e)},unshift(...e){return _o(this,"unshift",e)},values(){return ac(this,"values",ct)}};function ac(e,t,r){const n=bu(e),o=n[t]();return n!==e&&!or(e)&&(o._next=o.next,o.next=()=>{const i=o._next();return i.value&&(i.value=r(i.value)),i}),o}const yb=Array.prototype;function Kr(e,t,r,n,o,i){const a=bu(e),u=a!==e&&!or(e),l=a[t];if(l!==yb[t]){const f=l.apply(e,i);return u?ct(f):f}let s=r;a!==e&&(u?s=function(f,d){return r.call(this,ct(f),d,e)}:r.length>2&&(s=function(f,d){return r.call(this,f,d,e)}));const c=l.call(a,s,n);return u&&o?o(c):c}function Rd(e,t,r,n){const o=bu(e);let i=r;return o!==e&&(or(e)?r.length>3&&(i=function(a,u,l){return r.call(this,a,u,l,e)}):i=function(a,u,l){return r.call(this,a,ct(u),l,e)}),o[t](i,...n)}function uc(e,t,r){const n=Ne(e);mt(n,"iterate",as);const o=n[t](...r);return(o===-1||o===!1)&&lf(r[0])?(r[0]=Ne(r[0]),n[t](...r)):o}function _o(e,t,r=[]){dn(),nf();const n=Ne(e)[t].apply(e,r);return of(),hn(),n}const _b=Xl("__proto__,__v_isRef,__isVue"),Sm=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Wr));function bb(e){Wr(e)||(e=String(e));const t=Ne(this);return mt(t,"has",e),t.hasOwnProperty(e)}class Im{constructor(t=!1,r=!1){this._isReadonly=t,this._isShallow=r}get(t,r,n){if(r==="__v_skip")return t.__v_skip;const o=this._isReadonly,i=this._isShallow;if(r==="__v_isReactive")return!o;if(r==="__v_isReadonly")return o;if(r==="__v_isShallow")return i;if(r==="__v_raw")return n===(o?i?xb:Rm:i?Am:Tm).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(n)?t:void 0;const a=me(t);if(!o){let l;if(a&&(l=gb[r]))return l;if(r==="hasOwnProperty")return bb}const u=Reflect.get(t,r,_t(t)?t:n);return(Wr(r)?Sm.has(r):_b(r))||(o||mt(t,"get",r),i)?u:_t(u)?a&&tf(r)?u:u.value:qe(u)?o?xm(u):bi(u):u}}class Om extends Im{constructor(t=!1){super(!1,t)}set(t,r,n,o){let i=t[r];if(!this._isShallow){const l=Fn(i);if(!or(n)&&!Fn(n)&&(i=Ne(i),n=Ne(n)),!me(t)&&_t(i)&&!_t(n))return l?!1:(i.value=n,!0)}const a=me(t)&&tf(r)?Number(r)<t.length:$e(t,r),u=Reflect.set(t,r,n,_t(t)?t:o);return t===Ne(o)&&(a?Dn(n,i)&&rn(t,"set",r,n):rn(t,"add",r,n)),u}deleteProperty(t,r){const n=$e(t,r);t[r];const o=Reflect.deleteProperty(t,r);return o&&n&&rn(t,"delete",r,void 0),o}has(t,r){const n=Reflect.has(t,r);return(!Wr(r)||!Sm.has(r))&&mt(t,"has",r),n}ownKeys(t){return mt(t,"iterate",me(t)?"length":ui),Reflect.ownKeys(t)}}class wb extends Im{constructor(t=!1){super(!0,t)}set(t,r){return!0}deleteProperty(t,r){return!0}}const Eb=new Om,Sb=new wb,Ib=new Om(!0);const ll=e=>e,Us=e=>Reflect.getPrototypeOf(e);function Ob(e,t,r){return function(...n){const o=this.__v_raw,i=Ne(o),a=ji(i),u=e==="entries"||e===Symbol.iterator&&a,l=e==="keys"&&a,s=o[e](...n),c=r?ll:t?Ia:ct;return!t&&mt(i,"iterate",l?cl:ui),{next(){const{value:f,done:d}=s.next();return d?{value:f,done:d}:{value:u?[c(f[0]),c(f[1])]:c(f),done:d}},[Symbol.iterator](){return this}}}}function Fs(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Tb(e,t){const r={get(o){const i=this.__v_raw,a=Ne(i),u=Ne(o);e||(Dn(o,u)&&mt(a,"get",o),mt(a,"get",u));const{has:l}=Us(a),s=t?ll:e?Ia:ct;if(l.call(a,o))return s(i.get(o));if(l.call(a,u))return s(i.get(u));i!==a&&i.get(o)},get size(){const o=this.__v_raw;return!e&&mt(Ne(o),"iterate",ui),Reflect.get(o,"size",o)},has(o){const i=this.__v_raw,a=Ne(i),u=Ne(o);return e||(Dn(o,u)&&mt(a,"has",o),mt(a,"has",u)),o===u?i.has(o):i.has(o)||i.has(u)},forEach(o,i){const a=this,u=a.__v_raw,l=Ne(u),s=t?ll:e?Ia:ct;return!e&&mt(l,"iterate",ui),u.forEach((c,f)=>o.call(i,s(c),s(f),a))}};return bt(r,e?{add:Fs("add"),set:Fs("set"),delete:Fs("delete"),clear:Fs("clear")}:{add(o){!t&&!or(o)&&!Fn(o)&&(o=Ne(o));const i=Ne(this);return Us(i).has.call(i,o)||(i.add(o),rn(i,"add",o,o)),this},set(o,i){!t&&!or(i)&&!Fn(i)&&(i=Ne(i));const a=Ne(this),{has:u,get:l}=Us(a);let s=u.call(a,o);s||(o=Ne(o),s=u.call(a,o));const c=l.call(a,o);return a.set(o,i),s?Dn(i,c)&&rn(a,"set",o,i):rn(a,"add",o,i),this},delete(o){const i=Ne(this),{has:a,get:u}=Us(i);let l=a.call(i,o);l||(o=Ne(o),l=a.call(i,o)),u&&u.call(i,o);const s=i.delete(o);return l&&rn(i,"delete",o,void 0),s},clear(){const o=Ne(this),i=o.size!==0,a=o.clear();return i&&rn(o,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(o=>{r[o]=Ob(o,e,t)}),r}function uf(e,t){const r=Tb(e,t);return(n,o,i)=>o==="__v_isReactive"?!e:o==="__v_isReadonly"?e:o==="__v_raw"?n:Reflect.get($e(r,o)&&o in n?r:n,o,i)}const Ab={get:uf(!1,!1)},Rb={get:uf(!1,!0)},Cb={get:uf(!0,!1)};const Tm=new WeakMap,Am=new WeakMap,Rm=new WeakMap,xb=new WeakMap;function Pb(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Nb(e){return e.__v_skip||!Object.isExtensible(e)?0:Pb(rb(e))}function bi(e){return Fn(e)?e:cf(e,!1,Eb,Ab,Tm)}function Cm(e){return cf(e,!1,Ib,Rb,Am)}function xm(e){return cf(e,!0,Sb,Cb,Rm)}function cf(e,t,r,n,o){if(!qe(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=Nb(e);if(i===0)return e;const a=o.get(e);if(a)return a;const u=new Proxy(e,i===2?n:r);return o.set(e,u),u}function ki(e){return Fn(e)?ki(e.__v_raw):!!(e&&e.__v_isReactive)}function Fn(e){return!!(e&&e.__v_isReadonly)}function or(e){return!!(e&&e.__v_isShallow)}function lf(e){return e?!!e.__v_raw:!1}function Ne(e){const t=e&&e.__v_raw;return t?Ne(t):e}function $b(e){return!$e(e,"__v_skip")&&Object.isExtensible(e)&&sl(e,"__v_skip",!0),e}const ct=e=>qe(e)?bi(e):e,Ia=e=>qe(e)?xm(e):e;function _t(e){return e?e.__v_isRef===!0:!1}function ve(e){return Pm(e,!1)}function Db(e){return Pm(e,!0)}function Pm(e,t){return _t(e)?e:new Lb(e,t)}class Lb{constructor(t,r){this.dep=new af,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?t:Ne(t),this._value=r?t:ct(t),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(t){const r=this._rawValue,n=this.__v_isShallow||or(t)||Fn(t);t=n?t:Ne(t),Dn(t,r)&&(this._rawValue=t,this._value=n?t:ct(t),this.dep.trigger())}}function cn(e){return _t(e)?e.value:e}const Ub={get:(e,t,r)=>t==="__v_raw"?e:cn(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const o=e[t];return _t(o)&&!_t(r)?(o.value=r,!0):Reflect.set(e,t,r,n)}};function Nm(e){return ki(e)?e:new Proxy(e,Ub)}class Fb{constructor(t,r,n){this.fn=t,this.setter=r,this._value=void 0,this.dep=new af(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ss-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!r,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&je!==this)return gm(this,!0),!0}get value(){const t=this.dep.track();return bm(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Mb(e,t,r=!1){let n,o;return we(e)?n=e:(n=e.get,o=e.set),new Fb(n,o,r)}const Ms={},Oa=new WeakMap;let Jn;function Bb(e,t=!1,r=Jn){if(r){let n=Oa.get(r);n||Oa.set(r,n=[]),n.push(e)}}function jb(e,t,r=Fe){const{immediate:n,deep:o,once:i,scheduler:a,augmentJob:u,call:l}=r,s=I=>o?I:or(I)||o===!1||o===0?nn(I,1):nn(I);let c,f,d,v,g=!1,b=!1;if(_t(e)?(f=()=>e.value,g=or(e)):ki(e)?(f=()=>s(e),g=!0):me(e)?(b=!0,g=e.some(I=>ki(I)||or(I)),f=()=>e.map(I=>{if(_t(I))return I.value;if(ki(I))return s(I);if(we(I))return l?l(I,2):I()})):we(e)?t?f=l?()=>l(e,2):e:f=()=>{if(d){dn();try{d()}finally{hn()}}const I=Jn;Jn=c;try{return l?l(e,3,[v]):e(v)}finally{Jn=I}}:f=qr,t&&o){const I=f,R=o===!0?1/0:o;f=()=>nn(I(),R)}const y=pb(),w=()=>{c.stop(),y&&y.active&&ef(y.effects,c)};if(i&&t){const I=t;t=(...R)=>{I(...R),w()}}let E=b?new Array(e.length).fill(Ms):Ms;const A=I=>{if(!(!(c.flags&1)||!c.dirty&&!I))if(t){const R=c.run();if(o||g||(b?R.some((L,F)=>Dn(L,E[F])):Dn(R,E))){d&&d();const L=Jn;Jn=c;try{const F=[R,E===Ms?void 0:b&&E[0]===Ms?[]:E,v];E=R,l?l(t,3,F):t(...F)}finally{Jn=L}}}else c.run()};return u&&u(A),c=new vm(f),c.scheduler=a?()=>a(A,!1):A,v=I=>Bb(I,!1,c),d=c.onStop=()=>{const I=Oa.get(c);if(I){if(l)l(I,4);else for(const R of I)R();Oa.delete(c)}},t?n?A(!0):E=c.run():a?a(A.bind(null,!0),!0):c.run(),w.pause=c.pause.bind(c),w.resume=c.resume.bind(c),w.stop=w,w}function nn(e,t=1/0,r){if(t<=0||!qe(e)||e.__v_skip||(r=r||new Set,r.has(e)))return e;if(r.add(e),t--,_t(e))nn(e.value,t,r);else if(me(e))for(let n=0;n<e.length;n++)nn(e[n],t,r);else if(vu(e)||ji(e))e.forEach(n=>{nn(n,t,r)});else if(fm(e)){for(const n in e)nn(e[n],t,r);for(const n of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,n)&&nn(e[n],t,r)}return e}/**
* @vue/runtime-core v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Rs(e,t,r,n){try{return n?e(...n):e()}catch(o){wu(o,t,r)}}function Hr(e,t,r,n){if(we(e)){const o=Rs(e,t,r,n);return o&&cm(o)&&o.catch(i=>{wu(i,t,r)}),o}if(me(e)){const o=[];for(let i=0;i<e.length;i++)o.push(Hr(e[i],t,r,n));return o}}function wu(e,t,r,n=!0){const o=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:a}=t&&t.appContext.config||Fe;if(t){let u=t.parent;const l=t.proxy,s=`https://vuejs.org/error-reference/#runtime-${r}`;for(;u;){const c=u.ec;if(c){for(let f=0;f<c.length;f++)if(c[f](e,l,s)===!1)return}u=u.parent}if(i){dn(),Rs(i,null,10,[e,l,s]),hn();return}}kb(e,r,o,n,a)}function kb(e,t,r,n=!0,o=!1){if(o)throw e;console.error(e)}const Ot=[];let $r=-1;const qi=[];let bn=null,Ci=0;const $m=Promise.resolve();let Ta=null;function ff(e){const t=Ta||$m;return e?t.then(this?e.bind(this):e):t}function qb(e){let t=$r+1,r=Ot.length;for(;t<r;){const n=t+r>>>1,o=Ot[n],i=us(o);i<e||i===e&&o.flags&2?t=n+1:r=n}return t}function df(e){if(!(e.flags&1)){const t=us(e),r=Ot[Ot.length-1];!r||!(e.flags&2)&&t>=us(r)?Ot.push(e):Ot.splice(qb(t),0,e),e.flags|=1,Dm()}}function Dm(){Ta||(Ta=$m.then(Um))}function Wb(e){me(e)?qi.push(...e):bn&&e.id===-1?bn.splice(Ci+1,0,e):e.flags&1||(qi.push(e),e.flags|=1),Dm()}function Cd(e,t,r=$r+1){for(;r<Ot.length;r++){const n=Ot[r];if(n&&n.flags&2){if(e&&n.id!==e.uid)continue;Ot.splice(r,1),r--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function Lm(e){if(qi.length){const t=[...new Set(qi)].sort((r,n)=>us(r)-us(n));if(qi.length=0,bn){bn.push(...t);return}for(bn=t,Ci=0;Ci<bn.length;Ci++){const r=bn[Ci];r.flags&4&&(r.flags&=-2),r.flags&8||r(),r.flags&=-2}bn=null,Ci=0}}const us=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Um(e){try{for($r=0;$r<Ot.length;$r++){const t=Ot[$r];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Rs(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;$r<Ot.length;$r++){const t=Ot[$r];t&&(t.flags&=-2)}$r=-1,Ot.length=0,Lm(),Ta=null,(Ot.length||qi.length)&&Um()}}let Jt=null,Fm=null;function Aa(e){const t=Jt;return Jt=e,Fm=e&&e.type.__scopeId||null,t}function Mm(e,t=Jt,r){if(!t||e._n)return e;const n=(...o)=>{n._d&&Bd(-1);const i=Aa(t);let a;try{a=e(...o)}finally{Aa(i),n._d&&Bd(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function ke(e,t){if(Jt===null)return e;const r=Ou(Jt),n=e.dirs||(e.dirs=[]);for(let o=0;o<t.length;o++){let[i,a,u,l=Fe]=t[o];i&&(we(i)&&(i={mounted:i,updated:i}),i.deep&&nn(a),n.push({dir:i,instance:r,value:a,oldValue:void 0,arg:u,modifiers:l}))}return e}function qn(e,t,r,n){const o=e.dirs,i=t&&t.dirs;for(let a=0;a<o.length;a++){const u=o[a];i&&(u.oldValue=i[a].value);let l=u.dir[n];l&&(dn(),Hr(l,r,8,[e.el,u,e,t]),hn())}}const Hb=Symbol("_vte"),Gb=e=>e.__isTeleport;function hf(e,t){e.shapeFlag&6&&e.component?(e.transition=t,hf(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}/*! #__NO_SIDE_EFFECTS__ */function vn(e,t){return we(e)?bt({name:e.name},t,{setup:e}):e}function Bm(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function Ko(e,t,r,n,o=!1){if(me(e)){e.forEach((g,b)=>Ko(g,t&&(me(t)?t[b]:t),r,n,o));return}if(zo(n)&&!o){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Ko(e,t,r,n.component.subTree);return}const i=n.shapeFlag&4?Ou(n.component):n.el,a=o?null:i,{i:u,r:l}=e,s=t&&t.r,c=u.refs===Fe?u.refs={}:u.refs,f=u.setupState,d=Ne(f),v=f===Fe?()=>!1:g=>$e(d,g);if(s!=null&&s!==l&&(Je(s)?(c[s]=null,v(s)&&(f[s]=null)):_t(s)&&(s.value=null)),we(l))Rs(l,u,12,[a,c]);else{const g=Je(l),b=_t(l);if(g||b){const y=()=>{if(e.f){const w=g?v(l)?f[l]:c[l]:l.value;o?me(w)&&ef(w,i):me(w)?w.includes(i)||w.push(i):g?(c[l]=[i],v(l)&&(f[l]=c[l])):(l.value=[i],e.k&&(c[e.k]=l.value))}else g?(c[l]=a,v(l)&&(f[l]=a)):b&&(l.value=a,e.k&&(c[e.k]=a))};a?(y.id=-1,Gt(y,r)):y()}}}yu().requestIdleCallback;yu().cancelIdleCallback;const zo=e=>!!e.type.__asyncLoader,jm=e=>e.type.__isKeepAlive;function Vb(e,t){km(e,"a",t)}function Kb(e,t){km(e,"da",t)}function km(e,t,r=gt){const n=e.__wdc||(e.__wdc=()=>{let o=r;for(;o;){if(o.isDeactivated)return;o=o.parent}return e()});if(Eu(t,n,r),r){let o=r.parent;for(;o&&o.parent;)jm(o.parent.vnode)&&zb(n,t,r,o),o=o.parent}}function zb(e,t,r,n){const o=Eu(t,e,n,!0);qm(()=>{ef(n[t],o)},r)}function Eu(e,t,r=gt,n=!1){if(r){const o=r[e]||(r[e]=[]),i=t.__weh||(t.__weh=(...a)=>{dn();const u=xs(r),l=Hr(t,r,e,a);return u(),hn(),l});return n?o.unshift(i):o.push(i),i}}const mn=e=>(t,r=gt)=>{(!ls||e==="sp")&&Eu(e,(...n)=>t(...n),r)},Jb=mn("bm"),Cs=mn("m"),Yb=mn("bu"),Qb=mn("u"),Xb=mn("bum"),qm=mn("um"),Zb=mn("sp"),ew=mn("rtg"),tw=mn("rtc");function rw(e,t=gt){Eu("ec",e,t)}const Wm="components";function Hm(e,t){return Vm(Wm,e,!0,t)||e}const Gm=Symbol.for("v-ndc");function nw(e){return Je(e)?Vm(Wm,e,!1)||e:e||Gm}function Vm(e,t,r=!0,n=!1){const o=Jt||gt;if(o){const i=o.type;{const u=Gw(i,!1);if(u&&(u===t||u===sr(t)||u===gu(sr(t))))return i}const a=xd(o[e]||i[e],t)||xd(o.appContext[e],t);return!a&&n?i:a}}function xd(e,t){return e&&(e[t]||e[sr(t)]||e[gu(sr(t))])}function Tt(e,t,r,n){let o;const i=r,a=me(e);if(a||Je(e)){const u=a&&ki(e);let l=!1,s=!1;u&&(l=!or(e),s=Fn(e),e=bu(e)),o=new Array(e.length);for(let c=0,f=e.length;c<f;c++)o[c]=t(l?s?Ia(ct(e[c])):ct(e[c]):e[c],c,void 0,i)}else if(typeof e=="number"){o=new Array(e);for(let u=0;u<e;u++)o[u]=t(u+1,u,void 0,i)}else if(qe(e))if(e[Symbol.iterator])o=Array.from(e,(u,l)=>t(u,l,void 0,i));else{const u=Object.keys(e);o=new Array(u.length);for(let l=0,s=u.length;l<s;l++){const c=u[l];o[l]=t(e[c],c,l,i)}}else o=[];return o}const fl=e=>e?hg(e)?Ou(e):fl(e.parent):null,Jo=bt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>fl(e.parent),$root:e=>fl(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>zm(e),$forceUpdate:e=>e.f||(e.f=()=>{df(e.update)}),$nextTick:e=>e.n||(e.n=ff.bind(e.proxy)),$watch:e=>Iw.bind(e)}),cc=(e,t)=>e!==Fe&&!e.__isScriptSetup&&$e(e,t),iw={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:r,setupState:n,data:o,props:i,accessCache:a,type:u,appContext:l}=e;let s;if(t[0]!=="$"){const v=a[t];if(v!==void 0)switch(v){case 1:return n[t];case 2:return o[t];case 4:return r[t];case 3:return i[t]}else{if(cc(n,t))return a[t]=1,n[t];if(o!==Fe&&$e(o,t))return a[t]=2,o[t];if((s=e.propsOptions[0])&&$e(s,t))return a[t]=3,i[t];if(r!==Fe&&$e(r,t))return a[t]=4,r[t];dl&&(a[t]=0)}}const c=Jo[t];let f,d;if(c)return t==="$attrs"&&mt(e.attrs,"get",""),c(e);if((f=u.__cssModules)&&(f=f[t]))return f;if(r!==Fe&&$e(r,t))return a[t]=4,r[t];if(d=l.config.globalProperties,$e(d,t))return d[t]},set({_:e},t,r){const{data:n,setupState:o,ctx:i}=e;return cc(o,t)?(o[t]=r,!0):n!==Fe&&$e(n,t)?(n[t]=r,!0):$e(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:o,propsOptions:i}},a){let u;return!!r[a]||e!==Fe&&$e(e,a)||cc(t,a)||(u=i[0])&&$e(u,a)||$e(n,a)||$e(Jo,a)||$e(o.config.globalProperties,a)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:$e(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};function Pd(e){return me(e)?e.reduce((t,r)=>(t[r]=null,t),{}):e}let dl=!0;function ow(e){const t=zm(e),r=e.proxy,n=e.ctx;dl=!1,t.beforeCreate&&Nd(t.beforeCreate,e,"bc");const{data:o,computed:i,methods:a,watch:u,provide:l,inject:s,created:c,beforeMount:f,mounted:d,beforeUpdate:v,updated:g,activated:b,deactivated:y,beforeDestroy:w,beforeUnmount:E,destroyed:A,unmounted:I,render:R,renderTracked:L,renderTriggered:F,errorCaptured:U,serverPrefetch:N,expose:W,inheritAttrs:j,components:X,directives:fe,filters:q}=t;if(s&&sw(s,n,null),a)for(const M in a){const D=a[M];we(D)&&(n[M]=D.bind(r))}if(o){const M=o.call(r,r);qe(M)&&(e.data=bi(M))}if(dl=!0,i)for(const M in i){const D=i[M],G=we(D)?D.bind(r,r):we(D.get)?D.get.bind(r,r):qr,Z=!we(D)&&we(D.set)?D.set.bind(r):qr,ne=Ve({get:G,set:Z});Object.defineProperty(n,M,{enumerable:!0,configurable:!0,get:()=>ne.value,set:Ee=>ne.value=Ee})}if(u)for(const M in u)Km(u[M],n,r,M);if(l){const M=we(l)?l.call(r):l;Reflect.ownKeys(M).forEach(D=>{oa(D,M[D])})}c&&Nd(c,e,"c");function k(M,D){me(D)?D.forEach(G=>M(G.bind(r))):D&&M(D.bind(r))}if(k(Jb,f),k(Cs,d),k(Yb,v),k(Qb,g),k(Vb,b),k(Kb,y),k(rw,U),k(tw,L),k(ew,F),k(Xb,E),k(qm,I),k(Zb,N),me(W))if(W.length){const M=e.exposed||(e.exposed={});W.forEach(D=>{Object.defineProperty(M,D,{get:()=>r[D],set:G=>r[D]=G,enumerable:!0})})}else e.exposed||(e.exposed={});R&&e.render===qr&&(e.render=R),j!=null&&(e.inheritAttrs=j),X&&(e.components=X),fe&&(e.directives=fe),N&&Bm(e)}function sw(e,t,r=qr){me(e)&&(e=hl(e));for(const n in e){const o=e[n];let i;qe(o)?"default"in o?i=br(o.from||n,o.default,!0):i=br(o.from||n):i=br(o),_t(i)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:a=>i.value=a}):t[n]=i}}function Nd(e,t,r){Hr(me(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function Km(e,t,r,n){let o=n.includes(".")?ag(r,n):()=>r[n];if(Je(e)){const i=t[e];we(i)&&Ln(o,i)}else if(we(e))Ln(o,e.bind(r));else if(qe(e))if(me(e))e.forEach(i=>Km(i,t,r,n));else{const i=we(e.handler)?e.handler.bind(r):t[e.handler];we(i)&&Ln(o,i,e)}}function zm(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:o,optionsCache:i,config:{optionMergeStrategies:a}}=e.appContext,u=i.get(t);let l;return u?l=u:!o.length&&!r&&!n?l=t:(l={},o.length&&o.forEach(s=>Ra(l,s,a,!0)),Ra(l,t,a)),qe(t)&&i.set(t,l),l}function Ra(e,t,r,n=!1){const{mixins:o,extends:i}=t;i&&Ra(e,i,r,!0),o&&o.forEach(a=>Ra(e,a,r,!0));for(const a in t)if(!(n&&a==="expose")){const u=aw[a]||r&&r[a];e[a]=u?u(e[a],t[a]):t[a]}return e}const aw={data:$d,props:Dd,emits:Dd,methods:Mo,computed:Mo,beforeCreate:Et,created:Et,beforeMount:Et,mounted:Et,beforeUpdate:Et,updated:Et,beforeDestroy:Et,beforeUnmount:Et,destroyed:Et,unmounted:Et,activated:Et,deactivated:Et,errorCaptured:Et,serverPrefetch:Et,components:Mo,directives:Mo,watch:cw,provide:$d,inject:uw};function $d(e,t){return t?e?function(){return bt(we(e)?e.call(this,this):e,we(t)?t.call(this,this):t)}:t:e}function uw(e,t){return Mo(hl(e),hl(t))}function hl(e){if(me(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function Et(e,t){return e?[...new Set([].concat(e,t))]:t}function Mo(e,t){return e?bt(Object.create(null),e,t):t}function Dd(e,t){return e?me(e)&&me(t)?[...new Set([...e,...t])]:bt(Object.create(null),Pd(e),Pd(t??{})):t}function cw(e,t){if(!e)return t;if(!t)return e;const r=bt(Object.create(null),e);for(const n in t)r[n]=Et(e[n],t[n]);return r}function Jm(){return{app:null,config:{isNativeTag:eb,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let lw=0;function fw(e,t){return function(n,o=null){we(n)||(n=bt({},n)),o!=null&&!qe(o)&&(o=null);const i=Jm(),a=new WeakSet,u=[];let l=!1;const s=i.app={_uid:lw++,_component:n,_props:o,_container:null,_context:i,_instance:null,version:Kw,get config(){return i.config},set config(c){},use(c,...f){return a.has(c)||(c&&we(c.install)?(a.add(c),c.install(s,...f)):we(c)&&(a.add(c),c(s,...f))),s},mixin(c){return i.mixins.includes(c)||i.mixins.push(c),s},component(c,f){return f?(i.components[c]=f,s):i.components[c]},directive(c,f){return f?(i.directives[c]=f,s):i.directives[c]},mount(c,f,d){if(!l){const v=s._ceVNode||Rt(n,o);return v.appContext=i,d===!0?d="svg":d===!1&&(d=void 0),e(v,c,d),l=!0,s._container=c,c.__vue_app__=s,Ou(v.component)}},onUnmount(c){u.push(c)},unmount(){l&&(Hr(u,s._instance,16),e(null,s._container),delete s._container.__vue_app__)},provide(c,f){return i.provides[c]=f,s},runWithContext(c){const f=Wi;Wi=s;try{return c()}finally{Wi=f}}};return s}}let Wi=null;function oa(e,t){if(gt){let r=gt.provides;const n=gt.parent&&gt.parent.provides;n===r&&(r=gt.provides=Object.create(n)),r[e]=t}}function br(e,t,r=!1){const n=jw();if(n||Wi){let o=Wi?Wi._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(o&&e in o)return o[e];if(arguments.length>1)return r&&we(t)?t.call(n&&n.proxy):t}}const Ym={},Qm=()=>Object.create(Ym),Xm=e=>Object.getPrototypeOf(e)===Ym;function dw(e,t,r,n=!1){const o={},i=Qm();e.propsDefaults=Object.create(null),Zm(e,t,o,i);for(const a in e.propsOptions[0])a in o||(o[a]=void 0);r?e.props=n?o:Cm(o):e.type.props?e.props=o:e.props=i,e.attrs=i}function hw(e,t,r,n){const{props:o,attrs:i,vnode:{patchFlag:a}}=e,u=Ne(o),[l]=e.propsOptions;let s=!1;if((n||a>0)&&!(a&16)){if(a&8){const c=e.vnode.dynamicProps;for(let f=0;f<c.length;f++){let d=c[f];if(Su(e.emitsOptions,d))continue;const v=t[d];if(l)if($e(i,d))v!==i[d]&&(i[d]=v,s=!0);else{const g=sr(d);o[g]=pl(l,u,g,v,e,!1)}else v!==i[d]&&(i[d]=v,s=!0)}}}else{Zm(e,t,o,i)&&(s=!0);let c;for(const f in u)(!t||!$e(t,f)&&((c=_i(f))===f||!$e(t,c)))&&(l?r&&(r[f]!==void 0||r[c]!==void 0)&&(o[f]=pl(l,u,f,void 0,e,!0)):delete o[f]);if(i!==u)for(const f in i)(!t||!$e(t,f))&&(delete i[f],s=!0)}s&&rn(e.attrs,"set","")}function Zm(e,t,r,n){const[o,i]=e.propsOptions;let a=!1,u;if(t)for(let l in t){if(Ho(l))continue;const s=t[l];let c;o&&$e(o,c=sr(l))?!i||!i.includes(c)?r[c]=s:(u||(u={}))[c]=s:Su(e.emitsOptions,l)||(!(l in n)||s!==n[l])&&(n[l]=s,a=!0)}if(i){const l=Ne(r),s=u||Fe;for(let c=0;c<i.length;c++){const f=i[c];r[f]=pl(o,l,f,s[f],e,!$e(s,f))}}return a}function pl(e,t,r,n,o,i){const a=e[r];if(a!=null){const u=$e(a,"default");if(u&&n===void 0){const l=a.default;if(a.type!==Function&&!a.skipFactory&&we(l)){const{propsDefaults:s}=o;if(r in s)n=s[r];else{const c=xs(o);n=s[r]=l.call(null,t),c()}}else n=l;o.ce&&o.ce._setProp(r,n)}a[0]&&(i&&!u?n=!1:a[1]&&(n===""||n===_i(r))&&(n=!0))}return n}const pw=new WeakMap;function eg(e,t,r=!1){const n=r?pw:t.propsCache,o=n.get(e);if(o)return o;const i=e.props,a={},u=[];let l=!1;if(!we(e)){const c=f=>{l=!0;const[d,v]=eg(f,t,!0);bt(a,d),v&&u.push(...v)};!r&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}if(!i&&!l)return qe(e)&&n.set(e,Bi),Bi;if(me(i))for(let c=0;c<i.length;c++){const f=sr(i[c]);Ld(f)&&(a[f]=Fe)}else if(i)for(const c in i){const f=sr(c);if(Ld(f)){const d=i[c],v=a[f]=me(d)||we(d)?{type:d}:bt({},d),g=v.type;let b=!1,y=!0;if(me(g))for(let w=0;w<g.length;++w){const E=g[w],A=we(E)&&E.name;if(A==="Boolean"){b=!0;break}else A==="String"&&(y=!1)}else b=we(g)&&g.name==="Boolean";v[0]=b,v[1]=y,(b||$e(v,"default"))&&u.push(f)}}const s=[a,u];return qe(e)&&n.set(e,s),s}function Ld(e){return e[0]!=="$"&&!Ho(e)}const pf=e=>e==="_"||e==="__"||e==="_ctx"||e==="$stable",vf=e=>me(e)?e.map(Ur):[Ur(e)],vw=(e,t,r)=>{if(t._n)return t;const n=Mm((...o)=>vf(t(...o)),r);return n._c=!1,n},tg=(e,t,r)=>{const n=e._ctx;for(const o in e){if(pf(o))continue;const i=e[o];if(we(i))t[o]=vw(o,i,n);else if(i!=null){const a=vf(i);t[o]=()=>a}}},rg=(e,t)=>{const r=vf(t);e.slots.default=()=>r},ng=(e,t,r)=>{for(const n in t)(r||!pf(n))&&(e[n]=t[n])},mw=(e,t,r)=>{const n=e.slots=Qm();if(e.vnode.shapeFlag&32){const o=t.__;o&&sl(n,"__",o,!0);const i=t._;i?(ng(n,t,r),r&&sl(n,"_",i,!0)):tg(t,n)}else t&&rg(e,t)},gw=(e,t,r)=>{const{vnode:n,slots:o}=e;let i=!0,a=Fe;if(n.shapeFlag&32){const u=t._;u?r&&u===1?i=!1:ng(o,t,r):(i=!t.$stable,tg(t,o)),a=t}else t&&(rg(e,t),a={default:1});if(i)for(const u in o)!pf(u)&&a[u]==null&&delete o[u]},Gt=Pw;function yw(e){return _w(e)}function _w(e,t){const r=yu();r.__VUE__=!0;const{insert:n,remove:o,patchProp:i,createElement:a,createText:u,createComment:l,setText:s,setElementText:c,parentNode:f,nextSibling:d,setScopeId:v=qr,insertStaticContent:g}=e,b=(S,T,$,m=null,h=null,p=null,_=void 0,O=null,P=!!T.dynamicChildren)=>{if(S===T)return;S&&!bo(S,T)&&(m=B(S),Ee(S,h,p,!0),S=null),T.patchFlag===-2&&(P=!1,T.dynamicChildren=null);const{type:x,ref:z,shapeFlag:H}=T;switch(x){case Iu:y(S,T,$,m);break;case Mn:w(S,T,$,m);break;case fc:S==null&&E(T,$,m,_);break;case Me:X(S,T,$,m,h,p,_,O,P);break;default:H&1?R(S,T,$,m,h,p,_,O,P):H&6?fe(S,T,$,m,h,p,_,O,P):(H&64||H&128)&&x.process(S,T,$,m,h,p,_,O,P,ee)}z!=null&&h?Ko(z,S&&S.ref,p,T||S,!T):z==null&&S&&S.ref!=null&&Ko(S.ref,null,p,S,!0)},y=(S,T,$,m)=>{if(S==null)n(T.el=u(T.children),$,m);else{const h=T.el=S.el;T.children!==S.children&&s(h,T.children)}},w=(S,T,$,m)=>{S==null?n(T.el=l(T.children||""),$,m):T.el=S.el},E=(S,T,$,m)=>{[S.el,S.anchor]=g(S.children,T,$,m,S.el,S.anchor)},A=({el:S,anchor:T},$,m)=>{let h;for(;S&&S!==T;)h=d(S),n(S,$,m),S=h;n(T,$,m)},I=({el:S,anchor:T})=>{let $;for(;S&&S!==T;)$=d(S),o(S),S=$;o(T)},R=(S,T,$,m,h,p,_,O,P)=>{T.type==="svg"?_="svg":T.type==="math"&&(_="mathml"),S==null?L(T,$,m,h,p,_,O,P):N(S,T,h,p,_,O,P)},L=(S,T,$,m,h,p,_,O)=>{let P,x;const{props:z,shapeFlag:H,transition:Q,dirs:ie}=S;if(P=S.el=a(S.type,p,z&&z.is,z),H&8?c(P,S.children):H&16&&U(S.children,P,null,m,h,lc(S,p),_,O),ie&&qn(S,null,m,"created"),F(P,S,S.scopeId,_,m),z){for(const Ce in z)Ce!=="value"&&!Ho(Ce)&&i(P,Ce,null,z[Ce],p,m);"value"in z&&i(P,"value",null,z.value,p),(x=z.onVnodeBeforeMount)&&Rr(x,m,S)}ie&&qn(S,null,m,"beforeMount");const ue=bw(h,Q);ue&&Q.beforeEnter(P),n(P,T,$),((x=z&&z.onVnodeMounted)||ue||ie)&&Gt(()=>{x&&Rr(x,m,S),ue&&Q.enter(P),ie&&qn(S,null,m,"mounted")},h)},F=(S,T,$,m,h)=>{if($&&v(S,$),m)for(let p=0;p<m.length;p++)v(S,m[p]);if(h){let p=h.subTree;if(T===p||cg(p.type)&&(p.ssContent===T||p.ssFallback===T)){const _=h.vnode;F(S,_,_.scopeId,_.slotScopeIds,h.parent)}}},U=(S,T,$,m,h,p,_,O,P=0)=>{for(let x=P;x<S.length;x++){const z=S[x]=O?wn(S[x]):Ur(S[x]);b(null,z,T,$,m,h,p,_,O)}},N=(S,T,$,m,h,p,_)=>{const O=T.el=S.el;let{patchFlag:P,dynamicChildren:x,dirs:z}=T;P|=S.patchFlag&16;const H=S.props||Fe,Q=T.props||Fe;let ie;if($&&Wn($,!1),(ie=Q.onVnodeBeforeUpdate)&&Rr(ie,$,T,S),z&&qn(T,S,$,"beforeUpdate"),$&&Wn($,!0),(H.innerHTML&&Q.innerHTML==null||H.textContent&&Q.textContent==null)&&c(O,""),x?W(S.dynamicChildren,x,O,$,m,lc(T,h),p):_||D(S,T,O,null,$,m,lc(T,h),p,!1),P>0){if(P&16)j(O,H,Q,$,h);else if(P&2&&H.class!==Q.class&&i(O,"class",null,Q.class,h),P&4&&i(O,"style",H.style,Q.style,h),P&8){const ue=T.dynamicProps;for(let Ce=0;Ce<ue.length;Ce++){const Ae=ue[Ce],at=H[Ae],xt=Q[Ae];(xt!==at||Ae==="value")&&i(O,Ae,at,xt,h,$)}}P&1&&S.children!==T.children&&c(O,T.children)}else!_&&x==null&&j(O,H,Q,$,h);((ie=Q.onVnodeUpdated)||z)&&Gt(()=>{ie&&Rr(ie,$,T,S),z&&qn(T,S,$,"updated")},m)},W=(S,T,$,m,h,p,_)=>{for(let O=0;O<T.length;O++){const P=S[O],x=T[O],z=P.el&&(P.type===Me||!bo(P,x)||P.shapeFlag&198)?f(P.el):$;b(P,x,z,null,m,h,p,_,!0)}},j=(S,T,$,m,h)=>{if(T!==$){if(T!==Fe)for(const p in T)!Ho(p)&&!(p in $)&&i(S,p,T[p],null,h,m);for(const p in $){if(Ho(p))continue;const _=$[p],O=T[p];_!==O&&p!=="value"&&i(S,p,O,_,h,m)}"value"in $&&i(S,"value",T.value,$.value,h)}},X=(S,T,$,m,h,p,_,O,P)=>{const x=T.el=S?S.el:u(""),z=T.anchor=S?S.anchor:u("");let{patchFlag:H,dynamicChildren:Q,slotScopeIds:ie}=T;ie&&(O=O?O.concat(ie):ie),S==null?(n(x,$,m),n(z,$,m),U(T.children||[],$,z,h,p,_,O,P)):H>0&&H&64&&Q&&S.dynamicChildren?(W(S.dynamicChildren,Q,$,h,p,_,O),(T.key!=null||h&&T===h.subTree)&&ig(S,T,!0)):D(S,T,$,z,h,p,_,O,P)},fe=(S,T,$,m,h,p,_,O,P)=>{T.slotScopeIds=O,S==null?T.shapeFlag&512?h.ctx.activate(T,$,m,_,P):q(T,$,m,h,p,_,P):de(S,T,P)},q=(S,T,$,m,h,p,_)=>{const O=S.component=Bw(S,m,h);if(jm(S)&&(O.ctx.renderer=ee),kw(O,!1,_),O.asyncDep){if(h&&h.registerDep(O,k,_),!S.el){const P=O.subTree=Rt(Mn);w(null,P,T,$),S.placeholder=P.el}}else k(O,S,T,$,h,p,_)},de=(S,T,$)=>{const m=T.component=S.component;if(Cw(S,T,$))if(m.asyncDep&&!m.asyncResolved){M(m,T,$);return}else m.next=T,m.update();else T.el=S.el,m.vnode=T},k=(S,T,$,m,h,p,_)=>{const O=()=>{if(S.isMounted){let{next:H,bu:Q,u:ie,parent:ue,vnode:Ce}=S;{const Tr=og(S);if(Tr){H&&(H.el=Ce.el,M(S,H,_)),Tr.asyncDep.then(()=>{S.isUnmounted||O()});return}}let Ae=H,at;Wn(S,!1),H?(H.el=Ce.el,M(S,H,_)):H=Ce,Q&&ia(Q),(at=H.props&&H.props.onVnodeBeforeUpdate)&&Rr(at,ue,H,Ce),Wn(S,!0);const xt=Fd(S),Or=S.subTree;S.subTree=xt,b(Or,xt,f(Or.el),B(Or),S,h,p),H.el=xt.el,Ae===null&&xw(S,xt.el),ie&&Gt(ie,h),(at=H.props&&H.props.onVnodeUpdated)&&Gt(()=>Rr(at,ue,H,Ce),h)}else{let H;const{el:Q,props:ie}=T,{bm:ue,m:Ce,parent:Ae,root:at,type:xt}=S,Or=zo(T);Wn(S,!1),ue&&ia(ue),!Or&&(H=ie&&ie.onVnodeBeforeMount)&&Rr(H,Ae,T),Wn(S,!0);{at.ce&&at.ce._def.shadowRoot!==!1&&at.ce._injectChildStyle(xt);const Tr=S.subTree=Fd(S);b(null,Tr,$,m,S,h,p),T.el=Tr.el}if(Ce&&Gt(Ce,h),!Or&&(H=ie&&ie.onVnodeMounted)){const Tr=T;Gt(()=>Rr(H,Ae,Tr),h)}(T.shapeFlag&256||Ae&&zo(Ae.vnode)&&Ae.vnode.shapeFlag&256)&&S.a&&Gt(S.a,h),S.isMounted=!0,T=$=m=null}};S.scope.on();const P=S.effect=new vm(O);S.scope.off();const x=S.update=P.run.bind(P),z=S.job=P.runIfDirty.bind(P);z.i=S,z.id=S.uid,P.scheduler=()=>df(z),Wn(S,!0),x()},M=(S,T,$)=>{T.component=S;const m=S.vnode.props;S.vnode=T,S.next=null,hw(S,T.props,m,$),gw(S,T.children,$),dn(),Cd(S),hn()},D=(S,T,$,m,h,p,_,O,P=!1)=>{const x=S&&S.children,z=S?S.shapeFlag:0,H=T.children,{patchFlag:Q,shapeFlag:ie}=T;if(Q>0){if(Q&128){Z(x,H,$,m,h,p,_,O,P);return}else if(Q&256){G(x,H,$,m,h,p,_,O,P);return}}ie&8?(z&16&&he(x,h,p),H!==x&&c($,H)):z&16?ie&16?Z(x,H,$,m,h,p,_,O,P):he(x,h,p,!0):(z&8&&c($,""),ie&16&&U(H,$,m,h,p,_,O,P))},G=(S,T,$,m,h,p,_,O,P)=>{S=S||Bi,T=T||Bi;const x=S.length,z=T.length,H=Math.min(x,z);let Q;for(Q=0;Q<H;Q++){const ie=T[Q]=P?wn(T[Q]):Ur(T[Q]);b(S[Q],ie,$,null,h,p,_,O,P)}x>z?he(S,h,p,!0,!1,H):U(T,$,m,h,p,_,O,P,H)},Z=(S,T,$,m,h,p,_,O,P)=>{let x=0;const z=T.length;let H=S.length-1,Q=z-1;for(;x<=H&&x<=Q;){const ie=S[x],ue=T[x]=P?wn(T[x]):Ur(T[x]);if(bo(ie,ue))b(ie,ue,$,null,h,p,_,O,P);else break;x++}for(;x<=H&&x<=Q;){const ie=S[H],ue=T[Q]=P?wn(T[Q]):Ur(T[Q]);if(bo(ie,ue))b(ie,ue,$,null,h,p,_,O,P);else break;H--,Q--}if(x>H){if(x<=Q){const ie=Q+1,ue=ie<z?T[ie].el:m;for(;x<=Q;)b(null,T[x]=P?wn(T[x]):Ur(T[x]),$,ue,h,p,_,O,P),x++}}else if(x>Q)for(;x<=H;)Ee(S[x],h,p,!0),x++;else{const ie=x,ue=x,Ce=new Map;for(x=ue;x<=Q;x++){const Wt=T[x]=P?wn(T[x]):Ur(T[x]);Wt.key!=null&&Ce.set(Wt.key,x)}let Ae,at=0;const xt=Q-ue+1;let Or=!1,Tr=0;const yo=new Array(xt);for(x=0;x<xt;x++)yo[x]=0;for(x=ie;x<=H;x++){const Wt=S[x];if(at>=xt){Ee(Wt,h,p,!0);continue}let Ar;if(Wt.key!=null)Ar=Ce.get(Wt.key);else for(Ae=ue;Ae<=Q;Ae++)if(yo[Ae-ue]===0&&bo(Wt,T[Ae])){Ar=Ae;break}Ar===void 0?Ee(Wt,h,p,!0):(yo[Ar-ue]=x+1,Ar>=Tr?Tr=Ar:Or=!0,b(Wt,T[Ar],$,null,h,p,_,O,P),at++)}const Ed=Or?ww(yo):Bi;for(Ae=Ed.length-1,x=xt-1;x>=0;x--){const Wt=ue+x,Ar=T[Wt],Sd=T[Wt+1],Id=Wt+1<z?Sd.el||Sd.placeholder:m;yo[x]===0?b(null,Ar,$,Id,h,p,_,O,P):Or&&(Ae<0||x!==Ed[Ae]?ne(Ar,$,Id,2):Ae--)}}},ne=(S,T,$,m,h=null)=>{const{el:p,type:_,transition:O,children:P,shapeFlag:x}=S;if(x&6){ne(S.component.subTree,T,$,m);return}if(x&128){S.suspense.move(T,$,m);return}if(x&64){_.move(S,T,$,ee);return}if(_===Me){n(p,T,$);for(let H=0;H<P.length;H++)ne(P[H],T,$,m);n(S.anchor,T,$);return}if(_===fc){A(S,T,$);return}if(m!==2&&x&1&&O)if(m===0)O.beforeEnter(p),n(p,T,$),Gt(()=>O.enter(p),h);else{const{leave:H,delayLeave:Q,afterLeave:ie}=O,ue=()=>{S.ctx.isUnmounted?o(p):n(p,T,$)},Ce=()=>{H(p,()=>{ue(),ie&&ie()})};Q?Q(p,ue,Ce):Ce()}else n(p,T,$)},Ee=(S,T,$,m=!1,h=!1)=>{const{type:p,props:_,ref:O,children:P,dynamicChildren:x,shapeFlag:z,patchFlag:H,dirs:Q,cacheIndex:ie}=S;if(H===-2&&(h=!1),O!=null&&(dn(),Ko(O,null,$,S,!0),hn()),ie!=null&&(T.renderCache[ie]=void 0),z&256){T.ctx.deactivate(S);return}const ue=z&1&&Q,Ce=!zo(S);let Ae;if(Ce&&(Ae=_&&_.onVnodeBeforeUnmount)&&Rr(Ae,T,S),z&6)Xe(S.component,$,m);else{if(z&128){S.suspense.unmount($,m);return}ue&&qn(S,null,T,"beforeUnmount"),z&64?S.type.remove(S,T,$,ee,m):x&&!x.hasOnce&&(p!==Me||H>0&&H&64)?he(x,T,$,!1,!0):(p===Me&&H&384||!h&&z&16)&&he(P,T,$),m&&tt(S)}(Ce&&(Ae=_&&_.onVnodeUnmounted)||ue)&&Gt(()=>{Ae&&Rr(Ae,T,S),ue&&qn(S,null,T,"unmounted")},$)},tt=S=>{const{type:T,el:$,anchor:m,transition:h}=S;if(T===Me){Ct($,m);return}if(T===fc){I(S);return}const p=()=>{o($),h&&!h.persisted&&h.afterLeave&&h.afterLeave()};if(S.shapeFlag&1&&h&&!h.persisted){const{leave:_,delayLeave:O}=h,P=()=>_($,p);O?O(S.el,p,P):P()}else p()},Ct=(S,T)=>{let $;for(;S!==T;)$=d(S),o(S),S=$;o(T)},Xe=(S,T,$)=>{const{bum:m,scope:h,job:p,subTree:_,um:O,m:P,a:x,parent:z,slots:{__:H}}=S;Ud(P),Ud(x),m&&ia(m),z&&me(H)&&H.forEach(Q=>{z.renderCache[Q]=void 0}),h.stop(),p&&(p.flags|=8,Ee(_,S,T,$)),O&&Gt(O,T),Gt(()=>{S.isUnmounted=!0},T),T&&T.pendingBranch&&!T.isUnmounted&&S.asyncDep&&!S.asyncResolved&&S.suspenseId===T.pendingId&&(T.deps--,T.deps===0&&T.resolve())},he=(S,T,$,m=!1,h=!1,p=0)=>{for(let _=p;_<S.length;_++)Ee(S[_],T,$,m,h)},B=S=>{if(S.shapeFlag&6)return B(S.component.subTree);if(S.shapeFlag&128)return S.suspense.next();const T=d(S.anchor||S.el),$=T&&T[Hb];return $?d($):T};let J=!1;const K=(S,T,$)=>{S==null?T._vnode&&Ee(T._vnode,null,null,!0):b(T._vnode||null,S,T,null,null,null,$),T._vnode=S,J||(J=!0,Cd(),Lm(),J=!1)},ee={p:b,um:Ee,m:ne,r:tt,mt:q,mc:U,pc:D,pbc:W,n:B,o:e};return{render:K,hydrate:void 0,createApp:fw(K)}}function lc({type:e,props:t},r){return r==="svg"&&e==="foreignObject"||r==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:r}function Wn({effect:e,job:t},r){r?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function bw(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function ig(e,t,r=!1){const n=e.children,o=t.children;if(me(n)&&me(o))for(let i=0;i<n.length;i++){const a=n[i];let u=o[i];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=o[i]=wn(o[i]),u.el=a.el),!r&&u.patchFlag!==-2&&ig(a,u)),u.type===Iu&&(u.el=a.el),u.type===Mn&&!u.el&&(u.el=a.el)}}function ww(e){const t=e.slice(),r=[0];let n,o,i,a,u;const l=e.length;for(n=0;n<l;n++){const s=e[n];if(s!==0){if(o=r[r.length-1],e[o]<s){t[n]=o,r.push(n);continue}for(i=0,a=r.length-1;i<a;)u=i+a>>1,e[r[u]]<s?i=u+1:a=u;s<e[r[i]]&&(i>0&&(t[n]=r[i-1]),r[i]=n)}}for(i=r.length,a=r[i-1];i-- >0;)r[i]=a,a=t[a];return r}function og(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:og(t)}function Ud(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const Ew=Symbol.for("v-scx"),Sw=()=>br(Ew);function Ln(e,t,r){return sg(e,t,r)}function sg(e,t,r=Fe){const{immediate:n,deep:o,flush:i,once:a}=r,u=bt({},r),l=t&&n||!t&&i!=="post";let s;if(ls){if(i==="sync"){const v=Sw();s=v.__watcherHandles||(v.__watcherHandles=[])}else if(!l){const v=()=>{};return v.stop=qr,v.resume=qr,v.pause=qr,v}}const c=gt;u.call=(v,g,b)=>Hr(v,c,g,b);let f=!1;i==="post"?u.scheduler=v=>{Gt(v,c&&c.suspense)}:i!=="sync"&&(f=!0,u.scheduler=(v,g)=>{g?v():df(v)}),u.augmentJob=v=>{t&&(v.flags|=4),f&&(v.flags|=2,c&&(v.id=c.uid,v.i=c))};const d=jb(e,t,u);return ls&&(s?s.push(d):l&&d()),d}function Iw(e,t,r){const n=this.proxy,o=Je(e)?e.includes(".")?ag(n,e):()=>n[e]:e.bind(n,n);let i;we(t)?i=t:(i=t.handler,r=t);const a=xs(this),u=sg(o,i.bind(n),r);return a(),u}function ag(e,t){const r=t.split(".");return()=>{let n=e;for(let o=0;o<r.length&&n;o++)n=n[r[o]];return n}}const Ow=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${sr(t)}Modifiers`]||e[`${_i(t)}Modifiers`];function Tw(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||Fe;let o=r;const i=t.startsWith("update:"),a=i&&Ow(n,t.slice(7));a&&(a.trim&&(o=r.map(c=>Je(c)?c.trim():c)),a.number&&(o=r.map(Sa)));let u,l=n[u=ic(t)]||n[u=ic(sr(t))];!l&&i&&(l=n[u=ic(_i(t))]),l&&Hr(l,e,6,o);const s=n[u+"Once"];if(s){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,Hr(s,e,6,o)}}function ug(e,t,r=!1){const n=t.emitsCache,o=n.get(e);if(o!==void 0)return o;const i=e.emits;let a={},u=!1;if(!we(e)){const l=s=>{const c=ug(s,t,!0);c&&(u=!0,bt(a,c))};!r&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!i&&!u?(qe(e)&&n.set(e,null),null):(me(i)?i.forEach(l=>a[l]=null):bt(a,i),qe(e)&&n.set(e,a),a)}function Su(e,t){return!e||!pu(t)?!1:(t=t.slice(2).replace(/Once$/,""),$e(e,t[0].toLowerCase()+t.slice(1))||$e(e,_i(t))||$e(e,t))}function Fd(e){const{type:t,vnode:r,proxy:n,withProxy:o,propsOptions:[i],slots:a,attrs:u,emit:l,render:s,renderCache:c,props:f,data:d,setupState:v,ctx:g,inheritAttrs:b}=e,y=Aa(e);let w,E;try{if(r.shapeFlag&4){const I=o||n,R=I;w=Ur(s.call(R,I,c,f,v,d,g)),E=u}else{const I=t;w=Ur(I.length>1?I(f,{attrs:u,slots:a,emit:l}):I(f,null)),E=t.props?u:Aw(u)}}catch(I){Yo.length=0,wu(I,e,1),w=Rt(Mn)}let A=w;if(E&&b!==!1){const I=Object.keys(E),{shapeFlag:R}=A;I.length&&R&7&&(i&&I.some(Zl)&&(E=Rw(E,i)),A=Xi(A,E,!1,!0))}return r.dirs&&(A=Xi(A,null,!1,!0),A.dirs=A.dirs?A.dirs.concat(r.dirs):r.dirs),r.transition&&hf(A,r.transition),w=A,Aa(y),w}const Aw=e=>{let t;for(const r in e)(r==="class"||r==="style"||pu(r))&&((t||(t={}))[r]=e[r]);return t},Rw=(e,t)=>{const r={};for(const n in e)(!Zl(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r};function Cw(e,t,r){const{props:n,children:o,component:i}=e,{props:a,children:u,patchFlag:l}=t,s=i.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&l>=0){if(l&1024)return!0;if(l&16)return n?Md(n,a,s):!!a;if(l&8){const c=t.dynamicProps;for(let f=0;f<c.length;f++){const d=c[f];if(a[d]!==n[d]&&!Su(s,d))return!0}}}else return(o||u)&&(!u||!u.$stable)?!0:n===a?!1:n?a?Md(n,a,s):!0:!!a;return!1}function Md(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let o=0;o<n.length;o++){const i=n[o];if(t[i]!==e[i]&&!Su(r,i))return!0}return!1}function xw({vnode:e,parent:t},r){for(;t;){const n=t.subTree;if(n.suspense&&n.suspense.activeBranch===e&&(n.el=e.el),n===e)(e=t.vnode).el=r,t=t.parent;else break}}const cg=e=>e.__isSuspense;function Pw(e,t){t&&t.pendingBranch?me(e)?t.effects.push(...e):t.effects.push(e):Wb(e)}const Me=Symbol.for("v-fgt"),Iu=Symbol.for("v-txt"),Mn=Symbol.for("v-cmt"),fc=Symbol.for("v-stc"),Yo=[];let Yt=null;function oe(e=!1){Yo.push(Yt=e?null:[])}function Nw(){Yo.pop(),Yt=Yo[Yo.length-1]||null}let cs=1;function Bd(e,t=!1){cs+=e,e<0&&Yt&&t&&(Yt.hasOnce=!0)}function lg(e){return e.dynamicChildren=cs>0?Yt||Bi:null,Nw(),cs>0&&Yt&&Yt.push(e),e}function ae(e,t,r,n,o,i){return lg(C(e,t,r,n,o,i,!0))}function fg(e,t,r,n,o){return lg(Rt(e,t,r,n,o,!0))}function Ca(e){return e?e.__v_isVNode===!0:!1}function bo(e,t){return e.type===t.type&&e.key===t.key}const dg=({key:e})=>e??null,sa=({ref:e,ref_key:t,ref_for:r})=>(typeof e=="number"&&(e=""+e),e!=null?Je(e)||_t(e)||we(e)?{i:Jt,r:e,k:t,f:!!r}:e:null);function C(e,t=null,r=null,n=0,o=null,i=e===Me?0:1,a=!1,u=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&dg(t),ref:t&&sa(t),scopeId:Fm,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:Jt};return u?(mf(l,r),i&128&&e.normalize(l)):r&&(l.shapeFlag|=Je(r)?8:16),cs>0&&!a&&Yt&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&Yt.push(l),l}const Rt=$w;function $w(e,t=null,r=null,n=0,o=null,i=!1){if((!e||e===Gm)&&(e=Mn),Ca(e)){const u=Xi(e,t,!0);return r&&mf(u,r),cs>0&&!i&&Yt&&(u.shapeFlag&6?Yt[Yt.indexOf(e)]=u:Yt.push(u)),u.patchFlag=-2,u}if(Vw(e)&&(e=e.__vccOpts),t){t=Dw(t);let{class:u,style:l}=t;u&&!Je(u)&&(t.class=st(u)),qe(l)&&(lf(l)&&!me(l)&&(l=bt({},l)),t.style=rf(l))}const a=Je(e)?1:cg(e)?128:Gb(e)?64:qe(e)?4:we(e)?2:0;return C(e,t,r,n,o,a,i,!0)}function Dw(e){return e?lf(e)||Xm(e)?bt({},e):e:null}function Xi(e,t,r=!1,n=!1){const{props:o,ref:i,patchFlag:a,children:u,transition:l}=e,s=t?Uw(o||{},t):o,c={__v_isVNode:!0,__v_skip:!0,type:e.type,props:s,key:s&&dg(s),ref:t&&t.ref?r&&i?me(i)?i.concat(sa(t)):[i,sa(t)]:sa(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Me?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Xi(e.ssContent),ssFallback:e.ssFallback&&Xi(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&n&&hf(c,l.clone(c)),c}function Lw(e=" ",t=0){return Rt(Iu,null,e,t)}function ln(e="",t=!1){return t?(oe(),fg(Mn,null,e)):Rt(Mn,null,e)}function Ur(e){return e==null||typeof e=="boolean"?Rt(Mn):me(e)?Rt(Me,null,e.slice()):Ca(e)?wn(e):Rt(Iu,null,String(e))}function wn(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Xi(e)}function mf(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(me(t))r=16;else if(typeof t=="object")if(n&65){const o=t.default;o&&(o._c&&(o._d=!1),mf(e,o()),o._c&&(o._d=!0));return}else{r=32;const o=t._;!o&&!Xm(t)?t._ctx=Jt:o===3&&Jt&&(Jt.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else we(t)?(t={default:t,_ctx:Jt},r=32):(t=String(t),n&64?(r=16,t=[Lw(t)]):r=8);e.children=t,e.shapeFlag|=r}function Uw(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const o in n)if(o==="class")t.class!==n.class&&(t.class=st([t.class,n.class]));else if(o==="style")t.style=rf([t.style,n.style]);else if(pu(o)){const i=t[o],a=n[o];a&&i!==a&&!(me(i)&&i.includes(a))&&(t[o]=i?[].concat(i,a):a)}else o!==""&&(t[o]=n[o])}return t}function Rr(e,t,r,n=null){Hr(e,t,7,[r,n])}const Fw=Jm();let Mw=0;function Bw(e,t,r){const n=e.type,o=(t?t.appContext:e.appContext)||Fw,i={uid:Mw++,vnode:e,type:n,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new hb(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:eg(n,o),emitsOptions:ug(n,o),emit:null,emitted:null,propsDefaults:Fe,inheritAttrs:n.inheritAttrs,ctx:Fe,data:Fe,props:Fe,attrs:Fe,slots:Fe,refs:Fe,setupState:Fe,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=Tw.bind(null,i),e.ce&&e.ce(i),i}let gt=null;const jw=()=>gt||Jt;let xa,vl;{const e=yu(),t=(r,n)=>{let o;return(o=e[r])||(o=e[r]=[]),o.push(n),i=>{o.length>1?o.forEach(a=>a(i)):o[0](i)}};xa=t("__VUE_INSTANCE_SETTERS__",r=>gt=r),vl=t("__VUE_SSR_SETTERS__",r=>ls=r)}const xs=e=>{const t=gt;return xa(e),e.scope.on(),()=>{e.scope.off(),xa(t)}},jd=()=>{gt&&gt.scope.off(),xa(null)};function hg(e){return e.vnode.shapeFlag&4}let ls=!1;function kw(e,t=!1,r=!1){t&&vl(t);const{props:n,children:o}=e.vnode,i=hg(e);dw(e,n,i,t),mw(e,o,r||t);const a=i?qw(e,t):void 0;return t&&vl(!1),a}function qw(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,iw);const{setup:n}=r;if(n){dn();const o=e.setupContext=n.length>1?Hw(e):null,i=xs(e),a=Rs(n,e,0,[e.props,o]),u=cm(a);if(hn(),i(),(u||e.sp)&&!zo(e)&&Bm(e),u){if(a.then(jd,jd),t)return a.then(l=>{kd(e,l)}).catch(l=>{wu(l,e,0)});e.asyncDep=a}else kd(e,a)}else pg(e)}function kd(e,t,r){we(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:qe(t)&&(e.setupState=Nm(t)),pg(e)}function pg(e,t,r){const n=e.type;e.render||(e.render=n.render||qr);{const o=xs(e);dn();try{ow(e)}finally{hn(),o()}}}const Ww={get(e,t){return mt(e,"get",""),e[t]}};function Hw(e){const t=r=>{e.exposed=r||{}};return{attrs:new Proxy(e.attrs,Ww),slots:e.slots,emit:e.emit,expose:t}}function Ou(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Nm($b(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in Jo)return Jo[r](e)},has(t,r){return r in t||r in Jo}})):e.proxy}function Gw(e,t=!0){return we(e)?e.displayName||e.name:e.name||t&&e.__name}function Vw(e){return we(e)&&"__vccOpts"in e}const Ve=(e,t)=>Mb(e,t,ls);function vg(e,t,r){const n=arguments.length;return n===2?qe(t)&&!me(t)?Ca(t)?Rt(e,null,[t]):Rt(e,t):Rt(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&Ca(r)&&(r=[r]),Rt(e,t,r))}const Kw="3.5.18";/**
* @vue/runtime-dom v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ml;const qd=typeof window<"u"&&window.trustedTypes;if(qd)try{ml=qd.createPolicy("vue",{createHTML:e=>e})}catch{}const mg=ml?e=>ml.createHTML(e):e=>e,zw="http://www.w3.org/2000/svg",Jw="http://www.w3.org/1998/Math/MathML",en=typeof document<"u"?document:null,Wd=en&&en.createElement("template"),Yw={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const o=t==="svg"?en.createElementNS(zw,e):t==="mathml"?en.createElementNS(Jw,e):r?en.createElement(e,{is:r}):en.createElement(e);return e==="select"&&n&&n.multiple!=null&&o.setAttribute("multiple",n.multiple),o},createText:e=>en.createTextNode(e),createComment:e=>en.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>en.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,r,n,o,i){const a=r?r.previousSibling:t.lastChild;if(o&&(o===i||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),r),!(o===i||!(o=o.nextSibling)););else{Wd.innerHTML=mg(n==="svg"?`<svg>${e}</svg>`:n==="mathml"?`<math>${e}</math>`:e);const u=Wd.content;if(n==="svg"||n==="mathml"){const l=u.firstChild;for(;l.firstChild;)u.appendChild(l.firstChild);u.removeChild(l)}t.insertBefore(u,r)}return[a?a.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}},Qw=Symbol("_vtc");function Xw(e,t,r){const n=e[Qw];n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}const Pa=Symbol("_vod"),gg=Symbol("_vsh"),pn={beforeMount(e,{value:t},{transition:r}){e[Pa]=e.style.display==="none"?"":e.style.display,r&&t?r.beforeEnter(e):wo(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:n}){!t!=!r&&(n?t?(n.beforeEnter(e),wo(e,!0),n.enter(e)):n.leave(e,()=>{wo(e,!1)}):wo(e,t))},beforeUnmount(e,{value:t}){wo(e,t)}};function wo(e,t){e.style.display=t?e[Pa]:"none",e[gg]=!t}const Zw=Symbol(""),e1=/(^|;)\s*display\s*:/;function t1(e,t,r){const n=e.style,o=Je(r);let i=!1;if(r&&!o){if(t)if(Je(t))for(const a of t.split(";")){const u=a.slice(0,a.indexOf(":")).trim();r[u]==null&&aa(n,u,"")}else for(const a in t)r[a]==null&&aa(n,a,"");for(const a in r)a==="display"&&(i=!0),aa(n,a,r[a])}else if(o){if(t!==r){const a=n[Zw];a&&(r+=";"+a),n.cssText=r,i=e1.test(r)}}else t&&e.removeAttribute("style");Pa in e&&(e[Pa]=i?n.display:"",e[gg]&&(n.display="none"))}const Hd=/\s*!important$/;function aa(e,t,r){if(me(r))r.forEach(n=>aa(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=r1(e,t);Hd.test(r)?e.setProperty(_i(n),r.replace(Hd,""),"important"):e[n]=r}}const Gd=["Webkit","Moz","ms"],dc={};function r1(e,t){const r=dc[t];if(r)return r;let n=sr(t);if(n!=="filter"&&n in e)return dc[t]=n;n=gu(n);for(let o=0;o<Gd.length;o++){const i=Gd[o]+n;if(i in e)return dc[t]=i}return t}const Vd="http://www.w3.org/1999/xlink";function Kd(e,t,r,n,o,i=lb(t)){n&&t.startsWith("xlink:")?r==null?e.removeAttributeNS(Vd,t.slice(6,t.length)):e.setAttributeNS(Vd,t,r):r==null||i&&!dm(r)?e.removeAttribute(t):e.setAttribute(t,i?"":Wr(r)?String(r):r)}function zd(e,t,r,n,o){if(t==="innerHTML"||t==="textContent"){r!=null&&(e[t]=t==="innerHTML"?mg(r):r);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const u=i==="OPTION"?e.getAttribute("value")||"":e.value,l=r==null?e.type==="checkbox"?"on":"":String(r);(u!==l||!("_value"in e))&&(e.value=l),r==null&&e.removeAttribute(t),e._value=r;return}let a=!1;if(r===""||r==null){const u=typeof e[t];u==="boolean"?r=dm(r):r==null&&u==="string"?(r="",a=!0):u==="number"&&(r=0,a=!0)}try{e[t]=r}catch{}a&&e.removeAttribute(o||t)}function Qn(e,t,r,n){e.addEventListener(t,r,n)}function n1(e,t,r,n){e.removeEventListener(t,r,n)}const Jd=Symbol("_vei");function i1(e,t,r,n,o=null){const i=e[Jd]||(e[Jd]={}),a=i[t];if(n&&a)a.value=n;else{const[u,l]=o1(t);if(n){const s=i[t]=u1(n,o);Qn(e,u,s,l)}else a&&(n1(e,u,a,l),i[t]=void 0)}}const Yd=/(?:Once|Passive|Capture)$/;function o1(e){let t;if(Yd.test(e)){t={};let n;for(;n=e.match(Yd);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):_i(e.slice(2)),t]}let hc=0;const s1=Promise.resolve(),a1=()=>hc||(s1.then(()=>hc=0),hc=Date.now());function u1(e,t){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;Hr(c1(n,r.value),t,5,[n])};return r.value=e,r.attached=a1(),r}function c1(e,t){if(me(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>o=>!o._stopped&&n&&n(o))}else return t}const Qd=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,l1=(e,t,r,n,o,i)=>{const a=o==="svg";t==="class"?Xw(e,n,a):t==="style"?t1(e,r,n):pu(t)?Zl(t)||i1(e,t,r,n,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):f1(e,t,n,a))?(zd(e,t,n),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Kd(e,t,n,a,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Je(n))?zd(e,sr(t),n,i,t):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),Kd(e,t,n,a))};function f1(e,t,r,n){if(n)return!!(t==="innerHTML"||t==="textContent"||t in e&&Qd(t)&&we(r));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const o=e.tagName;if(o==="IMG"||o==="VIDEO"||o==="CANVAS"||o==="SOURCE")return!1}return Qd(t)&&Je(r)?!1:t in e}const Na=e=>{const t=e.props["onUpdate:modelValue"]||!1;return me(t)?r=>ia(t,r):t};function d1(e){e.target.composing=!0}function Xd(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Hi=Symbol("_assign"),wr={created(e,{modifiers:{lazy:t,trim:r,number:n}},o){e[Hi]=Na(o);const i=n||o.props&&o.props.type==="number";Qn(e,t?"change":"input",a=>{if(a.target.composing)return;let u=e.value;r&&(u=u.trim()),i&&(u=Sa(u)),e[Hi](u)}),r&&Qn(e,"change",()=>{e.value=e.value.trim()}),t||(Qn(e,"compositionstart",d1),Qn(e,"compositionend",Xd),Qn(e,"change",Xd))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:r,modifiers:{lazy:n,trim:o,number:i}},a){if(e[Hi]=Na(a),e.composing)return;const u=(i||e.type==="number")&&!/^0\d/.test(e.value)?Sa(e.value):e.value,l=t??"";u!==l&&(document.activeElement===e&&e.type!=="range"&&(n&&t===r||o&&e.value.trim()===l)||(e.value=l))}},Pi={deep:!0,created(e,{value:t,modifiers:{number:r}},n){const o=vu(t);Qn(e,"change",()=>{const i=Array.prototype.filter.call(e.options,a=>a.selected).map(a=>r?Sa($a(a)):$a(a));e[Hi](e.multiple?o?new Set(i):i:i[0]),e._assigning=!0,ff(()=>{e._assigning=!1})}),e[Hi]=Na(n)},mounted(e,{value:t}){Zd(e,t)},beforeUpdate(e,t,r){e[Hi]=Na(r)},updated(e,{value:t}){e._assigning||Zd(e,t)}};function Zd(e,t){const r=e.multiple,n=me(t);if(!(r&&!n&&!vu(t))){for(let o=0,i=e.options.length;o<i;o++){const a=e.options[o],u=$a(a);if(r)if(n){const l=typeof u;l==="string"||l==="number"?a.selected=t.some(s=>String(s)===String(u)):a.selected=db(t,u)>-1}else a.selected=t.has(u);else if(_u($a(a),t)){e.selectedIndex!==o&&(e.selectedIndex=o);return}}!r&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function $a(e){return"_value"in e?e._value:e.value}const h1=["ctrl","shift","alt","meta"],p1={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>h1.some(r=>e[`${r}Key`]&&!t.includes(r))},Tu=(e,t)=>{const r=e._withMods||(e._withMods={}),n=t.join(".");return r[n]||(r[n]=(o,...i)=>{for(let a=0;a<t.length;a++){const u=p1[t[a]];if(u&&u(o,t))return}return e(o,...i)})},v1=bt({patchProp:l1},Yw);let eh;function m1(){return eh||(eh=yw(v1))}const g1=(...e)=>{const t=m1().createApp(...e),{mount:r}=t;return t.mount=n=>{const o=_1(n);if(!o)return;const i=t._component;!we(i)&&!i.render&&!i.template&&(i.template=o.innerHTML),o.nodeType===1&&(o.textContent="");const a=r(o,!1,y1(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),a},t};function y1(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function _1(e){return Je(e)?document.querySelector(e):e}/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const xi=typeof document<"u";function yg(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function b1(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&yg(e.default)}const Pe=Object.assign;function pc(e,t){const r={};for(const n in t){const o=t[n];r[n]=Sr(o)?o.map(e):e(o)}return r}const Qo=()=>{},Sr=Array.isArray,_g=/#/g,w1=/&/g,E1=/\//g,S1=/=/g,I1=/\?/g,bg=/\+/g,O1=/%5B/g,T1=/%5D/g,wg=/%5E/g,A1=/%60/g,Eg=/%7B/g,R1=/%7C/g,Sg=/%7D/g,C1=/%20/g;function gf(e){return encodeURI(""+e).replace(R1,"|").replace(O1,"[").replace(T1,"]")}function x1(e){return gf(e).replace(Eg,"{").replace(Sg,"}").replace(wg,"^")}function gl(e){return gf(e).replace(bg,"%2B").replace(C1,"+").replace(_g,"%23").replace(w1,"%26").replace(A1,"`").replace(Eg,"{").replace(Sg,"}").replace(wg,"^")}function P1(e){return gl(e).replace(S1,"%3D")}function N1(e){return gf(e).replace(_g,"%23").replace(I1,"%3F")}function $1(e){return e==null?"":N1(e).replace(E1,"%2F")}function fs(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const D1=/\/$/,L1=e=>e.replace(D1,"");function vc(e,t,r="/"){let n,o={},i="",a="";const u=t.indexOf("#");let l=t.indexOf("?");return u<l&&u>=0&&(l=-1),l>-1&&(n=t.slice(0,l),i=t.slice(l+1,u>-1?u:t.length),o=e(i)),u>-1&&(n=n||t.slice(0,u),a=t.slice(u,t.length)),n=B1(n??t,r),{fullPath:n+(i&&"?")+i+a,path:n,query:o,hash:fs(a)}}function U1(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function th(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function F1(e,t,r){const n=t.matched.length-1,o=r.matched.length-1;return n>-1&&n===o&&Zi(t.matched[n],r.matched[o])&&Ig(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function Zi(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Ig(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!M1(e[r],t[r]))return!1;return!0}function M1(e,t){return Sr(e)?rh(e,t):Sr(t)?rh(t,e):e===t}function rh(e,t){return Sr(t)?e.length===t.length&&e.every((r,n)=>r===t[n]):e.length===1&&e[0]===t}function B1(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),n=e.split("/"),o=n[n.length-1];(o===".."||o===".")&&n.push("");let i=r.length-1,a,u;for(a=0;a<n.length;a++)if(u=n[a],u!==".")if(u==="..")i>1&&i--;else break;return r.slice(0,i).join("/")+"/"+n.slice(a).join("/")}const yn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var ds;(function(e){e.pop="pop",e.push="push"})(ds||(ds={}));var Xo;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Xo||(Xo={}));function j1(e){if(!e)if(xi){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),L1(e)}const k1=/^[^#]+#/;function q1(e,t){return e.replace(k1,"#")+t}function W1(e,t){const r=document.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{behavior:t.behavior,left:n.left-r.left-(t.left||0),top:n.top-r.top-(t.top||0)}}const Au=()=>({left:window.scrollX,top:window.scrollY});function H1(e){let t;if("el"in e){const r=e.el,n=typeof r=="string"&&r.startsWith("#"),o=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!o)return;t=W1(o,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function nh(e,t){return(history.state?history.state.position-t:-1)+e}const yl=new Map;function G1(e,t){yl.set(e,t)}function V1(e){const t=yl.get(e);return yl.delete(e),t}let K1=()=>location.protocol+"//"+location.host;function Og(e,t){const{pathname:r,search:n,hash:o}=t,i=e.indexOf("#");if(i>-1){let u=o.includes(e.slice(i))?e.slice(i).length:1,l=o.slice(u);return l[0]!=="/"&&(l="/"+l),th(l,"")}return th(r,e)+n+o}function z1(e,t,r,n){let o=[],i=[],a=null;const u=({state:d})=>{const v=Og(e,location),g=r.value,b=t.value;let y=0;if(d){if(r.value=v,t.value=d,a&&a===g){a=null;return}y=b?d.position-b.position:0}else n(v);o.forEach(w=>{w(r.value,g,{delta:y,type:ds.pop,direction:y?y>0?Xo.forward:Xo.back:Xo.unknown})})};function l(){a=r.value}function s(d){o.push(d);const v=()=>{const g=o.indexOf(d);g>-1&&o.splice(g,1)};return i.push(v),v}function c(){const{history:d}=window;d.state&&d.replaceState(Pe({},d.state,{scroll:Au()}),"")}function f(){for(const d of i)d();i=[],window.removeEventListener("popstate",u),window.removeEventListener("beforeunload",c)}return window.addEventListener("popstate",u),window.addEventListener("beforeunload",c,{passive:!0}),{pauseListeners:l,listen:s,destroy:f}}function ih(e,t,r,n=!1,o=!1){return{back:e,current:t,forward:r,replaced:n,position:window.history.length,scroll:o?Au():null}}function J1(e){const{history:t,location:r}=window,n={value:Og(e,r)},o={value:t.state};o.value||i(n.value,{back:null,current:n.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(l,s,c){const f=e.indexOf("#"),d=f>-1?(r.host&&document.querySelector("base")?e:e.slice(f))+l:K1()+e+l;try{t[c?"replaceState":"pushState"](s,"",d),o.value=s}catch(v){console.error(v),r[c?"replace":"assign"](d)}}function a(l,s){const c=Pe({},t.state,ih(o.value.back,l,o.value.forward,!0),s,{position:o.value.position});i(l,c,!0),n.value=l}function u(l,s){const c=Pe({},o.value,t.state,{forward:l,scroll:Au()});i(c.current,c,!0);const f=Pe({},ih(n.value,l,null),{position:c.position+1},s);i(l,f,!1),n.value=l}return{location:n,state:o,push:u,replace:a}}function Y1(e){e=j1(e);const t=J1(e),r=z1(e,t.state,t.location,t.replace);function n(i,a=!0){a||r.pauseListeners(),history.go(i)}const o=Pe({location:"",base:e,go:n,createHref:q1.bind(null,e)},t,r);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>t.state.value}),o}function Q1(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),Y1(e)}function X1(e){return typeof e=="string"||e&&typeof e=="object"}function Tg(e){return typeof e=="string"||typeof e=="symbol"}const Ag=Symbol("");var oh;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(oh||(oh={}));function eo(e,t){return Pe(new Error,{type:e,[Ag]:!0},t)}function zr(e,t){return e instanceof Error&&Ag in e&&(t==null||!!(e.type&t))}const sh="[^/]+?",Z1={sensitive:!1,strict:!1,start:!0,end:!0},eE=/[.+*?^${}()[\]/\\]/g;function tE(e,t){const r=Pe({},Z1,t),n=[];let o=r.start?"^":"";const i=[];for(const s of e){const c=s.length?[]:[90];r.strict&&!s.length&&(o+="/");for(let f=0;f<s.length;f++){const d=s[f];let v=40+(r.sensitive?.25:0);if(d.type===0)f||(o+="/"),o+=d.value.replace(eE,"\\$&"),v+=40;else if(d.type===1){const{value:g,repeatable:b,optional:y,regexp:w}=d;i.push({name:g,repeatable:b,optional:y});const E=w||sh;if(E!==sh){v+=10;try{new RegExp(`(${E})`)}catch(I){throw new Error(`Invalid custom RegExp for param "${g}" (${E}): `+I.message)}}let A=b?`((?:${E})(?:/(?:${E}))*)`:`(${E})`;f||(A=y&&s.length<2?`(?:/${A})`:"/"+A),y&&(A+="?"),o+=A,v+=20,y&&(v+=-8),b&&(v+=-20),E===".*"&&(v+=-50)}c.push(v)}n.push(c)}if(r.strict&&r.end){const s=n.length-1;n[s][n[s].length-1]+=.7000000000000001}r.strict||(o+="/?"),r.end?o+="$":r.strict&&!o.endsWith("/")&&(o+="(?:/|$)");const a=new RegExp(o,r.sensitive?"":"i");function u(s){const c=s.match(a),f={};if(!c)return null;for(let d=1;d<c.length;d++){const v=c[d]||"",g=i[d-1];f[g.name]=v&&g.repeatable?v.split("/"):v}return f}function l(s){let c="",f=!1;for(const d of e){(!f||!c.endsWith("/"))&&(c+="/"),f=!1;for(const v of d)if(v.type===0)c+=v.value;else if(v.type===1){const{value:g,repeatable:b,optional:y}=v,w=g in s?s[g]:"";if(Sr(w)&&!b)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const E=Sr(w)?w.join("/"):w;if(!E)if(y)d.length<2&&(c.endsWith("/")?c=c.slice(0,-1):f=!0);else throw new Error(`Missing required param "${g}"`);c+=E}}return c||"/"}return{re:a,score:n,keys:i,parse:u,stringify:l}}function rE(e,t){let r=0;for(;r<e.length&&r<t.length;){const n=t[r]-e[r];if(n)return n;r++}return e.length<t.length?e.length===1&&e[0]===80?-1:1:e.length>t.length?t.length===1&&t[0]===80?1:-1:0}function Rg(e,t){let r=0;const n=e.score,o=t.score;for(;r<n.length&&r<o.length;){const i=rE(n[r],o[r]);if(i)return i;r++}if(Math.abs(o.length-n.length)===1){if(ah(n))return 1;if(ah(o))return-1}return o.length-n.length}function ah(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const nE={type:0,value:""},iE=/[a-zA-Z0-9_]/;function oE(e){if(!e)return[[]];if(e==="/")return[[nE]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(v){throw new Error(`ERR (${r})/"${s}": ${v}`)}let r=0,n=r;const o=[];let i;function a(){i&&o.push(i),i=[]}let u=0,l,s="",c="";function f(){s&&(r===0?i.push({type:0,value:s}):r===1||r===2||r===3?(i.length>1&&(l==="*"||l==="+")&&t(`A repeatable param (${s}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:s,regexp:c,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):t("Invalid state to consume buffer"),s="")}function d(){s+=l}for(;u<e.length;){if(l=e[u++],l==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:l==="/"?(s&&f(),a()):l===":"?(f(),r=1):d();break;case 4:d(),r=n;break;case 1:l==="("?r=2:iE.test(l)?d():(f(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&u--);break;case 2:l===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+l:r=3:c+=l;break;case 3:f(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&u--,c="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${s}"`),f(),a(),o}function sE(e,t,r){const n=tE(oE(e.path),r),o=Pe(n,{record:e,parent:t,children:[],alias:[]});return t&&!o.record.aliasOf==!t.record.aliasOf&&t.children.push(o),o}function aE(e,t){const r=[],n=new Map;t=fh({strict:!1,end:!0,sensitive:!1},t);function o(f){return n.get(f)}function i(f,d,v){const g=!v,b=ch(f);b.aliasOf=v&&v.record;const y=fh(t,f),w=[b];if("alias"in f){const I=typeof f.alias=="string"?[f.alias]:f.alias;for(const R of I)w.push(ch(Pe({},b,{components:v?v.record.components:b.components,path:R,aliasOf:v?v.record:b})))}let E,A;for(const I of w){const{path:R}=I;if(d&&R[0]!=="/"){const L=d.record.path,F=L[L.length-1]==="/"?"":"/";I.path=d.record.path+(R&&F+R)}if(E=sE(I,d,y),v?v.alias.push(E):(A=A||E,A!==E&&A.alias.push(E),g&&f.name&&!lh(E)&&a(f.name)),Cg(E)&&l(E),b.children){const L=b.children;for(let F=0;F<L.length;F++)i(L[F],E,v&&v.children[F])}v=v||E}return A?()=>{a(A)}:Qo}function a(f){if(Tg(f)){const d=n.get(f);d&&(n.delete(f),r.splice(r.indexOf(d),1),d.children.forEach(a),d.alias.forEach(a))}else{const d=r.indexOf(f);d>-1&&(r.splice(d,1),f.record.name&&n.delete(f.record.name),f.children.forEach(a),f.alias.forEach(a))}}function u(){return r}function l(f){const d=lE(f,r);r.splice(d,0,f),f.record.name&&!lh(f)&&n.set(f.record.name,f)}function s(f,d){let v,g={},b,y;if("name"in f&&f.name){if(v=n.get(f.name),!v)throw eo(1,{location:f});y=v.record.name,g=Pe(uh(d.params,v.keys.filter(A=>!A.optional).concat(v.parent?v.parent.keys.filter(A=>A.optional):[]).map(A=>A.name)),f.params&&uh(f.params,v.keys.map(A=>A.name))),b=v.stringify(g)}else if(f.path!=null)b=f.path,v=r.find(A=>A.re.test(b)),v&&(g=v.parse(b),y=v.record.name);else{if(v=d.name?n.get(d.name):r.find(A=>A.re.test(d.path)),!v)throw eo(1,{location:f,currentLocation:d});y=v.record.name,g=Pe({},d.params,f.params),b=v.stringify(g)}const w=[];let E=v;for(;E;)w.unshift(E.record),E=E.parent;return{name:y,path:b,params:g,matched:w,meta:cE(w)}}e.forEach(f=>i(f));function c(){r.length=0,n.clear()}return{addRoute:i,resolve:s,removeRoute:a,clearRoutes:c,getRoutes:u,getRecordMatcher:o}}function uh(e,t){const r={};for(const n of t)n in e&&(r[n]=e[n]);return r}function ch(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:uE(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function uE(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const n in e.components)t[n]=typeof r=="object"?r[n]:r;return t}function lh(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function cE(e){return e.reduce((t,r)=>Pe(t,r.meta),{})}function fh(e,t){const r={};for(const n in e)r[n]=n in t?t[n]:e[n];return r}function lE(e,t){let r=0,n=t.length;for(;r!==n;){const i=r+n>>1;Rg(e,t[i])<0?n=i:r=i+1}const o=fE(e);return o&&(n=t.lastIndexOf(o,n-1)),n}function fE(e){let t=e;for(;t=t.parent;)if(Cg(t)&&Rg(e,t)===0)return t}function Cg({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function dE(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let o=0;o<n.length;++o){const i=n[o].replace(bg," "),a=i.indexOf("="),u=fs(a<0?i:i.slice(0,a)),l=a<0?null:fs(i.slice(a+1));if(u in t){let s=t[u];Sr(s)||(s=t[u]=[s]),s.push(l)}else t[u]=l}return t}function dh(e){let t="";for(let r in e){const n=e[r];if(r=P1(r),n==null){n!==void 0&&(t+=(t.length?"&":"")+r);continue}(Sr(n)?n.map(i=>i&&gl(i)):[n&&gl(n)]).forEach(i=>{i!==void 0&&(t+=(t.length?"&":"")+r,i!=null&&(t+="="+i))})}return t}function hE(e){const t={};for(const r in e){const n=e[r];n!==void 0&&(t[r]=Sr(n)?n.map(o=>o==null?null:""+o):n==null?n:""+n)}return t}const pE=Symbol(""),hh=Symbol(""),Ru=Symbol(""),yf=Symbol(""),_l=Symbol("");function Eo(){let e=[];function t(n){return e.push(n),()=>{const o=e.indexOf(n);o>-1&&e.splice(o,1)}}function r(){e=[]}return{add:t,list:()=>e.slice(),reset:r}}function En(e,t,r,n,o,i=a=>a()){const a=n&&(n.enterCallbacks[o]=n.enterCallbacks[o]||[]);return()=>new Promise((u,l)=>{const s=d=>{d===!1?l(eo(4,{from:r,to:t})):d instanceof Error?l(d):X1(d)?l(eo(2,{from:t,to:d})):(a&&n.enterCallbacks[o]===a&&typeof d=="function"&&a.push(d),u())},c=i(()=>e.call(n&&n.instances[o],t,r,s));let f=Promise.resolve(c);e.length<3&&(f=f.then(s)),f.catch(d=>l(d))})}function mc(e,t,r,n,o=i=>i()){const i=[];for(const a of e)for(const u in a.components){let l=a.components[u];if(!(t!=="beforeRouteEnter"&&!a.instances[u]))if(yg(l)){const c=(l.__vccOpts||l)[t];c&&i.push(En(c,r,n,a,u,o))}else{let s=l();i.push(()=>s.then(c=>{if(!c)throw new Error(`Couldn't resolve component "${u}" at "${a.path}"`);const f=b1(c)?c.default:c;a.mods[u]=c,a.components[u]=f;const v=(f.__vccOpts||f)[t];return v&&En(v,r,n,a,u,o)()}))}}return i}function ph(e){const t=br(Ru),r=br(yf),n=Ve(()=>{const l=cn(e.to);return t.resolve(l)}),o=Ve(()=>{const{matched:l}=n.value,{length:s}=l,c=l[s-1],f=r.matched;if(!c||!f.length)return-1;const d=f.findIndex(Zi.bind(null,c));if(d>-1)return d;const v=vh(l[s-2]);return s>1&&vh(c)===v&&f[f.length-1].path!==v?f.findIndex(Zi.bind(null,l[s-2])):d}),i=Ve(()=>o.value>-1&&_E(r.params,n.value.params)),a=Ve(()=>o.value>-1&&o.value===r.matched.length-1&&Ig(r.params,n.value.params));function u(l={}){if(yE(l)){const s=t[cn(e.replace)?"replace":"push"](cn(e.to)).catch(Qo);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>s),s}return Promise.resolve()}return{route:n,href:Ve(()=>n.value.href),isActive:i,isExactActive:a,navigate:u}}function vE(e){return e.length===1?e[0]:e}const mE=vn({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:ph,setup(e,{slots:t}){const r=bi(ph(e)),{options:n}=br(Ru),o=Ve(()=>({[mh(e.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[mh(e.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const i=t.default&&vE(t.default(r));return e.custom?i:vg("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:o.value},i)}}}),gE=mE;function yE(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function _E(e,t){for(const r in t){const n=t[r],o=e[r];if(typeof n=="string"){if(n!==o)return!1}else if(!Sr(o)||o.length!==n.length||n.some((i,a)=>i!==o[a]))return!1}return!0}function vh(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const mh=(e,t,r)=>e??t??r,bE=vn({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const n=br(_l),o=Ve(()=>e.route||n.value),i=br(hh,0),a=Ve(()=>{let s=cn(i);const{matched:c}=o.value;let f;for(;(f=c[s])&&!f.components;)s++;return s}),u=Ve(()=>o.value.matched[a.value]);oa(hh,Ve(()=>a.value+1)),oa(pE,u),oa(_l,o);const l=ve();return Ln(()=>[l.value,u.value,e.name],([s,c,f],[d,v,g])=>{c&&(c.instances[f]=s,v&&v!==c&&s&&s===d&&(c.leaveGuards.size||(c.leaveGuards=v.leaveGuards),c.updateGuards.size||(c.updateGuards=v.updateGuards))),s&&c&&(!v||!Zi(c,v)||!d)&&(c.enterCallbacks[f]||[]).forEach(b=>b(s))},{flush:"post"}),()=>{const s=o.value,c=e.name,f=u.value,d=f&&f.components[c];if(!d)return gh(r.default,{Component:d,route:s});const v=f.props[c],g=v?v===!0?s.params:typeof v=="function"?v(s):v:null,y=vg(d,Pe({},g,t,{onVnodeUnmounted:w=>{w.component.isUnmounted&&(f.instances[c]=null)},ref:l}));return gh(r.default,{Component:y,route:s})||y}}});function gh(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const wE=bE;function EE(e){const t=aE(e.routes,e),r=e.parseQuery||dE,n=e.stringifyQuery||dh,o=e.history,i=Eo(),a=Eo(),u=Eo(),l=Db(yn);let s=yn;xi&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=pc.bind(null,B=>""+B),f=pc.bind(null,$1),d=pc.bind(null,fs);function v(B,J){let K,ee;return Tg(B)?(K=t.getRecordMatcher(B),ee=J):ee=B,t.addRoute(ee,K)}function g(B){const J=t.getRecordMatcher(B);J&&t.removeRoute(J)}function b(){return t.getRoutes().map(B=>B.record)}function y(B){return!!t.getRecordMatcher(B)}function w(B,J){if(J=Pe({},J||l.value),typeof B=="string"){const $=vc(r,B,J.path),m=t.resolve({path:$.path},J),h=o.createHref($.fullPath);return Pe($,m,{params:d(m.params),hash:fs($.hash),redirectedFrom:void 0,href:h})}let K;if(B.path!=null)K=Pe({},B,{path:vc(r,B.path,J.path).path});else{const $=Pe({},B.params);for(const m in $)$[m]==null&&delete $[m];K=Pe({},B,{params:f($)}),J.params=f(J.params)}const ee=t.resolve(K,J),_e=B.hash||"";ee.params=c(d(ee.params));const S=U1(n,Pe({},B,{hash:x1(_e),path:ee.path})),T=o.createHref(S);return Pe({fullPath:S,hash:_e,query:n===dh?hE(B.query):B.query||{}},ee,{redirectedFrom:void 0,href:T})}function E(B){return typeof B=="string"?vc(r,B,l.value.path):Pe({},B)}function A(B,J){if(s!==B)return eo(8,{from:J,to:B})}function I(B){return F(B)}function R(B){return I(Pe(E(B),{replace:!0}))}function L(B){const J=B.matched[B.matched.length-1];if(J&&J.redirect){const{redirect:K}=J;let ee=typeof K=="function"?K(B):K;return typeof ee=="string"&&(ee=ee.includes("?")||ee.includes("#")?ee=E(ee):{path:ee},ee.params={}),Pe({query:B.query,hash:B.hash,params:ee.path!=null?{}:B.params},ee)}}function F(B,J){const K=s=w(B),ee=l.value,_e=B.state,S=B.force,T=B.replace===!0,$=L(K);if($)return F(Pe(E($),{state:typeof $=="object"?Pe({},_e,$.state):_e,force:S,replace:T}),J||K);const m=K;m.redirectedFrom=J;let h;return!S&&F1(n,ee,K)&&(h=eo(16,{to:m,from:ee}),ne(ee,ee,!0,!1)),(h?Promise.resolve(h):W(m,ee)).catch(p=>zr(p)?zr(p,2)?p:Z(p):D(p,m,ee)).then(p=>{if(p){if(zr(p,2))return F(Pe({replace:T},E(p.to),{state:typeof p.to=="object"?Pe({},_e,p.to.state):_e,force:S}),J||m)}else p=X(m,ee,!0,T,_e);return j(m,ee,p),p})}function U(B,J){const K=A(B,J);return K?Promise.reject(K):Promise.resolve()}function N(B){const J=Ct.values().next().value;return J&&typeof J.runWithContext=="function"?J.runWithContext(B):B()}function W(B,J){let K;const[ee,_e,S]=SE(B,J);K=mc(ee.reverse(),"beforeRouteLeave",B,J);for(const $ of ee)$.leaveGuards.forEach(m=>{K.push(En(m,B,J))});const T=U.bind(null,B,J);return K.push(T),he(K).then(()=>{K=[];for(const $ of i.list())K.push(En($,B,J));return K.push(T),he(K)}).then(()=>{K=mc(_e,"beforeRouteUpdate",B,J);for(const $ of _e)$.updateGuards.forEach(m=>{K.push(En(m,B,J))});return K.push(T),he(K)}).then(()=>{K=[];for(const $ of S)if($.beforeEnter)if(Sr($.beforeEnter))for(const m of $.beforeEnter)K.push(En(m,B,J));else K.push(En($.beforeEnter,B,J));return K.push(T),he(K)}).then(()=>(B.matched.forEach($=>$.enterCallbacks={}),K=mc(S,"beforeRouteEnter",B,J,N),K.push(T),he(K))).then(()=>{K=[];for(const $ of a.list())K.push(En($,B,J));return K.push(T),he(K)}).catch($=>zr($,8)?$:Promise.reject($))}function j(B,J,K){u.list().forEach(ee=>N(()=>ee(B,J,K)))}function X(B,J,K,ee,_e){const S=A(B,J);if(S)return S;const T=J===yn,$=xi?history.state:{};K&&(ee||T?o.replace(B.fullPath,Pe({scroll:T&&$&&$.scroll},_e)):o.push(B.fullPath,_e)),l.value=B,ne(B,J,K,T),Z()}let fe;function q(){fe||(fe=o.listen((B,J,K)=>{if(!Xe.listening)return;const ee=w(B),_e=L(ee);if(_e){F(Pe(_e,{replace:!0,force:!0}),ee).catch(Qo);return}s=ee;const S=l.value;xi&&G1(nh(S.fullPath,K.delta),Au()),W(ee,S).catch(T=>zr(T,12)?T:zr(T,2)?(F(Pe(E(T.to),{force:!0}),ee).then($=>{zr($,20)&&!K.delta&&K.type===ds.pop&&o.go(-1,!1)}).catch(Qo),Promise.reject()):(K.delta&&o.go(-K.delta,!1),D(T,ee,S))).then(T=>{T=T||X(ee,S,!1),T&&(K.delta&&!zr(T,8)?o.go(-K.delta,!1):K.type===ds.pop&&zr(T,20)&&o.go(-1,!1)),j(ee,S,T)}).catch(Qo)}))}let de=Eo(),k=Eo(),M;function D(B,J,K){Z(B);const ee=k.list();return ee.length?ee.forEach(_e=>_e(B,J,K)):console.error(B),Promise.reject(B)}function G(){return M&&l.value!==yn?Promise.resolve():new Promise((B,J)=>{de.add([B,J])})}function Z(B){return M||(M=!B,q(),de.list().forEach(([J,K])=>B?K(B):J()),de.reset()),B}function ne(B,J,K,ee){const{scrollBehavior:_e}=e;if(!xi||!_e)return Promise.resolve();const S=!K&&V1(nh(B.fullPath,0))||(ee||!K)&&history.state&&history.state.scroll||null;return ff().then(()=>_e(B,J,S)).then(T=>T&&H1(T)).catch(T=>D(T,B,J))}const Ee=B=>o.go(B);let tt;const Ct=new Set,Xe={currentRoute:l,listening:!0,addRoute:v,removeRoute:g,clearRoutes:t.clearRoutes,hasRoute:y,getRoutes:b,resolve:w,options:e,push:I,replace:R,go:Ee,back:()=>Ee(-1),forward:()=>Ee(1),beforeEach:i.add,beforeResolve:a.add,afterEach:u.add,onError:k.add,isReady:G,install(B){const J=this;B.component("RouterLink",gE),B.component("RouterView",wE),B.config.globalProperties.$router=J,Object.defineProperty(B.config.globalProperties,"$route",{enumerable:!0,get:()=>cn(l)}),xi&&!tt&&l.value===yn&&(tt=!0,I(o.location).catch(_e=>{}));const K={};for(const _e in yn)Object.defineProperty(K,_e,{get:()=>l.value[_e],enumerable:!0});B.provide(Ru,J),B.provide(yf,Cm(K)),B.provide(_l,l);const ee=B.unmount;Ct.add(B),B.unmount=function(){Ct.delete(B),Ct.size<1&&(s=yn,fe&&fe(),fe=null,l.value=yn,tt=!1,M=!1),ee()}}};function he(B){return B.reduce((J,K)=>J.then(()=>N(K)),Promise.resolve())}return Xe}function SE(e,t){const r=[],n=[],o=[],i=Math.max(t.matched.length,e.matched.length);for(let a=0;a<i;a++){const u=t.matched[a];u&&(e.matched.find(s=>Zi(s,u))?n.push(u):r.push(u));const l=e.matched[a];l&&(t.matched.find(s=>Zi(s,l))||o.push(l))}return[r,n,o]}function Ps(){return br(Ru)}function _f(e){return br(yf)}var xg="@cloudbase/js-sdk";function IE(e){xg=e}function Cu(){return xg}var Pg="https:";function OE(e){Pg=e}function TE(){return Pg}var xu="https://support.qq.com/products/148793",kt={INVALID_PARAMS:"INVALID_PARAMS",INVALID_OPERATION:"INVALID_OPERATION",OPERATION_FAIL:"OPERATION_FAIL"},Da;(function(e){e.local="local",e.none="none",e.session="session"})(Da||(Da={}));var bf=function(){function e(){}return e}(),Ng=function(){function e(){}return e}();function ua(e,t,r){r===void 0&&(r={});var n=/\?/.test(t),o="";for(var i in r)o===""?!n&&(t+="?"):o+="&",o+=i+"="+encodeURIComponent(r[i]);return t+=o,/^http(s)?\:\/\//.test(t)?t:""+e+t}const AE=Object.freeze(Object.defineProperty({__proto__:null,AbstractSDKRequest:bf,AbstractStorage:Ng,get StorageType(){return Da},formatUrl:ua},Symbol.toStringTag,{value:"Module"}));function $g(e){return Object.prototype.toString.call(e)==="[object Array]"}function Dg(e){return typeof e=="string"}function RE(e){return Object.prototype.toString.call(e)==="[object Object]"}function CE(e,t){return e instanceof t}function Lg(e){return Object.prototype.toString.call(e)==="[object FormData]"}function xE(){return Math.random().toString(16).slice(2)}function PE(){var e=new Date().getTime(),t=(Date==null?void 0:Date.now)&&Date.now()*1e3||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var n=Math.random()*16;return e>0?(n=(e+n)%16|0,e=Math.floor(e/16)):(n=(t+n)%16|0,t=Math.floor(t/16)),(r==="x"?n:n&7|8).toString(16)})}function Ug(e,t,r){r===void 0&&(r={});var n=/\?/.test(t),o="";return Object.keys(r).forEach(function(i){o===""?!n&&(t+="?"):o+="&",o+="".concat(i,"=").concat(encodeURIComponent(r[i]))}),t+=o,/^http(s)?:\/\//.test(t)?t:"".concat(e).concat(t)}function NE(e){e===void 0&&(e={});var t=[];return Object.keys(e).forEach(function(r){t.push("".concat(r,"=").concat(encodeURIComponent(e[r])))}),t.join("&")}function Fg(e,t,r){if(r===void 0&&(r=null),e&&typeof e=="function")return e(t,r);if(t)throw t;return r}function Gi(e,t){console.warn("[".concat(Cu(),"][").concat(e,"]:").concat(t))}var $E=function(e){e=e.replace(/^\?/,"");var t={},r=e.split("&");return r.forEach(function(n){var o=n.split("="),i=o[0],a=o[1];i=decodeURIComponent(i),a=decodeURIComponent(a),i&&(t[i]?Array.isArray(t[i])?t[i].push(a):t[i]=[t[i],a]:t[i]=a)}),t},DE=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),lt=function(){return lt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},lt.apply(this,arguments)},gc=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},yc=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},LE=function(e){DE(t,e);function t(r){var n=e.call(this)||this,o=r.timeout,i=r.timeoutMsg,a=r.restrictedMethods;return n.timeout=o||0,n.timeoutMsg=i||"请求超时",n.restrictedMethods=a||["get","post","upload","download"],n}return t.prototype.get=function(r){return this.request(lt(lt({},r),{method:"get"}),this.restrictedMethods.includes("get"))},t.prototype.post=function(r){return this.request(lt(lt({},r),{method:"post"}),this.restrictedMethods.includes("post"))},t.prototype.put=function(r){return this.request(lt(lt({},r),{method:"put"}))},t.prototype.upload=function(r){var n=r.data,o=r.file,i=r.name,a=r.method,u=r.headers,l=u===void 0?{}:u,s={post:"post",put:"put"}[a==null?void 0:a.toLowerCase()]||"put",c=new FormData;return s==="post"?(Object.keys(n).forEach(function(f){c.append(f,n[f])}),c.append("key",i),c.append("file",o),this.request(lt(lt({},r),{data:c,method:s}),this.restrictedMethods.includes("upload"))):this.request(lt(lt({},r),{method:"put",headers:l,body:o}),this.restrictedMethods.includes("upload"))},t.prototype.download=function(r){return gc(this,void 0,void 0,function(){var n,o,i,a;return yc(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,this.get(lt(lt({},r),{headers:{},responseType:"blob"}))];case 1:return n=u.sent().data,o=window.URL.createObjectURL(new Blob([n])),i=decodeURIComponent(new URL(r.url).pathname.split("/").pop()||""),a=document.createElement("a"),a.href=o,a.setAttribute("download",i),a.style.display="none",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(o),document.body.removeChild(a),[3,3];case 2:return u.sent(),[3,3];case 3:return[2,new Promise(function(l){l({statusCode:200,tempFilePath:r.url})})]}})})},t.prototype.fetch=function(r){var n;return gc(this,void 0,void 0,function(){var o,i,a,u,l,s,c,f,d,v,g,b=this;return yc(this,function(y){switch(y.label){case 0:return o=new AbortController,i=r.url,a=r.enableAbort,u=a===void 0?!1:a,l=r.stream,s=l===void 0?!1:l,c=r.signal,f=r.timeout,d=f??this.timeout,c&&(c.aborted&&o.abort(),c.addEventListener("abort",function(){return o.abort()})),v=null,u&&d&&(v=setTimeout(function(){console.warn(b.timeoutMsg),o.abort(new Error(b.timeoutMsg))},d)),[4,fetch(i,lt(lt({},r),{signal:o.signal})).then(function(w){return gc(b,void 0,void 0,function(){var E,A,I;return yc(this,function(R){switch(R.label){case 0:return clearTimeout(v),w.ok?(E=w,[3,3]):[3,1];case 1:return I=(A=Promise).reject,[4,w.json()];case 2:E=I.apply(A,[R.sent()]),R.label=3;case 3:return[2,E]}})})}).catch(function(w){return clearTimeout(v),Promise.reject(w)})];case 1:return g=y.sent(),[2,{data:s?g.body:!((n=g.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?g.json():g.text(),statusCode:g.status,header:g.headers}]}})})},t.prototype.request=function(r,n){var o=this;n===void 0&&(n=!1);var i=String(r.method).toLowerCase()||"get";return new Promise(function(a){var u=r.url,l=r.headers,s=l===void 0?{}:l,c=r.data,f=r.responseType,d=r.withCredentials,v=r.body,g=r.onUploadProgress,b=Ug(TE(),u,i==="get"?c:{}),y=new XMLHttpRequest;y.open(i,b),f&&(y.responseType=f),Object.keys(s).forEach(function(A){y.setRequestHeader(A,s[A])});var w;g&&y.upload.addEventListener("progress",g),y.onreadystatechange=function(){var A={};if(y.readyState===4){var I=y.getAllResponseHeaders(),R=I.trim().split(/[\r\n]+/),L={};R.forEach(function(F){var U=F.split(": "),N=U.shift().toLowerCase(),W=U.join(": ");L[N]=W}),A.header=L,A.statusCode=y.status;try{A.data=f==="blob"?y.response:JSON.parse(y.responseText)}catch{A.data=f==="blob"?y.response:y.responseText}clearTimeout(w),a(A)}},n&&o.timeout&&(w=setTimeout(function(){console.warn(o.timeoutMsg),y.abort()},o.timeout));var E;Lg(c)?E=c:s["content-type"]==="application/x-www-form-urlencoded"?E=NE(c):v?E=v:E=c?JSON.stringify(c):void 0,d&&(y.withCredentials=!0),y.send(E)})},t}(bf);function UE(){var e={type:"default",root:window,reqClass:LE,wsClass:WebSocket,localStorage};return e}var bl=function(){return bl=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},bl.apply(this,arguments)},wl;(function(e){e.WEB="web",e.WX_MP="wx_mp"})(wl||(wl={}));function FE(e,t){for(var r=$g(e)?e:[e],n=0,o=r;n<o.length;n++){var i=o[n],a=i.isMatch,u=i.genAdapter,l=i.runtime;if(a())return{adapter:bl({isMatch:a},u(t)),runtime:l}}}function ME(){return{adapter:UE(),runtime:wl.WEB}}var Bs={},BE=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),_c=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,[])).next())})},bc=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},wc=function(e){BE(t,e);function t(r){var n=e.call(this)||this;return n.root=r,r.tcbCacheObject||(r.tcbCacheObject={}),n}return t.prototype.setItem=function(r,n){this.root.tcbCacheObject[r]=n},t.prototype.getItem=function(r){return this.root.tcbCacheObject[r]},t.prototype.removeItem=function(r){delete this.root.tcbCacheObject[r]},t.prototype.clear=function(){delete this.root.tcbCacheObject},t}(Ng);function jE(e,t){switch(e){case"local":return t.localStorage?t.localStorage:(Gi(kt.INVALID_PARAMS,"localStorage is not supported on current platform"),new wc(t.root));case"none":return new wc(t.root);default:return t.localStorage?t.localStorage:(Gi(kt.INVALID_PARAMS,"localStorage is not supported on current platform"),new wc(t.root))}}var kE=function(){function e(t){this.keys={};var r=t.persistence,n=t.platformInfo,o=n===void 0?{}:n,i=t.keys,a=i===void 0?{}:i;this.platformInfo=o,this.storage||(this.persistenceTag=this.platformInfo.adapter.primaryStorage||r,this.storage=jE(this.persistenceTag,this.platformInfo.adapter),this.keys=a)}return Object.defineProperty(e.prototype,"mode",{get:function(){return this.storage.mode||"sync"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"persistence",{get:function(){return this.persistenceTag},enumerable:!1,configurable:!0}),e.prototype.setStore=function(t,r,n){if(this.mode==="async"){Gi(kt.INVALID_OPERATION,"current platform's storage is asynchronous, please use setStoreAsync insteed");return}if(this.storage)try{var o={version:n||"localCachev1",content:r};this.storage.setItem(t,JSON.stringify(o))}catch(i){throw new Error(JSON.stringify({code:kt.OPERATION_FAIL,msg:"[".concat(Cu(),"][").concat(kt.OPERATION_FAIL,"]setStore failed"),info:i}))}},e.prototype.setStoreAsync=function(t,r,n){return _c(this,void 0,void 0,function(){var o;return bc(this,function(i){switch(i.label){case 0:if(!this.storage)return[2];i.label=1;case 1:return i.trys.push([1,3,,4]),o={version:n||"localCachev1",content:r},[4,this.storage.setItem(t,JSON.stringify(o))];case 2:return i.sent(),[3,4];case 3:return i.sent(),[2];case 4:return[2]}})})},e.prototype.getStore=function(t,r){var n;if(this.mode==="async"){Gi(kt.INVALID_OPERATION,"current platform's storage is asynchronous, please use getStoreAsync insteed");return}try{if(typeof process<"u"&&(!((n=Bs)===null||n===void 0)&&n.tcb_token))return Bs.tcb_token;if(!this.storage)return""}catch{return""}r=r||"localCachev1";var o=this.storage.getItem(t);if(!o)return"";if(o.indexOf(r)>=0){var i=JSON.parse(o);return i.content}return""},e.prototype.getStoreAsync=function(t,r){var n;return _c(this,void 0,void 0,function(){var o,i;return bc(this,function(a){switch(a.label){case 0:try{if(typeof process<"u"&&(!((n=Bs)===null||n===void 0)&&n.tcb_token))return[2,Bs.tcb_token];if(!this.storage)return[2,""]}catch{return[2,""]}return r=r||"localCachev1",[4,this.storage.getItem(t)];case 1:return o=a.sent(),o?o.indexOf(r)>=0?(i=JSON.parse(o),[2,i.content]):[2,""]:[2,""]}})})},e.prototype.removeStore=function(t){if(this.mode==="async"){Gi(kt.INVALID_OPERATION,"current platform's storage is asynchronous, please use removeStoreAsync insteed");return}this.storage.removeItem(t)},e.prototype.removeStoreAsync=function(t){return _c(this,void 0,void 0,function(){return bc(this,function(r){switch(r.label){case 0:return[4,this.storage.removeItem(t)];case 1:return r.sent(),[2]}})})},e}(),qE=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),WE=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))};function HE(e,t,r){r[e]=r[e]||[],r[e].push(t)}function GE(e,t,r){if(r!=null&&r[e]){var n=r[e].indexOf(t);n!==-1&&r[e].splice(n,1)}}var Mg=function(){function e(t,r){this.data=r||null,this.name=t}return e}(),VE=function(e){qE(t,e);function t(r,n){var o=e.call(this,"error",{error:r,data:n})||this;return o.error=r,o}return t}(Mg),Bg=function(){function e(){this.listeners={}}return e.prototype.on=function(t,r){return HE(t,r,this.listeners),this},e.prototype.off=function(t,r){return GE(t,r,this.listeners),this},e.prototype.fire=function(t,r){if(CE(t,VE))return console.error(t.error),this;var n=Dg(t)?new Mg(t,r||{}):t,o=n.name;if(this.listens(o)){n.target=this;for(var i=this.listeners[o]?WE([],this.listeners[o],!0):[],a=0,u=i;a<u.length;a++){var l=u[a];l.call(this,n)}}return this},e.prototype.listens=function(t){return this.listeners[t]&&this.listeners[t].length>0},e}(),Pu=new Bg,Nu="lang_change";typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.indexOf("Firefox");function $u(e){return e.mode,e.customInfo,e.title,e.messages,function(t,r,n){}}function El(e){this.message=e}El.prototype=new Error,El.prototype.name="InvalidCharacterError";typeof window<"u"&&window.atob&&window.atob.bind(window);function yh(e){this.message=e}yh.prototype=new Error,yh.prototype.name="InvalidTokenError";/**
 * @license
 * web-streams-polyfill v4.2.0
 * Copyright 2025 Mattias Buelens, Diwank Singh Tomer and other contributors.
 * This code is released under the MIT license.
 * SPDX-License-Identifier: MIT
 */function hs(){}function et(e){return typeof e=="object"&&e!==null||typeof e=="function"}const jg=hs;function Oe(e,t){try{Object.defineProperty(e,"name",{value:t,configurable:!0})}catch{}}const wf=Promise,KE=Promise.resolve.bind(wf),zE=Promise.prototype.then,JE=Promise.reject.bind(wf),YE=KE;function Ye(e){return new wf(e)}function Te(e){return Ye(t=>t(e))}function se(e){return JE(e)}function Br(e,t,r){return zE.call(e,t,r)}function qt(e,t,r){Br(Br(e,t,r),void 0,jg)}function Ec(e,t){qt(e,t)}function Sl(e,t){qt(e,void 0,t)}function fn(e,t,r){return Br(e,t,r)}function ao(e){Br(e,void 0,jg)}let ci=e=>{if(typeof queueMicrotask=="function")ci=queueMicrotask;else{const t=Te(void 0);ci=r=>Br(t,r)}return ci(e)};function hi(e,t,r){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,r)}function gn(e,t,r){try{return Te(hi(e,t,r))}catch(n){return se(n)}}class cr{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(t){const r=this._back;let n=r;r._elements.length===16383&&(n={_elements:[],_next:void 0}),r._elements.push(t),n!==r&&(this._back=n,r._next=n),++this._size}shift(){const t=this._front;let r=t;const n=this._cursor;let o=n+1;const i=t._elements,a=i[n];return o===16384&&(r=t._next,o=0),--this._size,this._cursor=o,t!==r&&(this._front=r),i[n]=void 0,a}forEach(t){let r=this._cursor,n=this._front,o=n._elements;for(;!(r===o.length&&n._next===void 0||r===o.length&&(n=n._next,o=n._elements,r=0,o.length===0));)t(o[r]),++r}peek(){const t=this._front,r=this._cursor;return t._elements[r]}}const kg=Symbol("[[AbortSteps]]"),qg=Symbol("[[ErrorSteps]]"),Ef=Symbol("[[CancelSteps]]"),Sf=Symbol("[[PullSteps]]"),If=Symbol("[[ReleaseSteps]]");function Wg(e,t){e._ownerReadableStream=t,t._reader=e,t._state==="readable"?Il(e):t._state==="closed"?function(r){Il(r),Gg(r)}(e):Hg(e,t._storedError)}function Of(e,t){return mr(e._ownerReadableStream,t)}function an(e){const t=e._ownerReadableStream;t._state==="readable"?Tf(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):function(r,n){Hg(r,n)}(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),t._readableStreamController[If](),t._reader=void 0,e._ownerReadableStream=void 0}function La(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function Il(e){e._closedPromise=Ye((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r})}function Hg(e,t){Il(e),Tf(e,t)}function Tf(e,t){e._closedPromise_reject!==void 0&&(ao(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function Gg(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}const _h=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},QE=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function un(e,t){if(e!==void 0&&typeof(r=e)!="object"&&typeof r!="function")throw new TypeError(`${t} is not an object.`);var r}function lr(e,t){if(typeof e!="function")throw new TypeError(`${t} is not a function.`)}function Vg(e,t){if(!function(r){return typeof r=="object"&&r!==null||typeof r=="function"}(e))throw new TypeError(`${t} is not an object.`)}function pi(e,t,r){if(e===void 0)throw new TypeError(`Parameter ${t} is required in '${r}'.`)}function bh(e,t,r){if(e===void 0)throw new TypeError(`${t} is required in '${r}'.`)}function Kg(e){return Number(e)}function wh(e){return e===0?0:e}function Af(e,t){const r=Number.MAX_SAFE_INTEGER;let n=Number(e);if(n=wh(n),!_h(n))throw new TypeError(`${t} is not a finite number`);if(n=function(o){return wh(QE(o))}(n),n<0||n>r)throw new TypeError(`${t} is outside the accepted range of 0 to ${r}, inclusive`);return _h(n)&&n!==0?n:0}function Rf(e,t){if(!_n(e))throw new TypeError(`${t} is not a ReadableStream.`)}function Vi(e){return new Xn(e)}function zg(e,t){e._reader._readRequests.push(t)}function Cf(e,t,r){const n=e._reader._readRequests.shift();r?n._closeSteps():n._chunkSteps(t)}function Du(e){return e._reader._readRequests.length}function Jg(e){const t=e._reader;return t!==void 0&&!!xn(t)}class Xn{constructor(t){if(pi(t,1,"ReadableStreamDefaultReader"),Rf(t,"First parameter"),Pn(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");Wg(this,t),this._readRequests=new cr}get closed(){return xn(this)?this._closedPromise:se(js("closed"))}cancel(t=void 0){return xn(this)?this._ownerReadableStream===void 0?se(La("cancel")):Of(this,t):se(js("cancel"))}read(){if(!xn(this))return se(js("read"));if(this._ownerReadableStream===void 0)return se(La("read from"));let t,r;const n=Ye((o,i)=>{t=o,r=i});return ps(this,{_chunkSteps:o=>t({value:o,done:!1}),_closeSteps:()=>t({value:void 0,done:!0}),_errorSteps:o=>r(o)}),n}releaseLock(){if(!xn(this))throw js("releaseLock");this._ownerReadableStream!==void 0&&function(t){an(t);const r=new TypeError("Reader was released");Yg(t,r)}(this)}}function xn(e){return!!et(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readRequests")&&e instanceof Xn}function ps(e,t){const r=e._ownerReadableStream;r._disturbed=!0,r._state==="closed"?t._closeSteps():r._state==="errored"?t._errorSteps(r._storedError):r._readableStreamController[Sf](t)}function Yg(e,t){const r=e._readRequests;e._readRequests=new cr,r.forEach(n=>{n._errorSteps(t)})}function js(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}var Sc,Ic,Oc;function Bo(e){return e.slice()}function Qg(e,t,r,n,o){new Uint8Array(e).set(new Uint8Array(r,n,o),t)}Object.defineProperties(Xn.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),Oe(Xn.prototype.cancel,"cancel"),Oe(Xn.prototype.read,"read"),Oe(Xn.prototype.releaseLock,"releaseLock"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Xn.prototype,Symbol.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});let vi=e=>(vi=typeof e.transfer=="function"?t=>t.transfer():typeof structuredClone=="function"?t=>structuredClone(t,{transfer:[t]}):t=>t,vi(e)),mi=e=>(mi=typeof e.detached=="boolean"?t=>t.detached:t=>t.byteLength===0,mi(e));function Xg(e,t,r){if(e.slice)return e.slice(t,r);const n=r-t,o=new ArrayBuffer(n);return Qg(o,0,e,t,n),o}function jo(e,t){const r=e[t];if(r!=null){if(typeof r!="function")throw new TypeError(`${String(t)} is not a function`);return r}}function Eh(e){try{const t=e.done,r=e.value;return Br(YE(r),n=>({done:t,value:n}))}catch(t){return se(t)}}const Ns=(Oc=(Sc=Symbol.asyncIterator)!==null&&Sc!==void 0?Sc:(Ic=Symbol.for)===null||Ic===void 0?void 0:Ic.call(Symbol,"Symbol.asyncIterator"))!==null&&Oc!==void 0?Oc:"@@asyncIterator";function Zg(e,t="sync",r){if(r===void 0)if(t==="async"){if((r=jo(e,Ns))===void 0)return function(o){const i={next(){let a;try{a=ey(o)}catch(u){return se(u)}return Eh(a)},return(a){let u;try{const l=jo(o.iterator,"return");if(l===void 0)return Te({done:!0,value:a});u=hi(l,o.iterator,[a])}catch(l){return se(l)}return et(u)?Eh(u):se(new TypeError("The iterator.return() method must return an object"))}};return{iterator:i,nextMethod:i.next,done:!1}}(Zg(e,"sync",jo(e,Symbol.iterator)))}else r=jo(e,Symbol.iterator);if(r===void 0)throw new TypeError("The object is not iterable");const n=hi(r,e,[]);if(!et(n))throw new TypeError("The iterator method must return an object");return{iterator:n,nextMethod:n.next,done:!1}}function ey(e){const t=hi(e.nextMethod,e.iterator,[]);if(!et(t))throw new TypeError("The iterator.next() method must return an object");return t}class ty{constructor(t,r){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=t,this._preventCancel=r}next(){const t=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?fn(this._ongoingPromise,t,t):t(),this._ongoingPromise}return(t){const r=()=>this._returnSteps(t);return this._ongoingPromise=this._ongoingPromise?fn(this._ongoingPromise,r,r):r(),this._ongoingPromise}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});const t=this._reader;let r,n;const o=Ye((i,a)=>{r=i,n=a});return ps(t,{_chunkSteps:i=>{this._ongoingPromise=void 0,ci(()=>r({value:i,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,an(t),r({value:void 0,done:!0})},_errorSteps:i=>{this._ongoingPromise=void 0,this._isFinished=!0,an(t),n(i)}}),o}_returnSteps(t){if(this._isFinished)return Promise.resolve({value:t,done:!0});this._isFinished=!0;const r=this._reader;if(!this._preventCancel){const n=Of(r,t);return an(r),fn(n,()=>({value:t,done:!0}))}return an(r),Te({value:t,done:!0})}}const ry={next(){return Sh(this)?this._asyncIteratorImpl.next():se(Ih("next"))},return(e){return Sh(this)?this._asyncIteratorImpl.return(e):se(Ih("return"))},[Ns](){return this}};function Sh(e){if(!et(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof ty}catch{return!1}}function Ih(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}Object.defineProperty(ry,Ns,{enumerable:!1});const ny=Number.isNaN||function(e){return e!=e};function Oh(e){const t=Xg(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(t)}function Ol(e){const t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function xf(e,t,r){if(typeof(n=r)!="number"||ny(n)||n<0||r===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");var n;e._queue.push({value:t,size:r}),e._queueTotalSize+=r}function jn(e){e._queue=new cr,e._queueTotalSize=0}function iy(e){return e===DataView}class Ni{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Tc(this))throw Ac("view");return this._view}respond(t){if(!Tc(this))throw Ac("respond");if(pi(t,1,"respond"),t=Af(t,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(mi(this._view.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be used as a response");da(this._associatedReadableByteStreamController,t)}respondWithNewView(t){if(!Tc(this))throw Ac("respondWithNewView");if(pi(t,1,"respondWithNewView"),!ArrayBuffer.isView(t))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(mi(t.buffer))throw new TypeError("The given view's buffer has been detached and so cannot be used as a response");ha(this._associatedReadableByteStreamController,t)}}Object.defineProperties(Ni.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),Oe(Ni.prototype.respond,"respond"),Oe(Ni.prototype.respondWithNewView,"respondWithNewView"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Ni.prototype,Symbol.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class Rn{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!Zn(this))throw So("byobRequest");return Al(this)}get desiredSize(){if(!Zn(this))throw So("desiredSize");return vy(this)}close(){if(!Zn(this))throw So("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");const t=this._controlledReadableByteStream._state;if(t!=="readable")throw new TypeError(`The stream (in ${t} state) is not in the readable state and cannot be closed`);ko(this)}enqueue(t){if(!Zn(this))throw So("enqueue");if(pi(t,1,"enqueue"),!ArrayBuffer.isView(t))throw new TypeError("chunk must be an array buffer view");if(t.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(t.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");const r=this._controlledReadableByteStream._state;if(r!=="readable")throw new TypeError(`The stream (in ${r} state) is not in the readable state and cannot be enqueued to`);fa(this,t)}error(t=void 0){if(!Zn(this))throw So("error");ir(this,t)}[Ef](t){oy(this),jn(this);const r=this._cancelAlgorithm(t);return Lu(this),r}[Sf](t){const r=this._controlledReadableByteStream;if(this._queueTotalSize>0)return void py(this,t);const n=this._autoAllocateChunkSize;if(n!==void 0){let o;try{o=new ArrayBuffer(n)}catch(a){return void t._errorSteps(a)}const i={buffer:o,bufferByteLength:n,byteOffset:0,byteLength:n,bytesFilled:0,minimumFill:1,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(i)}zg(r,t),wi(this)}[If](){if(this._pendingPullIntos.length>0){const t=this._pendingPullIntos.peek();t.readerType="none",this._pendingPullIntos=new cr,this._pendingPullIntos.push(t)}}}function Zn(e){return!!et(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")&&e instanceof Rn}function Tc(e){return!!et(e)&&!!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")&&e instanceof Ni}function wi(e){if(function(r){const n=r._controlledReadableByteStream;return n._state!=="readable"||r._closeRequested||!r._started?!1:!!(Jg(n)&&Du(n)>0||Nf(n)&&yy(n)>0||vy(r)>0)}(e)){if(e._pulling)return void(e._pullAgain=!0);e._pulling=!0,qt(e._pullAlgorithm(),()=>(e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,wi(e)),null),r=>(ir(e,r),null))}}function oy(e){Pf(e),e._pendingPullIntos=new cr}function sy(e,t){let r=!1;e._state==="closed"&&(r=!0);const n=ay(t);t.readerType==="default"?Cf(e,n,r):function(o,i,a){const u=o._reader,l=u._readIntoRequests.shift();a?l._closeSteps(i):l._chunkSteps(i)}(e,n,r)}function ca(e,t){for(let r=0;r<t.length;++r)sy(e,t[r])}function ay(e){const t=e.bytesFilled,r=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/r)}function la(e,t,r,n){e._queue.push({buffer:t,byteOffset:r,byteLength:n}),e._queueTotalSize+=n}function uy(e,t,r,n){let o;try{o=Xg(t,r,r+n)}catch(i){throw ir(e,i),i}la(e,o,0,n)}function cy(e,t){t.bytesFilled>0&&uy(e,t.buffer,t.byteOffset,t.bytesFilled),Ki(e)}function ly(e,t){const r=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),n=t.bytesFilled+r;let o=r,i=!1;const a=n-n%t.elementSize;a>=t.minimumFill&&(o=a-t.bytesFilled,i=!0);const u=e._queue;for(;o>0;){const l=u.peek(),s=Math.min(o,l.byteLength),c=t.byteOffset+t.bytesFilled;Qg(t.buffer,c,l.buffer,l.byteOffset,s),l.byteLength===s?u.shift():(l.byteOffset+=s,l.byteLength-=s),e._queueTotalSize-=s,fy(e,s,t),o-=s}return i}function fy(e,t,r){r.bytesFilled+=t}function dy(e){e._queueTotalSize===0&&e._closeRequested?(Lu(e),$s(e._controlledReadableByteStream)):wi(e)}function Pf(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function Tl(e){const t=[];for(;e._pendingPullIntos.length>0&&e._queueTotalSize!==0;){const r=e._pendingPullIntos.peek();ly(e,r)&&(Ki(e),t.push(r))}return t}function XE(e,t,r,n){const o=e._controlledReadableByteStream,i=t.constructor,a=function(d){return iy(d)?1:d.BYTES_PER_ELEMENT}(i),{byteOffset:u,byteLength:l}=t,s=r*a;let c;try{c=vi(t.buffer)}catch(d){return void n._errorSteps(d)}const f={buffer:c,bufferByteLength:c.byteLength,byteOffset:u,byteLength:l,bytesFilled:0,minimumFill:s,elementSize:a,viewConstructor:i,readerType:"byob"};if(e._pendingPullIntos.length>0)return e._pendingPullIntos.push(f),void Th(o,n);if(o._state==="closed"){const d=new i(f.buffer,f.byteOffset,0);return void n._closeSteps(d)}if(e._queueTotalSize>0){if(ly(e,f)){const d=ay(f);return dy(e),void n._chunkSteps(d)}if(e._closeRequested){const d=new TypeError("Insufficient bytes to fill elements in the given buffer");return ir(e,d),void n._errorSteps(d)}}e._pendingPullIntos.push(f),Th(o,n),wi(e)}function hy(e,t){const r=e._pendingPullIntos.peek();Pf(e),e._controlledReadableByteStream._state==="closed"?function(n,o){o.readerType==="none"&&Ki(n);const i=n._controlledReadableByteStream;if(Nf(i)){const a=[];for(;a.length<yy(i);)a.push(Ki(n));ca(i,a)}}(e,r):function(n,o,i){if(fy(0,o,i),i.readerType==="none"){cy(n,i);const l=Tl(n);return void ca(n._controlledReadableByteStream,l)}if(i.bytesFilled<i.minimumFill)return;Ki(n);const a=i.bytesFilled%i.elementSize;if(a>0){const l=i.byteOffset+i.bytesFilled;uy(n,i.buffer,l-a,a)}i.bytesFilled-=a;const u=Tl(n);sy(n._controlledReadableByteStream,i),ca(n._controlledReadableByteStream,u)}(e,t,r),wi(e)}function Ki(e){return e._pendingPullIntos.shift()}function Lu(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function ko(e){const t=e._controlledReadableByteStream;if(!e._closeRequested&&t._state==="readable")if(e._queueTotalSize>0)e._closeRequested=!0;else{if(e._pendingPullIntos.length>0){const r=e._pendingPullIntos.peek();if(r.bytesFilled%r.elementSize!==0){const n=new TypeError("Insufficient bytes to fill elements in the given buffer");throw ir(e,n),n}}Lu(e),$s(t)}}function fa(e,t){const r=e._controlledReadableByteStream;if(e._closeRequested||r._state!=="readable")return;const{buffer:n,byteOffset:o,byteLength:i}=t;if(mi(n))throw new TypeError("chunk's buffer is detached and so cannot be enqueued");const a=vi(n);if(e._pendingPullIntos.length>0){const u=e._pendingPullIntos.peek();if(mi(u.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be filled with an enqueued chunk");Pf(e),u.buffer=vi(u.buffer),u.readerType==="none"&&cy(e,u)}Jg(r)?(function(u){const l=u._controlledReadableByteStream._reader;for(;l._readRequests.length>0;){if(u._queueTotalSize===0)return;py(u,l._readRequests.shift())}}(e),Du(r)===0?la(e,a,o,i):(e._pendingPullIntos.length>0&&Ki(e),Cf(r,new Uint8Array(a,o,i),!1))):Nf(r)?(la(e,a,o,i),ca(r,Tl(e))):la(e,a,o,i),wi(e)}function ir(e,t){const r=e._controlledReadableByteStream;r._state==="readable"&&(oy(e),jn(e),Lu(e),My(r,t))}function py(e,t){const r=e._queue.shift();e._queueTotalSize-=r.byteLength,dy(e);const n=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);t._chunkSteps(n)}function Al(e){if(e._byobRequest===null&&e._pendingPullIntos.length>0){const t=e._pendingPullIntos.peek(),r=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled),n=Object.create(Ni.prototype);(function(o,i,a){o._associatedReadableByteStreamController=i,o._view=a})(n,e,r),e._byobRequest=n}return e._byobRequest}function vy(e){const t=e._controlledReadableByteStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function da(e,t){const r=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(t===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(r.bytesFilled+t>r.byteLength)throw new RangeError("bytesWritten out of range")}r.buffer=vi(r.buffer),hy(e,t)}function ha(e,t){const r=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(t.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(r.byteOffset+r.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(r.bufferByteLength!==t.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(r.bytesFilled+t.byteLength>r.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");const n=t.byteLength;r.buffer=vi(t.buffer),hy(e,n)}function my(e,t,r,n,o,i,a){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=null,t._queue=t._queueTotalSize=void 0,jn(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=i,t._pullAlgorithm=n,t._cancelAlgorithm=o,t._autoAllocateChunkSize=a,t._pendingPullIntos=new cr,e._readableStreamController=t,qt(Te(r()),()=>(t._started=!0,wi(t),null),u=>(ir(t,u),null))}function Ac(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function So(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function ZE(e,t){if((e=`${e}`)!="byob")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function gy(e){return new ei(e)}function Th(e,t){e._reader._readIntoRequests.push(t)}function yy(e){return e._reader._readIntoRequests.length}function Nf(e){const t=e._reader;return t!==void 0&&!!oi(t)}Object.defineProperties(Rn.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),Oe(Rn.prototype.close,"close"),Oe(Rn.prototype.enqueue,"enqueue"),Oe(Rn.prototype.error,"error"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Rn.prototype,Symbol.toStringTag,{value:"ReadableByteStreamController",configurable:!0});class ei{constructor(t){if(pi(t,1,"ReadableStreamBYOBReader"),Rf(t,"First parameter"),Pn(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!Zn(t._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");Wg(this,t),this._readIntoRequests=new cr}get closed(){return oi(this)?this._closedPromise:se(ks("closed"))}cancel(t=void 0){return oi(this)?this._ownerReadableStream===void 0?se(La("cancel")):Of(this,t):se(ks("cancel"))}read(t,r={}){if(!oi(this))return se(ks("read"));if(!ArrayBuffer.isView(t))return se(new TypeError("view must be an array buffer view"));if(t.byteLength===0)return se(new TypeError("view must have non-zero byteLength"));if(t.buffer.byteLength===0)return se(new TypeError("view's buffer must have non-zero byteLength"));if(mi(t.buffer))return se(new TypeError("view's buffer has been detached"));let n;try{n=function(l,s){var c;return un(l,s),{min:Af((c=l==null?void 0:l.min)!==null&&c!==void 0?c:1,`${s} has member 'min' that`)}}(r,"options")}catch(l){return se(l)}const o=n.min;if(o===0)return se(new TypeError("options.min must be greater than 0"));if(function(l){return iy(l.constructor)}(t)){if(o>t.byteLength)return se(new RangeError("options.min must be less than or equal to view's byteLength"))}else if(o>t.length)return se(new RangeError("options.min must be less than or equal to view's length"));if(this._ownerReadableStream===void 0)return se(La("read from"));let i,a;const u=Ye((l,s)=>{i=l,a=s});return _y(this,t,o,{_chunkSteps:l=>i({value:l,done:!1}),_closeSteps:l=>i({value:l,done:!0}),_errorSteps:l=>a(l)}),u}releaseLock(){if(!oi(this))throw ks("releaseLock");this._ownerReadableStream!==void 0&&function(t){an(t);const r=new TypeError("Reader was released");by(t,r)}(this)}}function oi(e){return!!et(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")&&e instanceof ei}function _y(e,t,r,n){const o=e._ownerReadableStream;o._disturbed=!0,o._state==="errored"?n._errorSteps(o._storedError):XE(o._readableStreamController,t,r,n)}function by(e,t){const r=e._readIntoRequests;e._readIntoRequests=new cr,r.forEach(n=>{n._errorSteps(t)})}function ks(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function vs(e,t){const{highWaterMark:r}=e;if(r===void 0)return t;if(ny(r)||r<0)throw new RangeError("Invalid highWaterMark");return r}function Ua(e){const{size:t}=e;return t||(()=>1)}function Fa(e,t){un(e,t);const r=e==null?void 0:e.highWaterMark,n=e==null?void 0:e.size;return{highWaterMark:r===void 0?void 0:Kg(r),size:n===void 0?void 0:eS(n,`${t} has member 'size' that`)}}function eS(e,t){return lr(e,t),r=>Kg(e(r))}function tS(e,t,r){return lr(e,r),n=>gn(e,t,[n])}function rS(e,t,r){return lr(e,r),()=>gn(e,t,[])}function nS(e,t,r){return lr(e,r),n=>hi(e,t,[n])}function iS(e,t,r){return lr(e,r),(n,o)=>gn(e,t,[n,o])}function wy(e,t){if(!$i(e))throw new TypeError(`${t} is not a WritableStream.`)}Object.defineProperties(ei.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),Oe(ei.prototype.cancel,"cancel"),Oe(ei.prototype.read,"read"),Oe(ei.prototype.releaseLock,"releaseLock"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ei.prototype,Symbol.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});class ti{constructor(t={},r={}){t===void 0?t=null:Vg(t,"First parameter");const n=Fa(r,"Second parameter"),o=function(a,u){un(a,u);const l=a==null?void 0:a.abort,s=a==null?void 0:a.close,c=a==null?void 0:a.start,f=a==null?void 0:a.type,d=a==null?void 0:a.write;return{abort:l===void 0?void 0:tS(l,a,`${u} has member 'abort' that`),close:s===void 0?void 0:rS(s,a,`${u} has member 'close' that`),start:c===void 0?void 0:nS(c,a,`${u} has member 'start' that`),write:d===void 0?void 0:iS(d,a,`${u} has member 'write' that`),type:f}}(t,"First parameter");if(Sy(this),o.type!==void 0)throw new RangeError("Invalid type is specified");const i=Ua(n);(function(a,u,l,s){const c=Object.create(ms.prototype);let f,d,v,g;f=u.start!==void 0?()=>u.start(c):()=>{},d=u.write!==void 0?b=>u.write(b,c):()=>Te(void 0),v=u.close!==void 0?()=>u.close():()=>Te(void 0),g=u.abort!==void 0?b=>u.abort(b):()=>Te(void 0),xy(a,c,f,d,v,g,l,s)})(this,o,vs(n,1),i)}get locked(){if(!$i(this))throw Ws("locked");return zi(this)}abort(t=void 0){return $i(this)?zi(this)?se(new TypeError("Cannot abort a stream that already has a writer")):Ma(this,t):se(Ws("abort"))}close(){return $i(this)?zi(this)?se(new TypeError("Cannot close a stream that already has a writer")):jr(this)?se(new TypeError("Cannot close an already-closing stream")):Iy(this):se(Ws("close"))}getWriter(){if(!$i(this))throw Ws("getWriter");return Ey(this)}}function Ey(e){return new Sn(e)}function Sy(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new cr,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function $i(e){return!!et(e)&&!!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")&&e instanceof ti}function zi(e){return e._writer!==void 0}function Ma(e,t){var r;if(e._state==="closed"||e._state==="errored")return Te(void 0);e._writableStreamController._abortReason=t,(r=e._writableStreamController._abortController)===null||r===void 0||r.abort(t);const n=e._state;if(n==="closed"||n==="errored")return Te(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let o=!1;n==="erroring"&&(o=!0,t=void 0);const i=Ye((a,u)=>{e._pendingAbortRequest={_promise:void 0,_resolve:a,_reject:u,_reason:t,_wasAlreadyErroring:o}});return e._pendingAbortRequest._promise=i,o||$f(e,t),i}function Iy(e){const t=e._state;if(t==="closed"||t==="errored")return se(new TypeError(`The stream (in ${t} state) is not in the writable state and cannot be closed`));const r=Ye((i,a)=>{const u={_resolve:i,_reject:a};e._closeRequest=u}),n=e._writer;var o;return n!==void 0&&e._backpressure&&t==="writable"&&Mf(n),xf(o=e._writableStreamController,Cy,0),Uu(o),r}function Rl(e,t){e._state!=="writable"?Df(e):$f(e,t)}function $f(e,t){const r=e._writableStreamController;e._state="erroring",e._storedError=t;const n=e._writer;n!==void 0&&Ty(n,t),!function(o){return!(o._inFlightWriteRequest===void 0&&o._inFlightCloseRequest===void 0)}(e)&&r._started&&Df(e)}function Df(e){e._state="errored",e._writableStreamController[qg]();const t=e._storedError;if(e._writeRequests.forEach(n=>{n._reject(t)}),e._writeRequests=new cr,e._pendingAbortRequest===void 0)return void qs(e);const r=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,r._wasAlreadyErroring)return r._reject(t),void qs(e);qt(e._writableStreamController[kg](r._reason),()=>(r._resolve(),qs(e),null),n=>(r._reject(n),qs(e),null))}function jr(e){return e._closeRequest!==void 0||e._inFlightCloseRequest!==void 0}function qs(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);const t=e._writer;t!==void 0&&Ff(t,e._storedError)}function Lf(e,t){const r=e._writer;r!==void 0&&t!==e._backpressure&&(t?function(n){Fu(n)}(r):Mf(r)),e._backpressure=t}Object.defineProperties(ti.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),Oe(ti.prototype.abort,"abort"),Oe(ti.prototype.close,"close"),Oe(ti.prototype.getWriter,"getWriter"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ti.prototype,Symbol.toStringTag,{value:"WritableStream",configurable:!0});class Sn{constructor(t){if(pi(t,1,"WritableStreamDefaultWriter"),wy(t,"First parameter"),zi(t))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=t,t._writer=this;const r=t._state;if(r==="writable")!jr(t)&&t._backpressure?Fu(this):Ah(this),pa(this);else if(r==="erroring")Cl(this,t._storedError),pa(this);else if(r==="closed")Ah(this),pa(n=this),Dy(n);else{const o=t._storedError;Cl(this,o),$y(this,o)}var n}get closed(){return Hn(this)?this._closedPromise:se(Gn("closed"))}get desiredSize(){if(!Hn(this))throw Gn("desiredSize");if(this._ownerWritableStream===void 0)throw qo("desiredSize");return function(t){const r=t._ownerWritableStream,n=r._state;return n==="errored"||n==="erroring"?null:n==="closed"?0:Py(r._writableStreamController)}(this)}get ready(){return Hn(this)?this._readyPromise:se(Gn("ready"))}abort(t=void 0){return Hn(this)?this._ownerWritableStream===void 0?se(qo("abort")):function(r,n){return Ma(r._ownerWritableStream,n)}(this,t):se(Gn("abort"))}close(){if(!Hn(this))return se(Gn("close"));const t=this._ownerWritableStream;return t===void 0?se(qo("close")):jr(t)?se(new TypeError("Cannot close an already-closing stream")):Oy(this)}releaseLock(){if(!Hn(this))throw Gn("releaseLock");this._ownerWritableStream!==void 0&&Ay(this)}write(t=void 0){return Hn(this)?this._ownerWritableStream===void 0?se(qo("write to")):Ry(this,t):se(Gn("write"))}}function Hn(e){return!!et(e)&&!!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")&&e instanceof Sn}function Oy(e){return Iy(e._ownerWritableStream)}function oS(e,t){e._closedPromiseState==="pending"?Ff(e,t):function(r,n){$y(r,n)}(e,t)}function Ty(e,t){e._readyPromiseState==="pending"?Ly(e,t):function(r,n){Cl(r,n)}(e,t)}function Ay(e){const t=e._ownerWritableStream,r=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");Ty(e,r),oS(e,r),t._writer=void 0,e._ownerWritableStream=void 0}function Ry(e,t){const r=e._ownerWritableStream,n=r._writableStreamController,o=function(u,l){if(u._strategySizeAlgorithm===void 0)return 1;try{return u._strategySizeAlgorithm(l)}catch(s){return gs(u,s),1}}(n,t);if(r!==e._ownerWritableStream)return se(qo("write to"));const i=r._state;if(i==="errored")return se(r._storedError);if(jr(r)||i==="closed")return se(new TypeError("The stream is closing or closed and cannot be written to"));if(i==="erroring")return se(r._storedError);const a=function(u){return Ye((l,s)=>{const c={_resolve:l,_reject:s};u._writeRequests.push(c)})}(r);return function(u,l,s){try{xf(u,l,s)}catch(f){return void gs(u,f)}const c=u._controlledWritableStream;!jr(c)&&c._state==="writable"&&Lf(c,Uf(u)),Uu(u)}(n,t,o),a}Object.defineProperties(Sn.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),Oe(Sn.prototype.abort,"abort"),Oe(Sn.prototype.close,"close"),Oe(Sn.prototype.releaseLock,"releaseLock"),Oe(Sn.prototype.write,"write"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Sn.prototype,Symbol.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});const Cy={};class ms{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Rc(this))throw Cc("abortReason");return this._abortReason}get signal(){if(!Rc(this))throw Cc("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(t=void 0){if(!Rc(this))throw Cc("error");this._controlledWritableStream._state==="writable"&&Ny(this,t)}[kg](t){const r=this._abortAlgorithm(t);return Ba(this),r}[qg](){jn(this)}}function Rc(e){return!!et(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")&&e instanceof ms}function xy(e,t,r,n,o,i,a,u){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,jn(t),t._abortReason=void 0,t._abortController=function(){if(typeof AbortController=="function")return new AbortController}(),t._started=!1,t._strategySizeAlgorithm=u,t._strategyHWM=a,t._writeAlgorithm=n,t._closeAlgorithm=o,t._abortAlgorithm=i;const l=Uf(t);Lf(e,l),qt(Te(r()),()=>(t._started=!0,Uu(t),null),s=>(t._started=!0,Rl(e,s),null))}function Ba(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Py(e){return e._strategyHWM-e._queueTotalSize}function Uu(e){const t=e._controlledWritableStream;if(!e._started||t._inFlightWriteRequest!==void 0)return;if(t._state==="erroring")return void Df(t);if(e._queue.length===0)return;const r=e._queue.peek().value;r===Cy?function(n){const o=n._controlledWritableStream;(function(a){a._inFlightCloseRequest=a._closeRequest,a._closeRequest=void 0})(o),Ol(n);const i=n._closeAlgorithm();Ba(n),qt(i,()=>(function(a){a._inFlightCloseRequest._resolve(void 0),a._inFlightCloseRequest=void 0,a._state==="erroring"&&(a._storedError=void 0,a._pendingAbortRequest!==void 0&&(a._pendingAbortRequest._resolve(),a._pendingAbortRequest=void 0)),a._state="closed";const u=a._writer;u!==void 0&&Dy(u)}(o),null),a=>(function(u,l){u._inFlightCloseRequest._reject(l),u._inFlightCloseRequest=void 0,u._pendingAbortRequest!==void 0&&(u._pendingAbortRequest._reject(l),u._pendingAbortRequest=void 0),Rl(u,l)}(o,a),null))}(e):function(n,o){const i=n._controlledWritableStream;(function(u){u._inFlightWriteRequest=u._writeRequests.shift()})(i);const a=n._writeAlgorithm(o);qt(a,()=>{(function(l){l._inFlightWriteRequest._resolve(void 0),l._inFlightWriteRequest=void 0})(i);const u=i._state;if(Ol(n),!jr(i)&&u==="writable"){const l=Uf(n);Lf(i,l)}return Uu(n),null},u=>(i._state==="writable"&&Ba(n),function(l,s){l._inFlightWriteRequest._reject(s),l._inFlightWriteRequest=void 0,Rl(l,s)}(i,u),null))}(e,r)}function gs(e,t){e._controlledWritableStream._state==="writable"&&Ny(e,t)}function Uf(e){return Py(e)<=0}function Ny(e,t){const r=e._controlledWritableStream;Ba(e),$f(r,t)}function Ws(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function Cc(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function Gn(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function qo(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function pa(e){e._closedPromise=Ye((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r,e._closedPromiseState="pending"})}function $y(e,t){pa(e),Ff(e,t)}function Ff(e,t){e._closedPromise_reject!==void 0&&(ao(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function Dy(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function Fu(e){e._readyPromise=Ye((t,r)=>{e._readyPromise_resolve=t,e._readyPromise_reject=r}),e._readyPromiseState="pending"}function Cl(e,t){Fu(e),Ly(e,t)}function Ah(e){Fu(e),Mf(e)}function Ly(e,t){e._readyPromise_reject!==void 0&&(ao(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function Mf(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}Object.defineProperties(ms.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ms.prototype,Symbol.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});const Rh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:void 0,sS=function(){const e=Rh==null?void 0:Rh.DOMException;return function(t){if(typeof t!="function"&&typeof t!="object"||t.name!=="DOMException")return!1;try{return new t,!0}catch{return!1}}(e)?e:void 0}()||function(){const e=function(t,r){this.message=t||"",this.name=r||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return Oe(e,"DOMException"),e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}();function Ch(e,t,r,n,o,i){const a=Vi(e),u=Ey(t);e._disturbed=!0;let l=!1,s=Te(void 0);return Ye((c,f)=>{let d;if(i!==void 0){if(d=()=>{const R=i.reason!==void 0?i.reason:new sS("Aborted","AbortError"),L=[];n||L.push(()=>t._state==="writable"?Ma(t,R):Te(void 0)),o||L.push(()=>e._state==="readable"?mr(e,R):Te(void 0)),E(()=>Promise.all(L.map(F=>F())),!0,R)},i.aborted)return void d();i.addEventListener("abort",d)}var v,g,b;if(w(e,a._closedPromise,R=>(n?A(!0,R):E(()=>Ma(t,R),!0,R),null)),w(t,u._closedPromise,R=>(o?A(!0,R):E(()=>mr(e,R),!0,R),null)),v=e,g=a._closedPromise,b=()=>(r?A():E(()=>function(R){const L=R._ownerWritableStream,F=L._state;return jr(L)||F==="closed"?Te(void 0):F==="errored"?se(L._storedError):Oy(R)}(u)),null),v._state==="closed"?b():Ec(g,b),jr(t)||t._state==="closed"){const R=new TypeError("the destination writable stream closed before all data could be piped to it");o?A(!0,R):E(()=>mr(e,R),!0,R)}function y(){const R=s;return Br(s,()=>R!==s?y():void 0)}function w(R,L,F){R._state==="errored"?F(R._storedError):Sl(L,F)}function E(R,L,F){function U(){return qt(R(),()=>I(L,F),N=>I(!0,N)),null}l||(l=!0,t._state!=="writable"||jr(t)?U():Ec(y(),U))}function A(R,L){l||(l=!0,t._state!=="writable"||jr(t)?I(R,L):Ec(y(),()=>I(R,L)))}function I(R,L){return Ay(u),an(a),i!==void 0&&i.removeEventListener("abort",d),R?f(L):c(void 0),null}ao(Ye((R,L)=>{(function F(U){U?R():Br(l?Te(!0):Br(u._readyPromise,()=>Ye((N,W)=>{ps(a,{_chunkSteps:j=>{s=Br(Ry(u,j),void 0,hs),N(!1)},_closeSteps:()=>N(!0),_errorSteps:W})})),F,L)})(!1)}))})}class Cn{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Hs(this))throw Gs("desiredSize");return Bf(this)}close(){if(!Hs(this))throw Gs("close");if(!ro(this))throw new TypeError("The stream is not in a state that permits close");gi(this)}enqueue(t=void 0){if(!Hs(this))throw Gs("enqueue");if(!ro(this))throw new TypeError("The stream is not in a state that permits enqueue");return to(this,t)}error(t=void 0){if(!Hs(this))throw Gs("error");Er(this,t)}[Ef](t){jn(this);const r=this._cancelAlgorithm(t);return ja(this),r}[Sf](t){const r=this._controlledReadableStream;if(this._queue.length>0){const n=Ol(this);this._closeRequested&&this._queue.length===0?(ja(this),$s(r)):ys(this),t._chunkSteps(n)}else zg(r,t),ys(this)}[If](){}}function Hs(e){return!!et(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")&&e instanceof Cn}function ys(e){if(Uy(e)){if(e._pulling)return void(e._pullAgain=!0);e._pulling=!0,qt(e._pullAlgorithm(),()=>(e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,ys(e)),null),t=>(Er(e,t),null))}}function Uy(e){const t=e._controlledReadableStream;return!ro(e)||!e._started?!1:Pn(t)&&Du(t)>0?!0:Bf(e)>0}function ja(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function gi(e){if(!ro(e))return;const t=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(ja(e),$s(t))}function to(e,t){if(!ro(e))return;const r=e._controlledReadableStream;if(Pn(r)&&Du(r)>0)Cf(r,t,!1);else{let n;try{n=e._strategySizeAlgorithm(t)}catch(o){throw Er(e,o),o}try{xf(e,t,n)}catch(o){throw Er(e,o),o}}ys(e)}function Er(e,t){const r=e._controlledReadableStream;r._state==="readable"&&(jn(e),ja(e),My(r,t))}function Bf(e){const t=e._controlledReadableStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function ro(e){const t=e._controlledReadableStream._state;return!e._closeRequested&&t==="readable"}function Fy(e,t,r,n,o,i,a){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,jn(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=a,t._strategyHWM=i,t._pullAlgorithm=n,t._cancelAlgorithm=o,e._readableStreamController=t,qt(Te(r()),()=>(t._started=!0,ys(t),null),u=>(Er(t,u),null))}function Gs(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function aS(e,t){return Zn(e._readableStreamController)?function(r){let n,o,i,a,u,l=Vi(r),s=!1,c=!1,f=!1,d=!1,v=!1;const g=Ye(F=>{u=F});function b(F){Sl(F._closedPromise,U=>(F!==l||(ir(i._readableStreamController,U),ir(a._readableStreamController,U),d&&v||u(void 0)),null))}function y(){oi(l)&&(an(l),l=Vi(r),b(l)),ps(l,{_chunkSteps:F=>{ci(()=>{c=!1,f=!1;const U=F;let N=F;if(!d&&!v)try{N=Oh(F)}catch(W){return ir(i._readableStreamController,W),ir(a._readableStreamController,W),void u(mr(r,W))}d||fa(i._readableStreamController,U),v||fa(a._readableStreamController,N),s=!1,c?E():f&&A()})},_closeSteps:()=>{s=!1,d||ko(i._readableStreamController),v||ko(a._readableStreamController),i._readableStreamController._pendingPullIntos.length>0&&da(i._readableStreamController,0),a._readableStreamController._pendingPullIntos.length>0&&da(a._readableStreamController,0),d&&v||u(void 0)},_errorSteps:()=>{s=!1}})}function w(F,U){xn(l)&&(an(l),l=gy(r),b(l));const N=U?a:i,W=U?i:a;_y(l,F,1,{_chunkSteps:j=>{ci(()=>{c=!1,f=!1;const X=U?v:d;if(U?d:v)X||ha(N._readableStreamController,j);else{let fe;try{fe=Oh(j)}catch(q){return ir(N._readableStreamController,q),ir(W._readableStreamController,q),void u(mr(r,q))}X||ha(N._readableStreamController,j),fa(W._readableStreamController,fe)}s=!1,c?E():f&&A()})},_closeSteps:j=>{s=!1;const X=U?v:d,fe=U?d:v;X||ko(N._readableStreamController),fe||ko(W._readableStreamController),j!==void 0&&(X||ha(N._readableStreamController,j),!fe&&W._readableStreamController._pendingPullIntos.length>0&&da(W._readableStreamController,0)),X&&fe||u(void 0)},_errorSteps:()=>{s=!1}})}function E(){if(s)return c=!0,Te(void 0);s=!0;const F=Al(i._readableStreamController);return F===null?y():w(F._view,!1),Te(void 0)}function A(){if(s)return f=!0,Te(void 0);s=!0;const F=Al(a._readableStreamController);return F===null?y():w(F._view,!0),Te(void 0)}function I(F){if(d=!0,n=F,v){const U=Bo([n,o]),N=mr(r,U);u(N)}return g}function R(F){if(v=!0,o=F,d){const U=Bo([n,o]),N=mr(r,U);u(N)}return g}function L(){}return i=Ph(L,E,I),a=Ph(L,A,R),b(l),[i,a]}(e):function(r){const n=Vi(r);let o,i,a,u,l,s=!1,c=!1,f=!1,d=!1;const v=Ye(E=>{l=E});function g(){return s?(c=!0,Te(void 0)):(s=!0,ps(n,{_chunkSteps:E=>{ci(()=>{c=!1;const A=E,I=E;f||to(a._readableStreamController,A),d||to(u._readableStreamController,I),s=!1,c&&g()})},_closeSteps:()=>{s=!1,f||gi(a._readableStreamController),d||gi(u._readableStreamController),f&&d||l(void 0)},_errorSteps:()=>{s=!1}}),Te(void 0))}function b(E){if(f=!0,o=E,d){const A=Bo([o,i]),I=mr(r,A);l(I)}return v}function y(E){if(d=!0,i=E,f){const A=Bo([o,i]),I=mr(r,A);l(I)}return v}function w(){}return a=_s(w,g,b),u=_s(w,g,y),Sl(n._closedPromise,E=>(Er(a._readableStreamController,E),Er(u._readableStreamController,E),f&&d||l(void 0),null)),[a,u]}(e)}function uS(e){return et(t=e)&&t.getReader!==void 0?function(r){let n;function o(){let a;try{a=r.read()}catch(u){return se(u)}return fn(a,u=>{if(!et(u))throw new TypeError("The promise returned by the reader.read() method must fulfill with an object");if(u.done)gi(n._readableStreamController);else{const l=u.value;to(n._readableStreamController,l)}})}function i(a){try{return Te(r.cancel(a))}catch(u){return se(u)}}return n=_s(hs,o,i,0),n}(e.getReader()):function(r){let n;const o=Zg(r,"async");function i(){let u;try{u=ey(o)}catch(l){return se(l)}return fn(Te(u),l=>{if(!et(l))throw new TypeError("The promise returned by the iterator.next() method must fulfill with an object");if(l.done)gi(n._readableStreamController);else{const s=l.value;to(n._readableStreamController,s)}})}function a(u){const l=o.iterator;let s;try{s=jo(l,"return")}catch(c){return se(c)}return s===void 0?Te(void 0):fn(gn(s,l,[u]),c=>{if(!et(c))throw new TypeError("The promise returned by the iterator.return() method must fulfill with an object")})}return n=_s(hs,i,a,0),n}(e);var t}function cS(e,t,r){return lr(e,r),n=>gn(e,t,[n])}function lS(e,t,r){return lr(e,r),n=>gn(e,t,[n])}function fS(e,t,r){return lr(e,r),n=>hi(e,t,[n])}function dS(e,t){if((e=`${e}`)!="bytes")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function xh(e,t){un(e,t);const r=e==null?void 0:e.preventAbort,n=e==null?void 0:e.preventCancel,o=e==null?void 0:e.preventClose,i=e==null?void 0:e.signal;return i!==void 0&&function(a,u){if(!function(l){if(typeof l!="object"||l===null)return!1;try{return typeof l.aborted=="boolean"}catch{return!1}}(a))throw new TypeError(`${u} is not an AbortSignal.`)}(i,`${t} has member 'signal' that`),{preventAbort:!!r,preventCancel:!!n,preventClose:!!o,signal:i}}Object.defineProperties(Cn.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),Oe(Cn.prototype.close,"close"),Oe(Cn.prototype.enqueue,"enqueue"),Oe(Cn.prototype.error,"error"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Cn.prototype,Symbol.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});let ut=class{constructor(t={},r={}){t===void 0?t=null:Vg(t,"First parameter");const n=Fa(r,"Second parameter"),o=function(i,a){un(i,a);const u=i,l=u==null?void 0:u.autoAllocateChunkSize,s=u==null?void 0:u.cancel,c=u==null?void 0:u.pull,f=u==null?void 0:u.start,d=u==null?void 0:u.type;return{autoAllocateChunkSize:l===void 0?void 0:Af(l,`${a} has member 'autoAllocateChunkSize' that`),cancel:s===void 0?void 0:cS(s,u,`${a} has member 'cancel' that`),pull:c===void 0?void 0:lS(c,u,`${a} has member 'pull' that`),start:f===void 0?void 0:fS(f,u,`${a} has member 'start' that`),type:d===void 0?void 0:dS(d,`${a} has member 'type' that`)}}(t,"First parameter");if(jf(this),o.type==="bytes"){if(n.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");(function(i,a,u){const l=Object.create(Rn.prototype);let s,c,f;s=a.start!==void 0?()=>a.start(l):()=>{},c=a.pull!==void 0?()=>a.pull(l):()=>Te(void 0),f=a.cancel!==void 0?v=>a.cancel(v):()=>Te(void 0);const d=a.autoAllocateChunkSize;if(d===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");my(i,l,s,c,f,u,d)})(this,o,vs(n,0))}else{const i=Ua(n);(function(a,u,l,s){const c=Object.create(Cn.prototype);let f,d,v;f=u.start!==void 0?()=>u.start(c):()=>{},d=u.pull!==void 0?()=>u.pull(c):()=>Te(void 0),v=u.cancel!==void 0?g=>u.cancel(g):()=>Te(void 0),Fy(a,c,f,d,v,l,s)})(this,o,vs(n,1),i)}}get locked(){if(!_n(this))throw Vn("locked");return Pn(this)}cancel(t=void 0){return _n(this)?Pn(this)?se(new TypeError("Cannot cancel a stream that already has a reader")):mr(this,t):se(Vn("cancel"))}getReader(t=void 0){if(!_n(this))throw Vn("getReader");return function(r,n){un(r,n);const o=r==null?void 0:r.mode;return{mode:o===void 0?void 0:ZE(o,`${n} has member 'mode' that`)}}(t,"First parameter").mode===void 0?Vi(this):gy(this)}pipeThrough(t,r={}){if(!_n(this))throw Vn("pipeThrough");pi(t,1,"pipeThrough");const n=function(i,a){un(i,a);const u=i==null?void 0:i.readable;bh(u,"readable","ReadableWritablePair"),Rf(u,`${a} has member 'readable' that`);const l=i==null?void 0:i.writable;return bh(l,"writable","ReadableWritablePair"),wy(l,`${a} has member 'writable' that`),{readable:u,writable:l}}(t,"First parameter"),o=xh(r,"Second parameter");if(Pn(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(zi(n.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");return ao(Ch(this,n.writable,o.preventClose,o.preventAbort,o.preventCancel,o.signal)),n.readable}pipeTo(t,r={}){if(!_n(this))return se(Vn("pipeTo"));if(t===void 0)return se("Parameter 1 is required in 'pipeTo'.");if(!$i(t))return se(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let n;try{n=xh(r,"Second parameter")}catch(o){return se(o)}return Pn(this)?se(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):zi(t)?se(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Ch(this,t,n.preventClose,n.preventAbort,n.preventCancel,n.signal)}tee(){if(!_n(this))throw Vn("tee");return Bo(aS(this))}values(t=void 0){if(!_n(this))throw Vn("values");return function(r,n){const o=Vi(r),i=new ty(o,n),a=Object.create(ry);return a._asyncIteratorImpl=i,a}(this,function(r,n){return un(r,n),{preventCancel:!!(r==null?void 0:r.preventCancel)}}(t,"First parameter").preventCancel)}[Ns](t){return this.values(t)}static from(t){return uS(t)}};function _s(e,t,r,n=1,o=()=>1){const i=Object.create(ut.prototype);return jf(i),Fy(i,Object.create(Cn.prototype),e,t,r,n,o),i}function Ph(e,t,r){const n=Object.create(ut.prototype);return jf(n),my(n,Object.create(Rn.prototype),e,t,r,0,void 0),n}function jf(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function _n(e){return!!et(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")&&e instanceof ut}function Pn(e){return e._reader!==void 0}function mr(e,t){if(e._disturbed=!0,e._state==="closed")return Te(void 0);if(e._state==="errored")return se(e._storedError);$s(e);const r=e._reader;if(r!==void 0&&oi(r)){const n=r._readIntoRequests;r._readIntoRequests=new cr,n.forEach(o=>{o._closeSteps(void 0)})}return fn(e._readableStreamController[Ef](t),hs)}function $s(e){e._state="closed";const t=e._reader;if(t!==void 0&&(Gg(t),xn(t))){const r=t._readRequests;t._readRequests=new cr,r.forEach(n=>{n._closeSteps()})}}function My(e,t){e._state="errored",e._storedError=t;const r=e._reader;r!==void 0&&(Tf(r,t),xn(r)?Yg(r,t):by(r,t))}function Vn(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}Object.defineProperties(ut,{from:{enumerable:!0}}),Object.defineProperties(ut.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),Oe(ut.from,"from"),Oe(ut.prototype.cancel,"cancel"),Oe(ut.prototype.getReader,"getReader"),Oe(ut.prototype.pipeThrough,"pipeThrough"),Oe(ut.prototype.pipeTo,"pipeTo"),Oe(ut.prototype.tee,"tee"),Oe(ut.prototype.values,"values"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ut.prototype,Symbol.toStringTag,{value:"ReadableStream",configurable:!0}),Object.defineProperty(ut.prototype,Ns,{value:ut.prototype.values,writable:!0,configurable:!0});const hS=e=>e.byteLength;Oe(hS,"size");const pS=()=>1;Oe(pS,"size");function vS(e,t,r){return lr(e,r),n=>gn(e,t,[n])}function mS(e,t,r){return lr(e,r),n=>hi(e,t,[n])}function gS(e,t,r){return lr(e,r),(n,o)=>gn(e,t,[n,o])}function yS(e,t,r){return lr(e,r),n=>gn(e,t,[n])}let ka=class{constructor(t={},r={},n={}){t===void 0&&(t=null);const o=Fa(r,"Second parameter"),i=Fa(n,"Third parameter"),a=function(d,v){un(d,v);const g=d==null?void 0:d.cancel,b=d==null?void 0:d.flush,y=d==null?void 0:d.readableType,w=d==null?void 0:d.start,E=d==null?void 0:d.transform,A=d==null?void 0:d.writableType;return{cancel:g===void 0?void 0:yS(g,d,`${v} has member 'cancel' that`),flush:b===void 0?void 0:vS(b,d,`${v} has member 'flush' that`),readableType:y,start:w===void 0?void 0:mS(w,d,`${v} has member 'start' that`),transform:E===void 0?void 0:gS(E,d,`${v} has member 'transform' that`),writableType:A}}(t,"First parameter");if(a.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(a.writableType!==void 0)throw new RangeError("Invalid writableType specified");const u=vs(i,0),l=Ua(i),s=vs(o,1),c=Ua(o);let f;(function(d,v,g,b,y,w){function E(){return v}function A(U){return function(N,W){const j=N._transformStreamController;return N._backpressure?fn(N._backpressureChangePromise,()=>{const X=N._writable;if(X._state==="erroring")throw X._storedError;return $h(j,W)}):$h(j,W)}(d,U)}function I(U){return function(N,W){const j=N._transformStreamController;if(j._finishPromise!==void 0)return j._finishPromise;const X=N._readable;j._finishPromise=Ye((q,de)=>{j._finishPromise_resolve=q,j._finishPromise_reject=de});const fe=j._cancelAlgorithm(W);return va(j),qt(fe,()=>(X._state==="errored"?Ii(j,X._storedError):(Er(X._readableStreamController,W),xc(j)),null),q=>(Er(X._readableStreamController,q),Ii(j,q),null)),j._finishPromise}(d,U)}function R(){return function(U){const N=U._transformStreamController;if(N._finishPromise!==void 0)return N._finishPromise;const W=U._readable;N._finishPromise=Ye((X,fe)=>{N._finishPromise_resolve=X,N._finishPromise_reject=fe});const j=N._flushAlgorithm();return va(N),qt(j,()=>(W._state==="errored"?Ii(N,W._storedError):(gi(W._readableStreamController),xc(N)),null),X=>(Er(W._readableStreamController,X),Ii(N,X),null)),N._finishPromise}(d)}function L(){return function(U){return qa(U,!1),U._backpressureChangePromise}(d)}function F(U){return function(N,W){const j=N._transformStreamController;if(j._finishPromise!==void 0)return j._finishPromise;const X=N._writable;j._finishPromise=Ye((q,de)=>{j._finishPromise_resolve=q,j._finishPromise_reject=de});const fe=j._cancelAlgorithm(W);return va(j),qt(fe,()=>(X._state==="errored"?Ii(j,X._storedError):(gs(X._writableStreamController,W),xl(N),xc(j)),null),q=>(gs(X._writableStreamController,q),xl(N),Ii(j,q),null)),j._finishPromise}(d,U)}d._writable=function(U,N,W,j,X=1,fe=()=>1){const q=Object.create(ti.prototype);return Sy(q),xy(q,Object.create(ms.prototype),U,N,W,j,X,fe),q}(E,A,R,I,g,b),d._readable=_s(E,L,F,y,w),d._backpressure=void 0,d._backpressureChangePromise=void 0,d._backpressureChangePromise_resolve=void 0,qa(d,!0),d._transformStreamController=void 0})(this,Ye(d=>{f=d}),s,c,u,l),function(d,v){const g=Object.create(ri.prototype);let b,y,w;b=v.transform!==void 0?E=>v.transform(E,g):E=>{try{return jy(g,E),Te(void 0)}catch(A){return se(A)}},y=v.flush!==void 0?()=>v.flush(g):()=>Te(void 0),w=v.cancel!==void 0?E=>v.cancel(E):()=>Te(void 0),function(E,A,I,R,L){A._controlledTransformStream=E,E._transformStreamController=A,A._transformAlgorithm=I,A._flushAlgorithm=R,A._cancelAlgorithm=L,A._finishPromise=void 0,A._finishPromise_resolve=void 0,A._finishPromise_reject=void 0}(d,g,b,y,w)}(this,a),a.start!==void 0?f(a.start(this._transformStreamController)):f(void 0)}get readable(){if(!Nh(this))throw Dh("readable");return this._readable}get writable(){if(!Nh(this))throw Dh("writable");return this._writable}};function Nh(e){return!!et(e)&&!!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")&&e instanceof ka}function By(e,t){Er(e._readable._readableStreamController,t),kf(e,t)}function kf(e,t){va(e._transformStreamController),gs(e._writable._writableStreamController,t),xl(e)}function xl(e){e._backpressure&&qa(e,!1)}function qa(e,t){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=Ye(r=>{e._backpressureChangePromise_resolve=r}),e._backpressure=t}Object.defineProperties(ka.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ka.prototype,Symbol.toStringTag,{value:"TransformStream",configurable:!0});class ri{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Vs(this))throw Ks("desiredSize");return Bf(this._controlledTransformStream._readable._readableStreamController)}enqueue(t=void 0){if(!Vs(this))throw Ks("enqueue");jy(this,t)}error(t=void 0){if(!Vs(this))throw Ks("error");var r;r=t,By(this._controlledTransformStream,r)}terminate(){if(!Vs(this))throw Ks("terminate");(function(t){const r=t._controlledTransformStream;gi(r._readable._readableStreamController);const n=new TypeError("TransformStream terminated");kf(r,n)})(this)}}function Vs(e){return!!et(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")&&e instanceof ri}function va(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0,e._cancelAlgorithm=void 0}function jy(e,t){const r=e._controlledTransformStream,n=r._readable._readableStreamController;if(!ro(n))throw new TypeError("Readable side is not in a state that permits enqueue");try{to(n,t)}catch(i){throw kf(r,i),r._readable._storedError}(function(i){return!Uy(i)})(n)!==r._backpressure&&qa(r,!0)}function $h(e,t){return fn(e._transformAlgorithm(t),void 0,r=>{throw By(e._controlledTransformStream,r),r})}function Ks(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function xc(e){e._finishPromise_resolve!==void 0&&(e._finishPromise_resolve(),e._finishPromise_resolve=void 0,e._finishPromise_reject=void 0)}function Ii(e,t){e._finishPromise_reject!==void 0&&(ao(e._finishPromise),e._finishPromise_reject(t),e._finishPromise_resolve=void 0,e._finishPromise_reject=void 0)}function Dh(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}Object.defineProperties(ri.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),Oe(ri.prototype.enqueue,"enqueue"),Oe(ri.prototype.error,"error"),Oe(ri.prototype.terminate,"terminate"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ri.prototype,Symbol.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});var _S=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Wa=function(){return Wa=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Wa.apply(this,arguments)},bS=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},wS=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function ES(){if(typeof wx>"u"||typeof Page>"u"||!wx.getSystemInfoSync||!wx.getStorageSync||!wx.setStorageSync||!wx.connectSocket||!wx.request)return!1;try{if(!wx.getSystemInfoSync()||wx.getSystemInfoSync().AppPlatform==="qq")return!1}catch{return!1}return!0}function SS(){return typeof App>"u"&&typeof getApp>"u"&&!wx.onAppHide&&!wx.offAppHide&&!wx.onAppShow&&!wx.offAppShow}var Lh="Error when aborting requestTask",IS=function(e){_S(t,e);function t(r){r===void 0&&(r={});var n=e.call(this)||this,o=r.timeout,i=r.timeoutMsg,a=r.restrictedMethods;return n._timeout=o||0,n._timeoutMsg=i||"请求超时",n._restrictedMethods=a||["get","post","upload","download"],n}return t.prototype.post=function(r){var n=this;return new Promise(function(o,i){var a=r.url,u=r.data,l=r.headers,s=wx.request({url:ua("https:",a),data:u,timeout:n._timeout,method:"POST",header:l,success:function(c){o(c)},fail:function(c){i(c)},complete:function(c){if(!(!c||!c.errMsg)&&!(!n._timeout||n._restrictedMethods.indexOf("post")===-1)){var f=c.errMsg;if(f==="request:fail timeout"){console.warn(n._timeoutMsg);try{s.abort()}catch{}}}}})})},t.prototype.upload=function(r){var n=this,o=this;return new Promise(function(i){return bS(n,void 0,void 0,function(){var a,u,l,s,c,f;return wS(this,function(d){return a=r.url,u=r.file,l=r.data,s=r.headers,c=r.onUploadProgress,f=wx.uploadFile({url:a,filePath:u,name:"file",formData:Wa({},l),header:s,timeout:this._timeout,success:function(v){var g={statusCode:v.statusCode,data:v.data||{}};v.statusCode===200&&l.success_action_status&&(g.statusCode=parseInt(l.success_action_status,10)),i(g)},fail:function(v){i(v)},complete:function(v){if(!(!v||!v.errMsg)&&!(!o._timeout||o._restrictedMethods.indexOf("upload")===-1)){var g=v.errMsg;if(g==="request:fail timeout"){console.warn(o._timeoutMsg);try{f.abort()}catch{}}}}}),c&&f.onProgressUpdate(function(v){c(v)}),[2]})})})},t.prototype.download=function(r){var n=this,o=this;return new Promise(function(i,a){var u=r.url,l=r.headers,s=wx.downloadFile({url:ua("https:",u),header:l,timeout:n._timeout,success:function(c){c.statusCode===200&&c.tempFilePath?i({statusCode:200,tempFilePath:c.tempFilePath}):i(c)},fail:function(c){a(c)},complete:function(c){if(!(!c||!c.errMsg)&&!(!o._timeout||o._restrictedMethods.indexOf("download")===-1)){var f=c.errMsg;if(f==="request:fail timeout"){console.warn(o._timeoutMsg);try{s.abort()}catch{}}}}})})},t.prototype.fetch=function(r){var n=r.url,o=r.body,i=r.enableAbort,a=r.headers,u=r.method,l=r.stream,s=l===void 0?!1:l,c=r.signal,f=r.timeout,d=this,v=f??this._timeout,g=null,b=new ut({start:function(y){g=y},cancel:function(){g=null}});return new Promise(function(y,w){s&&y({data:b});var E=wx.request({url:ua("https:",n),data:o,timeout:v,method:u.toUpperCase(),header:a,success:function(I){var R;(R=g)===null||R===void 0||R.close(),!s&&y(I)},fail:function(I){var R;if((R=g)===null||R===void 0||R.close(),w(I),s)throw I},complete:function(I){if(!(!I||!I.errMsg)&&!(!v||d._restrictedMethods.indexOf("post")===-1||!i)){var R=I.errMsg;if(R==="request:fail timeout"){console.warn(d._timeoutMsg);try{E.abort()}catch(L){console.warn(Lh,L)}}}},enableChunked:s});if(E.onChunkReceived(function(I){var R;(R=g)===null||R===void 0||R.enqueue(new Uint8Array(I.data))}),c){var A=function(){try{E.abort()}catch(I){console.warn(Lh,I)}};c.aborted?A():c.addEventListener("abort",function(){return A()})}})},t}(bf),OS={setItem:function(e,t){wx.setStorageSync(e,t)},getItem:function(e){return wx.getStorageSync(e)},removeItem:function(e){wx.removeStorageSync(e)},clear:function(){wx.clearStorageSync()}},TS=function(){function e(t,r){r===void 0&&(r={});var n=wx.connectSocket(Wa({url:t},r)),o={set onopen(i){n.onOpen(i)},set onmessage(i){n.onMessage(i)},set onclose(i){n.onClose(i)},set onerror(i){n.onError(i)},send:function(i){return n.send({data:i})},close:function(i,a){return n.close({code:i,reason:a})},get readyState(){return n.readyState},CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3};return o}return e}();function AS(){var e={root:{},reqClass:IS,wsClass:TS,localStorage:OS,primaryStorage:Da.local,getAppSign:function(){var t=wx.getAccountInfoSync();return SS()?t&&t.plugin?t.plugin.appId:"":t&&t.miniProgram?t.miniProgram.appId:""}};return e}var tn={genAdapter:AS,isMatch:ES,runtime:"wx_mp"},Ha=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},Ga=kt,Uh={};function RS(e,t){var r=t.name,n=t.namespace,o=t.entity,i=t.injectEvents,a=t.IIFE,u=a===void 0?!1:a;if(Uh[r]||n&&e[n])throw new Error(JSON.stringify({code:Ga.INVALID_OPERATION,msg:"Duplicate component ".concat(r)}));if(u){if(!o||typeof o!="function")throw new Error(JSON.stringify({code:Ga.INVALID_PARAMS,msg:"IIFE component's entity must be a function"}));o.call(e)}if(Uh[r]=t,n?e.prototype[n]=o:ky(e.prototype,o),i){var l=i.bus,s=i.events;if(!l||!s||s.length===0)return;var c=e.prototype.fire||function(){};e.prototype.events||(e.prototype.events={});var f=e.prototype.events||{};f[r]?e.prototype.events[r].events=Ha(Ha([],e.prototype.events[r].events,!0),s,!0):e.prototype.events[r]={bus:l,events:s},e.prototype.fire=function(d,v){c(d,v);for(var g=Object.keys(this.events),b=0,y=g;b<y.length;b++){var w=y[b],E=this.events[w],A=E.bus,I=E.events;if(I.includes(d)){A.fire(d,v);break}}}}}function ky(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:{var r=t;return new Date(r.getTime())}case Object:e===void 0&&(e={});break;case Array:e=[];break;default:return t}for(var n=Object.keys(t),o=0,i=n;o<i.length;o++){var a=i[o];Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=ky(e[a],t[a]))}return e}function CS(e,t){var r=t.entity,n=t.target;if(Object.prototype.hasOwnProperty.call(e,n))throw new Error(JSON.stringify({code:Ga.INVALID_OPERATION,msg:"target:".concat(n," is not exist")}));var o=e.prototype[n];if(typeof o!="function")throw new Error(JSON.stringify({code:Ga.INVALID_OPERATION,msg:"target:".concat(n," is not a function which is the only type supports hook")}));e.prototype[n]=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];return r.call.apply(r,Ha([this],i,!1)),o.call.apply(o,Ha([this],i,!1))}}var Zr={},Di=function(){return Di=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Di.apply(this,arguments)},xS="user_info",Fh=kE,Pl={},Nl={};function Mh(e){var t=e.env,r=e.platformInfo,n="".concat(xS,"_").concat(t),o={userInfoKey:n};Pl[t]=Pl[t]||new Fh(Di(Di({},e),{keys:o,platformInfo:r})),Nl[t]=Nl[t]||new Fh(Di(Di({},e),{keys:o,platformInfo:r,persistence:"local"}))}function PS(e){return Pl[e]}function qy(e){return Nl[e]}var Va=function(){return Va=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Va.apply(this,arguments)},NS=IE,$S=OE,Wy="",Hy="@cloudbase/js-sdk";function DS(e){Wy=e}function qf(){return Wy}function LS(e){Hy=e,NS(e)}function US(){return Hy}var FS="2020-01-10",Gy=[],MS=["env","endPointKey","region"],Bh="https:";function Vy(e){return Gy.find(function(t){return MS.filter(function(r){return e[r]!=null}).every(function(r){return t[r]===e[r]})})}function Ka(e){var t,r,n=Vy(e);n?(e.baseUrl!=null&&(n.baseUrl=e.baseUrl),e.protocol!=null&&(n.protocol=e.protocol)):Gy.push(Va(Va({},e),{protocol:(t=e.protocol)!==null&&t!==void 0?t:Bh})),e.endPointKey==="CLOUD_API"&&$S((r=e.protocol)!==null&&r!==void 0?r:Bh)}function Wf(e,t,r){return Vy({env:e,endPointKey:t,region:r})}function BS(e,t){Ka({endPointKey:"GATEWAY",env:e,baseUrl:"//".concat(e,".api.tcloudbasegateway.com/v1"),protocol:t})}function jS(e,t,r){var n=t?"//".concat(e,".").concat(t,".tcb-api.tencentcloudapi.com/web"):"//".concat(e,".ap-shanghai.tcb-api.tencentcloudapi.com/web");Ka({env:e,region:t,baseUrl:n,protocol:r,endPointKey:"CLOUD_API"})}function jh(e){var t=Wf(e,"CLOUD_API"),r=t.protocol,n=t.baseUrl,o="".concat(r).concat(n);return o.match(/(http(s)?:)?\/\/([^/?#]*)/)[0]}var kh;(function(e){e.NULL="NULL",e.ANONYMOUS="ANONYMOUS",e.WECHAT="WECHAT",e.WECHAT_PUBLIC="WECHAT-PUBLIC",e.WECHAT_OPEN="WECHAT-OPEN",e.CUSTOM="CUSTOM",e.EMAIL="EMAIL",e.USERNAME="USERNAME",e.PHONE="PHONE"})(kh||(kh={}));var Re=function(){return Re=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Re.apply(this,arguments)},Jr=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Yr=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},kS=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},qS=kt,WS=xE,HS=Lg,qh=Ug,GS=["auth.getJwt","auth.logout","auth.signInWithTicket","auth.signInAnonymously","auth.signIn","auth.fetchAccessTokenWithRefreshToken","auth.signUpWithEmailAndPassword","auth.activateEndUserMail","auth.sendPasswordResetEmail","auth.resetPasswordWithToken","auth.isUsernameRegistered"];function Pc(e,t,r){var n=e[t];e[t]=function(o){var i={},a={};r.forEach(function(l){var s=l.call(e,o),c=s.data,f=s.headers;Object.assign(i,c),Object.assign(a,f)});var u=o.data;return u&&function(){if(HS(u)){Object.keys(i).forEach(function(l){u.append(l,i[l])});return}o.data=Re(Re({},u),i)}(),o.headers=Re(Re({},o.headers||{}),a),n.call(e,o)}}function Nc(){var e=WS();return{data:{seqId:e},headers:{"X-SDK-Version":"@cloudbase/js-sdk/".concat(qf()),"x-seqid":e}}}var VS=function(){function e(t){var r=this;this.throwWhenRequestFail=!1,this.config=t;var n={timeout:this.config.timeout,timeoutMsg:"[@cloudbase/js-sdk] 请求在".concat(this.config.timeout/1e3,"s内未完成，已中断"),restrictedMethods:["post","put"]};this.reqClass=new Zr.adapter.reqClass(n),this.throwWhenRequestFail=t.throw||!1,this.localCache=qy(this.config.env),Pc(this.reqClass,"post",[Nc]),Pc(this.reqClass,"upload",[Nc]),Pc(this.reqClass,"download",[Nc]),Pu.on(Nu,function(o){var i;r.config.i18n=((i=o.data)===null||i===void 0?void 0:i.i18n)||r.config.i18n})}return e.prototype.getDefaultHeaders=function(){var t,r,n;return t={},t[(r=this.config.i18n)===null||r===void 0?void 0:r.LANG_HEADER_KEY]=(n=this.config.i18n)===null||n===void 0?void 0:n.lang,t},e.prototype.post=function(t){return Jr(this,void 0,void 0,function(){var r;return Yr(this,function(n){switch(n.label){case 0:return[4,this.reqClass.post(Re(Re({},t),{headers:Re(Re({},t.headers),this.getDefaultHeaders())}))];case 1:return r=n.sent(),[2,r]}})})},e.prototype.upload=function(t){return Jr(this,void 0,void 0,function(){var r;return Yr(this,function(n){switch(n.label){case 0:return[4,this.reqClass.upload(Re(Re({},t),{headers:Re(Re({},t.headers),this.getDefaultHeaders())}))];case 1:return r=n.sent(),[2,r]}})})},e.prototype.download=function(t){return Jr(this,void 0,void 0,function(){var r;return Yr(this,function(n){switch(n.label){case 0:return[4,this.reqClass.download(Re(Re({},t),{headers:Re(Re({},t.headers),this.getDefaultHeaders())}))];case 1:return r=n.sent(),[2,r]}})})},e.prototype.getBaseEndPoint=function(){return jh(this.config.env)},e.prototype.getOauthAccessTokenV2=function(t){return Jr(this,void 0,void 0,function(){var r,n;return Yr(this,function(o){switch(o.label){case 0:return[4,t.getAccessToken()];case 1:return r=o.sent(),[4,t.getCredentials()];case 2:return n=o.sent(),[2,{accessToken:r,accessTokenExpire:new Date(n.expires_at).getTime()}]}})})},e.prototype.request=function(t,r,n){var o,i;return Jr(this,void 0,void 0,function(){var a,u,l,s,c,f,d,v,g,b,y,w,E,A,I,R,L,F,U,N;return Yr(this,function(W){switch(W.label){case 0:if(a="x-tcb-trace_".concat(this.config.env),u="application/x-www-form-urlencoded",l=Re({action:t,dataVersion:FS,env:this.config.env},r),GS.indexOf(t)!==-1)return[3,2];if(s=this.config._fromApp,!s.oauthInstance)throw new Error("you can't request without auth");return c=s.oauthInstance,f=c.oauth2client,d=l,[4,this.getOauthAccessTokenV2(f)];case 1:d.access_token=W.sent().accessToken,W.label=2;case 2:return t==="storage.uploadFile"?(v=new FormData,Object.keys(v).forEach(function(j){Object.prototype.hasOwnProperty.call(v,j)&&v[j]!==void 0&&v.append(j,l[j])}),u="multipart/form-data"):(u="application/json;charset=UTF-8",v={},Object.keys(l).forEach(function(j){l[j]!==void 0&&(v[j]=l[j])})),g={headers:Re({"content-type":u},this.getDefaultHeaders())},n!=null&&n.onUploadProgress&&(g.onUploadProgress=n.onUploadProgress),this.config.region&&(g.headers["X-TCB-Region"]=this.config.region),b=this.localCache.getStore(a),b&&(g.headers["X-TCB-Trace"]=b),y=(n==null?void 0:n.parse)!==void 0?n.parse:r.parse,w=(n==null?void 0:n.inQuery)!==void 0?n.inQuery:r.inQuery,E=(n==null?void 0:n.search)!==void 0?n.search:r.search,A=Re(Re({},(n==null?void 0:n.defaultQuery)||{}),{env:this.config.env}),y&&(A.parse=!0),w&&(A=Re(Re({},w),A)),I=Wf(this.config.env,"CLOUD_API"),R=I.baseUrl,L=I.protocol,n.pathname?F=qh(L,"".concat((o=jh(this.config.env))===null||o===void 0?void 0:o.replace(/^https?:/,""),"/").concat(n.pathname),A):F=qh(L,R,A),E&&(F+=E),[4,this.post(Re({url:F,data:v},g))];case 3:if(U=W.sent(),N=(i=U.header)===null||i===void 0?void 0:i["x-tcb-trace"],N&&this.localCache.setStore(a,N),Number(U.status)!==200&&Number(U.statusCode)!==200||!U.data)throw new Error("network request error");return[2,U]}})})},e.prototype.fetch=function(t){var r,n,o,i,a,u,l,s;return Jr(this,void 0,void 0,function(){var c,f,d,v,g,b,y,w,E=this;return Yr(this,function(A){switch(A.label){case 0:c=t.token,f=t.headers,d=f===void 0?{}:f,v=kS(t,["token","headers"]),g=function(){return Jr(E,void 0,void 0,function(){var I,R,L;return Yr(this,function(F){switch(F.label){case 0:if(c!=null)return[2,c];if(I=this.config._fromApp,!I.oauthInstance)throw new Error("you can't request without auth");return R=I.oauthInstance,L=R.oauth2client,[4,this.getOauthAccessTokenV2(L)];case 1:return[2,F.sent().accessToken]}})})},b=function(){return Jr(E,void 0,void 0,function(){var I,R,L,F,U;return Yr(this,function(N){switch(N.label){case 0:return R=(I=this.reqClass).fetch,F={},U={"X-SDK-Version":"@cloudbase/js-sdk/".concat(qf())},L="Bearer ".concat,[4,g()];case 1:return[2,R.apply(I,[Re.apply(void 0,[(F.headers=Re.apply(void 0,[Re.apply(void 0,[(U.Authorization=L.apply("Bearer ",[N.sent()]),U),this.getDefaultHeaders()]),d]),F),v])])]}})})},A.label=1;case 1:return A.trys.push([1,3,,6]),[4,b()];case 2:return y=A.sent(),[2,y];case 3:if(w=A.sent(),(w==null?void 0:w.code)!=="ACCESS_TOKEN_EXPIRED")return[3,5];if(typeof((i=(o=(n=(r=this.config)===null||r===void 0?void 0:r._fromApp)===null||n===void 0?void 0:n.oauthInstance)===null||o===void 0?void 0:o.authApi)===null||i===void 0?void 0:i.refreshTokenForce)!="function")throw w;return[4,(s=(l=(u=(a=this.config)===null||a===void 0?void 0:a._fromApp)===null||u===void 0?void 0:u.oauthInstance)===null||l===void 0?void 0:l.authApi)===null||s===void 0?void 0:s.refreshTokenForce()];case 4:return A.sent(),[2,b()];case 5:throw w;case 6:return[2]}})})},e.prototype.send=function(t,r,n){return r===void 0&&(r={}),n===void 0&&(n={}),Jr(this,void 0,void 0,function(){var o;return Yr(this,function(i){switch(i.label){case 0:return[4,this.request(t,r,Re(Re({},n),{onUploadProgress:r.onUploadProgress}))];case 1:if(o=i.sent(),o.data.code&&this.throwWhenRequestFail)throw new Error(JSON.stringify({code:qS.OPERATION_FAIL,msg:"[".concat(o.data.code,"] ").concat(o.data.message)}));return[2,o.data]}})})},e}(),Ky={};function KS(e){Ky[e.env]=new VS(Re(Re({},e),{throw:!0}))}function zS(e){return Ky[e]}var $c,za;(function(e){e.ZH="zh-CN",e.EN="en-US"})(za||(za={}));var JS="Accept-Language",YS=($c={},$c[za.EN]={"请检查调用方式，或前往云开发 AI+ 首页查看文档":"Please check the calling method or visit the AI+ homepage to view the documentation","AI+ 请求出错，错误码":"AI+ request error, error code",错误信息:"error message",未实现:"not implemented","小程序不支持 wasm 加载":"wasm loading is not supported in mini programs","小程序不支持动态 js 加载":"dynamic js loading is not supported in mini programs",请求超时:"request timeout","缺少 privatelink sdk 地址":"missing privatelink sdk address"},$c),Wh=function(e,t){var r;return((r=YS[t])===null||r===void 0?void 0:r[e])||e},QS=function(e){return"lang_".concat(e.clientId||e.env)},XS=function(e,t){var r,n,o=QS(t),i=(e.adapter||{}).localStorage,a=t.lang||((r=i==null?void 0:i.getItem)===null||r===void 0?void 0:r.call(i,o))||za.ZH;return(n=i==null?void 0:i.setItem)===null||n===void 0||n.call(i,o,a),new Proxy({t:function(u){return Wh(u,a)},LANG_HEADER_KEY:JS,lang:a},{get:function(u,l){var s;return l==="lang"&&((s=i==null?void 0:i.getItem)===null||s===void 0?void 0:s.call(i,o))||u[l]},set:function(u,l,s){var c;return l==="lang"&&s!==u[l]&&(u[l]=s,u.t=function(f){return Wh(f,s)},(c=i==null?void 0:i.setItem)===null||c===void 0||c.call(i,o,s),Pu.fire(Nu,{i18n:u})),u[l]=s,!0}})},be=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Hf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ZS(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}),r}var Se={},At={};Object.defineProperty(At,"__esModule",{value:!0});At.COMMUNITY_SITE_URL=At.IS_DEBUG_MODE=At.getProtocol=At.setProtocol=At.getSdkName=At.setSdkName=void 0;var zy="@cloudbase/js-sdk";function eI(e){zy=e}At.setSdkName=eI;function tI(){return zy}At.getSdkName=tI;var Jy="https:";function rI(e){Jy=e}At.setProtocol=rI;function nI(){return Jy}At.getProtocol=nI;At.IS_DEBUG_MODE=!1;At.COMMUNITY_SITE_URL="https://support.qq.com/products/148793";var Mu={};Object.defineProperty(Mu,"__esModule",{value:!0});Mu.ERRORS=void 0;Mu.ERRORS={INVALID_PARAMS:"INVALID_PARAMS",INVALID_SYNTAX:"INVALID_SYNTAX",INVALID_OPERATION:"INVALID_OPERATION",OPERATION_FAIL:"OPERATION_FAIL",NETWORK_ERROR:"NETWORK_ERROR",UNKOWN_ERROR:"UNKOWN_ERROR"};(function(e){var t=be&&be.__createBinding||(Object.create?function(n,o,i,a){a===void 0&&(a=i);var u=Object.getOwnPropertyDescriptor(o,i);(!u||("get"in u?!o.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return o[i]}}),Object.defineProperty(n,a,u)}:function(n,o,i,a){a===void 0&&(a=i),n[a]=o[i]}),r=be&&be.__exportStar||function(n,o){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(o,i)&&t(o,n,i)};Object.defineProperty(e,"__esModule",{value:!0}),e.OATUH_LOGINTYPE=void 0,r(At,e),r(Mu,e),e.OATUH_LOGINTYPE="constants"})(Se);var bs=function(){return bs=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},bs.apply(this,arguments)},Yy=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Qy=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function iI(e,t){var r,n,o;return Yy(this,void 0,void 0,function(){var i,a,u,l,s,c,f,d,v,g,b,y,w,E,A,I;return Qy(this,function(R){switch(R.label){case 0:if(i=e||{},a=i.name,u=i.body,l=i.path,s=l===void 0?"":l,c=i.method,f=c===void 0?"POST":c,d=i.headers,v=d===void 0?{}:d,g=i.token,!a)throw new Error(JSON.stringify({code:Se.ERRORS.INVALID_PARAMS,msg:"[apis] invalid api name"}));return b=this.getEndPointWithKey("GATEWAY"),y=b.BASE_URL,w=b.PROTOCOL,E="".concat(w).concat(y,"/apis/").concat(a),A=s.startsWith("/")?s:"/".concat(s),[4,this.request.fetch(bs({url:"".concat(E).concat(A),method:f||"POST",headers:bs({"Content-Type":"application/json; charset=utf-8"},v),body:u,token:((r=g==null?void 0:g.trim)===null||r===void 0?void 0:r.call(g))||((o=(n=v.Authorization)===null||n===void 0?void 0:n.replace)===null||o===void 0?void 0:o.call(n,/^Bearer /,""))||""},t))];case 1:return I=R.sent(),[4,I.data];case 2:return[2,R.sent()]}})})}var oI=["GET","POST","PUT","DELETE","HEAD","OPTIONS","PATCH","REQUEST"];function sI(e){var t=this;return new Proxy({},{get:function(r,n){if(typeof n!="string")throw new Error("[apis] method must be string");var o=n.toLocaleUpperCase();if(!oI.includes(o))throw new Error("[apis] invalid method: ".concat(n));return function(i,a){return Yy(t,void 0,void 0,function(){return Qy(this,function(u){switch(u.label){case 0:return[4,iI.call(this,bs({name:e,method:(o==="REQUEST"?i.method:o)||"POST"},i),a)];case 1:return[2,u.sent()]}})})}}})}function aI(){var e=this;return new Proxy({},{get:function(t,r){if(typeof r=="string")return sI.call(e,r)}})}var Zo=function(){return Zo=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Zo.apply(this,arguments)},Hh=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(a=e[u])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},Oi=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},uI=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},cI=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},lI=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},fI=FE,dI=ME,zs=kt,Gh=xu,Vh=Gi,Kh=$u,hI={timeout:15e3,persistence:"local"},zh=1e3*60*10,Jh=100,Yh={},pI=function(){function e(t){this.cloudbaseConfig=t||this.cloudbaseConfig,this.authInstance=null,this.oauthInstance=null,this.version=qf()}return Object.defineProperty(e.prototype,"config",{get:function(){return this.cloudbaseConfig},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"platform",{get:function(){return Zr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cache",{get:function(){return PS(this.cloudbaseConfig.env)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localCache",{get:function(){return qy(this.cloudbaseConfig.env)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"request",{get:function(){return zS(this.cloudbaseConfig.env)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apis",{get:function(){return aI.call(this)},enumerable:!1,configurable:!0}),e.prototype.init=function(t){var r;if(!t.env)throw new Error(JSON.stringify({code:zs.INVALID_PARAMS,msg:"env must not be specified"}));Zr.adapter||this.useDefaultAdapter();var n={timeout:t.timeout||5e3,timeoutMsg:"[".concat(US(),"][REQUEST TIMEOUT] request had been abort since didn't finished within").concat(t.timeout/1e3,"s")};this.requestClient=new Zr.adapter.reqClass(n),this.cloudbaseConfig=Zo(Zo(Zo({},hI),t),{i18n:XS(Zr,t)}),delete this.cloudbaseConfig.lang,this.cloudbaseConfig.timeout=this.formatTimeout(this.cloudbaseConfig.timeout);var o=this.cloudbaseConfig,i=o.env,a=o.persistence,u=o.debug,l=o.timeout,s=o.oauthClient,c=o.i18n;Mh({env:i,persistence:a,debug:u,platformInfo:this.platform}),jS(i,t.region||""),BS(i);var f=new e(this.cloudbaseConfig);return KS({env:i,region:t.region||"",timeout:l,oauthClient:s,_fromApp:f,i18n:c}),f.requestClient=this.requestClient,(r=this===null||this===void 0?void 0:this.fire)===null||r===void 0||r.call(this,"cloudbase_init",f),f},e.prototype.updateConfig=function(t){var r=t.persistence,n=t.debug;this.cloudbaseConfig.persistence=r,this.cloudbaseConfig.debug=n,Mh({env:this.cloudbaseConfig.env,persistence:r,debug:n,platformInfo:this.platform})},e.prototype.updateLang=function(t){var r;!t||t===((r=this.cloudbaseConfig.i18n)===null||r===void 0?void 0:r.lang)||(this.cloudbaseConfig.i18n.lang=t)},e.prototype.registerExtension=function(t){Yh[t.name]=t},e.prototype.invokeExtension=function(t,r){return uI(this,void 0,void 0,function(){var n;return cI(this,function(o){switch(o.label){case 0:if(n=Yh[t],!n)throw new Error(JSON.stringify({code:zs.INVALID_PARAMS,msg:"extension:".concat(t," must be registered before invoke")}));return[4,n.invoke(r,this)];case 1:return[2,o.sent()]}})})},e.prototype.useAdapters=function(t,r){var n=fI(t,r)||{},o=n.adapter,i=n.runtime;o&&(Zr.adapter=o),i&&(Zr.runtime=i)},e.prototype.registerHook=function(t){CS(e,t)},e.prototype.registerComponent=function(t){RS(e,t)},e.prototype.registerVersion=function(t){DS(t),this.version=t},e.prototype.registerSdkName=function(t){LS(t)},e.prototype.registerEndPoint=function(t,r){Ka({baseUrl:t,protocol:r,env:this.config.env,endPointKey:"CLOUD_API"})},e.prototype.registerEndPointWithKey=function(t){Ka({env:this.config.env,endPointKey:t.key,baseUrl:t.url,protocol:t.protocol})},e.prototype.getEndPointWithKey=function(t){var r=Wf(this.config.env,t);return{BASE_URL:r.baseUrl,PROTOCOL:r.protocol}},e.prototype.parseCaptcha=function(t){var r={},n=t.match(/^(data:.*?)(\?[^#\s]*)?$/);if(n){t=n[1];var o=n[2];o&&(r=$E(o))}var i=r.token,a=lI(r,["token"]);return/^data:/.test(t)&&!i?{error:"invalid_argument",error_description:"invalid captcha data: ".concat(t)}:i?{state:a.state,token:i,captchaData:t}:{error:"unimplemented",error_description:"need to impl captcha data"}},e.prototype.useDefaultAdapter=function(){var t=dI(),r=t.adapter,n=t.runtime;Zr.adapter=r,Zr.runtime=n},e.prototype.formatTimeout=function(t){switch(!0){case t>zh:return Vh(zs.INVALID_PARAMS,"timeout is greater than maximum value[10min]"),zh;case t<Jh:return Vh(zs.INVALID_PARAMS,"timeout is less than maximum value[100ms]"),Jh;default:return t}},Hh([Kh({mode:"sync",title:"Cloudbase 初始化失败",messages:["请确认以下各项：","  1 - 调用 cloudbase.init() 的语法或参数是否正确","  2 - 如果是非浏览器环境，是否配置了安全应用来源（https://docs.cloudbase.net/api-reference/webv3/adapter#%E7%AC%AC-2-%E6%AD%A5%E9%85%8D%E7%BD%AE%E5%AE%89%E5%85%A8%E5%BA%94%E7%94%A8%E6%9D%A5%E6%BA%90）","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Gh)]}),Oi("design:type",Function),Oi("design:paramtypes",[Object]),Oi("design:returntype",e)],e.prototype,"init",null),Hh([Kh({title:"调用扩展能力失败",messages:["请确认以下各项：","  1 - 调用 invokeExtension() 的语法或参数是否正确","  2 - 被调用的扩展能力是否已经安装并通过 registerExtension() 注册","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Gh)]}),Oi("design:type",Function),Oi("design:paramtypes",[String,Object]),Oi("design:returntype",Promise)],e.prototype,"invokeExtension",null),e}(),Kt=new pI;Kt.useAdapters(tn);const Bu="/auth";var ye;(function(e){e.AUTH_SIGN_UP_URL="/v1/signup",e.AUTH_TOKEN_URL="/v1/token",e.AUTH_REVOKE_URL="/v1/revoke",e.WEDA_USER_URL="/v1/plugin/weda/userinfo",e.AUTH_RESET_PASSWORD="/v1/reset",e.AUTH_GET_DEVICE_CODE="/v1/device/code",e.CHECK_USERNAME="/v1/checkUsername",e.CHECK_IF_USER_EXIST="/v1/checkIfUserExist",e.GET_PROVIDER_TYPE="/v1/mgr/provider/providerSubType",e.AUTH_SIGN_IN_URL="/v1/signin",e.AUTH_SIGN_IN_ANONYMOUSLY_URL="/v1/signin/anonymously",e.AUTH_SIGN_IN_WITH_PROVIDER_URL="/v1/signin/with/provider",e.AUTH_SIGN_IN_WITH_WECHAT_URL="/v1/signin/wechat/noauth",e.AUTH_SIGN_IN_CUSTOM="/v1/signin/custom",e.PROVIDER_TOKEN_URL="/v1/provider/token",e.PROVIDER_URI_URL="/v1/provider/uri",e.USER_ME_URL="/v1/user/me",e.AUTH_SIGNOUT_URL="/v1/user/signout",e.USER_QUERY_URL="/v1/user/query",e.USER_PRIFILE_URL="/v1/user/profile",e.USER_BASIC_EDIT_URL="/v1/user/basic/edit",e.USER_TRANS_BY_PROVIDER_URL="/v1/user/trans/by/provider",e.PROVIDER_LIST="/v1/user/provider",e.PROVIDER_BIND_URL="/v1/user/provider/bind",e.PROVIDER_UNBIND_URL="/v1/user/provider",e.CHECK_PWD_URL="/v1/user/sudo",e.SUDO_URL="/v1/user/sudo",e.BIND_CONTACT_URL="/v1/user/contact",e.AUTH_SET_PASSWORD="/v1/user/password",e.AUTHORIZE_DEVICE_URL="/v1/user/device/authorize",e.AUTHORIZE_URL="/v1/user/authorize",e.AUTHORIZE_INFO_URL="/v1/user/authorize/info",e.AUTHORIZED_DEVICES_DELETE_URL="/v1/user/authorized/devices/",e.AUTH_REVOKE_ALL_URL="/v1/user/revoke/all",e.GET_USER_BEHAVIOR_LOG="/v1/user/security/history",e.VERIFICATION_URL="/v1/verification",e.VERIFY_URL="/v1/verification/verify",e.CAPTCHA_DATA_URL="/v1/captcha/data",e.VERIFY_CAPTCHA_DATA_URL="/v1/captcha/data/verify",e.GET_CAPTCHA_URL="/v1/captcha/init",e.GET_MINIPROGRAM_QRCODE="/v1/qrcode/generate",e.GET_MINIPROGRAM_QRCODE_STATUS="/v1/qrcode/get/status"})(ye||(ye={}));var Ji;(function(e){e.AUTH_SIGN_IN_URL="/v2/signin/username",e.AUTH_TOKEN_URL="/v2/token",e.USER_ME_URL="/v2/user/me",e.VERIFY_URL="/v2/signin/verificationcode",e.AUTH_SIGN_IN_WITH_PROVIDER_URL="/v2/signin/with/provider",e.AUTH_PUBLIC_KEY="/v2/signin/publichkey",e.AUTH_RESET_PASSWORD="/v2/signin/password/update"})(Ji||(Ji={}));var Qh;(function(e){e.REGISTER="REGISTER",e.SIGN_IN="SIGN_IN",e.PASSWORD_RESET="PASSWORD_RESET",e.EMAIL_ADDRESS_CHANGE="EMAIL_ADDRESS_CHANGE",e.PHONE_NUMBER_CHANGE="PHONE_NUMBER_CHANGE"})(Qh||(Qh={}));var It;(function(e){e.UNREACHABLE="unreachable",e.LOCAL="local",e.CANCELLED="cancelled",e.UNKNOWN="unknown",e.UNAUTHENTICATED="unauthenticated",e.RESOURCE_EXHAUSTED="resource_exhausted",e.FAILED_PRECONDITION="failed_precondition",e.INVALID_ARGUMENT="invalid_argument",e.DEADLINE_EXCEEDED="deadline_exceeded",e.NOT_FOUND="not_found",e.ALREADY_EXISTS="already_exists",e.PERMISSION_DENIED="permission_denied",e.ABORTED="aborted",e.OUT_OF_RANGE="out_of_range",e.UNIMPLEMENTED="unimplemented",e.INTERNAL="internal",e.UNAVAILABLE="unavailable",e.DATA_LOSS="data_loss",e.INVALID_PASSWORD="invalid_password",e.PASSWORD_NOT_SET="password_not_set",e.INVALID_STATUS="invalid_status",e.USER_PENDING="user_pending",e.USER_BLOCKED="user_blocked",e.INVALID_VERIFICATION_CODE="invalid_verification_code",e.TWO_FACTOR_REQUIRED="two_factor_required",e.INVALID_TWO_FACTOR="invalid_two_factor",e.INVALID_TWO_FACTOR_RECOVERY="invalid_two_factor_recovery",e.UNDER_REVIEW="under_review",e.INVALID_REQUEST="invalid_request",e.UNAUTHORIZED_CLIENT="unauthorized_client",e.ACCESS_DENIED="access_denied",e.UNSUPPORTED_RESPONSE_TYPE="unsupported_response_type",e.INVALID_SCOPE="invalid_scope",e.INVALID_GRANT="invalid_grant",e.SERVER_ERROR="server_error",e.TEMPORARILY_UNAVAILABLE="temporarily_unavailable",e.INTERACTION_REQUIRED="interaction_required",e.LOGIN_REQUIRED="login_required",e.ACCOUNT_SELECTION_REQUIRED="account_selection_required",e.CONSENT_REQUIRED="consent_required",e.INVALID_REQUEST_URI="invalid_request_uri",e.INVALID_REQUEST_OBJECT="invalid_request_object",e.REQUEST_NOT_SUPPORTED="request_not_supported",e.REQUEST_URI_NOT_SUPPORTED="request_uri_not_supported",e.REGISTRATION_NOT_SUPPORTED="registration_not_supported",e.CAPTCHA_REQUIRED="captcha_required",e.CAPTCHA_INVALID="captcha_invalid"})(It||(It={}));var Xh;(function(e){e.CLIENT_ID="client_id",e.CLIENT_SECRET="client_secret",e.RESPONSE_TYPE="response_type",e.SCOPE="scope",e.STATE="state",e.REDIRECT_URI="redirect_uri",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ERROR_URI="error_uri",e.GRANT_TYPE="grant_type",e.CODE="code",e.ACCESS_TOKEN="access_token",e.TOKEN_TYPE="token_type",e.EXPIRES_IN="expires_in",e.USERNAME="username",e.PASSWORD="password",e.REFRESH_TOKEN="refresh_token"})(Xh||(Xh={}));function Xy(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}const $l=e=>{const t=n=>{for(const o in e)e.hasOwnProperty(o)&&(n[o]=$l(e[o]));return n},r=e==null?"NullOrUndefined":Object.prototype.toString.call(e).slice(8,-1);if(["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"].includes(r))return e.slice();switch(r){case"Object":return t(Object.create(Object.getPrototypeOf(e)));case"Array":return t([]);case"Date":return new Date(e.valueOf());case"RegExp":return new RegExp(e.source,(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.sticky?"y":"")+(e.unicode?"u":""));default:return e}},Zh=e=>{const t=/^(?:http(s)?:\/\/[^\/]+)?(\/[^\?#]*)/,r=e.match(t);return r&&r[2]||""};let Io=new Map;class Zy{constructor(t){this.clientId=(t==null?void 0:t.clientId)||"",Io=Io||new Map}async run(t,r){t=`${this.clientId}_${t}`;let n=Io.get(t);return n||(n=new Promise((o,i)=>{(async()=>{try{await this.runIdlePromise();const a=r();o(await a)}catch(a){i(a)}finally{Io.delete(t)}})()}),Io.set(t,n)),n}runIdlePromise(){return Promise.resolve()}}const Js="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function vI(e){e=String(e);let t,r,n,o,i="",a=0;const u=e.length%3;for(;a<e.length;){if((r=e.charCodeAt(a++))>255||(n=e.charCodeAt(a++))>255||(o=e.charCodeAt(a++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");t=r<<16|n<<8|o,i+=Js.charAt(t>>18&63)+Js.charAt(t>>12&63)+Js.charAt(t>>6&63)+Js.charAt(t&63)}return u?i.slice(0,u-3)+"===".substring(u):i}function mI(){if(typeof wx>"u"||typeof Page>"u"||!wx.getSystemInfoSync||!wx.getStorageSync||!wx.setStorageSync||!wx.connectSocket||!wx.request)return!1;try{if(!wx.getSystemInfoSync()||wx.getSystemInfoSync().AppPlatform==="qq")return!1}catch{return!1}return!0}const ep="x-request-id",tp="x-device-id",rp="device_id",gI=async function(e,t){let r=null,n=null;try{const o=Object.assign({},t);o.method||(o.method="GET"),o.body&&typeof o.body!="string"&&(o.body=JSON.stringify(o.body));const a=await(await fetch(e,o)).json();a!=null&&a.error?(n=a,n.error_uri=new URL(e).pathname):r=a}catch(o){n={error:It.UNREACHABLE,error_description:o.message,error_uri:new URL(e).pathname}}if(n)throw n;return r};function yI(){return Xy()}class _I{constructor(t){this._env=(t==null?void 0:t.env)||""}async getItem(t){return window.localStorage.getItem(`${t}${this._env}`)}async removeItem(t){window.localStorage.removeItem(`${t}${this._env}`)}async setItem(t,r){window.localStorage.setItem(`${t}${this._env}`,r)}getItemSync(t){return window.localStorage.getItem(`${t}${this._env}`)}removeItemSync(t){window.localStorage.removeItem(`${t}${this._env}`)}setItemSync(t,r){window.localStorage.setItem(`${t}${this._env}`,r)}}const Gf=new _I;function e0(e){let t=!0;return e!=null&&e.expires_at&&(e!=null&&e.access_token)&&(t=e.expires_at<new Date),t}class bI{constructor(t){this.credentials=null,this.singlePromise=null,this.tokenSectionName=t.tokenSectionName,this.storage=t.storage,this.clientId=t.clientId,this.singlePromise=new Zy({clientId:this.clientId}),this.credentials=t.credentials||null,this.credentials&&this.setCredentials(this.credentials)}getStorageCredentialsSync(){let t=null;const r=this.storage.getItemSync(this.tokenSectionName);if(r!=null)try{t=JSON.parse(r),t!=null&&t.expires_at&&(t.expires_at=new Date(t.expires_at))}catch{this.storage.removeItem(this.tokenSectionName),t=null}return t}async setCredentials(t){if(t!=null&&t.expires_in){if(t!=null&&t.expires_at||(t.expires_at=new Date(Date.now()+(t.expires_in-30)*1e3)),this.storage){const r=JSON.stringify(t);await this.storage.setItem(this.tokenSectionName,r)}this.credentials=t}else this.storage&&await this.storage.removeItem(this.tokenSectionName),this.credentials=null}async getCredentials(){return this.singlePromise.run("getCredentials",async()=>(e0(this.credentials)&&(this.credentials=await this.getStorageCredentials()),this.credentials))}async getStorageCredentials(){return this.singlePromise.run("_getStorageCredentials",async()=>{let t=null;const r=await this.storage.getItem(this.tokenSectionName);if(r!=null)try{t=JSON.parse(r),t!=null&&t.expires_at&&(t.expires_at=new Date(t.expires_at))}catch{await this.storage.removeItem(this.tokenSectionName),t=null}return t})}}class gr{constructor(t){this.singlePromise=null,t.clientSecret||(t.clientSecret=""),!t.clientId&&t.env&&(t.clientId=t.env),this.apiOrigin=t.apiOrigin,this.apiPath=t.apiPath||Bu,this.clientId=t.clientId,this.i18n=t.i18n,this.publishable_key=t.publishable_key,this.singlePromise=new Zy({clientId:this.clientId}),this.retry=this.formatRetry(t.retry,gr.defaultRetry),t.baseRequest?this.baseRequest=t.baseRequest:this.baseRequest=gI,this.tokenInURL=t.tokenInURL,this.headers=t.headers,this.storage=t.storage||Gf,this.localCredentials=new bI({tokenSectionName:`credentials_${t.clientId}`,storage:this.storage,clientId:t.clientId,credentials:this.publishable_key?{access_token:this.publishable_key,token_type:"Bearer",scope:"publishable_key",expires_at:new Date(+new Date+ +new Date),expires_in:+new Date+ +new Date}:null}),this.clientSecret=t.clientSecret,t.clientId&&(this.basicAuth=`Basic ${vI(`${t.clientId}:${this.clientSecret}`)}`),this.wxCloud=t.wxCloud;try{mI()&&this.wxCloud===void 0&&t.env&&(wx.cloud.init({env:t.env}),this.wxCloud=wx.cloud)}catch{}this.refreshTokenFunc=t.refreshTokenFunc||this.defaultRefreshTokenFunc,this.anonymousSignInFunc=t.anonymousSignInFunc,this.onCredentialsError=t.onCredentialsError,Pu.on(Nu,r=>{var n;this.i18n=((n=r.data)==null?void 0:n.i18n)||this.i18n})}setCredentials(t){return this.localCredentials.setCredentials(t)}async getAccessToken(){const t=await this.getCredentials();if(t!=null&&t.access_token)return Promise.resolve(t.access_token);const r={error:It.UNAUTHENTICATED};return Promise.reject(r)}async request(t,r){var a,u;r||(r={});const n=this.formatRetry(r.retry,this.retry);if(r.headers={...r.headers,[(a=this.i18n)==null?void 0:a.LANG_HEADER_KEY]:(u=this.i18n)==null?void 0:u.lang},this.headers&&(r.headers={...this.headers,...r.headers}),r.headers[ep]||(r.headers[ep]=yI()),!r.headers[tp]){const l=await this.getDeviceId();r.headers[tp]=l}if(r!=null&&r.withBasicAuth&&this.basicAuth&&(r.headers.Authorization=this.basicAuth),r!=null&&r.withCredentials){const l=await this.getCredentials();l&&(this.tokenInURL?(t.indexOf("?")<0&&(t+="?"),t+=`access_token=${l.access_token}`):r.headers.Authorization=`${l.token_type} ${l.access_token}`)}else this.clientId&&t.indexOf("client_id")<0&&(t+=t.indexOf("?")<0?"?":"&",t+=`client_id=${this.clientId}`);t.startsWith("/")&&(t=`${this.apiOrigin}${this.apiPath}${t}`);let o=null;const i=n+1;for(let l=0;l<i;l++){try{r.useWxCloud?o=await this.wxCloudCallFunction(t,r):o=await this.baseRequest(t,r);break}catch(s){if(r.withCredentials&&s&&s.error===It.UNAUTHENTICATED)return await this.setCredentials(null),Promise.reject(s);if(l===n||!s||s.error!=="unreachable")return Promise.reject(s)}await this.sleep(gr.retryInterval)}return o}async wxCloudCallFunction(t,r){var i;let n=null,o=null;try{let a="";try{a=await wx.getRendererUserAgent()}catch{}const{result:u}=await this.wxCloud.callFunction({name:"httpOverCallFunction",data:{url:t,method:r.method,headers:{origin:"https://servicewechat.com","User-Agent":a,...r.headers},body:r.body}});(i=u==null?void 0:u.body)!=null&&i.error_code?(o=u==null?void 0:u.body,o.error_uri=Zh(t)):n=u==null?void 0:u.body}catch(a){o={error:It.UNREACHABLE,error_description:a.message,error_uri:Zh(t)}}if(o)throw o;return n}async getCredentials(){var r,n,o;let t=await this.localCredentials.getCredentials();if(!t){const i="credentials not found";return(r=this.onCredentialsError)==null||r.call(this,{msg:i}),this.unAuthenticatedError(i)}if(e0(t))if(t.refresh_token)try{t=await this.refreshToken(t)}catch(i){if(t.scope==="anonymous")t=await this.anonymousLogin(t);else return(n=this.onCredentialsError)==null||n.call(this,{msg:i.error_description}),Promise.reject(i)}else if(t.scope==="anonymous")t=await this.anonymousLogin(t);else{const i="no refresh token found in credentials";return(o=this.onCredentialsError)==null||o.call(this,{msg:i}),this.unAuthenticatedError(i)}return t}getCredentialsSync(){return this.localCredentials.getStorageCredentialsSync()}getCredentialsAsync(){return this.getCredentials()}async getScope(){var r;const t=await this.localCredentials.getCredentials();if(!t){const n="credentials not found";return(r=this.onCredentialsError)==null||r.call(this,{msg:n}),this.unAuthenticatedError(n)}return t.scope}async getGroups(){var r;const t=await this.localCredentials.getCredentials();if(!t){const n="credentials not found";return(r=this.onCredentialsError)==null||r.call(this,{msg:n}),this.unAuthenticatedError(n)}return t.groups}async refreshToken(t){return this.singlePromise.run("_refreshToken",async()=>{var r,n,o;if(!t||!t.refresh_token){const i="no refresh token found in credentials";return(r=this.onCredentialsError)==null||r.call(this,{msg:i}),this.unAuthenticatedError(i)}try{const i=await this.refreshTokenFunc(t.refresh_token,t);return await this.localCredentials.setCredentials(i),i}catch(i){if(i.error===It.INVALID_GRANT){await this.localCredentials.setCredentials(null);const a=i.error_description;return(n=this.onCredentialsError)==null||n.call(this,{msg:a}),this.unAuthenticatedError(a)}return(o=this.onCredentialsError)==null||o.call(this,{msg:i.error_description}),Promise.reject(i)}})}async anonymousLogin(t){return this.singlePromise.run("_anonymousLogin",async()=>(this.anonymousSignInFunc?t=await this.anonymousSignInFunc(t)||await this.localCredentials.getCredentials():t=await this.anonymousSignIn(t),t))}checkRetry(t){let r=null;if((typeof t!="number"||t<gr.minRetry||t>gr.maxRetry)&&(r={error:It.UNREACHABLE,error_description:"wrong options param: retry"}),r)throw r;return t}formatRetry(t,r){return typeof t>"u"?r:this.checkRetry(t)}async sleep(t){return new Promise(r=>{setTimeout(()=>{r()},t)})}async anonymousSignIn(t){return this.singlePromise.run("_anonymous",async()=>{if(!t||t.scope!=="anonymous")return this.unAuthenticatedError("no anonymous in credentials");try{const r=await this.request(ye.AUTH_SIGN_IN_ANONYMOUSLY_URL,{method:"POST",withBasicAuth:!0,body:{}});return await this.localCredentials.setCredentials(r),r}catch(r){return r.error===It.INVALID_GRANT?(await this.localCredentials.setCredentials(null),this.unAuthenticatedError(r.error_description)):Promise.reject(r)}})}async defaultRefreshTokenFunc(t,r){var i;if(t===void 0||t===""){const a="refresh token not found";return(i=this.onCredentialsError)==null||i.call(this,{msg:a}),this.unAuthenticatedError(a)}let n=ye.AUTH_TOKEN_URL;return(r==null?void 0:r.version)==="v2"&&(n=Ji.AUTH_TOKEN_URL),{...await this.request(n,{method:"POST",body:{client_id:this.clientId,client_secret:this.clientSecret,grant_type:"refresh_token",refresh_token:t}}),version:(r==null?void 0:r.version)||"v1"}}async getDeviceId(){if(this.deviceID)return this.deviceID;let t=await this.storage.getItem(rp);return typeof t=="string"&&t.length>=16&&t.length<=48||(t=Xy(),await this.storage.setItem(rp,t)),this.deviceID=t,t}unAuthenticatedError(t){const r={error:It.UNAUTHENTICATED,error_description:t};return Promise.reject(r)}}gr.defaultRetry=2;gr.minRetry=0;gr.maxRetry=5;gr.retryInterval=1e3;function t0(){if(typeof globalThis>"u")return!1;const{wx:e}=globalThis;if(typeof e>"u"||globalThis.Page===void 0||!e.getSystemInfoSync||!e.getStorageSync||!e.setStorageSync||!e.connectSocket||!e.request)return!1;try{if(!e.getSystemInfoSync()||e.getSystemInfoSync().AppPlatform==="qq")return!1}catch{return!1}return!0}let ws=!1;function np(){ws=ws||typeof window!==void 0&&window.__wxjs_environment==="miniprogram"}try{t0()||(ws=ws||!!navigator.userAgent.match(/miniprogram/i)||window.__wxjs_environment==="miniprogram",window&&window.WeixinJSBridge&&window.WeixinJSBridge.invoke?np():typeof document<"u"&&document.addEventListener("WeixinJSBridgeReady",np,!1))}catch{}function ip(){return ws}class Wo{constructor(t){if(this.params={},typeof t=="string")this.parse(t);else if(t&&typeof t=="object")for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&this.append(r,t[r])}parse(t){t.split("&").forEach(n=>{const[o,i]=n.split("=").map(decodeURIComponent);this.append(o,i)})}append(t,r){this.params[t]?this.params[t]=this.params[t].concat([r]):this.params[t]=[r]}get(t){return this.params[t]?this.params[t][0]:null}getAll(t){return this.params[t]||[]}delete(t){delete this.params[t]}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}set(t,r){this.params[t]=[r]}toString(){const t=[];for(const r in this.params)Object.prototype.hasOwnProperty.call(this.params,r)&&this.params[r].forEach(n=>{t.push(`${encodeURIComponent(r)}=${encodeURIComponent(n)}`)});return t.join("&")}}class wI{constructor(t){t.openURIWithCallback||(t.openURIWithCallback=this.getDefaultOpenURIWithCallback()),t.storage||(t.storage=Gf),this.config=t,this.tokenSectionName=`captcha_${t.clientId}`}isMatch(){var t,r,n;return((n=(r=(t=this.config)==null?void 0:t.adapter)==null?void 0:r.isMatch)==null?void 0:n.call(r))||t0()}async request(t,r){r||(r={}),r.method||(r.method="GET");const n=`${r.method}:${t}`;let o=t;r.withCaptcha&&(o=await this.appendCaptchaTokenToURL(t,n,!1));let i;try{i=await this.config.request(o,r)}catch(a){return a.error===It.CAPTCHA_REQUIRED||a.error===It.CAPTCHA_INVALID?(t=await this.appendCaptchaTokenToURL(t,n,a.error===It.CAPTCHA_INVALID),this.config.request(t,r)):Promise.reject(a)}return i}getDefaultOpenURIWithCallback(){if(!this.isMatch()&&!ip()&&(window.location.search.indexOf("__captcha")>0&&(document.body.style.display="none"),document.getElementById("captcha_panel_wrap")===null)){const t=document.createElement("div");t.style.cssText="background-color: rgba(0, 0, 0, 0.7);position: fixed;left: 0px;right: 0px;top: 0px;bottom: 0px;padding: 9vw 0 0 0;display: none;z-index:100;",t.setAttribute("id","captcha_panel_wrap"),setTimeout(()=>{document.body.appendChild(t)},0)}return this.defaultOpenURIWithCallback}async defaultOpenURIWithCallback(t,r){const{width:n="355px",height:o="355px"}=r||{};if(t.match(/^(data:.*)$/))return Promise.reject({error:It.UNIMPLEMENTED,error_description:"need to impl captcha data"});const a=document.getElementById("captcha_panel_wrap"),u=document.createElement("iframe");return a.innerHTML="",u.setAttribute("src",t),u.setAttribute("id","review-panel-iframe"),u.style.cssText=`min-width:${n};display:block;height:${o};margin:0 auto;background-color: rgb(255, 255, 255);border: none;`,a.appendChild(u),a.style.display="block",new Promise((l,s)=>{u.onload=function(){try{const c=window.location,f=u.contentWindow.location;if(f.host+f.pathname===c.host+c.pathname){a.style.display="none";const d=new Wo(f.search),v=d.get("captcha_token");return v?l({captcha_token:v,expires_in:Number(d.get("expires_in"))}):s({error:d.get("error"),error_description:d.get("error_description")})}a.style.display="block"}catch{a.style.display="block"}}})}async getCaptchaToken(t,r){if(!t){const i=await this.findCaptchaToken();if(i)return i}let n;if(!this.isMatch()&&!ip()){const i=`${window.location.origin+window.location.pathname}?__captcha=on`;if(n=await this.config.request(ye.GET_CAPTCHA_URL,{method:"POST",body:{client_id:this.config.clientId,redirect_uri:i,state:r},withCredentials:!1}),n.captcha_token){const a={captcha_token:n.captcha_token,expires_in:n.expires_in};return this.saveCaptchaToken(a),n.captcha_token}}else{const i=await this.config.request(ye.CAPTCHA_DATA_URL,{method:"POST",body:{state:r,redirect_uri:""},withCredentials:!1});n={url:`${i.data}?state=${encodeURIComponent(r)}&token=${encodeURIComponent(i.token)}`}}const o=await this.config.openURIWithCallback(n.url);return this.saveCaptchaToken(o),o.captcha_token}async appendCaptchaTokenToURL(t,r,n){const o=await this.getCaptchaToken(n,r);return t.indexOf("?")>0?t+=`&captcha_token=${o}`:t+=`?captcha_token=${o}`,t}async saveCaptchaToken(t){t.expires_at=new Date(Date.now()+(t.expires_in-10)*1e3);const r=JSON.stringify(t);await this.config.storage.setItem(this.tokenSectionName,r)}async findCaptchaToken(){const t=await this.config.storage.getItem(this.tokenSectionName);if(t!=null)try{const r=JSON.parse(t);return r!=null&&r.expires_at&&(r.expires_at=new Date(r.expires_at)),r.expires_at<new Date?null:r.captcha_token}catch{return await this.config.storage.removeItem(this.tokenSectionName),null}return null}}var EI={};function Dc(e,t){var n;const r=()=>{try{return require("../utils/encrypt")}catch{return}};try{if((((n=t==null?void 0:t.root)==null?void 0:n.globalThis)||globalThis).IS_MP_BUILD)return;if(!EI.IS_MP_BUILD&&e)return r()}catch{if(e)return r()}}let SI=class ma{static parseParamsToSearch(t){return Object.keys(t).forEach(n=>{t[n]||delete t[n]}),new Wo(t).toString()}constructor(t){let{request:r}=t,n=t.credentialsClient;if(!n){const o={apiOrigin:t.apiOrigin,apiPath:t.apiPath,clientId:t.clientId,storage:t.storage,env:t.env,baseRequest:t.baseRequest,anonymousSignInFunc:t.anonymousSignInFunc,wxCloud:t.wxCloud,onCredentialsError:t.onCredentialsError,headers:t.headers||{},i18n:t.i18n,publishable_key:t.publishable_key};n=new gr(o)}if(!r){const o=n.request.bind(n),i=new wI({clientId:t.clientId,request:o,storage:t.storage,adapter:t.adapter,...t.captchaOptions});r=i.request.bind(i)}this.config={env:t.env,apiOrigin:t.apiOrigin,apiPath:t.apiPath,clientId:t.clientId,request:r,credentialsClient:n,storage:t.storage||Gf,adapter:t.adapter}}getParamsByVersion(t,r){var i;const n=$l(t),o=((i={v2:Ji}[n==null?void 0:n.version])==null?void 0:i[r])||ye[r];return n&&delete n.version,{params:n,url:o}}async signIn(t){const r=t.version||"v1",n=this.getParamsByVersion(t,"AUTH_SIGN_IN_URL");n.params.query&&delete n.params.query;const o=await this.getEncryptParams(n.params),i=await this.config.request(n.url,{method:"POST",body:o});return await this.config.credentialsClient.setCredentials({...i,version:r}),Promise.resolve(i)}async signInAnonymously(t={},r=!1){const n=await this.config.request(ye.AUTH_SIGN_IN_ANONYMOUSLY_URL,{method:"POST",body:t,useWxCloud:r});return await this.config.credentialsClient.setCredentials(n),Promise.resolve(n)}async signUp(t){const r=await this.config.request(ye.AUTH_SIGN_UP_URL,{method:"POST",body:t});return await this.config.credentialsClient.setCredentials(r),Promise.resolve(r)}async signOut(t){let r={};if(t){try{r=await this.config.request(ye.AUTH_SIGNOUT_URL,{method:"POST",withCredentials:!0,body:t})}catch(i){i.error!==It.UNAUTHENTICATED&&console.log("sign_out_error",i)}return await this.config.credentialsClient.setCredentials(),r}const n=await this.config.credentialsClient.getAccessToken(),o=await this.config.request(ye.AUTH_REVOKE_URL,{method:"POST",body:{token:n}});return await this.config.credentialsClient.setCredentials(),Promise.resolve(o)}async revokeAllDevices(){await this.config.request(ye.AUTH_REVOKE_ALL_URL,{method:"DELETE",withCredentials:!0})}async revokeDevice(t){await this.config.request(ye.AUTHORIZED_DEVICES_DELETE_URL+t.device_id,{method:"DELETE",withCredentials:!0})}async getVerification(t,r){let n=!1;return(t.target==="CUR_USER"||await this.hasLoginState())&&(n=!0),this.config.request(ye.VERIFICATION_URL,{method:"POST",body:t,withCaptcha:(r==null?void 0:r.withCaptcha)||!1,withCredentials:n})}async verify(t){const r=this.getParamsByVersion(t,"VERIFY_URL"),n=await this.config.request(r.url,{method:"POST",body:r.params});return(t==null?void 0:t.version)==="v2"&&await this.config.credentialsClient.setCredentials({...n,version:"v2"}),n}async genProviderRedirectUri(t){const{provider_redirect_uri:r,other_params:n={},...o}=t;r&&!o.redirect_uri&&(o.redirect_uri=r);let i=`${ye.PROVIDER_URI_URL}?${ma.parseParamsToSearch(o)}`;return Object.keys(n).forEach(a=>{const u=n[a];a==="sign_out_uri"&&!((u==null?void 0:u.length)>0)||(i+=`&other_params[${a}]=${encodeURIComponent(u)}`)}),this.config.request(i,{method:"GET"})}async grantProviderToken(t,r=!1){return this.config.request(ye.PROVIDER_TOKEN_URL,{method:"POST",body:t,useWxCloud:r})}async patchProviderToken(t){return this.config.request(ye.PROVIDER_TOKEN_URL,{method:"PATCH",body:t})}async signInWithProvider(t,r=!1){const n=this.getParamsByVersion(t,"AUTH_SIGN_IN_WITH_PROVIDER_URL"),o=await this.config.request(n.url,{method:"POST",body:n.params,useWxCloud:r});return await this.config.credentialsClient.setCredentials({...o,version:(t==null?void 0:t.version)||"v1"}),Promise.resolve(o)}async signInCustom(t){const r=await this.config.request(ye.AUTH_SIGN_IN_CUSTOM,{method:"POST",body:t});return await this.config.credentialsClient.setCredentials(r),Promise.resolve(r)}async signInWithWechat(t={}){const r=await this.config.request(ye.AUTH_SIGN_IN_WITH_WECHAT_URL,{method:"POST",body:t});return await this.config.credentialsClient.setCredentials(r),Promise.resolve(r)}async bindWithProvider(t){return this.config.request(ye.PROVIDER_BIND_URL,{method:"POST",body:t,withCredentials:!0})}async getUserProfile(t){return this.getUserInfo(t)}async getUserInfo(t={}){var o;const r=this.getParamsByVersion(t,"USER_ME_URL");if((o=r.params)!=null&&o.query){const i=new Wo(r.params.query);r.url+=`?${i.toString()}`}const n=await this.config.request(r.url,{method:"GET",withCredentials:!0});return n.sub&&(n.uid=n.sub),n}async getWedaUserInfo(){return await this.config.request(ye.WEDA_USER_URL,{method:"GET",withCredentials:!0})}async deleteMe(t){const r=this.getParamsByVersion(t,"USER_ME_URL"),n=`${r.url}?${ma.parseParamsToSearch(r.params)}`;return this.config.request(n,{method:"DELETE",withCredentials:!0})}async hasLoginState(){try{return await this.config.credentialsClient.getAccessToken(),!0}catch{return!1}}hasLoginStateSync(){return this.config.credentialsClient.getCredentialsSync()}async getLoginState(){return this.config.credentialsClient.getCredentialsAsync()}async transByProvider(t){return this.config.request(ye.USER_TRANS_BY_PROVIDER_URL,{method:"PATCH",body:t,withCredentials:!0})}async grantToken(t){const r=this.getParamsByVersion(t,"AUTH_TOKEN_URL");return this.config.request(r.url,{method:"POST",body:r.params})}async getProviders(){return this.config.request(ye.PROVIDER_LIST,{method:"GET",withCredentials:!0})}async unbindProvider(t){return this.config.request(`${ye.PROVIDER_UNBIND_URL}/${t.provider_id}`,{method:"DELETE",withCredentials:!0})}async checkPassword(t){return this.config.request(`${ye.CHECK_PWD_URL}`,{method:"POST",withCredentials:!0,body:t})}async editContact(t){return this.config.request(`${ye.BIND_CONTACT_URL}`,{method:"PATCH",withCredentials:!0,body:t})}async setPassword(t){return this.config.request(`${ye.AUTH_SET_PASSWORD}`,{method:"PATCH",withCredentials:!0,body:t})}async updatePasswordByOld(t){const r=await this.sudo({password:t.old_password});return this.setPassword({sudo_token:r.sudo_token,new_password:t.new_password})}async sudo(t){return this.config.request(`${ye.SUDO_URL}`,{method:"POST",withCredentials:!0,body:t})}async sendVerificationCodeToCurrentUser(t){return t.target="CUR_USER",this.config.request(ye.VERIFICATION_URL,{method:"POST",body:t,withCredentials:!0,withCaptcha:!0})}async changeBoundProvider(t){return this.config.request(`${ye.PROVIDER_LIST}/${t.provider_id}/trans`,{method:"POST",body:{provider_trans_token:t.trans_token},withCredentials:!0})}async setUserProfile(t){return this.config.request(ye.USER_PRIFILE_URL,{method:"PATCH",body:t,withCredentials:!0})}async updateUserBasicInfo(t){return this.config.request(ye.USER_BASIC_EDIT_URL,{method:"POST",withCredentials:!0,body:t})}async queryUserProfile(t){const r=new Wo(t);return this.config.request(`${ye.USER_QUERY_URL}?${r.toString()}`,{method:"GET",withCredentials:!0})}setCustomSignFunc(t){this.getCustomSignTicketFn=t}async signInWithCustomTicket(){const t=this.getCustomSignTicketFn;if(!t)return Promise.reject({error:"failed_precondition",error_description:"please use setCustomSignFunc to set custom sign function"});const r=await t();return this.signInCustom({provider_id:"custom",ticket:r})}async resetPassword(t){return this.config.request(ye.AUTH_RESET_PASSWORD,{method:"POST",body:t})}async authorize(t){return this.config.request(ye.AUTHORIZE_URL,{method:"POST",withCredentials:!0,body:t})}async authorizeDevice(t){return this.config.request(ye.AUTHORIZE_DEVICE_URL,{method:"POST",withCredentials:!0,body:t})}async deviceAuthorize(t){return this.config.request(ye.AUTH_GET_DEVICE_CODE,{method:"POST",body:t,withCredentials:!0})}async authorizeInfo(t){const r=`${ye.AUTHORIZE_INFO_URL}?${ma.parseParamsToSearch(t)}`;let n=!0,o=!1;return await this.hasLoginState()&&(o=!0,n=!1),this.config.request(r,{method:"GET",withBasicAuth:n,withCredentials:o})}async checkUsername(t){return this.config.request(ye.CHECK_USERNAME,{method:"GET",body:t,withCredentials:!0})}async checkIfUserExist(t){const r=new Wo(t);return this.config.request(`${ye.CHECK_IF_USER_EXIST}?${r.toString()}`,{method:"GET"})}async loginScope(){return this.config.credentialsClient.getScope()}async loginGroups(){return this.config.credentialsClient.getGroups()}async refreshTokenForce(t){const r=await this.config.credentialsClient.getCredentials();return await this.config.credentialsClient.refreshToken({...r,version:(t==null?void 0:t.version)||"v1"})}async getCredentials(){return this.config.credentialsClient.getCredentials()}async getPublicKey(){return this.config.request(Ji.AUTH_PUBLIC_KEY,{method:"POST",body:{}})}async getEncryptParams(t){const{isEncrypt:r}=t;delete t.isEncrypt;const n=$l(t),o=Dc(r,this.config.adapter);if(!o)return t;let i="",a="";try{const u=await this.getPublicKey();if(i=u.public_key,a=u.public_key_thumbprint,!i||!a)throw u}catch(u){throw u}return{params:o.getEncryptInfo({publicKey:i,payload:n}),public_key_thumbprint:a}}async getProviderSubType(){return this.config.request(ye.GET_PROVIDER_TYPE,{method:"POST",body:{provider_id:"weda"}})}async verifyCaptchaData({token:t,key:r}){return this.config.request(ye.VERIFY_CAPTCHA_DATA_URL,{method:"POST",body:{token:t,key:r},withCredentials:!1})}async createCaptchaData({state:t,redirect_uri:r=void 0}){return this.config.request(ye.CAPTCHA_DATA_URL,{method:"POST",body:{state:t,redirect_uri:r},withCredentials:!1})}async getMiniProgramCode(t){return this.config.request(ye.GET_MINIPROGRAM_QRCODE,{method:"POST",body:t})}async getMiniProgramQrCodeStatus(t){return this.config.request(ye.GET_MINIPROGRAM_QRCODE_STATUS,{method:"POST",body:t})}async getUserBehaviorLog(t){const r={LOGIN:"query[action]=USER_LOGIN",MODIFY:"ne_query[action]=USER_LOGIN"},n=`${ye.GET_USER_BEHAVIOR_LOG}?${r[t.type]}&limit=${t.limit}${t.page_token?`&page_token=${t.page_token}`:""}`;return this.config.request(n,{method:"GET",withCredentials:!0})}async modifyPassword(t){let r="",n="";const o=Dc(!0,this.config.adapter);if(!o)throw new Error("do not support encrypt, a encrypt util required.");try{const u=await this.getPublicKey();if(r=u.public_key,n=u.public_key_thumbprint,!r||!n)throw u}catch(u){throw u}const i=t.password?o.getEncryptInfo({publicKey:r,payload:t.password}):"",a=o.getEncryptInfo({publicKey:r,payload:t.new_password});return this.config.request(ye.USER_BASIC_EDIT_URL,{method:"POST",withCredentials:!0,body:{user_id:t.user_id,encrypt_password:i,encrypt_new_password:a,public_key_thumbprint:n}})}async modifyPasswordWithoutLogin(t){let r="",n="";const o=Dc(!0,this.config.adapter);if(!o)throw new Error("do not support encrypt, a encrypt util required.");try{const u=await this.getPublicKey();if(r=u.public_key,n=u.public_key_thumbprint,!r||!n)throw u}catch(u){throw u}const i=t.password?o.getEncryptInfo({publicKey:r,payload:t.password}):"",a=o.getEncryptInfo({publicKey:r,payload:t.new_password});return this.config.request(Ji.AUTH_RESET_PASSWORD,{method:"POST",body:{username:t.username,password:i,new_password:a,public_key_thumbprint:n}})}};class II{constructor(t){const{apiOrigin:r,apiPath:n=Bu,clientId:o,env:i,storage:a,request:u,baseRequest:l,anonymousSignInFunc:s,wxCloud:c,adapter:f,onCredentialsError:d,headers:v,i18n:g,publishable_key:b}=t;this.oauth2client=new gr({apiOrigin:r,apiPath:n,clientId:o,env:i,storage:a,baseRequest:l||u,anonymousSignInFunc:s,wxCloud:c,onCredentialsError:d,headers:v||{},i18n:g,publishable_key:b}),this.authApi=new SI({credentialsClient:this.oauth2client,...t,request:u?this.oauth2client.request.bind(this.oauth2client):void 0,adapter:f})}}var le={};Object.defineProperty(le,"__esModule",{value:!0});le.parseQueryString=le.transformPhone=le.sleep=le.printGroupLog=ku=le.throwError=le.printInfo=le.printError=Ja=le.printWarn=le.execCallback=le.createPromiseCallback=le.removeParam=le.getHash=le.getQuery=le.toQueryString=le.formatUrl=le.generateRequestId=le.genSeqId=le.isFormData=le.isInstanceOf=le.isNull=le.isPalinObject=le.isUndefined=le.isString=le.isArray=void 0;var ju=Se;function OI(e){return Object.prototype.toString.call(e)==="[object Array]"}le.isArray=OI;function TI(e){return typeof e=="string"}le.isString=TI;function AI(e){return typeof e>"u"}le.isUndefined=AI;function RI(e){return Object.prototype.toString.call(e)==="[object Object]"}le.isPalinObject=RI;function CI(e){return Object.prototype.toString.call(e)==="[object Null]"}le.isNull=CI;function xI(e,t){return e instanceof t}le.isInstanceOf=xI;function PI(e){return Object.prototype.toString.call(e)==="[object FormData]"}le.isFormData=PI;function NI(){return Math.random().toString(16).slice(2)}le.genSeqId=NI;function $I(){var e=new Date().getTime(),t=(Date==null?void 0:Date.now)&&Date.now()*1e3||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var n=Math.random()*16;return e>0?(n=(e+n)%16|0,e=Math.floor(e/16)):(n=(t+n)%16|0,t=Math.floor(t/16)),(r==="x"?n:n&7|8).toString(16)})}le.generateRequestId=$I;function DI(e,t,r){r===void 0&&(r={});var n=/\?/.test(t),o="";return Object.keys(r).forEach(function(i){o===""?!n&&(t+="?"):o+="&",o+="".concat(i,"=").concat(encodeURIComponent(r[i]))}),t+=o,/^http(s)?:\/\//.test(t)?t:"".concat(e).concat(t)}le.formatUrl=DI;function LI(e){e===void 0&&(e={});var t=[];return Object.keys(e).forEach(function(r){t.push("".concat(r,"=").concat(encodeURIComponent(e[r])))}),t.join("&")}le.toQueryString=LI;function UI(e,t){if(typeof window>"u")return!1;var r=t||window.location.search,n=new RegExp("(^|&)".concat(e,"=([^&]*)(&|$)")),o=r.substr(r.indexOf("?")+1).match(n);return o!=null?o[2]:""}le.getQuery=UI;var FI=function(e){if(typeof window>"u")return"";var t=window.location.hash.match(new RegExp("[#?&/]".concat(e,"=([^&#]*)")));return t?t[1]:""};le.getHash=FI;function MI(e,t){var r=t.split("?")[0],n,o=[],i=t.indexOf("?")!==-1?t.split("?")[1]:"";if(i!==""){o=i.split("&");for(var a=o.length-1;a>=0;a-=1)n=o[a].split("=")[0],n===e&&o.splice(a,1);r="".concat(r,"?").concat(o.join("&"))}return r}le.removeParam=MI;function BI(){var e;if(!Promise){e=function(){},e.promise={};var t=function(){throw new Error('Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.')};return Object.defineProperty(e.promise,"then",{get:t}),Object.defineProperty(e.promise,"catch",{get:t}),e}var r=new Promise(function(n,o){e=function(i,a){return i?o(i):n(a)}});return e.promise=r,e}le.createPromiseCallback=BI;function jI(e,t,r){if(r===void 0&&(r=null),e&&typeof e=="function")return e(t,r);if(t)throw t;return r}le.execCallback=jI;function kI(e,t){console.warn("[".concat((0,ju.getSdkName)(),"][").concat(e,"]:").concat(t))}var Ja=le.printWarn=kI;function qI(e,t){console.error({code:e,msg:"[".concat((0,ju.getSdkName)(),"][").concat(e,"]:").concat(t)})}le.printError=qI;function WI(e,t){console.log("[".concat((0,ju.getSdkName)(),"][").concat(e,"]:").concat(t))}le.printInfo=WI;function HI(e,t){throw new Error(JSON.stringify({code:e,msg:"[".concat((0,ju.getSdkName)(),"][").concat(e,"]:").concat(t)}))}var ku=le.throwError=HI;function GI(e){var t,r=e.title,n=e.subtitle,o=n===void 0?"":n,i=e.content,a=i===void 0?[]:i,u=e.printTrace,l=u===void 0?!1:u,s=e.collapsed,c=s===void 0?!1:s;c?(console.groupCollapsed||console.error)(r,o):(console.group||console.error)(r,o);for(var f=0,d=a;f<d.length;f++){var v=d[f],g=v.type,b=v.body;switch(g){case"info":console.log(b);break;case"warn":console.warn(b);break;case"error":console.error(b);break}}l&&(console.trace||console.log)("stack trace:"),(t=console.groupEnd)===null||t===void 0||t.call(console)}le.printGroupLog=GI;var VI=function(e){return e===void 0&&(e=0),new Promise(function(t){return setTimeout(t,e)})};le.sleep=VI;function KI(e){return"+86".concat(e)}le.transformPhone=KI;var zI=function(e){e=e.replace(/^\?/,"");var t={},r=e.split("&");return r.forEach(function(n){var o=n.split("="),i=o[0],a=o[1];i=decodeURIComponent(i),a=decodeURIComponent(a),i&&(t[i]?Array.isArray(t[i])?t[i].push(a):t[i]=[t[i],a]:t[i]=a)}),t};le.parseQueryString=zI;var De={},qu={},JI=be&&be.__awaiter||function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},YI=be&&be.__generator||function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(qu,"__esModule",{value:!0});qu.catchErrorsDecorator=void 0;var op=le,QI=Se,es=!1;typeof navigator<"u"&&navigator.userAgent&&(es=navigator.userAgent.indexOf("Firefox")!==-1);var XI=es?/(\.js\/)?__decorate(\$\d+)?<@.*\d$/:/(\/\w+\.js\.)?__decorate(\$\d+)?\s*\(.*\)$/,r0=/https?:\/\/.+:\d*\/.*\.js:\d+:\d+/;function ZI(e){var t=e.mode,r=t===void 0?"async":t,n=e.customInfo,o=n===void 0?{}:n,i=e.title,a=e.messages,u=a===void 0?[]:a;return function(l,s,c){if(QI.IS_DEBUG_MODE){var f=o.className||l.constructor.name,d=o.methodName||s,v=c.value,g=eO(new Error);r==="sync"?c.value=function(){for(var b=[],y=0;y<arguments.length;y++)b[y]=arguments[y];var w=sp({err:new Error,className:f,methodName:d,sourceLink:g});try{return v.apply(this,b)}catch(U){var E=U,A=U.message,I=U.error,R=U.error_description,L={title:i||"".concat(f,".").concat(d," failed"),content:[{type:"error",body:U}]};if(A&&/^\{.*\}$/.test(A)){var F=JSON.parse(A);L.subtitle=A,F.code&&(w?(w.code=F.code,w.msg=F.msg):(U.code=F.code,U.message=F.msg),E=w||U,L.content=u.map(function(N){return{type:"info",body:N}}))}throw I&&R&&(L.subtitle=R,w?(w.code=I,w.msg=R):(U.code=I,U.message=R),E=w||U,L.content=u.map(function(N){return{type:"info",body:N}})),(0,op.printGroupLog)(L),E}}:c.value=function(){for(var b=[],y=0;y<arguments.length;y++)b[y]=arguments[y];return JI(this,void 0,void 0,function(){var w,E,A,I,R,L,F,U;return YI(this,function(N){switch(N.label){case 0:w=sp({err:new Error,className:f,methodName:d,sourceLink:g}),N.label=1;case 1:return N.trys.push([1,3,,4]),[4,v.apply(this,b)];case 2:return[2,N.sent()];case 3:throw E=N.sent(),A=E,I=E.message,R=E.error,L=E.error_description,F={title:i||"".concat(f,".").concat(d," failed"),content:[{type:"error",body:E}]},I&&/^\{.*\}$/.test(I)&&(U=JSON.parse(I),F.subtitle=U,U.code&&(w?(w.code=U.code,w.message=U.msg):(E.code=U.code,E.message=U.msg),A=w||E,F.content=u.map(function(W){return{type:"info",body:W}}))),R&&L&&(F.subtitle=L,w?(w.code=R,w.msg=L):(E.code=R,E.message=L),A=w||E,F.content=u.map(function(W){return{type:"info",body:W}})),(0,op.printGroupLog)(F),A;case 4:return[2]}})})}}}}qu.catchErrorsDecorator=ZI;function eO(e){var t="",r=e.stack.split(`
`),n=r.findIndex(function(i){return XI.test(i)});if(n!==-1){var o=r0.exec(r[n+1]||"");t=o?o[0]:""}return t}function sp(e){var t=e.err,r=e.className,n=e.methodName,o=e.sourceLink;if(!o)return null;var i=t.stack.split(`
`),a=es?/^catchErrorsDecorator\/<\/descriptor.value@.*\d$/:new RegExp("".concat(r,"\\.descriptor.value\\s*\\[as\\s").concat(n,"\\]\\s*\\(.*\\)$")),u=es?/^catchErrorsDecorator\/<\/descriptor.value/:new RegExp("".concat(r,"\\.descriptor.value\\s*\\[as\\s").concat(n,"\\]")),l=i.findIndex(function(f){return a.test(f)}),s;if(l!==-1){var c=i.filter(function(f,d){return d>l});c.unshift(i[l].replace(u,"".concat(r,".").concat(n)).replace(r0,o)),s=new Error,s.stack="".concat(es?"@debugger":"Error",`
`).concat(c.join(`
`))}return s}(function(e){var t=be&&be.__createBinding||(Object.create?function(n,o,i,a){a===void 0&&(a=i);var u=Object.getOwnPropertyDescriptor(o,i);(!u||("get"in u?!o.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return o[i]}}),Object.defineProperty(n,a,u)}:function(n,o,i,a){a===void 0&&(a=i),n[a]=o[i]}),r=be&&be.__exportStar||function(n,o){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(o,i)&&t(o,n,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(qu,e)})(De);var zt={},tO=be&&be.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),rO=be&&be.__spreadArray||function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))};Object.defineProperty(zt,"__esModule",{value:!0});zt.removeEventListener=zt.activateEvent=zt.addEventListener=o0=zt.CloudbaseEventEmitter=zt.IErrorEvent=zt.CloudbaseEvent=void 0;var ap=le;function nO(e,t,r){r[e]=r[e]||[],r[e].push(t)}function iO(e,t,r){if(r!=null&&r[e]){var n=r[e].indexOf(t);n!==-1&&r[e].splice(n,1)}}var Vf=function(){function e(t,r){this.data=r||null,this.name=t}return e}();zt.CloudbaseEvent=Vf;var n0=function(e){tO(t,e);function t(r,n){var o=e.call(this,"error",{error:r,data:n})||this;return o.error=r,o}return t}(Vf);zt.IErrorEvent=n0;var i0=function(){function e(){this.listeners={}}return e.prototype.on=function(t,r){return nO(t,r,this.listeners),this},e.prototype.off=function(t,r){return iO(t,r,this.listeners),this},e.prototype.fire=function(t,r){if((0,ap.isInstanceOf)(t,n0))return console.error(t.error),this;var n=(0,ap.isString)(t)?new Vf(t,r||{}):t,o=n.name;if(this.listens(o)){n.target=this;for(var i=this.listeners[o]?rO([],this.listeners[o],!0):[],a=0,u=i;a<u.length;a++){var l=u[a];l.call(this,n)}}return this},e.prototype.listens=function(t){return this.listeners[t]&&this.listeners[t].length>0},e}(),o0=zt.CloudbaseEventEmitter=i0,Kf=new i0;function oO(e,t){Kf.on(e,t)}zt.addEventListener=oO;function sO(e,t){t===void 0&&(t={}),Kf.fire(e,t)}zt.activateEvent=sO;function aO(e,t){Kf.off(e,t)}zt.removeEventListener=aO;var zf={};const s0=ZS(AE);var Ys={},uO=be&&be.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Lc=be&&be.__awaiter||function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Uc=be&&be.__generator||function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(zf,"__esModule",{value:!0});var a0=zf.CloudbaseCache=void 0,cO=s0,ts=le,In=Se,Fc=function(e){uO(t,e);function t(r){var n=e.call(this)||this;return n.root=r,r.tcbCacheObject||(r.tcbCacheObject={}),n}return t.prototype.setItem=function(r,n){this.root.tcbCacheObject[r]=n},t.prototype.getItem=function(r){return this.root.tcbCacheObject[r]},t.prototype.removeItem=function(r){delete this.root.tcbCacheObject[r]},t.prototype.clear=function(){delete this.root.tcbCacheObject},t}(cO.AbstractStorage);function lO(e,t){switch(e){case"local":return t.localStorage?t.localStorage:((0,ts.printWarn)(In.ERRORS.INVALID_PARAMS,"localStorage is not supported on current platform"),new Fc(t.root));case"none":return new Fc(t.root);default:return t.localStorage?t.localStorage:((0,ts.printWarn)(In.ERRORS.INVALID_PARAMS,"localStorage is not supported on current platform"),new Fc(t.root))}}var fO=function(){function e(t){this.keys={};var r=t.persistence,n=t.platformInfo,o=n===void 0?{}:n,i=t.keys,a=i===void 0?{}:i;this.platformInfo=o,this.storage||(this.persistenceTag=this.platformInfo.adapter.primaryStorage||r,this.storage=lO(this.persistenceTag,this.platformInfo.adapter),this.keys=a)}return Object.defineProperty(e.prototype,"mode",{get:function(){return this.storage.mode||"sync"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"persistence",{get:function(){return this.persistenceTag},enumerable:!1,configurable:!0}),e.prototype.setStore=function(t,r,n){if(this.mode==="async"){(0,ts.printWarn)(In.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use setStoreAsync insteed");return}if(this.storage)try{var o={version:n||"localCachev1",content:r};this.storage.setItem(t,JSON.stringify(o))}catch(i){throw new Error(JSON.stringify({code:In.ERRORS.OPERATION_FAIL,msg:"[".concat((0,In.getSdkName)(),"][").concat(In.ERRORS.OPERATION_FAIL,"]setStore failed"),info:i}))}},e.prototype.setStoreAsync=function(t,r,n){return Lc(this,void 0,void 0,function(){var o;return Uc(this,function(i){switch(i.label){case 0:if(!this.storage)return[2];i.label=1;case 1:return i.trys.push([1,3,,4]),o={version:n||"localCachev1",content:r},[4,this.storage.setItem(t,JSON.stringify(o))];case 2:return i.sent(),[3,4];case 3:return i.sent(),[2];case 4:return[2]}})})},e.prototype.getStore=function(t,r){var n;if(this.mode==="async"){(0,ts.printWarn)(In.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use getStoreAsync insteed");return}try{if(typeof process<"u"&&(!((n=Ys)===null||n===void 0)&&n.tcb_token))return Ys.tcb_token;if(!this.storage)return""}catch{return""}r=r||"localCachev1";var o=this.storage.getItem(t);if(!o)return"";if(o.indexOf(r)>=0){var i=JSON.parse(o);return i.content}return""},e.prototype.getStoreAsync=function(t,r){var n;return Lc(this,void 0,void 0,function(){var o,i;return Uc(this,function(a){switch(a.label){case 0:try{if(typeof process<"u"&&(!((n=Ys)===null||n===void 0)&&n.tcb_token))return[2,Ys.tcb_token];if(!this.storage)return[2,""]}catch{return[2,""]}return r=r||"localCachev1",[4,this.storage.getItem(t)];case 1:return o=a.sent(),o?o.indexOf(r)>=0?(i=JSON.parse(o),[2,i.content]):[2,""]:[2,""]}})})},e.prototype.removeStore=function(t){if(this.mode==="async"){(0,ts.printWarn)(In.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use removeStoreAsync insteed");return}this.storage.removeItem(t)},e.prototype.removeStoreAsync=function(t){return Lc(this,void 0,void 0,function(){return Uc(this,function(r){switch(r.label){case 0:return[4,this.storage.removeItem(t)];case 1:return r.sent(),[2]}})})},e}();a0=zf.CloudbaseCache=fO;var u0={},no={},dO=be&&be.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ft=be&&be.__assign||function(){return ft=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ft.apply(this,arguments)},Mc=be&&be.__awaiter||function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Bc=be&&be.__generator||function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(no,"__esModule",{value:!0});no.WebRequest=no.genAdapter=void 0;var hO=s0,jc=le,pO=At,c0=function(e){dO(t,e);function t(r){var n=e.call(this)||this,o=r.timeout,i=r.timeoutMsg,a=r.restrictedMethods;return n.timeout=o||0,n.timeoutMsg=i||"请求超时",n.restrictedMethods=a||["get","post","upload","download"],n}return t.prototype.get=function(r){return this.request(ft(ft({},r),{method:"get"}),this.restrictedMethods.includes("get"))},t.prototype.post=function(r){return this.request(ft(ft({},r),{method:"post"}),this.restrictedMethods.includes("post"))},t.prototype.put=function(r){return this.request(ft(ft({},r),{method:"put"}))},t.prototype.upload=function(r){var n=r.data,o=r.file,i=r.name,a=r.method,u=r.headers,l=u===void 0?{}:u,s={post:"post",put:"put"}[a==null?void 0:a.toLowerCase()]||"put",c=new FormData;return s==="post"?(Object.keys(n).forEach(function(f){c.append(f,n[f])}),c.append("key",i),c.append("file",o),this.request(ft(ft({},r),{data:c,method:s}),this.restrictedMethods.includes("upload"))):this.request(ft(ft({},r),{method:"put",headers:l,body:o}),this.restrictedMethods.includes("upload"))},t.prototype.download=function(r){return Mc(this,void 0,void 0,function(){var n,o,i,a;return Bc(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,this.get(ft(ft({},r),{headers:{},responseType:"blob"}))];case 1:return n=u.sent().data,o=window.URL.createObjectURL(new Blob([n])),i=decodeURIComponent(new URL(r.url).pathname.split("/").pop()||""),a=document.createElement("a"),a.href=o,a.setAttribute("download",i),a.style.display="none",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(o),document.body.removeChild(a),[3,3];case 2:return u.sent(),[3,3];case 3:return[2,new Promise(function(l){l({statusCode:200,tempFilePath:r.url})})]}})})},t.prototype.fetch=function(r){var n;return Mc(this,void 0,void 0,function(){var o,i,a,u,l,s,c,f,d,v,g,b=this;return Bc(this,function(y){switch(y.label){case 0:return o=new AbortController,i=r.url,a=r.enableAbort,u=a===void 0?!1:a,l=r.stream,s=l===void 0?!1:l,c=r.signal,f=r.timeout,d=f??this.timeout,c&&(c.aborted&&o.abort(),c.addEventListener("abort",function(){return o.abort()})),v=null,u&&d&&(v=setTimeout(function(){console.warn(b.timeoutMsg),o.abort(new Error(b.timeoutMsg))},d)),[4,fetch(i,ft(ft({},r),{signal:o.signal})).then(function(w){return Mc(b,void 0,void 0,function(){var E,A,I;return Bc(this,function(R){switch(R.label){case 0:return clearTimeout(v),w.ok?(E=w,[3,3]):[3,1];case 1:return I=(A=Promise).reject,[4,w.json()];case 2:E=I.apply(A,[R.sent()]),R.label=3;case 3:return[2,E]}})})}).catch(function(w){return clearTimeout(v),Promise.reject(w)})];case 1:return g=y.sent(),[2,{data:s?g.body:!((n=g.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?g.json():g.text(),statusCode:g.status,header:g.headers}]}})})},t.prototype.request=function(r,n){var o=this;n===void 0&&(n=!1);var i=String(r.method).toLowerCase()||"get";return new Promise(function(a){var u=r.url,l=r.headers,s=l===void 0?{}:l,c=r.data,f=r.responseType,d=r.withCredentials,v=r.body,g=r.onUploadProgress,b=(0,jc.formatUrl)((0,pO.getProtocol)(),u,i==="get"?c:{}),y=new XMLHttpRequest;y.open(i,b),f&&(y.responseType=f),Object.keys(s).forEach(function(A){y.setRequestHeader(A,s[A])});var w;g&&y.upload.addEventListener("progress",g),y.onreadystatechange=function(){var A={};if(y.readyState===4){var I=y.getAllResponseHeaders(),R=I.trim().split(/[\r\n]+/),L={};R.forEach(function(F){var U=F.split(": "),N=U.shift().toLowerCase(),W=U.join(": ");L[N]=W}),A.header=L,A.statusCode=y.status;try{A.data=f==="blob"?y.response:JSON.parse(y.responseText)}catch{A.data=f==="blob"?y.response:y.responseText}clearTimeout(w),a(A)}},n&&o.timeout&&(w=setTimeout(function(){console.warn(o.timeoutMsg),y.abort()},o.timeout));var E;(0,jc.isFormData)(c)?E=c:s["content-type"]==="application/x-www-form-urlencoded"?E=(0,jc.toQueryString)(c):v?E=v:E=c?JSON.stringify(c):void 0,d&&(y.withCredentials=!0),y.send(E)})},t}(hO.AbstractSDKRequest);no.WebRequest=c0;function vO(){var e={type:"default",root:window,reqClass:c0,wsClass:WebSocket,localStorage};return e}no.genAdapter=vO;(function(e){var t=be&&be.__assign||function(){return t=Object.assign||function(c){for(var f,d=1,v=arguments.length;d<v;d++){f=arguments[d];for(var g in f)Object.prototype.hasOwnProperty.call(f,g)&&(c[g]=f[g])}return c},t.apply(this,arguments)},r=be&&be.__createBinding||(Object.create?function(c,f,d,v){v===void 0&&(v=d);var g=Object.getOwnPropertyDescriptor(f,d);(!g||("get"in g?!f.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return f[d]}}),Object.defineProperty(c,v,g)}:function(c,f,d,v){v===void 0&&(v=d),c[v]=f[d]}),n=be&&be.__setModuleDefault||(Object.create?function(c,f){Object.defineProperty(c,"default",{enumerable:!0,value:f})}:function(c,f){c.default=f}),o=be&&be.__importStar||function(c){if(c&&c.__esModule)return c;var f={};if(c!=null)for(var d in c)d!=="default"&&Object.prototype.hasOwnProperty.call(c,d)&&r(f,c,d);return n(f,c),f};Object.defineProperty(e,"__esModule",{value:!0}),e.useDefaultAdapter=e.useAdapters=e.RUNTIME=void 0;var i=o(no),a=le,u;(function(c){c.WEB="web",c.WX_MP="wx_mp"})(u=e.RUNTIME||(e.RUNTIME={}));function l(c,f){for(var d=(0,a.isArray)(c)?c:[c],v=0,g=d;v<g.length;v++){var b=g[v],y=b.isMatch,w=b.genAdapter,E=b.runtime;if(y())return{adapter:t({isMatch:y},w(f)),runtime:E}}}e.useAdapters=l;function s(){return{adapter:i.genAdapter(),runtime:u.WEB}}e.useDefaultAdapter=s})(u0);var yr=function(){return yr=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},yr.apply(this,arguments)},rs=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},ns=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},l0=function(){function e(t){var r,n;try{this.localStorage=(t==null?void 0:t.localStorage)||(((n=(r=t==null?void 0:t.adapter)===null||r===void 0?void 0:r.root)===null||n===void 0?void 0:n.globalThis)||globalThis).localStorage}catch{this.localStorage=(t==null?void 0:t.localStorage)||{}}}return e.prototype.getItem=function(t){return rs(this,void 0,void 0,function(){return ns(this,function(r){return[2,this.localStorage.getItem(t)]})})},e.prototype.removeItem=function(t){return rs(this,void 0,void 0,function(){return ns(this,function(r){return this.localStorage.removeItem(t),[2]})})},e.prototype.setItem=function(t,r){return rs(this,void 0,void 0,function(){return ns(this,function(n){return this.localStorage.setItem(t,r),[2]})})},e.prototype.getItemSync=function(t){return this.localStorage.getItem(t)},e.prototype.setItemSync=function(t,r){this.localStorage.setItem(t,r)},e.prototype.removeItemSync=function(t){this.localStorage.removeItem(t)},e}(),mO=/^[^:]+:\/\/[^/]+(\/[^?#]+)/,f0=function(e,t){var r,n,o,i=(r=t==null?void 0:t.headers)===null||r===void 0?void 0:r["x-request-id"];return e||(e={}),(e!=null&&e.code||!((n=e==null?void 0:e.data)===null||n===void 0)&&n.error_code)&&(e={error:e.code||e.data.error,error_description:e.data.error_description||e.message||e.code||e.data.error_code,request_id:e.requestId,error_code:(o=e.data)===null||o===void 0?void 0:o.error_code}),e!=null&&e.request_id||(e.request_id=e.request_id||i),e!=null&&e.error?(e.error_uri=yO(t==null?void 0:t.url),e):(e==null?void 0:e.data)||{}};function gO(e){return function(t,r){return rs(this,void 0,void 0,function(){return ns(this,function(n){return[2,new Promise(function(o,i){var a=Object.assign({},r);a.body&&typeof a.body!="string"&&(a.body=JSON.stringify(a.body));var u=wx.request({url:t,data:a.body,timeout:e._timeout,method:a.method||"GET",header:a.headers,success:function(l){l=f0(l,yr(yr({},r),{url:t})),l.error&&i(l),o(l)},fail:function(l){i({error:"unreachable",error_description:l.message})},complete:function(l){if(!(!l||!l.errMsg)&&!(!e._timeout||e._restrictedMethods.indexOf("request")===-1)){var s=l.errMsg;if(s==="request:fail timeout"){console.warn(e._timeoutMsg);try{u.abort()}catch{}}}}})})]})})}}function yO(e){return mO.test(e)?RegExp.$1:e}var _O=function(e,t){var r=yr({},e);try{if(!(e!=null&&e.storage)&&(t!=null&&t.localStorage)&&(r.storage=new l0({localStorage:t.localStorage,adapter:t})),!e.captchaOptions&&(t!=null&&t.captchaOptions)&&(r.captchaOptions=t.captchaOptions),!e.baseRequest&&!e.request&&(t!=null&&t.reqClass)){var n={timeout:1e4,restrictedMethods:["get","post","upload","download","request"]},o=new t.reqClass(n);r.baseRequest=function(i,a){var u;return rs(this,void 0,void 0,function(){var l,s,c,f;return ns(this,function(d){switch(d.label){case 0:if(l={},s=((u=a.method)===null||u===void 0?void 0:u.toLocaleLowerCase())||"get",c=o==null?void 0:o[s],typeof c!="function")throw new Error("invalid 【".concat(s,"】 request method"));d.label=1;case 1:return d.trys.push([1,3,,4]),(!a.headers["content-type"]||a.headers["content-type"].includes("application/json"))&&typeof a.body!="string"&&(a.data=a.data||a.body,a.body=JSON.stringify(a.body)),[4,c(yr({url:i},a))];case 2:return l=d.sent(),l=f0(l,yr(yr({},a),{url:i})),[3,4];case 3:throw f=d.sent(),l=f,f;case 4:if(l!=null&&l.error)throw l;return[2,l]}})})}}}catch(i){console.error("user adapter generate fail:",i)}return r},bO=function(e,t){if(!tn.isMatch()||e.storage&&e.baseRequest)return e;var r=yr({},e),n={};try{var o=tn.genAdapter(),i=o.localStorage,a=o.reqClass;if(i&&(n.storage=new l0({localStorage:i,adapter:t})),a){var u=new a({timeout:1e4,restrictedMethods:["get","post","upload","download","request"]});n.request=gO(u)}return r.captchaOptions&&(n.baseRequest=n.request,n.request=void 0),yr(yr({},r),n)}catch(l){console.error("adapter generate fail:",l)}return r},wO=function(e){return e.adapter&&e.adapter.type!=="default"?_O(e,e.adapter):bO(e,e.adapter)},yt=function(){return yt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},yt.apply(this,arguments)},Ue=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(a=e[u])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},Y=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},te=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},re=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},EO="auth",ga={SIGN_OUT:"sign_out",SIGN_IN:"sign_in",CREDENTIALS_ERROR:"credentials_error"},ya={LOGIN_STATE_CHANGED:"loginStateChanged"},_a=new o0,SO=function(e){_a.fire(ya.LOGIN_STATE_CHANGED,yt(yt({},e),{eventType:ga.CREDENTIALS_ERROR}))},IO=function(){function e(t){var r=t.cache,n=t.oauthInstance;this.cache=r,this.oauthInstance=n,this.setUserInfo()}return e.prototype.checkLocalInfo=function(){return te(this,void 0,void 0,function(){return re(this,function(t){return this.uid=this.getLocalUserInfo("uid"),this.gender=this.getLocalUserInfo("gender"),this.picture=this.getLocalUserInfo("picture"),this.email=this.getLocalUserInfo("email"),this.emailVerified=this.getLocalUserInfo("email_verified"),this.phoneNumber=this.getLocalUserInfo("phone_number"),this.username=this.getLocalUserInfo("username"),this.name=this.getLocalUserInfo("name"),this.birthdate=this.getLocalUserInfo("birthdate"),this.zoneinfo=this.getLocalUserInfo("zoneinfo"),this.locale=this.getLocalUserInfo("locale"),this.sub=this.getLocalUserInfo("sub"),this.createdFrom=this.getLocalUserInfo("created_from"),this.providers=this.getLocalUserInfo("providers"),[2]})})},e.prototype.checkLocalInfoAsync=function(){return te(this,void 0,void 0,function(){var t,r,n,o;return re(this,function(i){switch(i.label){case 0:return t=this,[4,this.getLocalUserInfoAsync("uid")];case 1:return t.uid=i.sent(),r=this,[4,this.getLocalUserInfoAsync("gender")];case 2:return r.gender=i.sent(),this.picture=this.getLocalUserInfo("picture"),n=this,[4,this.getLocalUserInfoAsync("email")];case 3:return n.email=i.sent(),this.emailVerified=this.getLocalUserInfo("email_verified"),this.phoneNumber=this.getLocalUserInfo("phone_number"),o=this,[4,this.getLocalUserInfoAsync("username")];case 4:return o.username=i.sent(),this.name=this.getLocalUserInfo("name"),this.birthdate=this.getLocalUserInfo("birthdate"),this.zoneinfo=this.getLocalUserInfo("zoneinfo"),this.locale=this.getLocalUserInfo("locale"),this.sub=this.getLocalUserInfo("sub"),this.createdFrom=this.getLocalUserInfo("created_from"),this.providers=this.getLocalUserInfo("providers"),[2]}})})},e.prototype.update=function(t){return te(this,void 0,void 0,function(){var r;return re(this,function(n){switch(n.label){case 0:return[4,this.oauthInstance.authApi.setUserProfile(yt({},t))];case 1:return r=n.sent(),this.setLocalUserInfo(r),[2]}})})},e.prototype.updateUserBasicInfo=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.authApi.updateUserBasicInfo(yt({},t))];case 1:return r.sent(),this.setLocalUserInfo({username:t.username}),[2]}})})},e.prototype.updatePassword=function(t,r){return this.oauthInstance.authApi.updatePasswordByOld({old_password:r,new_password:t})},e.prototype.updateUsername=function(t){return typeof t!="string"&&ku(Se.ERRORS.INVALID_PARAMS,"username must be a string"),this.update({username:t})},e.prototype.refresh=function(t){return te(this,void 0,void 0,function(){var r;return re(this,function(n){switch(n.label){case 0:return[4,this.oauthInstance.authApi.getUserInfo(t)];case 1:return r=n.sent(),this.setLocalUserInfo(r),[2,r]}})})},e.prototype.getLocalUserInfo=function(t){var r=this.cache.keys.userInfoKey,n=this.cache.getStore(r);return n[t]},e.prototype.getLocalUserInfoAsync=function(t){return te(this,void 0,void 0,function(){var r,n;return re(this,function(o){switch(o.label){case 0:return r=this.cache.keys.userInfoKey,[4,this.cache.getStoreAsync(r)];case 1:return n=o.sent(),[2,n[t]]}})})},e.prototype.setUserInfo=function(){var t=this,r=this.cache.keys.userInfoKey,n=this.cache.getStore(r);["uid","email","name","gender","picture","email_verified","phone_number","birthdate","zoneinfo","locale","sub","created_from","providers","username"].forEach(function(o){t[o]=n[o]})},e.prototype.setLocalUserInfo=function(t){var r=this.cache.keys.userInfoKey;this.cache.setStore(r,t),this.setUserInfo()},Ue([De.catchErrorsDecorator({title:"更新用户信息失败",messages:["请确认以下各项：","  1 - 调用 User.update() 的语法或参数是否正确","  2 - 用户信息中是否包含非法值","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",Promise)],e.prototype,"update",null),Ue([De.catchErrorsDecorator({title:"更新密码失败",messages:["请确认以下各项：","  1 - 调用 User.updatePassword() 的语法或参数是否正确","  3 - 新密码中是否包含非法字符","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[String,String]),Y("design:returntype",void 0)],e.prototype,"updatePassword",null),Ue([De.catchErrorsDecorator({title:"更新用户名失败",messages:["请确认以下各项：","  1 - 调用 User.updateUsername() 的语法或参数是否正确","  2 - 当前环境是否开通了用户名密码登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[String]),Y("design:returntype",void 0)],e.prototype,"updateUsername",null),Ue([De.catchErrorsDecorator({title:"刷新本地用户信息失败",messages:["请确认以下各项：","  1 - 调用 User.refresh() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",Promise)],e.prototype,"refresh",null),e}(),kc=function(){function e(t){var r=t.envId,n=t.cache,o=t.oauthInstance;r||ku(Se.ERRORS.INVALID_PARAMS,"envId is not defined"),this.cache=n,this.oauthInstance=o,this.user=new IO({cache:this.cache,oauthInstance:o})}return e.prototype.checkLocalState=function(){var t;this.oauthLoginState=(t=this.oauthInstance)===null||t===void 0?void 0:t.authApi.hasLoginStateSync(),this.user.checkLocalInfo()},e.prototype.checkLocalStateAsync=function(){var t;return te(this,void 0,void 0,function(){return re(this,function(r){switch(r.label){case 0:return[4,(t=this.oauthInstance)===null||t===void 0?void 0:t.authApi.getLoginState()];case 1:return r.sent(),[4,this.user.checkLocalInfoAsync()];case 2:return r.sent(),[2]}})})},e}(),OO=function(){function e(t){this.config=t,this.cache=t.cache,this.oauthInstance=t.oauthInstance,t.publishable_key&&this.createLoginState()}return e.prototype.bindPhoneNumber=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.editContact(t)]})})},e.prototype.unbindProvider=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.unbindProvider(t)]})})},e.prototype.bindEmail=function(t){return this.oauthInstance.authApi.editContact(t)},e.prototype.verify=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.verify(t)]})})},e.prototype.getVerification=function(t,r){return te(this,void 0,void 0,function(){return re(this,function(n){return[2,this.oauthInstance.authApi.getVerification(t,r)]})})},Object.defineProperty(e.prototype,"currentUser",{get:function(){if(this.cache.mode==="async"){Ja(Se.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use getCurrentUser insteed");return}var t=this.hasLoginState();return t&&t.user||null},enumerable:!1,configurable:!0}),e.prototype.getCurrentUser=function(){return te(this,void 0,void 0,function(){var t;return re(this,function(r){switch(r.label){case 0:return[4,this.getLoginState()];case 1:return t=r.sent(),t?[4,t.user.checkLocalInfoAsync()]:[3,3];case 2:return r.sent(),[2,t.user||null];case 3:return[2,null]}})})},e.prototype.signInAnonymously=function(t){return t===void 0&&(t={}),te(this,void 0,void 0,function(){return re(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.authApi.signInAnonymously(t)];case 1:return r.sent(),[2,this.createLoginState()]}})})},e.prototype.signInAnonymouslyInWx=function(t){var r=t===void 0?{}:t,n=r.useWxCloud;return te(this,void 0,void 0,function(){var o,i,a=this;return re(this,function(u){switch(u.label){case 0:if(!tn.isMatch())throw Error("wx api undefined");return o=wx.getAccountInfoSync().miniProgram,i=function(l){return te(a,void 0,void 0,function(){var s,c,f;return re(this,function(d){switch(d.label){case 0:s=void 0,c=void 0,d.label=1;case 1:return d.trys.push([1,4,,5]),[4,this.oauthInstance.authApi.grantProviderToken({provider_id:o==null?void 0:o.appId,provider_code:l,provider_params:{provider_code_type:"open_id",appid:o==null?void 0:o.appId}},n)];case 2:if(s=d.sent(),s!=null&&s.error_code||!s.provider_token)throw s;return[4,this.oauthInstance.authApi.signInAnonymously({provider_token:s.provider_token},n)];case 3:if(c=d.sent(),c!=null&&c.error_code)throw c;return[3,5];case 4:throw f=d.sent(),f;case 5:return[2]}})})},[4,new Promise(function(l,s){wx.login({success:function(c){return te(a,void 0,void 0,function(){var f;return re(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),[4,i(c.code)];case 1:return d.sent(),l(!0),[3,3];case 2:return f=d.sent(),s(f),[3,3];case 3:return[2]}})})},fail:function(c){var f=new Error(c==null?void 0:c.errMsg);f.code=c==null?void 0:c.errno,s(f)}})})];case 1:return u.sent(),[2,this.createLoginState(void 0,{asyncRefreshUser:!0})]}})})},e.prototype.bindOpenId=function(){return te(this,void 0,void 0,function(){var t,r,n=this;return re(this,function(o){switch(o.label){case 0:if(!tn.isMatch())throw Error("wx api undefined");return t=wx.getAccountInfoSync().miniProgram,r=function(i){return te(n,void 0,void 0,function(){var a,u;return re(this,function(l){switch(l.label){case 0:a=void 0,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,this.oauthInstance.authApi.grantProviderToken({provider_id:t==null?void 0:t.appId,provider_code:i,provider_params:{provider_code_type:"open_id",appid:t==null?void 0:t.appId}})];case 2:if(a=l.sent(),a!=null&&a.error_code||!a.provider_token)throw a;return[4,this.oauthInstance.authApi.bindWithProvider({provider_token:a.provider_token})];case 3:return l.sent(),[3,5];case 4:throw u=l.sent(),u;case 5:return[2]}})})},[4,new Promise(function(i,a){wx.login({success:function(u){return te(n,void 0,void 0,function(){var l;return re(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,r(u.code)];case 1:return s.sent(),i(!0),[3,3];case 2:return l=s.sent(),a(l),[3,3];case 3:return[2]}})})},fail:function(u){var l=new Error(u==null?void 0:u.errMsg);l.code=u==null?void 0:u.errno,a(l)}})})];case 1:return o.sent(),[2]}})})},e.prototype.signInWithOpenId=function(t){var r=t===void 0?{}:t,n=r.useWxCloud,o=n===void 0?!0:n;return te(this,void 0,void 0,function(){var i,a,u=this;return re(this,function(l){switch(l.label){case 0:if(!tn.isMatch())throw Error("wx api undefined");return i=wx.getAccountInfoSync().miniProgram,a=function(s){return te(u,void 0,void 0,function(){var c,f,d;return re(this,function(v){switch(v.label){case 0:c=void 0,f=void 0,v.label=1;case 1:return v.trys.push([1,4,,5]),[4,this.oauthInstance.authApi.grantProviderToken({provider_id:i==null?void 0:i.appId,provider_code:s,provider_params:{provider_code_type:"open_id",appid:i==null?void 0:i.appId}},o)];case 2:if(c=v.sent(),c!=null&&c.error_code||!c.provider_token)throw c;return[4,this.oauthInstance.authApi.signInWithProvider({provider_token:c.provider_token},o)];case 3:if(f=v.sent(),f!=null&&f.error_code)throw f;return[3,5];case 4:throw d=v.sent(),d;case 5:return[4,this.oauthInstance.oauth2client.setCredentials(f)];case 6:return v.sent(),[2]}})})},[4,new Promise(function(s,c){wx.login({success:function(f){return te(u,void 0,void 0,function(){var d;return re(this,function(v){switch(v.label){case 0:return v.trys.push([0,2,,3]),[4,a(f.code)];case 1:return v.sent(),s(!0),[3,3];case 2:return d=v.sent(),c(d),[3,3];case 3:return[2]}})})},fail:function(f){var d=new Error(f==null?void 0:f.errMsg);d.code=f==null?void 0:f.errno,c(d)}})})];case 1:return l.sent(),[2,this.createLoginState()]}})})},e.prototype.signInWithUnionId=function(){return te(this,void 0,void 0,function(){var t,r=this;return re(this,function(n){switch(n.label){case 0:if(!tn.isMatch())throw Error("wx api undefined");n.label=1;case 1:return n.trys.push([1,3,,4]),[4,new Promise(function(o,i){var a=wx.getAccountInfoSync().miniProgram;wx.login({success:function(u){return te(r,void 0,void 0,function(){var l,s,c,f,d;return re(this,function(v){switch(v.label){case 0:l=a==null?void 0:a.appId,v.label=1;case 1:return v.trys.push([1,4,,5]),[4,this.oauthInstance.authApi.grantProviderToken({provider_code:u.code,provider_id:l,provider_params:{provider_code_type:"union_id",appid:a==null?void 0:a.appId}})];case 2:return s=v.sent(),c=s.provider_token,c?[4,this.oauthInstance.authApi.signInWithProvider({provider_id:l,provider_token:c})]:(i(s),[2]);case 3:return f=v.sent(),f!=null&&f.error_code?(i(f),[2]):(o(!0),[3,5]);case 4:return d=v.sent(),i(d),[3,5];case 5:return[2]}})})},fail:function(u){var l=new Error(u==null?void 0:u.errMsg);l.code=u==null?void 0:u.errno,i(l)}})})];case 2:return n.sent(),[3,4];case 3:throw t=n.sent(),t;case 4:return[2,this.createLoginState()]}})})},e.prototype.signInWithPhoneAuth=function(t){var r=t.phoneCode,n=r===void 0?"":r;return te(this,void 0,void 0,function(){var o,i,a,u,l,s;return re(this,function(c){switch(c.label){case 0:if(!tn.isMatch())throw Error("wx api undefined");return o=wx.getAccountInfoSync().miniProgram,i={provider_params:{provider_code_type:"phone"},provider_id:o.appId},[4,wx.login()];case 1:a=c.sent().code,i.provider_code=a,c.label=2;case 2:return c.trys.push([2,6,,7]),[4,this.oauthInstance.authApi.grantProviderToken(i)];case 3:if(u=c.sent(),u.error_code)throw u;return[4,this.oauthInstance.authApi.patchProviderToken({provider_token:u.provider_token,provider_id:o.appId,provider_params:{code:n,provider_code_type:"phone"}})];case 4:if(u=c.sent(),u.error_code)throw u;return[4,this.oauthInstance.authApi.signInWithProvider({provider_token:u.provider_token})];case 5:if(l=c.sent(),l!=null&&l.error_code)throw l;return[3,7];case 6:throw s=c.sent(),s;case 7:return[2,this.createLoginState()]}})})},e.prototype.signInWithSms=function(t){var r=t.verificationInfo,n=r===void 0?{verification_id:"",is_user:!1}:r,o=t.verificationCode,i=o===void 0?"":o,a=t.phoneNum,u=a===void 0?"":a,l=t.bindInfo,s=l===void 0?void 0:l;return te(this,void 0,void 0,function(){return re(this,function(c){try{return[2,this.signInWithUsername({verificationInfo:n,verificationCode:i,bindInfo:s,username:u,loginType:"sms"})]}catch(f){throw f}return[2]})})},e.prototype.signInWithEmail=function(t){var r=t.verificationInfo,n=r===void 0?{verification_id:"",is_user:!1}:r,o=t.verificationCode,i=o===void 0?"":o,a=t.bindInfo,u=a===void 0?void 0:a,l=t.email,s=l===void 0?"":l;return te(this,void 0,void 0,function(){return re(this,function(c){try{return[2,this.signInWithUsername({verificationInfo:n,verificationCode:i,bindInfo:u,username:s,loginType:"email"})]}catch(f){throw f}return[2]})})},e.prototype.setCustomSignFunc=function(t){this.oauthInstance.authApi.setCustomSignFunc(t)},e.prototype.signInWithCustomTicket=function(){return te(this,void 0,void 0,function(){return re(this,function(t){switch(t.label){case 0:return[4,this.oauthInstance.authApi.signInWithCustomTicket()];case 1:return t.sent(),[2,this.createLoginState()]}})})},e.prototype.signIn=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.authApi.signIn(t)];case 1:return r.sent(),[2,this.createLoginState(t)]}})})},e.prototype.signUp=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.authApi.signUp(t)];case 1:return r.sent(),[2,this.createLoginState()]}})})},e.prototype.setPassword=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.setPassword(t)]})})},e.prototype.isUsernameRegistered=function(t){return te(this,void 0,void 0,function(){var r;return re(this,function(n){switch(n.label){case 0:return typeof t!="string"&&ku(Se.ERRORS.INVALID_PARAMS,"username must be a string"),[4,this.oauthInstance.authApi.checkIfUserExist({username:t})];case 1:return r=n.sent().exist,[2,r]}})})},e.prototype.signOut=function(t){return te(this,void 0,void 0,function(){var r,n;return re(this,function(o){switch(o.label){case 0:return r=this.cache.keys.userInfoKey,[4,this.oauthInstance.authApi.signOut(t)];case 1:return n=o.sent(),[4,this.cache.removeStoreAsync(r)];case 2:return o.sent(),_a.fire(ya.LOGIN_STATE_CHANGED,{eventType:ga.SIGN_OUT}),[2,n]}})})},e.prototype.hasLoginState=function(){var t;if(this.cache.mode==="async"){Ja(Se.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use getLoginState insteed");return}var r=(t=this.oauthInstance)===null||t===void 0?void 0:t.authApi.hasLoginStateSync();if(r){var n=new kc({envId:this.config.env,cache:this.cache,oauthInstance:this.oauthInstance});return n}return null},e.prototype.getLoginState=function(){return te(this,void 0,void 0,function(){var t,r;return re(this,function(n){switch(n.label){case 0:t=null,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.oauthInstance.authApi.getLoginState()];case 2:return t=n.sent(),[3,4];case 3:return n.sent(),[2,null];case 4:return t?(r=new kc({envId:this.config.env,cache:this.cache,oauthInstance:this.oauthInstance}),[2,r]):[2,null]}})})},e.prototype.getUserInfo=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.getUserInfo(t)]})})},e.prototype.getWedaUserInfo=function(){return te(this,void 0,void 0,function(){return re(this,function(t){return[2,this.oauthInstance.authApi.getWedaUserInfo()]})})},e.prototype.updateUserBasicInfo=function(t){return te(this,void 0,void 0,function(){var r;return re(this,function(n){switch(n.label){case 0:return[4,this.getLoginState()];case 1:return r=n.sent(),r?[4,r.user.updateUserBasicInfo(t)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.getAuthHeader=function(){return console.error("Auth.getAuthHeader API 已废弃"),{}},e.prototype.bindWithProvider=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.bindWithProvider(t)]})})},e.prototype.queryUser=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.queryUserProfile(t)]})})},e.prototype.getAccessToken=function(){return te(this,void 0,void 0,function(){var t;return re(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.oauth2client.getAccessToken()];case 1:return t=r.sent(),[2,{accessToken:t,env:this.config.env}]}})})},e.prototype.grantProviderToken=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.grantProviderToken(t)]})})},e.prototype.patchProviderToken=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.patchProviderToken(t)]})})},e.prototype.signInWithProvider=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.authApi.signInWithProvider(t)];case 1:return r.sent(),[2,this.createLoginState(t)]}})})},e.prototype.signInWithWechat=function(t){return t===void 0&&(t={}),te(this,void 0,void 0,function(){return re(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.authApi.signInWithWechat(t)];case 1:return r.sent(),[2,this.createLoginState(t)]}})})},e.prototype.grantToken=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.authApi.grantToken(t)];case 1:return r.sent(),[2,this.createLoginState()]}})})},e.prototype.genProviderRedirectUri=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.genProviderRedirectUri(t)]})})},e.prototype.resetPassword=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.resetPassword(t)]})})},e.prototype.deviceAuthorize=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.deviceAuthorize(t)]})})},e.prototype.sudo=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.sudo(t)]})})},e.prototype.deleteMe=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.deleteMe(t)]})})},e.prototype.getProviders=function(){return te(this,void 0,void 0,function(){return re(this,function(t){return[2,this.oauthInstance.authApi.getProviders()]})})},e.prototype.loginScope=function(){return te(this,void 0,void 0,function(){return re(this,function(t){return[2,this.oauthInstance.authApi.loginScope()]})})},e.prototype.loginGroups=function(){return te(this,void 0,void 0,function(){return re(this,function(t){return[2,this.oauthInstance.authApi.loginGroups()]})})},e.prototype.onLoginStateChanged=function(t){return te(this,void 0,void 0,function(){var r,n=this;return re(this,function(o){switch(o.label){case 0:return _a.on(ya.LOGIN_STATE_CHANGED,function(i){return te(n,void 0,void 0,function(){var a,u,l;return re(this,function(s){switch(s.label){case 0:return((l=i==null?void 0:i.data)===null||l===void 0?void 0:l.eventType)===ga.CREDENTIALS_ERROR?[3,2]:[4,this.getLoginState()];case 1:return u=s.sent(),[3,3];case 2:u={},s.label=3;case 3:return a=u,t.call(this,yt(yt({},i),a)),[2]}})})}),[4,this.getLoginState()];case 1:return r=o.sent(),t.call(this,r),[2]}})})},e.prototype.refreshTokenForce=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.refreshTokenForce(t)]})})},e.prototype.getCredentials=function(){return te(this,void 0,void 0,function(){return re(this,function(t){return[2,this.oauthInstance.authApi.getCredentials()]})})},e.prototype.setCredentials=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.oauth2client.setCredentials(t)];case 1:return r.sent(),[2]}})})},e.prototype.getProviderSubType=function(){return te(this,void 0,void 0,function(){return re(this,function(t){return[2,this.oauthInstance.authApi.getProviderSubType()]})})},e.prototype.createCaptchaData=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.createCaptchaData(t)]})})},e.prototype.verifyCaptchaData=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.verifyCaptchaData(t)]})})},e.prototype.getMiniProgramQrCode=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.getMiniProgramCode(t)]})})},e.prototype.getMiniProgramQrCodeStatus=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.getMiniProgramQrCodeStatus(t)]})})},e.prototype.modifyPassword=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.modifyPassword(t)]})})},e.prototype.modifyPasswordWithoutLogin=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.modifyPasswordWithoutLogin(t)]})})},e.prototype.getUserBehaviorLog=function(t){return te(this,void 0,void 0,function(){return re(this,function(r){return[2,this.oauthInstance.authApi.getUserBehaviorLog(t)]})})},e.prototype.toDefaultLoginPage=function(t){return t===void 0&&(t={}),te(this,void 0,void 0,function(){var r,n,o,i;return re(this,function(a){return r=t.config_version||"env",tn.isMatch()?wx.navigateTo({url:"/packages/$wd_system/pages/login/index"}):(n=t.redirect_uri||window.location.href,o=new URL(n),i="".concat(o.origin,"/__auth/?app_id=").concat(t.app_id||"","&env_id=").concat(this.config.env,"&client_id=").concat(this.config.clientId,"&config_version=").concat(r,"&redirect_uri=").concat(encodeURIComponent(n)),window.location.href=i),[2]})})},e.prototype.createLoginState=function(t,r){return te(this,void 0,void 0,function(){var n;return re(this,function(o){switch(o.label){case 0:return n=new kc({envId:this.config.env,cache:this.cache,oauthInstance:this.oauthInstance}),[4,n.checkLocalStateAsync()];case 1:return o.sent(),r!=null&&r.asyncRefreshUser?(n.user.refresh(t),[3,4]):[3,2];case 2:return[4,n.user.refresh(t)];case 3:o.sent(),o.label=4;case 4:return _a.fire(ya.LOGIN_STATE_CHANGED,{eventType:ga.SIGN_IN}),[2,n]}})})},e.prototype.signInWithUsername=function(t){var r=t.verificationInfo,n=r===void 0?{verification_id:"",is_user:!1}:r,o=t.verificationCode,i=o===void 0?"":o,a=t.username,u=a===void 0?"":a,l=t.bindInfo,s=l===void 0?void 0:l,c=t.loginType,f=c===void 0?"":c;return te(this,void 0,void 0,function(){var d,v,g,b,y,w,E,A;return re(this,function(I){switch(I.label){case 0:return I.trys.push([0,8,,9]),[4,this.oauthInstance.authApi.verify({verification_id:n.verification_id,verification_code:i})];case 1:if(d=I.sent(),d!=null&&d.error_code)throw d;return v=d.verification_token,g="+86 ".concat(u),b={phone_number:g},f==="email"&&(g=u,b={email:g}),n.is_user?[4,this.oauthInstance.authApi.signIn({username:g,verification_token:v})]:[3,5];case 2:if(y=I.sent(),y!=null&&y.error_code)throw y;return s?[4,this.oauthInstance.authApi.bindWithProvider({provider_token:s==null?void 0:s.providerToken})]:[3,4];case 3:if(w=I.sent(),w!=null&&w.error_code)throw w;I.label=4;case 4:return[3,7];case 5:return[4,this.oauthInstance.authApi.signUp(yt(yt({},b),{verification_token:v,provider_token:s==null?void 0:s.providerId}))];case 6:if(E=I.sent(),E!=null&&E.error_code)throw E;I.label=7;case 7:return[2,this.createLoginState()];case 8:throw A=I.sent(),A;case 9:return[2]}})})},Ue([De.catchErrorsDecorator({title:"绑定手机号失败",messages:["请确认以下各项：","  1 - 调用 auth().bindPhoneNumber() 的语法或参数是否正确","  2 - 当前环境是否开通了短信验证码登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",Promise)],e.prototype,"bindPhoneNumber",null),Ue([De.catchErrorsDecorator({title:"解除三方绑定失败",messages:["请确认以下各项：","  1 - 调用 auth().unbindProvider() 的语法或参数是否正确","  2 - 当前账户是否已经与此登录方式解绑","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",Promise)],e.prototype,"unbindProvider",null),Ue([De.catchErrorsDecorator({title:"绑定邮箱地址失败",messages:["请确认以下各项：","  1 - 调用 auth().bindEmail() 的语法或参数是否正确","  2 - 当前环境是否开通了邮箱密码登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",void 0)],e.prototype,"bindEmail",null),Ue([De.catchErrorsDecorator({title:"验证码验证失败",messages:["请确认以下各项：","  1 - 调用 auth().verify() 的语法或参数是否正确","  2 - 当前环境是否开通了手机验证码/邮箱登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",Promise)],e.prototype,"verify",null),Ue([De.catchErrorsDecorator({title:"获取验证码失败",messages:["请确认以下各项：","  1 - 调用 auth().getVerification() 的语法或参数是否正确","  2 - 当前环境是否开通了手机验证码/邮箱登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[Object,Object]),Y("design:returntype",Promise)],e.prototype,"getVerification",null),Ue([De.catchErrorsDecorator({title:"获取用户信息失败",messages:["请确认以下各项：","  1 - 调用 auth().getCurrentUser() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"getCurrentUser",null),Ue([De.catchErrorsDecorator({title:"匿名登录失败",messages:["请确认以下各项：","  1 - 当前环境是否开启了匿名登录","  2 - 调用 auth().signInAnonymously() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",Promise)],e.prototype,"signInAnonymously",null),Ue([De.catchErrorsDecorator({title:"小程序匿名登录失败",messages:["请确认以下各项：","  1 - 当前环境是否开启了匿名登录","  2 - 调用 auth().signInAnonymouslyInWx() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",Promise)],e.prototype,"signInAnonymouslyInWx",null),Ue([De.catchErrorsDecorator({title:"小程序绑定OpenID失败",messages:["请确认以下各项：","  1 - 当前环境是否开启了小程序openId静默登录","  2 - 调用 auth().bindOpenId() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"bindOpenId",null),Ue([De.catchErrorsDecorator({title:"小程序openId静默登录失败",messages:["请确认以下各项：","  1 - 当前环境是否开启了小程序openId静默登录","  2 - 调用 auth().signInWithOpenId() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",Promise)],e.prototype,"signInWithOpenId",null),Ue([De.catchErrorsDecorator({title:"小程序unionId静默登录失败",messages:["请确认以下各项：","  1 - 当前环境是否开启了小程序unionId静默登录","  2 - 调用 auth().signInWithUnionId() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"signInWithUnionId",null),Ue([De.catchErrorsDecorator({title:"小程序手机号授权登录失败",messages:["请确认以下各项：","  1 - 当前环境是否开启了小程序手机号授权登录","  2 - 调用 auth().signInWithPhoneAuth() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",Promise)],e.prototype,"signInWithPhoneAuth",null),Ue([De.catchErrorsDecorator({title:"短信验证码登陆",messages:["请确认以下各项：","  1 - 当前环境是否开启了小程序短信验证码登陆","  2 - 调用 auth().signInWithSms() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",Promise)],e.prototype,"signInWithSms",null),Ue([De.catchErrorsDecorator({title:"邮箱验证码登陆",messages:["请确认以下各项：","  1 - 当前环境是否开启了邮箱登陆","  2 - 调用 auth().signInWithEmail() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",Promise)],e.prototype,"signInWithEmail",null),Ue([De.catchErrorsDecorator({title:"自定义登录失败",messages:["请确认以下各项：","  1 - 当前环境是否开启了自定义登录","  2 - 调用 auth().signInWithCustomTicket() 的语法或参数是否正确","  3 - ticket 是否归属于当前环境","  4 - 创建 ticket 的自定义登录私钥是否过期","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"signInWithCustomTicket",null),Ue([De.catchErrorsDecorator({title:"注册失败",messages:["请确认以下各项：","  1 - 当前环境是否开启了指定登录方式","  2 - 调用 auth().signUp() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",Promise)],e.prototype,"signUp",null),Ue([De.catchErrorsDecorator({title:"获取用户是否被占用失败",messages:["请确认以下各项：","  1 - 调用 auth().isUsernameRegistered() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[String]),Y("design:returntype",Promise)],e.prototype,"isUsernameRegistered",null),Ue([De.catchErrorsDecorator({title:"用户登出失败",messages:["请确认以下各项：","  1 - 调用 auth().signOut() 的语法或参数是否正确","  2 - 当前用户是否为匿名登录（匿名登录不支持signOut）","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",Promise)],e.prototype,"signOut",null),Ue([De.catchErrorsDecorator({title:"获取本地登录态失败",messages:["请确认以下各项：","  1 - 调用 auth().getLoginState() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"getLoginState",null),Ue([De.catchErrorsDecorator({title:"获取用户信息失败",messages:["请确认以下各项：","  1 - 是否已登录","  2 - 调用 auth().getUserInfo() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",Promise)],e.prototype,"getUserInfo",null),Ue([De.catchErrorsDecorator({title:"获取微搭插件用户信息失败",messages:["请确认以下各项：","  1 - 是否已登录","  2 - 调用 auth().getWedaUserInfo() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"getWedaUserInfo",null),Ue([De.catchErrorsDecorator({title:"绑定第三方登录方式失败",messages:["请确认以下各项：","  1 - 调用 auth().bindWithProvider() 的语法或参数是否正确","  2 - 此账户是否已经绑定此第三方","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",Promise)],e.prototype,"bindWithProvider",null),Ue([De.catchErrorsDecorator({title:"获取身份源类型",messages:["请确认以下各项：","  1 - 调用 auth().getProviderSubType() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Se.COMMUNITY_SITE_URL)]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"getProviderSubType",null),e}();function TO(e,t){var r=e.region,n=r===void 0?"ap-shanghai":r,o=e.i18n,i=e.publishable_key,a=(t==null?void 0:t.platform)||u0.useDefaultAdapter(),u=a.runtime,l=a.adapter,s=t||{},c=s.env,f=s.clientId,d=s.debug,v=s.cache,g=s.app,b=(t||{}).apiOrigin;b||(b="https://".concat(c,".").concat(n,".tcb-api.tencentcloudapi.com"));var y={env:c,clientId:f,i18n:o,publishable_key:i},w=new II(wO(yt(yt({},y),{apiOrigin:b,apiPath:(e==null?void 0:e.apiPath)||Bu,storage:e==null?void 0:e.storage,baseRequest:e==null?void 0:e.baseRequest,request:e==null?void 0:e.request,anonymousSignInFunc:e==null?void 0:e.anonymousSignInFunc,captchaOptions:e==null?void 0:e.captchaOptions,wxCloud:e==null?void 0:e.wxCloud,adapter:l,onCredentialsError:SO,headers:e.headers||{}}))),E=new OO(yt(yt({},y),{region:n,persistence:e.persistence,debug:d,cache:v||new a0({persistence:e.persistence,keys:{userInfoKey:"user_info_".concat(c)},platformInfo:a}),runtime:u||"web",_fromApp:g,oauthInstance:w}));return{authInstance:E,oauthInstance:w}}var d0={name:EO,namespace:"auth",entity:function(e){if(e===void 0&&(e={region:"",persistence:"local",apiPath:Bu}),this.authInstance)return Ja(Se.ERRORS.INVALID_OPERATION,"every cloudbase instance should has only one auth object"),this.authInstance;var t=this.platform.adapter,r=e.persistence||t.primaryStorage;r&&r!==this.config.persistence&&this.updateConfig({persistence:r});var n=TO(yt(yt({wxCloud:this.config.wxCloud,storage:this.config.storage},e),{persistence:this.config.persistence,i18n:this.config.i18n,publishable_key:this.config.publishable_key}),{env:this.config.env,clientId:this.config.clientId,apiOrigin:this.request.getBaseEndPoint(),platform:this.platform,cache:this.cache,app:this,debug:this.config.debug}),o=n.authInstance,i=n.oauthInstance;return this.oauthInstance=i,this.authInstance=o,this.authInstance}};try{cloudbase.registerComponent(d0)}catch{}function AO(e){try{e.registerComponent(d0)}catch(t){console.warn(t)}}var Ya=function(){return Ya=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ya.apply(this,arguments)},h0=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},p0=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},up=kt,Dl="cloudrun",RO=function(){function e(){}return e.prototype.callContainer=function(t){return h0(this,void 0,void 0,function(){var r,n,o;return p0(this,function(i){switch(i.label){case 0:if(r=t.name,n=t.data,!r)throw new Error(JSON.stringify({code:up.INVALID_PARAMS,msg:"[".concat(Dl,".callContainer] invalid name")}));try{o=n?JSON.stringify(n):""}catch{throw new Error(JSON.stringify({code:up.INVALID_PARAMS,msg:"[".concat(Dl,".callContainer] invalid data")}))}return[4,v0.call(this,Ya(Ya({},t),{data:o}))];case 1:return[2,i.sent()]}})})},e}();function v0(e){return h0(this,void 0,void 0,function(){var t,r,n,o,i,a,u,l,s,c;return p0(this,function(f){switch(f.label){case 0:return t=e.name,r=e.data,n=e.path,o=n===void 0?"":n,i=e.method,a=e.header,u=a===void 0?{}:a,l="https://".concat(this.config.env,".api.tcloudbasegateway.com/v1/cloudrun/").concat(t),s=o.startsWith("/")?o:"/".concat(o),[4,this.request.fetch({method:i||"POST",headers:Object.assign({},{"Content-Type":"application/json; charset=utf-8"},u),body:r,url:"".concat(l).concat(s)})];case 1:return c=f.sent(),[4,c.data];case 2:return[2,f.sent()]}})})}var CO=new RO,m0={name:Dl,entity:{callContainer:CO.callContainer}};try{cloudbase.registerComponent(m0)}catch{}function xO(e){try{e.registerComponent(m0)}catch(t){console.warn(t)}}var Qa=function(){return Qa=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Qa.apply(this,arguments)},PO=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(a=e[u])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},qc=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},NO=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},$O=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},DO=Cu,Wc=kt,LO=xu,Oo=Fg,UO=$u,ba="functions",FO=function(){function e(){}return e.prototype.callFunction=function(t,r){var n,o;return NO(this,void 0,void 0,function(){var i,a,u,l,s,c,f,d,v,g,b,y,w,L,E,A,I,R,L,F;return $O(this,function(U){switch(U.label){case 0:if(i=t.name,a=t.data,u=t.query,l=t.parse,s=t.search,c=t.type,f=t.path,d=f===void 0?"":f,v=t.method,g=t.header,b=g===void 0?{}:g,!i)throw new Error(JSON.stringify({code:Wc.INVALID_PARAMS,msg:"[".concat(ba,".callFunction] invalid function name")}));try{y=a?JSON.stringify(a):""}catch{throw new Error(JSON.stringify({code:Wc.INVALID_PARAMS,msg:"[".concat(ba,".callFunction] invalid data")}))}return c!=="cloudrun"?[3,2]:(w=PE(),[4,v0.call(this,{name:i,data:y,path:d,method:v,header:Qa(Qa({},b),{"X-Request-Id":w})})]);case 1:return L=U.sent(),[2,{result:L,requestId:w}];case 2:E="functions.invokeFunction",A={inQuery:u,parse:l,search:s,function_name:i,request_data:y},I=this.request,U.label=3;case 3:return U.trys.push([3,5,,6]),[4,I.send(E,A,{defaultQuery:!((n=a==null?void 0:a.params)===null||n===void 0)&&n.action?{action:(o=a==null?void 0:a.params)===null||o===void 0?void 0:o.action}:{}})];case 4:if(R=U.sent(),R.code)return[2,Oo(r,null,R)];if(L=R.data.response_data,l)return[2,Oo(r,null,{result:L,requestId:R.requestId})];try{return L=JSON.parse(R.data.response_data),[2,Oo(r,null,{result:L,requestId:R.requestId})]}catch{Oo(r,new Error("[".concat(DO(),"][").concat(Wc.INVALID_PARAMS,"][").concat(ba,".callFunction] response data must be json")))}return[3,6];case 5:return F=U.sent(),Oo(r,F),[3,6];case 6:return[2]}})})},PO([UO({customInfo:{},title:"函数调用失败",messages:["请确认以下各项：","  1 - 调用 callFunction() 的语法或参数是否正确","  2 - 当前环境下是否存在此函数","  3 - 函数安全规则是否限制了当前登录状态访问","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(LO)]}),qc("design:type",Function),qc("design:paramtypes",[Object,Function]),qc("design:returntype",Promise)],e.prototype,"callFunction",null),e}(),MO=new FO,g0={name:ba,entity:{callFunction:MO.callFunction}};try{cloudbase.registerComponent(g0)}catch{}function BO(e){try{e.registerComponent(g0)}catch(t){console.warn(t)}}var On=function(){return On=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},On.apply(this,arguments)},To=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(a=e[u])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},wt=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},Ao=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Ro=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Dr;(function(e){e.put="put",e.post="post"})(Dr||(Dr={}));var jO=Cu,Qr=kt,Co=xu,cp=$g,xo=Dg,kO=RE,Cr=Fg,Po=$u,Nr="storage",qO=function(){function e(){}return e.prototype.uploadFile=function(t,r){return Ao(this,void 0,void 0,function(){var n,o,i,a,u,l,s,c,f,d,v,g,b,y,w,E,A,I,R,L,F,U,N,W,j,X;return Ro(this,function(fe){switch(fe.label){case 0:if(n=t.cloudPath,o=t.filePath,i=t.onUploadProgress,a=t.method,u=a===void 0?"put":a,l=t.headers,s=l===void 0?{}:l,!xo(n)||!o)throw new Error(JSON.stringify({code:Qr.INVALID_PARAMS,msg:"[".concat(Nr,".uploadFile] invalid params")}));return c={put:Dr.put,post:Dr.post}[u.toLocaleLowerCase()]||Dr.put,f="storage.getUploadMetadata",d=this.request,v={path:n,method:c},c===Dr.put&&(v.headers=s),[4,d.send(f,v)];case 1:return g=fe.sent(),b=g.data,y=b.url,w=b.authorization,E=b.token,A=b.fileId,I=b.cosFileId,R=b.download_url,L=g.requestId,F={url:y,file:o,name:n,onUploadProgress:i},U=On(On({},F),{method:Dr.put,headers:On(On({},s),{authorization:w,"x-cos-meta-fileid":I,"x-cos-security-token":E})}),N=On(On({},F),{method:Dr.post,data:{key:n,signature:w,"x-cos-meta-fileid":I,success_action_status:"201","x-cos-security-token":E}}),W=(X={},X[Dr.put]={params:U,isSuccess:function(q){return q>=200&&q<300}},X[Dr.post]={params:N,isSuccess:function(q){return q===201}},X),[4,d.upload(W[c].params)];case 2:return j=fe.sent(),W[c].isSuccess(j.statusCode)?[2,Cr(r,null,{fileID:A,download_url:R,requestId:L})]:[2,Cr(r,new Error("[".concat(jO(),"][").concat(Qr.OPERATION_FAIL,"][").concat(Nr,"]:").concat(j.data)))]}})})},e.prototype.getUploadMetadata=function(t,r){return Ao(this,void 0,void 0,function(){var n,o,i,a,u;return Ro(this,function(l){switch(l.label){case 0:if(n=t.cloudPath,!xo(n))throw new Error(JSON.stringify({code:Qr.INVALID_PARAMS,msg:"[".concat(Nr,".getUploadMetadata] invalid cloudPath")}));o=this.request,i="storage.getUploadMetadata",l.label=1;case 1:return l.trys.push([1,3,,4]),[4,o.send(i,{path:n})];case 2:return a=l.sent(),[2,Cr(r,null,a)];case 3:return u=l.sent(),[2,Cr(r,u)];case 4:return[2]}})})},e.prototype.deleteFile=function(t,r){return Ao(this,void 0,void 0,function(){var n,o,i,a,u,l,s,c;return Ro(this,function(f){switch(f.label){case 0:if(n=t.fileList,!n||!cp(n)||n.length===0)throw new Error(JSON.stringify({code:Qr.INVALID_PARAMS,msg:"[".concat(Nr,".deleteFile] fileList must not be empty")}));for(o=0,i=n;o<i.length;o++)if(a=i[o],!a||!xo(a))throw new Error(JSON.stringify({code:Qr.INVALID_PARAMS,msg:"[".concat(Nr,".deleteFile] fileID must be string")}));return u="storage.batchDeleteFile",l=this.request,[4,l.send(u,{fileid_list:n})];case 1:return s=f.sent(),s.code?[2,Cr(r,null,s)]:(c={fileList:s.data.delete_list,requestId:s.requestId},[2,Cr(r,null,c)])}})})},e.prototype.getTempFileURL=function(t,r){return Ao(this,void 0,void 0,function(){var n,o,i,a,u,l,s,c;return Ro(this,function(f){switch(f.label){case 0:if(n=t.fileList,!n||!cp(n)||n.length===0)throw new Error(JSON.stringify({code:Qr.INVALID_PARAMS,msg:"[".concat(Nr,".getTempFileURL] fileList must not be empty")}));for(o=[],i=0,a=n;i<a.length;i++)if(u=a[i],kO(u)){if(!Object.prototype.hasOwnProperty.call(u,"fileID")||!Object.prototype.hasOwnProperty.call(u,"maxAge"))throw new Error(JSON.stringify({code:Qr.INVALID_PARAMS,msg:"[".concat(Nr,".getTempFileURL] file info must include fileID and maxAge")}));o.push({fileid:u.fileID,max_age:u.maxAge})}else if(xo(u))o.push({fileid:u});else throw new Error(JSON.stringify({code:Qr.INVALID_PARAMS,msg:"[".concat(Nr,".getTempFileURL] invalid fileList")}));return l="storage.batchGetDownloadUrl",s=this.request,[4,s.send(l,{file_list:o})];case 1:return c=f.sent(),c.code?[2,Cr(r,null,c)]:[2,Cr(r,null,{fileList:c.data.download_list,requestId:c.requestId})]}})})},e.prototype.downloadFile=function(t,r){return Ao(this,void 0,void 0,function(){var n,o,i,a,u,l;return Ro(this,function(s){switch(s.label){case 0:if(n=t.fileID,!xo(n))throw new Error(JSON.stringify({code:Qr.INVALID_PARAMS,msg:"[".concat(Nr,".getTempFileURL] fileID must be string")}));return[4,this.getTempFileURL.call(this,{fileList:[{fileID:n,maxAge:600}]})];case 1:return o=s.sent(),i=o.fileList[0],i.code!=="SUCCESS"?[2,Cr(r,i)]:(a=this.request,u=encodeURI(i.download_url),[4,a.download({url:u})]);case 2:return l=s.sent(),[2,Cr(r,null,l)]}})})},To([Po({customInfo:{},title:"上传文件失败",messages:["请确认以下各项：","  1 - 调用 uploadFile() 的语法或参数是否正确","  2 - 当前域名是否在安全域名列表中：https://console.cloud.tencent.com/tcb/env/safety","  3 - 云存储安全规则是否限制了当前登录状态访问","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Co)]}),wt("design:type",Function),wt("design:paramtypes",[Object,Function]),wt("design:returntype",Promise)],e.prototype,"uploadFile",null),To([Po({customInfo:{},title:"获取上传元信息失败",messages:["请确认以下各项：","  1 - 调用 getUploadMetadata() 的语法或参数是否正确","  2 - 当前域名是否在安全域名列表中：https://console.cloud.tencent.com/tcb/env/safety","  3 - 云存储安全规则是否限制了当前登录状态访问","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Co)]}),wt("design:type",Function),wt("design:paramtypes",[Object,Function]),wt("design:returntype",Promise)],e.prototype,"getUploadMetadata",null),To([Po({customInfo:{},title:"删除文件失败",messages:["请确认以下各项：","  1 - 调用 deleteFile() 的语法或参数是否正确","  2 - 当前域名是否在安全域名列表中：https://console.cloud.tencent.com/tcb/env/safety","  3 - 云存储安全规则是否限制了当前登录状态访问","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Co)]}),wt("design:type",Function),wt("design:paramtypes",[Object,Function]),wt("design:returntype",Promise)],e.prototype,"deleteFile",null),To([Po({customInfo:{},title:"获取文件下载链接",messages:["请确认以下各项：","  1 - 调用 getTempFileURL() 的语法或参数是否正确","  2 - 当前域名是否在安全域名列表中：https://console.cloud.tencent.com/tcb/env/safety","  3 - 云存储安全规则是否限制了当前登录状态访问","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Co)]}),wt("design:type",Function),wt("design:paramtypes",[Object,Function]),wt("design:returntype",Promise)],e.prototype,"getTempFileURL",null),To([Po({customInfo:{},title:"下载文件失败",messages:["请确认以下各项：","  1 - 调用 downloadFile() 的语法或参数是否正确","  2 - 当前域名是否在安全域名列表中：https://console.cloud.tencent.com/tcb/env/safety","  3 - 云存储安全规则是否限制了当前登录状态访问","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Co)]}),wt("design:type",Function),wt("design:paramtypes",[Object,Function]),wt("design:returntype",Promise)],e.prototype,"downloadFile",null),e}(),No=new qO,y0={name:Nr,entity:{uploadFile:No.uploadFile,deleteFile:No.deleteFile,getTempFileURL:No.getTempFileURL,downloadFile:No.downloadFile,getUploadMetadata:No.getUploadMetadata}};try{cloudbase.registerComponent(y0)}catch{}function WO(e){try{e.registerComponent(y0)}catch(t){console.warn(t)}}var HO=typeof be=="object"&&be&&be.Object===Object&&be,_0=HO,GO=_0,VO=typeof self=="object"&&self&&self.Object===Object&&self,KO=GO||VO||Function("return this")(),Vr=KO,zO=Vr,JO=zO.Symbol,Wu=JO,lp=Wu,b0=Object.prototype,YO=b0.hasOwnProperty,QO=b0.toString,$o=lp?lp.toStringTag:void 0;function XO(e){var t=YO.call(e,$o),r=e[$o];try{e[$o]=void 0;var n=!0}catch{}var o=QO.call(e);return n&&(t?e[$o]=r:delete e[$o]),o}var ZO=XO,eT=Object.prototype,tT=eT.toString;function rT(e){return tT.call(e)}var nT=rT,fp=Wu,iT=ZO,oT=nT,sT="[object Null]",aT="[object Undefined]",dp=fp?fp.toStringTag:void 0;function uT(e){return e==null?e===void 0?aT:sT:dp&&dp in Object(e)?iT(e):oT(e)}var Ds=uT;function cT(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var uo=cT,lT=Ds,fT=uo,dT="[object AsyncFunction]",hT="[object Function]",pT="[object GeneratorFunction]",vT="[object Proxy]";function mT(e){if(!fT(e))return!1;var t=lT(e);return t==hT||t==pT||t==dT||t==vT}var w0=mT,gT=Vr,yT=gT["__core-js_shared__"],_T=yT,Hc=_T,hp=function(){var e=/[^.]+$/.exec(Hc&&Hc.keys&&Hc.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function bT(e){return!!hp&&hp in e}var wT=bT,ET=Function.prototype,ST=ET.toString;function IT(e){if(e!=null){try{return ST.call(e)}catch{}try{return e+""}catch{}}return""}var E0=IT,OT=w0,TT=wT,AT=uo,RT=E0,CT=/[\\^$.*+?()[\]{}|]/g,xT=/^\[object .+?Constructor\]$/,PT=Function.prototype,NT=Object.prototype,$T=PT.toString,DT=NT.hasOwnProperty,LT=RegExp("^"+$T.call(DT).replace(CT,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function UT(e){if(!AT(e)||TT(e))return!1;var t=OT(e)?LT:xT;return t.test(RT(e))}var FT=UT;function MT(e,t){return e==null?void 0:e[t]}var BT=MT,jT=FT,kT=BT;function qT(e,t){var r=kT(e,t);return jT(r)?r:void 0}var Ei=qT,WT=Ei,HT=function(){try{var e=WT(Object,"defineProperty");return e({},"",{}),e}catch{}}(),GT=HT,pp=GT;function VT(e,t,r){t=="__proto__"&&pp?pp(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var S0=VT;function KT(e,t){return e===t||e!==e&&t!==t}var I0=KT,zT=S0,JT=I0,YT=Object.prototype,QT=YT.hasOwnProperty;function XT(e,t,r){var n=e[t];(!(QT.call(e,t)&&JT(n,r))||r===void 0&&!(t in e))&&zT(e,t,r)}var Jf=XT,ZT=Array.isArray,co=ZT;function eA(e){return e!=null&&typeof e=="object"}var lo=eA,tA=Ds,rA=lo,nA="[object Symbol]";function iA(e){return typeof e=="symbol"||rA(e)&&tA(e)==nA}var Yf=iA,oA=co,sA=Yf,aA=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,uA=/^\w*$/;function cA(e,t){if(oA(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||sA(e)?!0:uA.test(e)||!aA.test(e)||t!=null&&e in Object(t)}var lA=cA,fA=Ei,dA=fA(Object,"create"),Hu=dA,vp=Hu;function hA(){this.__data__=vp?vp(null):{},this.size=0}var pA=hA;function vA(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var mA=vA,gA=Hu,yA="__lodash_hash_undefined__",_A=Object.prototype,bA=_A.hasOwnProperty;function wA(e){var t=this.__data__;if(gA){var r=t[e];return r===yA?void 0:r}return bA.call(t,e)?t[e]:void 0}var EA=wA,SA=Hu,IA=Object.prototype,OA=IA.hasOwnProperty;function TA(e){var t=this.__data__;return SA?t[e]!==void 0:OA.call(t,e)}var AA=TA,RA=Hu,CA="__lodash_hash_undefined__";function xA(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=RA&&t===void 0?CA:t,this}var PA=xA,NA=pA,$A=mA,DA=EA,LA=AA,UA=PA;function fo(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}fo.prototype.clear=NA;fo.prototype.delete=$A;fo.prototype.get=DA;fo.prototype.has=LA;fo.prototype.set=UA;var FA=fo;function MA(){this.__data__=[],this.size=0}var BA=MA,jA=I0;function kA(e,t){for(var r=e.length;r--;)if(jA(e[r][0],t))return r;return-1}var Gu=kA,qA=Gu,WA=Array.prototype,HA=WA.splice;function GA(e){var t=this.__data__,r=qA(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():HA.call(t,r,1),--this.size,!0}var VA=GA,KA=Gu;function zA(e){var t=this.__data__,r=KA(t,e);return r<0?void 0:t[r][1]}var JA=zA,YA=Gu;function QA(e){return YA(this.__data__,e)>-1}var XA=QA,ZA=Gu;function eR(e,t){var r=this.__data__,n=ZA(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var tR=eR,rR=BA,nR=VA,iR=JA,oR=XA,sR=tR;function ho(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ho.prototype.clear=rR;ho.prototype.delete=nR;ho.prototype.get=iR;ho.prototype.has=oR;ho.prototype.set=sR;var Vu=ho,aR=Ei,uR=Vr,cR=aR(uR,"Map"),Qf=cR,mp=FA,lR=Vu,fR=Qf;function dR(){this.size=0,this.__data__={hash:new mp,map:new(fR||lR),string:new mp}}var hR=dR;function pR(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var vR=pR,mR=vR;function gR(e,t){var r=e.__data__;return mR(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Ku=gR,yR=Ku;function _R(e){var t=yR(this,e).delete(e);return this.size-=t?1:0,t}var bR=_R,wR=Ku;function ER(e){return wR(this,e).get(e)}var SR=ER,IR=Ku;function OR(e){return IR(this,e).has(e)}var TR=OR,AR=Ku;function RR(e,t){var r=AR(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var CR=RR,xR=hR,PR=bR,NR=SR,$R=TR,DR=CR;function po(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}po.prototype.clear=xR;po.prototype.delete=PR;po.prototype.get=NR;po.prototype.has=$R;po.prototype.set=DR;var O0=po,T0=O0,LR="Expected a function";function Xf(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(LR);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(Xf.Cache||T0),r}Xf.Cache=T0;var UR=Xf,FR=UR,MR=500;function BR(e){var t=FR(e,function(n){return r.size===MR&&r.clear(),n}),r=t.cache;return t}var jR=BR,kR=jR,qR=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,WR=/\\(\\)?/g,HR=kR(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(qR,function(r,n,o,i){t.push(o?i.replace(WR,"$1"):n||r)}),t}),GR=HR;function VR(e,t){for(var r=-1,n=e==null?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}var KR=VR,gp=Wu,zR=KR,JR=co,YR=Yf,yp=gp?gp.prototype:void 0,_p=yp?yp.toString:void 0;function A0(e){if(typeof e=="string")return e;if(JR(e))return zR(e,A0)+"";if(YR(e))return _p?_p.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var QR=A0,XR=QR;function ZR(e){return e==null?"":XR(e)}var eC=ZR,tC=co,rC=lA,nC=GR,iC=eC;function oC(e,t){return tC(e)?e:rC(e,t)?[e]:nC(iC(e))}var Zf=oC,sC=9007199254740991,aC=/^(?:0|[1-9]\d*)$/;function uC(e,t){var r=typeof e;return t=t??sC,!!t&&(r=="number"||r!="symbol"&&aC.test(e))&&e>-1&&e%1==0&&e<t}var R0=uC,cC=Yf;function lC(e){if(typeof e=="string"||cC(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var ed=lC,fC=Jf,dC=Zf,hC=R0,bp=uo,pC=ed;function vC(e,t,r,n){if(!bp(e))return e;t=dC(t,e);for(var o=-1,i=t.length,a=i-1,u=e;u!=null&&++o<i;){var l=pC(t[o]),s=r;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(o!=a){var c=u[l];s=n?n(c,l,u):void 0,s===void 0&&(s=bp(c)?c:hC(t[o+1])?[]:{})}fC(u,l,s),u=u[l]}return e}var mC=vC,gC=mC;function yC(e,t,r){return e==null?e:gC(e,t,r)}var _C=yC;const bC=Hf(_C);function wC(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var EC=wC,SC=Zf,IC=ed;function OC(e,t){t=SC(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[IC(t[r++])];return r&&r==n?e:void 0}var TC=OC;function AC(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),r=r>o?o:r,r<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(o);++n<o;)i[n]=e[n+t];return i}var RC=AC,CC=TC,xC=RC;function PC(e,t){return t.length<2?e:CC(e,xC(t,0,-1))}var NC=PC,$C=Zf,DC=EC,LC=NC,UC=ed;function FC(e,t){return t=$C(t,e),e=LC(e,t),e==null||delete e[UC(DC(t))]}var MC=FC,BC=MC;function jC(e,t){return e==null?!0:BC(e,t)}var kC=jC;const qC=Hf(kC);var WC=Vu;function HC(){this.__data__=new WC,this.size=0}var GC=HC;function VC(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var KC=VC;function zC(e){return this.__data__.get(e)}var JC=zC;function YC(e){return this.__data__.has(e)}var QC=YC,XC=Vu,ZC=Qf,ex=O0,tx=200;function rx(e,t){var r=this.__data__;if(r instanceof XC){var n=r.__data__;if(!ZC||n.length<tx-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new ex(n)}return r.set(e,t),this.size=r.size,this}var nx=rx,ix=Vu,ox=GC,sx=KC,ax=JC,ux=QC,cx=nx;function vo(e){var t=this.__data__=new ix(e);this.size=t.size}vo.prototype.clear=ox;vo.prototype.delete=sx;vo.prototype.get=ax;vo.prototype.has=ux;vo.prototype.set=cx;var lx=vo;function fx(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var dx=fx,hx=Jf,px=S0;function vx(e,t,r,n){var o=!r;r||(r={});for(var i=-1,a=t.length;++i<a;){var u=t[i],l=n?n(r[u],e[u],u,r,e):void 0;l===void 0&&(l=e[u]),o?px(r,u,l):hx(r,u,l)}return r}var zu=vx;function mx(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var gx=mx,yx=Ds,_x=lo,bx="[object Arguments]";function Ex(e){return _x(e)&&yx(e)==bx}var Sx=Ex,wp=Sx,Ix=lo,C0=Object.prototype,Ox=C0.hasOwnProperty,Tx=C0.propertyIsEnumerable,Ax=wp(function(){return arguments}())?wp:function(e){return Ix(e)&&Ox.call(e,"callee")&&!Tx.call(e,"callee")},Rx=Ax,Xa={exports:{}};function Cx(){return!1}var xx=Cx;Xa.exports;(function(e,t){var r=Vr,n=xx,o=t&&!t.nodeType&&t,i=o&&!0&&e&&!e.nodeType&&e,a=i&&i.exports===o,u=a?r.Buffer:void 0,l=u?u.isBuffer:void 0,s=l||n;e.exports=s})(Xa,Xa.exports);var x0=Xa.exports,Px=9007199254740991;function Nx(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Px}var P0=Nx,$x=Ds,Dx=P0,Lx=lo,Ux="[object Arguments]",Fx="[object Array]",Mx="[object Boolean]",Bx="[object Date]",jx="[object Error]",kx="[object Function]",qx="[object Map]",Wx="[object Number]",Hx="[object Object]",Gx="[object RegExp]",Vx="[object Set]",Kx="[object String]",zx="[object WeakMap]",Jx="[object ArrayBuffer]",Yx="[object DataView]",Qx="[object Float32Array]",Xx="[object Float64Array]",Zx="[object Int8Array]",e2="[object Int16Array]",t2="[object Int32Array]",r2="[object Uint8Array]",n2="[object Uint8ClampedArray]",i2="[object Uint16Array]",o2="[object Uint32Array]",He={};He[Qx]=He[Xx]=He[Zx]=He[e2]=He[t2]=He[r2]=He[n2]=He[i2]=He[o2]=!0;He[Ux]=He[Fx]=He[Jx]=He[Mx]=He[Yx]=He[Bx]=He[jx]=He[kx]=He[qx]=He[Wx]=He[Hx]=He[Gx]=He[Vx]=He[Kx]=He[zx]=!1;function s2(e){return Lx(e)&&Dx(e.length)&&!!He[$x(e)]}var a2=s2;function u2(e){return function(t){return e(t)}}var td=u2,Za={exports:{}};Za.exports;(function(e,t){var r=_0,n=t&&!t.nodeType&&t,o=n&&!0&&e&&!e.nodeType&&e,i=o&&o.exports===n,a=i&&r.process,u=function(){try{var l=o&&o.require&&o.require("util").types;return l||a&&a.binding&&a.binding("util")}catch{}}();e.exports=u})(Za,Za.exports);var rd=Za.exports,c2=a2,l2=td,Ep=rd,Sp=Ep&&Ep.isTypedArray,f2=Sp?l2(Sp):c2,d2=f2,h2=gx,p2=Rx,v2=co,m2=x0,g2=R0,y2=d2,_2=Object.prototype,b2=_2.hasOwnProperty;function w2(e,t){var r=v2(e),n=!r&&p2(e),o=!r&&!n&&m2(e),i=!r&&!n&&!o&&y2(e),a=r||n||o||i,u=a?h2(e.length,String):[],l=u.length;for(var s in e)(t||b2.call(e,s))&&!(a&&(s=="length"||o&&(s=="offset"||s=="parent")||i&&(s=="buffer"||s=="byteLength"||s=="byteOffset")||g2(s,l)))&&u.push(s);return u}var N0=w2,E2=Object.prototype;function S2(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||E2;return e===r}var nd=S2;function I2(e,t){return function(r){return e(t(r))}}var $0=I2,O2=$0,T2=O2(Object.keys,Object),A2=T2,R2=nd,C2=A2,x2=Object.prototype,P2=x2.hasOwnProperty;function N2(e){if(!R2(e))return C2(e);var t=[];for(var r in Object(e))P2.call(e,r)&&r!="constructor"&&t.push(r);return t}var $2=N2,D2=w0,L2=P0;function U2(e){return e!=null&&L2(e.length)&&!D2(e)}var D0=U2,F2=N0,M2=$2,B2=D0;function j2(e){return B2(e)?F2(e):M2(e)}var id=j2,k2=zu,q2=id;function W2(e,t){return e&&k2(t,q2(t),e)}var H2=W2;function G2(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var V2=G2,K2=uo,z2=nd,J2=V2,Y2=Object.prototype,Q2=Y2.hasOwnProperty;function X2(e){if(!K2(e))return J2(e);var t=z2(e),r=[];for(var n in e)n=="constructor"&&(t||!Q2.call(e,n))||r.push(n);return r}var Z2=X2,eP=N0,tP=Z2,rP=D0;function nP(e){return rP(e)?eP(e,!0):tP(e)}var od=nP,iP=zu,oP=od;function sP(e,t){return e&&iP(t,oP(t),e)}var aP=sP,eu={exports:{}};eu.exports;(function(e,t){var r=Vr,n=t&&!t.nodeType&&t,o=n&&!0&&e&&!e.nodeType&&e,i=o&&o.exports===n,a=i?r.Buffer:void 0,u=a?a.allocUnsafe:void 0;function l(s,c){if(c)return s.slice();var f=s.length,d=u?u(f):new s.constructor(f);return s.copy(d),d}e.exports=l})(eu,eu.exports);var uP=eu.exports;function cP(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var lP=cP;function fP(e,t){for(var r=-1,n=e==null?0:e.length,o=0,i=[];++r<n;){var a=e[r];t(a,r,e)&&(i[o++]=a)}return i}var dP=fP;function hP(){return[]}var L0=hP,pP=dP,vP=L0,mP=Object.prototype,gP=mP.propertyIsEnumerable,Ip=Object.getOwnPropertySymbols,yP=Ip?function(e){return e==null?[]:(e=Object(e),pP(Ip(e),function(t){return gP.call(e,t)}))}:vP,sd=yP,_P=zu,bP=sd;function wP(e,t){return _P(e,bP(e),t)}var EP=wP;function SP(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}var U0=SP,IP=$0,OP=IP(Object.getPrototypeOf,Object),F0=OP,TP=U0,AP=F0,RP=sd,CP=L0,xP=Object.getOwnPropertySymbols,PP=xP?function(e){for(var t=[];e;)TP(t,RP(e)),e=AP(e);return t}:CP,M0=PP,NP=zu,$P=M0;function DP(e,t){return NP(e,$P(e),t)}var LP=DP,UP=U0,FP=co;function MP(e,t,r){var n=t(e);return FP(e)?n:UP(n,r(e))}var B0=MP,BP=B0,jP=sd,kP=id;function qP(e){return BP(e,kP,jP)}var WP=qP,HP=B0,GP=M0,VP=od;function KP(e){return HP(e,VP,GP)}var zP=KP,JP=Ei,YP=Vr,QP=JP(YP,"DataView"),XP=QP,ZP=Ei,eN=Vr,tN=ZP(eN,"Promise"),rN=tN,nN=Ei,iN=Vr,oN=nN(iN,"Set"),sN=oN,aN=Ei,uN=Vr,cN=aN(uN,"WeakMap"),lN=cN,Ll=XP,Ul=Qf,Fl=rN,Ml=sN,Bl=lN,j0=Ds,mo=E0,Op="[object Map]",fN="[object Object]",Tp="[object Promise]",Ap="[object Set]",Rp="[object WeakMap]",Cp="[object DataView]",dN=mo(Ll),hN=mo(Ul),pN=mo(Fl),vN=mo(Ml),mN=mo(Bl),Yn=j0;(Ll&&Yn(new Ll(new ArrayBuffer(1)))!=Cp||Ul&&Yn(new Ul)!=Op||Fl&&Yn(Fl.resolve())!=Tp||Ml&&Yn(new Ml)!=Ap||Bl&&Yn(new Bl)!=Rp)&&(Yn=function(e){var t=j0(e),r=t==fN?e.constructor:void 0,n=r?mo(r):"";if(n)switch(n){case dN:return Cp;case hN:return Op;case pN:return Tp;case vN:return Ap;case mN:return Rp}return t});var ad=Yn,gN=Object.prototype,yN=gN.hasOwnProperty;function _N(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&yN.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var bN=_N,wN=Vr,EN=wN.Uint8Array,SN=EN,xp=SN;function IN(e){var t=new e.constructor(e.byteLength);return new xp(t).set(new xp(e)),t}var ud=IN,ON=ud;function TN(e,t){var r=t?ON(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var AN=TN,RN=/\w*$/;function CN(e){var t=new e.constructor(e.source,RN.exec(e));return t.lastIndex=e.lastIndex,t}var xN=CN,Pp=Wu,Np=Pp?Pp.prototype:void 0,$p=Np?Np.valueOf:void 0;function PN(e){return $p?Object($p.call(e)):{}}var NN=PN,$N=ud;function DN(e,t){var r=t?$N(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var LN=DN,UN=ud,FN=AN,MN=xN,BN=NN,jN=LN,kN="[object Boolean]",qN="[object Date]",WN="[object Map]",HN="[object Number]",GN="[object RegExp]",VN="[object Set]",KN="[object String]",zN="[object Symbol]",JN="[object ArrayBuffer]",YN="[object DataView]",QN="[object Float32Array]",XN="[object Float64Array]",ZN="[object Int8Array]",e$="[object Int16Array]",t$="[object Int32Array]",r$="[object Uint8Array]",n$="[object Uint8ClampedArray]",i$="[object Uint16Array]",o$="[object Uint32Array]";function s$(e,t,r){var n=e.constructor;switch(t){case JN:return UN(e);case kN:case qN:return new n(+e);case YN:return FN(e,r);case QN:case XN:case ZN:case e$:case t$:case r$:case n$:case i$:case o$:return jN(e,r);case WN:return new n;case HN:case KN:return new n(e);case GN:return MN(e);case VN:return new n;case zN:return BN(e)}}var a$=s$,u$=uo,Dp=Object.create,c$=function(){function e(){}return function(t){if(!u$(t))return{};if(Dp)return Dp(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),l$=c$,f$=l$,d$=F0,h$=nd;function p$(e){return typeof e.constructor=="function"&&!h$(e)?f$(d$(e)):{}}var v$=p$,m$=ad,g$=lo,y$="[object Map]";function _$(e){return g$(e)&&m$(e)==y$}var b$=_$,w$=b$,E$=td,Lp=rd,Up=Lp&&Lp.isMap,S$=Up?E$(Up):w$,I$=S$,O$=ad,T$=lo,A$="[object Set]";function R$(e){return T$(e)&&O$(e)==A$}var C$=R$,x$=C$,P$=td,Fp=rd,Mp=Fp&&Fp.isSet,N$=Mp?P$(Mp):x$,$$=N$,D$=lx,L$=dx,U$=Jf,F$=H2,M$=aP,B$=uP,j$=lP,k$=EP,q$=LP,W$=WP,H$=zP,G$=ad,V$=bN,K$=a$,z$=v$,J$=co,Y$=x0,Q$=I$,X$=uo,Z$=$$,eD=id,tD=od,rD=1,nD=2,iD=4,k0="[object Arguments]",oD="[object Array]",sD="[object Boolean]",aD="[object Date]",uD="[object Error]",q0="[object Function]",cD="[object GeneratorFunction]",lD="[object Map]",fD="[object Number]",W0="[object Object]",dD="[object RegExp]",hD="[object Set]",pD="[object String]",vD="[object Symbol]",mD="[object WeakMap]",gD="[object ArrayBuffer]",yD="[object DataView]",_D="[object Float32Array]",bD="[object Float64Array]",wD="[object Int8Array]",ED="[object Int16Array]",SD="[object Int32Array]",ID="[object Uint8Array]",OD="[object Uint8ClampedArray]",TD="[object Uint16Array]",AD="[object Uint32Array]",Be={};Be[k0]=Be[oD]=Be[gD]=Be[yD]=Be[sD]=Be[aD]=Be[_D]=Be[bD]=Be[wD]=Be[ED]=Be[SD]=Be[lD]=Be[fD]=Be[W0]=Be[dD]=Be[hD]=Be[pD]=Be[vD]=Be[ID]=Be[OD]=Be[TD]=Be[AD]=!0;Be[uD]=Be[q0]=Be[mD]=!1;function wa(e,t,r,n,o,i){var a,u=t&rD,l=t&nD,s=t&iD;if(r&&(a=o?r(e,n,o,i):r(e)),a!==void 0)return a;if(!X$(e))return e;var c=J$(e);if(c){if(a=V$(e),!u)return j$(e,a)}else{var f=G$(e),d=f==q0||f==cD;if(Y$(e))return B$(e,u);if(f==W0||f==k0||d&&!o){if(a=l||d?{}:z$(e),!u)return l?q$(e,M$(a,e)):k$(e,F$(a,e))}else{if(!Be[f])return o?e:{};a=K$(e,f,u)}}i||(i=new D$);var v=i.get(e);if(v)return v;i.set(e,a),Z$(e)?e.forEach(function(y){a.add(wa(y,t,r,y,e,i))}):Q$(e)&&e.forEach(function(y,w){a.set(w,wa(y,t,r,w,e,i))});var g=s?l?H$:W$:l?tD:eD,b=c?void 0:g(e);return L$(b||e,function(y,w){b&&(w=y,y=e[w]),U$(a,w,wa(y,t,r,w,e,i))}),a}var RD=wa,CD=RD,xD=1,PD=4;function ND(e){return CD(e,xD|PD)}var $D=ND;const DD=Hf($D);function Li(e){return e===void 0&&(e=""),"".concat(e?"".concat(e,"_"):"").concat(+new Date,"_").concat(Math.random())}var LD=function(){function e(t){this.close=t.close,this.onChange=t.onChange,this.onError=t.onError,t.debug&&Object.defineProperty(this,"virtualClient",{get:function(){return t.virtualClient}})}return e}(),Bp=function(){function e(t){var r=t.id,n=t.docChanges,o=t.docs,i=t.msgType,a=t.type,u,l;Object.defineProperties(this,{id:{get:function(){return r},enumerable:!0},docChanges:{get:function(){return u||(u=JSON.parse(JSON.stringify(n))),u},enumerable:!0},docs:{get:function(){return l||(l=JSON.parse(JSON.stringify(o))),l},enumerable:!0},msgType:{get:function(){return i},enumerable:!0},type:{get:function(){return a},enumerable:!0}})}return e}(),Ju=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),UD=function(e){Ju(t,e);function t(r){var n=e.call(this,"Watch Error ".concat(JSON.stringify(r.msgData)," (requestid: ").concat(r.requestId,")"))||this;return n.isRealtimeErrorMessageError=!0,n.payload=r,n}return t}(Error),jp=function(e){return e==null?void 0:e.isRealtimeErrorMessageError},FD=function(e){Ju(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="timeout",r.payload=null,r.generic=!0,r}return t}(Error),MD=function(e){return e.type==="timeout"},BD=function(e){Ju(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="cancelled",r.payload=null,r.generic=!0,r}return t}(Error),jD=function(e){return e.type==="cancelled"},rr=function(e){Ju(t,e);function t(r){var n=e.call(this,r.errMsg)||this;return n.errCode="UNKNOWN_ERROR",Object.defineProperties(n,{message:{get:function(){return"errCode: ".concat(this.errCode," ").concat(Bt[this.errCode]||""," | errMsg: ").concat(this.errMsg)},set:function(o){this.errMsg=o}}}),n.errCode=r.errCode||"UNKNOWN_ERROR",n.errMsg=r.errMsg,n}return Object.defineProperty(t.prototype,"message",{get:function(){return"errCode: ".concat(this.errCode," | errMsg: ").concat(this.errMsg)},set:function(r){this.errMsg=r},enumerable:!1,configurable:!0}),t}(Error),Bt={UNKNOWN_ERROR:"UNKNOWN_ERROR",SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG:"SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG",SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA:"SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA",SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR:"SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR",SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED:"SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED",SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL:"SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL",SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR:"SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR"},jl=function(e){return e===void 0&&(e=0),new Promise(function(t){return setTimeout(t,e)})},Ht=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Pt=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},kp=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},Le;(function(e){e.LOGGINGIN="LOGGINGIN",e.INITING="INITING",e.REBUILDING="REBUILDING",e.ACTIVE="ACTIVE",e.ERRORED="ERRORED",e.CLOSING="CLOSING",e.CLOSED="CLOSED",e.PAUSED="PAUSED",e.RESUMING="RESUMING"})(Le||(Le={}));var kD=100,Qs=2,qD=2,WD=10*1e3,HD=10*1e3,GD=10*1e3,VD=function(){function e(t){var r=this;this.watchStatus=Le.INITING,this.wsLogin=function(n,o){return Ht(r,void 0,void 0,function(){var i;return Pt(this,function(a){switch(a.label){case 0:return this.watchStatus=Le.LOGGINGIN,[4,this.login(n,o)];case 1:return i=a.sent(),this.envId||(this.envId=i.envId),[2,i]}})})},this.initWatch=function(n){return Ht(r,void 0,void 0,function(){var o,i=this;return Pt(this,function(a){switch(a.label){case 0:if(this.initWatchPromise!==null&&this.initWatchPromise!==void 0)return[2,this.initWatchPromise];this.initWatchPromise=new Promise(function(u,l){(function(){return Ht(i,void 0,void 0,function(){var s,c,f,d,v,g,b,y,w,E,A;return Pt(this,function(I){switch(I.label){case 0:return I.trys.push([0,3,,4]),this.watchStatus===Le.PAUSED?(console.log("[realtime] initWatch cancelled on pause"),[2,u()]):[4,this.wsLogin(this.envId,n)];case 1:return s=I.sent().envId,this.watchStatus===Le.PAUSED?(console.log("[realtime] initWatch cancelled on pause"),[2,u()]):(this.watchStatus=Le.INITING,c={watchId:this.watchId,requestId:Li(),msgType:"INIT_WATCH",msgData:{envId:s,collName:this.collectionName,query:this.query,limit:this.limit,orderBy:this.orderBy}},[4,this.send({msg:c,waitResponse:!0,skipOnMessage:!0,timeout:HD})]);case 2:if(f=I.sent(),d=f.msgData,v=d.events,g=d.currEvent,this.sessionInfo={queryID:f.msgData.queryID,currentEventId:g-1,currentDocs:[]},v.length>0){for(b=0,y=v;b<y.length;b++)w=y[b],w.ID=g;this.handleServerEvents(f)}else this.sessionInfo.currentEventId=g,E=new Bp({id:g,docChanges:[],docs:[],type:"init"}),this.listener.onChange(E),this.scheduleSendACK();return this.onWatchStart(this,this.sessionInfo.queryID),this.watchStatus=Le.ACTIVE,this.availableRetries.INIT_WATCH=Qs,u(),[3,4];case 3:return A=I.sent(),this.handleWatchEstablishmentError(A,{operationName:"INIT_WATCH",resolve:u,reject:l}),[3,4];case 4:return[2]}})})})()}),o=!1,a.label=1;case 1:return a.trys.push([1,,3,4]),[4,this.initWatchPromise];case 2:return a.sent(),o=!0,[3,4];case 3:return this.initWatchPromise=void 0,[7];case 4:return console.log("[realtime] initWatch ".concat(o?"success":"fail")),[2]}})})},this.rebuildWatch=function(n){return Ht(r,void 0,void 0,function(){var o,i=this;return Pt(this,function(a){switch(a.label){case 0:if(this.rebuildWatchPromise!==null&&this.rebuildWatchPromise!==void 0)return[2,this.rebuildWatchPromise];this.rebuildWatchPromise=new Promise(function(u,l){(function(){return Ht(i,void 0,void 0,function(){var s,c,f,d;return Pt(this,function(v){switch(v.label){case 0:return v.trys.push([0,3,,4]),this.watchStatus===Le.PAUSED?(console.log("[realtime] rebuildWatch cancelled on pause"),[2,u()]):[4,this.wsLogin(this.envId,n)];case 1:if(s=v.sent().envId,!this.sessionInfo)throw new Error("can not rebuildWatch without a successful initWatch (lack of sessionInfo)");return this.watchStatus===Le.PAUSED?(console.log("[realtime] rebuildWatch cancelled on pause"),[2,u()]):(this.watchStatus=Le.REBUILDING,c={watchId:this.watchId,requestId:Li(),msgType:"REBUILD_WATCH",msgData:{envId:s,collName:this.collectionName,queryID:this.sessionInfo.queryID,eventID:this.sessionInfo.currentEventId}},[4,this.send({msg:c,waitResponse:!0,skipOnMessage:!1,timeout:GD})]);case 2:return f=v.sent(),this.handleServerEvents(f),this.watchStatus=Le.ACTIVE,this.availableRetries.REBUILD_WATCH=Qs,u(),[3,4];case 3:return d=v.sent(),this.handleWatchEstablishmentError(d,{operationName:"REBUILD_WATCH",resolve:u,reject:l}),[3,4];case 4:return[2]}})})})()}),o=!1,a.label=1;case 1:return a.trys.push([1,,3,4]),[4,this.rebuildWatchPromise];case 2:return a.sent(),o=!0,[3,4];case 3:return this.rebuildWatchPromise=void 0,[7];case 4:return console.log("[realtime] rebuildWatch ".concat(o?"success":"fail")),[2]}})})},this.handleWatchEstablishmentError=function(n,o){return Ht(r,void 0,void 0,function(){var i,a,u,l=this;return Pt(this,function(s){return i=o.operationName==="INIT_WATCH",a=function(){l.closeWithError(new rr({errCode:i?Bt.SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL:Bt.SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL,errMsg:n})),o.reject(n)},u=function(c){l.useRetryTicket(o.operationName)?i?(l.initWatchPromise=void 0,o.resolve(l.initWatch(c))):(l.rebuildWatchPromise=void 0,o.resolve(l.rebuildWatch(c))):a()},this.handleCommonError(n,{onSignError:function(){return u(!0)},onTimeoutError:function(){return u(!1)},onNotRetryableError:a,onCancelledError:o.reject,onUnknownError:function(){(function(){return Ht(l,void 0,void 0,function(){var c,f=this;return Pt(this,function(d){switch(d.label){case 0:return d.trys.push([0,8,,9]),c=function(){return Ht(f,void 0,void 0,function(){return Pt(this,function(v){switch(v.label){case 0:return this.pause(),[4,this.onceWSConnected()];case 1:return v.sent(),u(!0),[2]}})})},this.isWSConnected()?[3,2]:[4,c()];case 1:return d.sent(),[3,7];case 2:return[4,jl(kD)];case 3:return d.sent(),this.watchStatus!==Le.PAUSED?[3,4]:(o.reject(new BD("".concat(o.operationName," cancelled due to pause after unknownError"))),[3,7]);case 4:return this.isWSConnected()?[3,6]:[4,c()];case 5:return d.sent(),[3,7];case 6:u(!1),d.label=7;case 7:return[3,9];case 8:return d.sent(),u(!0),[3,9];case 9:return[2]}})})})()}}),[2]})})},this.closeWatch=function(){return Ht(r,void 0,void 0,function(){var n,o,i;return Pt(this,function(a){switch(a.label){case 0:if(n=this.sessionInfo?this.sessionInfo.queryID:"",this.watchStatus!==Le.ACTIVE)return this.watchStatus=Le.CLOSED,this.onWatchClose(this,n),[2];a.label=1;case 1:return a.trys.push([1,3,4,5]),this.watchStatus=Le.CLOSING,o={watchId:this.watchId,requestId:Li(),msgType:"CLOSE_WATCH",msgData:null},[4,this.send({msg:o})];case 2:return a.sent(),this.sessionInfo=void 0,this.watchStatus=Le.CLOSED,[3,5];case 3:return i=a.sent(),this.closeWithError(new rr({errCode:Bt.SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL,errMsg:i})),[3,5];case 4:return this.onWatchClose(this,n),[7];case 5:return[2]}})})},this.scheduleSendACK=function(){r.clearACKSchedule(),r.ackTimeoutId=setTimeout(function(){r.waitExpectedTimeoutId?r.scheduleSendACK():r.sendACK()},WD)},this.clearACKSchedule=function(){r.ackTimeoutId&&clearTimeout(r.ackTimeoutId)},this.sendACK=function(){return Ht(r,void 0,void 0,function(){var n,o,i;return Pt(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),this.watchStatus!==Le.ACTIVE?(this.scheduleSendACK(),[2]):this.sessionInfo?(n={watchId:this.watchId,requestId:Li(),msgType:"CHECK_LAST",msgData:{queryID:this.sessionInfo.queryID,eventID:this.sessionInfo.currentEventId}},[4,this.send({msg:n})]):(console.warn("[realtime listener] can not send ack without a successful initWatch (lack of sessionInfo)"),[2]);case 1:return a.sent(),this.scheduleSendACK(),[3,3];case 2:if(o=a.sent(),jp(o))switch(i=o.payload,i.msgData.code){case"CHECK_LOGIN_FAILED":case"SIGN_EXPIRED_ERROR":case"SIGN_INVALID_ERROR":case"SIGN_PARAM_INVALID":return this.rebuildWatch(),[2];case"QUERYID_INVALID_ERROR":case"SYS_ERR":case"INVALIID_ENV":case"COLLECTION_PERMISSION_DENIED":return this.closeWithError(new rr({errCode:Bt.SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL,errMsg:i.msgData.code})),[2]}return this.availableRetries.CHECK_LAST&&this.availableRetries.CHECK_LAST>0?(this.availableRetries.CHECK_LAST-=1,this.scheduleSendACK()):this.closeWithError(new rr({errCode:Bt.SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL,errMsg:o})),[3,3];case 3:return[2]}})})},this.handleCommonError=function(n,o){if(jp(n)){var i=n.payload;switch(i.msgData.code){case"CHECK_LOGIN_FAILED":case"SIGN_EXPIRED_ERROR":case"SIGN_INVALID_ERROR":case"SIGN_PARAM_INVALID":{o.onSignError(n);return}case"QUERYID_INVALID_ERROR":case"SYS_ERR":case"INVALIID_ENV":case"COLLECTION_PERMISSION_DENIED":{o.onNotRetryableError(n);return}default:{o.onNotRetryableError(n);return}}}else if(MD(n)){o.onTimeoutError(n);return}else if(jD(n)){o.onCancelledError(n);return}o.onUnknownError(n)},this.watchId="watchid_".concat(+new Date,"_").concat(Math.random()),this.envId=t.envId,this.collectionName=t.collectionName,this.query=t.query,this.limit=t.limit,this.orderBy=t.orderBy,this.send=t.send,this.login=t.login,this.isWSConnected=t.isWSConnected,this.onceWSConnected=t.onceWSConnected,this.getWaitExpectedTimeoutLength=t.getWaitExpectedTimeoutLength,this.onWatchStart=t.onWatchStart,this.onWatchClose=t.onWatchClose,this.debug=t.debug,this.availableRetries={INIT_WATCH:Qs,REBUILD_WATCH:Qs,CHECK_LAST:qD},this.listener=new LD({close:function(){r.closeWatch()},onChange:t.onChange,onError:t.onError,debug:this.debug,virtualClient:this}),this.initWatch()}return e.prototype.onMessage=function(t){var r=this;switch(this.watchStatus){case Le.PAUSED:{if(t.msgType!=="ERROR")return;break}case Le.LOGGINGIN:case Le.INITING:case Le.REBUILDING:{console.warn("[realtime listener] internal non-fatal error: unexpected message received while ".concat(this.watchStatus));return}case Le.CLOSED:{console.warn("[realtime listener] internal non-fatal error: unexpected message received when the watch has closed");return}case Le.ERRORED:{console.warn("[realtime listener] internal non-fatal error: unexpected message received when the watch has ended with error");return}}if(!this.sessionInfo){console.warn("[realtime listener] internal non-fatal error: sessionInfo not found while message is received.");return}switch(this.scheduleSendACK(),t.msgType){case"NEXT_EVENT":{console.warn("nextevent ".concat(t.msgData.currEvent," ignored"),t),this.handleServerEvents(t);break}case"CHECK_EVENT":{this.sessionInfo.currentEventId<t.msgData.currEvent&&(this.sessionInfo.expectEventId=t.msgData.currEvent,this.clearWaitExpectedEvent(),this.waitExpectedTimeoutId=setTimeout(function(){r.rebuildWatch()},this.getWaitExpectedTimeoutLength()),console.log("[realtime] waitExpectedTimeoutLength ".concat(this.getWaitExpectedTimeoutLength())));break}case"ERROR":{this.closeWithError(new rr({errCode:Bt.SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG,errMsg:"".concat(t.msgData.code," - ").concat(t.msgData.message)}));break}default:{console.warn("[realtime listener] virtual client receive unexpected msg ".concat(t.msgType,": "),t);break}}},e.prototype.closeWithError=function(t){var r;this.watchStatus=Le.ERRORED,this.clearACKSchedule(),this.listener.onError(t),this.onWatchClose(this,((r=this.sessionInfo)===null||r===void 0?void 0:r.queryID)||""),console.log("[realtime] client closed (".concat(this.collectionName," ").concat(this.query,") (watchId ").concat(this.watchId,")"))},e.prototype.pause=function(){this.watchStatus=Le.PAUSED,console.log("[realtime] client paused (".concat(this.collectionName," ").concat(this.query,") (watchId ").concat(this.watchId,")"))},e.prototype.resume=function(){return Ht(this,void 0,void 0,function(){var t;return Pt(this,function(r){switch(r.label){case 0:this.watchStatus=Le.RESUMING,console.log("[realtime] client resuming with ".concat(this.sessionInfo?"REBUILD_WATCH":"INIT_WATCH"," (").concat(this.collectionName," ").concat(this.query,") (").concat(this.watchId,")")),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.sessionInfo?this.rebuildWatch():this.initWatch()];case 2:return r.sent(),console.log("[realtime] client successfully resumed (".concat(this.collectionName," ").concat(this.query,") (").concat(this.watchId,")")),[3,4];case 3:return t=r.sent(),console.error("[realtime] client resume failed (".concat(this.collectionName," ").concat(this.query,") (").concat(this.watchId,")"),t),[3,4];case 4:return[2]}})})},e.prototype.useRetryTicket=function(t){return this.availableRetries[t]&&this.availableRetries[t]>0?(this.availableRetries[t]-=1,console.log("[realtime] ".concat(t," use a retry ticket, now only ").concat(this.availableRetries[t]," retry left")),!0):!1},e.prototype.handleServerEvents=function(t){return Ht(this,void 0,void 0,function(){var r;return Pt(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this.scheduleSendACK(),[4,this.handleServerEventsInternel(t)];case 1:return n.sent(),this.postHandleServerEventsValidityCheck(t),[3,3];case 2:throw r=n.sent(),console.error("[realtime listener] internal non-fatal error: handle server events failed with error: ",r),r;case 3:return[2]}})})},e.prototype.handleServerEventsInternel=function(t){return Ht(this,void 0,void 0,function(){var r,n,o,i,a,u,l,s,c,f,d,v;return Pt(this,function(g){switch(g.label){case 0:if(r=t.requestId,n=t.msgData.events,o=t.msgType,!n.length||!this.sessionInfo)return[2];i=this.sessionInfo;try{a=n.map(KD)}catch(b){return this.closeWithError(new rr({errCode:Bt.SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA,errMsg:b})),[2]}u=kp([],i.currentDocs,!0),l=!1,s=function(b,y){var w,E,A,I,R,L,U,U,F,F,U,N,N,W,j,X;return Pt(this,function(fe){switch(fe.label){case 0:return w=a[b],i.currentEventId>=w.id?(!a[b-1]||w.id>a[b-1].id?console.warn("[realtime] duplicate event received, cur ".concat(i.currentEventId," but got ").concat(w.id)):console.error("[realtime listener] server non-fatal error: events out of order (the latter event's id is smaller than that of the former) (requestId ".concat(r,")")),[2,"continue"]):[3,1];case 1:if(i.currentEventId!==w.id-1)return[3,2];switch(w.dataType){case"update":{if(!w.doc)switch(w.queueType){case"update":case"dequeue":{if(E=u.find(function(q){return q._id===w.docId}),E){if(A=DD(E),w.updatedFields&&Object.keys(w.updatedFields).forEach(function(q){bC(A,q,w.updatedFields[q])}),w.removedFields)for(I=0,R=w.removedFields;I<R.length;I++)L=R[I],qC(A,L);w.doc=A}else console.error("[realtime listener] internal non-fatal server error: unexpected update dataType event where no doc is associated.");break}case"enqueue":throw U=new rr({errCode:Bt.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="update" and queueType="enqueue" (requestId '.concat(t.requestId,")")}),c.closeWithError(U),U}break}case"replace":{if(!w.doc)throw U=new rr({errCode:Bt.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="replace" (requestId '.concat(t.requestId,")")}),c.closeWithError(U),U;break}case"remove":{F=u.find(function(q){return q._id===w.docId}),F?w.doc=F:console.error("[realtime listener] internal non-fatal server error: unexpected remove event where no doc is associated.");break}case"limit":{if(!w.doc)switch(w.queueType){case"dequeue":{F=u.find(function(q){return q._id===w.docId}),F?w.doc=F:console.error("[realtime listener] internal non-fatal server error: unexpected limit dataType event where no doc is associated.");break}case"enqueue":throw U=new rr({errCode:Bt.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="limit" and queueType="enqueue" (requestId '.concat(t.requestId,")")}),c.closeWithError(U),U}break}}switch(w.queueType){case"init":{l?u.push(w.doc):(l=!0,u=[w.doc]);break}case"enqueue":{u.push(w.doc);break}case"dequeue":{N=u.findIndex(function(q){return q._id===w.docId}),N>-1?u.splice(N,1):console.error("[realtime listener] internal non-fatal server error: unexpected dequeue event where no doc is associated.");break}case"update":{N=u.findIndex(function(q){return q._id===w.docId}),N>-1?u[N]=w.doc:console.error("[realtime listener] internal non-fatal server error: unexpected queueType update event where no doc is associated.");break}}return(b===y-1||a[b+1]&&a[b+1].id!==w.id)&&(W=kp([],u,!0),j=a.slice(0,b+1).filter(function(q){return q.id===w.id}),c.sessionInfo.currentEventId=w.id,c.sessionInfo.currentDocs=u,X=new Bp({id:w.id,docChanges:j,docs:W,msgType:o}),c.listener.onChange(X)),[3,4];case 2:return console.warn("[realtime listener] event received is out of order, cur ".concat(c.sessionInfo.currentEventId," but got ").concat(w.id)),[4,c.rebuildWatch()];case 3:return fe.sent(),[2,{value:void 0}];case 4:return[2]}})},c=this,f=0,d=a.length,g.label=1;case 1:return f<d?[5,s(f,d)]:[3,4];case 2:if(v=g.sent(),typeof v=="object")return[2,v.value];g.label=3;case 3:return f++,[3,1];case 4:return[2]}})})},e.prototype.postHandleServerEventsValidityCheck=function(t){if(!this.sessionInfo){console.error("[realtime listener] internal non-fatal error: sessionInfo lost after server event handling, this should never occur");return}if(this.sessionInfo.expectEventId&&this.sessionInfo.currentEventId>=this.sessionInfo.expectEventId&&this.clearWaitExpectedEvent(),this.sessionInfo.currentEventId<t.msgData.currEvent){console.warn("[realtime listener] internal non-fatal error: client eventId does not match with server event id after server event handling");return}},e.prototype.clearWaitExpectedEvent=function(){this.waitExpectedTimeoutId&&(clearTimeout(this.waitExpectedTimeoutId),this.waitExpectedTimeoutId=void 0)},e}();function KD(e){var t={id:e.ID,dataType:e.DataType,queueType:e.QueueType,docId:e.DocID,doc:e.Doc&&e.Doc!=="{}"?JSON.parse(e.Doc):void 0};return e.DataType==="update"&&(e.UpdatedFields&&(t.updatedFields=JSON.parse(e.UpdatedFields)),(e.removedFields||e.RemovedFields)&&(t.removedFields=JSON.parse(e.removedFields))),t}var H0={1e3:{code:1e3,name:"Normal Closure",description:"Normal closure; the connection successfully completed whatever purpose for which it was created."},1001:{code:1001,name:"Going Away",description:"The endpoint is going away, either because of a server failure or because the browser is navigating away from the page that opened the connection."},1002:{code:1002,name:"Protocol Error",description:"The endpoint is terminating the connection due to a protocol error."},1003:{code:1003,name:"Unsupported Data",description:"The connection is being terminated because the endpoint received data of a type it cannot accept (for example, a text-only endpoint received binary data)."},1005:{code:1005,name:"No Status Received",description:"Indicates that no status code was provided even though one was expected."},1006:{code:1006,name:"Abnormal Closure",description:"Used to indicate that a connection was closed abnormally (that is, with no close frame being sent) when a status code is expected."},1007:{code:1007,name:"Invalid frame payload data",description:"The endpoint is terminating the connection because a message was received that contained inconsistent data (e.g., non-UTF-8 data within a text message)."},1008:{code:1008,name:"Policy Violation",description:"The endpoint is terminating the connection because it received a message that violates its policy. This is a generic status code, used when codes 1003 and 1009 are not suitable."},1009:{code:1009,name:"Message too big",description:"The endpoint is terminating the connection because a data frame was received that is too large."},1010:{code:1010,name:"Missing Extension",description:"The client is terminating the connection because it expected the server to negotiate one or more extension, but the server didn't."},1011:{code:1011,name:"Internal Error",description:"The server is terminating the connection because it encountered an unexpected condition that prevented it from fulfilling the request."},1012:{code:1012,name:"Service Restart",description:"The server is terminating the connection because it is restarting."},1013:{code:1013,name:"Try Again Later",description:"The server is terminating the connection due to a temporary condition, e.g. it is overloaded and is casting off some of its clients."},1014:{code:1014,name:"Bad Gateway",description:"The server was acting as a gateway or proxy and received an invalid response from the upstream server. This is similar to 502 HTTP Status Code."},1015:{code:1015,name:"TLS Handshake",description:"Indicates that the connection was closed due to a failure to perform a TLS handshake (e.g., the server certificate can't be verified)."},3e3:{code:3e3,name:"Reconnect WebSocket",description:"The client is terminating the connection because it wants to reconnect"},3001:{code:3001,name:"No Realtime Listeners",description:"The client is terminating the connection because no more realtime listeners exist"},3002:{code:3002,name:"Heartbeat Ping Error",description:"The client is terminating the connection due to its failure in sending heartbeat messages"},3003:{code:3003,name:"Heartbeat Pong Timeout Error",description:"The client is terminating the connection because no heartbeat response is received from the server"},3050:{code:3050,name:"Server Close",description:"The client is terminating the connection because no heartbeat response is received from the server"}},tr;(function(e){e[e.NormalClosure=1e3]="NormalClosure",e[e.GoingAway=1001]="GoingAway",e[e.ProtocolError=1002]="ProtocolError",e[e.UnsupportedData=1003]="UnsupportedData",e[e.NoStatusReceived=1005]="NoStatusReceived",e[e.AbnormalClosure=1006]="AbnormalClosure",e[e.InvalidFramePayloadData=1007]="InvalidFramePayloadData",e[e.PolicyViolation=1008]="PolicyViolation",e[e.MessageTooBig=1009]="MessageTooBig",e[e.MissingExtension=1010]="MissingExtension",e[e.InternalError=1011]="InternalError",e[e.ServiceRestart=1012]="ServiceRestart",e[e.TryAgainLater=1013]="TryAgainLater",e[e.BadGateway=1014]="BadGateway",e[e.TLSHandshake=1015]="TLSHandshake",e[e.ReconnectWebSocket=3e3]="ReconnectWebSocket",e[e.NoRealtimeListeners=3001]="NoRealtimeListeners",e[e.HeartbeatPingError=3002]="HeartbeatPingError",e[e.HeartbeatPongTimeoutError=3003]="HeartbeatPongTimeoutError",e[e.NoAuthentication=3050]="NoAuthentication"})(tr||(tr={}));var Gc=function(e,t){var r=H0[e],n=r?"".concat(r.name,", code ").concat(e,", reason ").concat(t||r.description):"code ".concat(e);return new rr({errCode:Bt.SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED,errMsg:n})},G0=null,V0="web";function zD(){return G0}function JD(e){G0=e}function qp(){return V0}function YD(e){V0=e}var tu=function(){return tu=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},tu.apply(this,arguments)},dr=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},hr=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Vc={OPEN:1},Wp=3,QD=5e3,XD=1e4,ZD=5,e3=1e4,t3=2,r3=2,n3=5e3,i3=function(){function e(t){var r=this;this.virtualWSClient=new Set,this.queryIdClientMap=new Map,this.watchIdClientMap=new Map,this.pingFailed=0,this.pongMissed=0,this.logins=new Map,this.wsReadySubsribers=[],this.wsResponseWait=new Map,this.rttObserved=[],this.send=function(n){return dr(r,void 0,void 0,function(){var o=this;return hr(this,function(i){return[2,new Promise(function(a,u){(function(){return dr(o,void 0,void 0,function(){var l,s,c,f,d,v,g,b,y=this;return hr(this,function(w){switch(w.label){case 0:s=!1,c=!1,f=function(E){s=!0,l&&clearTimeout(l),a(E)},d=function(E){c=!0,l&&clearTimeout(l),u(E)},n.timeout&&(l=setTimeout(function(){(function(){return dr(y,void 0,void 0,function(){return hr(this,function(E){switch(E.label){case 0:return!s||!c?[4,jl(0)]:[3,2];case 1:E.sent(),(!s||!c)&&d(new FD("wsclient.send timedout")),E.label=2;case 2:return[2]}})})})()},n.timeout)),w.label=1;case 1:return w.trys.push([1,8,,9]),this.wsInitPromise!==void 0||this.wsInitPromise!==null?[4,this.wsInitPromise]:[3,3];case 2:w.sent(),w.label=3;case 3:if(!this.ws)return d(new Error("invalid state: ws connection not exists, can not send message")),[2];if(this.ws.readyState!==Vc.OPEN)return d(new Error("ws readyState invalid: ".concat(this.ws.readyState,", can not send message"))),[2];n.waitResponse&&(v={resolve:f,reject:d,skipOnMessage:n.skipOnMessage},this.wsResponseWait.set(n.msg.requestId,v)),w.label=4;case 4:return w.trys.push([4,6,,7]),[4,this.ws.send(JSON.stringify(n.msg))];case 5:return w.sent(),n.waitResponse||f(void 0),[3,7];case 6:return g=w.sent(),g&&(d(g),n.waitResponse&&this.wsResponseWait.delete(n.msg.requestId)),[3,7];case 7:return[3,9];case 8:return b=w.sent(),d(b),[3,9];case 9:return[2]}})})})()})]})})},this.closeAllClients=function(n){r.virtualWSClient.forEach(function(o){o.closeWithError(n)})},this.pauseClients=function(n){(n||r.virtualWSClient).forEach(function(o){o.pause()})},this.resumeClients=function(n){(n||r.virtualWSClient).forEach(function(o){o.resume()})},this.initWebSocketConnection=function(n,o){return o===void 0&&(o=r.maxReconnect),dr(r,void 0,void 0,function(){var i=this;return hr(this,function(a){switch(a.label){case 0:if(n&&this.reconnectState)return[2];if(n&&(this.reconnectState=!0),this.wsInitPromise!==void 0&&this.wsInitPromise!==null)return[2,this.wsInitPromise];n&&this.pauseClients(),this.close(tr.ReconnectWebSocket),this.wsInitPromise=new Promise(function(u,l){(function(){return dr(i,void 0,void 0,function(){var s,c,f,d=this;return hr(this,function(v){switch(v.label){case 0:return v.trys.push([0,6,,11]),[4,this.getWsSign()];case 1:return s=v.sent(),[4,new Promise(function(g){var b=s.wsUrl||"wss://tcb-ws.tencentcloudapi.com",y=zD();d.ws=y?new y(b):new WebSocket(b),g(void 0)})];case 2:return v.sent(),this.ws.connect?[4,this.ws.connect()]:[3,4];case 3:v.sent(),v.label=4;case 4:return[4,this.initWebSocketEvent()];case 5:return v.sent(),u(),n&&(this.resumeClients(),this.reconnectState=!1),[3,11];case 6:return c=v.sent(),console.error("[realtime] initWebSocketConnection connect fail",c),o>0?(f=!0,this.wsInitPromise=void 0,f?[4,jl(this.reconnectInterval)]:[3,8]):[3,9];case 7:v.sent(),n&&(this.reconnectState=!1),v.label=8;case 8:return u(this.initWebSocketConnection(n,o-1)),[3,10];case 9:l(c),n&&this.closeAllClients(new rr({errCode:Bt.SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL,errMsg:c})),v.label=10;case 10:return[3,11];case 11:return[2]}})})})()}),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,this.wsInitPromise];case 2:return a.sent(),this.wsReadySubsribers.forEach(function(u){var l=u.resolve;return l()}),[3,5];case 3:return a.sent(),this.wsReadySubsribers.forEach(function(u){var l=u.reject;return l()}),[3,5];case 4:return this.wsInitPromise=void 0,this.wsReadySubsribers=[],[7];case 5:return[2]}})})},this.initWebSocketEvent=function(){return new Promise(function(n,o){if(!r.ws)throw new Error("can not initWebSocketEvent, ws not exists");var i=!1;r.ws.onopen=function(a){console.warn("[realtime] ws event: open",a),i=!0,n()},r.ws.onerror=function(a){r.logins=new Map,i?(console.error("[realtime] ws event: error",a),r.clearHeartbeat(),r.virtualWSClient.forEach(function(u){return u.closeWithError(new rr({errCode:Bt.SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR,errMsg:a}))})):(console.error("[realtime] ws open failed with ws event: error",a),o(a))},r.ws.onclose=function(a){switch(console.warn("[realtime] ws event: close",a),r.logins=new Map,r.clearHeartbeat(),a.code){case tr.ReconnectWebSocket:break;case tr.NoRealtimeListeners:break;case tr.HeartbeatPingError:case tr.HeartbeatPongTimeoutError:case tr.NormalClosure:case tr.AbnormalClosure:{r.maxReconnect>0?r.initWebSocketConnection(!0,r.maxReconnect):r.closeAllClients(Gc(a.code));break}case tr.NoAuthentication:{r.closeAllClients(Gc(a.code,a.reason));break}default:r.maxReconnect>0?r.initWebSocketConnection(!0,r.maxReconnect):r.closeAllClients(Gc(a.code))}},r.ws.onmessage=function(a){var u,l=((u=a.data)===null||u===void 0?void 0:u.data)||a.data;r.heartbeat();var s;try{s=typeof l=="string"?JSON.parse(l):l}catch(E){throw new Error("[realtime] onMessage parse res.data error: ".concat(E))}if(s.msgType==="ERROR"){var c=null;r.virtualWSClient.forEach(function(E){E.watchId===s.watchId&&(c=E)}),c&&c.listener.onError(s)}var f=r.wsResponseWait.get(s.requestId);if(f){try{s.msgType==="ERROR"?f.reject(new UD(s)):f.resolve(s)}catch(E){console.error("ws onMessage responseWaitSpec.resolve(msg) errored:",E)}finally{r.wsResponseWait.delete(s.requestId)}if(f.skipOnMessage)return}if(s.msgType==="PONG"){if(r.lastPingSendTS){var d=Date.now()-r.lastPingSendTS;if(d>XD){console.warn("[realtime] untrusted rtt observed: ".concat(d));return}r.rttObserved.length>=Wp&&r.rttObserved.splice(0,r.rttObserved.length-Wp+1),r.rttObserved.push(d)}return}var v=s.watchId&&r.watchIdClientMap.get(s.watchId);if(v)v.onMessage(s);else switch(console.error("[realtime] no realtime listener found responsible for watchId ".concat(s.watchId,": "),s),s.msgType){case"INIT_EVENT":case"NEXT_EVENT":case"CHECK_EVENT":{v=r.queryIdClientMap.get(s.msgData.queryID),v&&v.onMessage(s);break}default:for(var g=0,b=Array.from(r.watchIdClientMap.entries());g<b.length;g++){var y=b[g],w=y[1];w.onMessage(s);break}}},r.heartbeat()})},this.isWSConnected=function(){return!!(r.ws&&r.ws.readyState===Vc.OPEN)},this.onceWSConnected=function(){return dr(r,void 0,void 0,function(){var n=this;return hr(this,function(o){return this.isWSConnected()?[2]:this.wsInitPromise!==null&&this.wsInitPromise!==void 0?[2,this.wsInitPromise]:[2,new Promise(function(i,a){n.wsReadySubsribers.push({resolve:i,reject:a})})]})})},this.webLogin=function(n,o){return dr(r,void 0,void 0,function(){var i,a,u,l,s,c,f,d,v=this;return hr(this,function(g){switch(g.label){case 0:if(!o){if(n){if(i=this.logins.get(n),i){if(i.loggedIn&&i.loginResult)return[2,i.loginResult];if(i.loggingInPromise!==null&&i.loggingInPromise!==void 0)return[2,i.loggingInPromise]}}else if(a=this.logins.get(""),(a==null?void 0:a.loggingInPromise)!==null&&(a==null?void 0:a.loggingInPromise)!==void 0)return[2,a.loggingInPromise]}u=new Promise(function(b,y){(function(){return dr(v,void 0,void 0,function(){var w,E,A,I,R;return hr(this,function(L){switch(L.label){case 0:return L.trys.push([0,3,,4]),[4,this.getWsSign()];case 1:return w=L.sent(),E={envId:w.envId||"",accessToken:"",referrer:"web",sdkVersion:"",dataVersion:""},A={watchId:void 0,requestId:Li(),msgType:"LOGIN",msgData:E,exMsgData:{runtime:qp(),signStr:w.signStr,secretVersion:w.secretVersion}},[4,this.send({msg:A,waitResponse:!0,skipOnMessage:!0,timeout:n3})];case 2:return I=L.sent(),I.msgData.code?y(new Error("".concat(I.msgData.code," ").concat(I.msgData.message))):b({envId:w.envId}),[3,4];case 3:return R=L.sent(),y(R),[3,4];case 4:return[2]}})})})()}),l=n&&this.logins.get(n),s=Date.now(),l?(l.loggedIn=!1,l.loggingInPromise=u,l.loginStartTS=s):(l={loggedIn:!1,loggingInPromise:u,loginStartTS:s},this.logins.set(n||"",l)),g.label=1;case 1:return g.trys.push([1,3,,4]),[4,u];case 2:if(c=g.sent(),f=n&&this.logins.get(n),f&&f===l&&f.loginStartTS===s)return l.loggedIn=!0,l.loggingInPromise=void 0,l.loginStartTS=void 0,l.loginResult=c,[2,c];if(f){if(f.loggedIn&&f.loginResult)return[2,f.loginResult];if(f.loggingInPromise!==null&&f.loggingInPromise!==void 0)return[2,f.loggingInPromise];throw new Error("ws unexpected login info")}else throw new Error("ws login info reset");case 3:throw d=g.sent(),l.loggedIn=!1,l.loggingInPromise=void 0,l.loginStartTS=void 0,l.loginResult=void 0,d;case 4:return[2]}})})},this.getWsSign=function(){return dr(r,void 0,void 0,function(){var n,o,i,a,u,l,s;return hr(this,function(c){switch(c.label){case 0:return this.wsSign&&this.wsSign.expiredTs>Date.now()?[2,this.wsSign]:(n=Date.now()+6e4,[4,this.context.appConfig.request.send("auth.wsWebSign",{runtime:qp()})]);case 1:if(o=c.sent(),o.code)throw new Error("[tcb-js-sdk] 获取实时数据推送登录票据失败: ".concat(o.code));if(o.data)return i=o.data,a=i.signStr,u=i.wsUrl,l=i.secretVersion,s=i.envId,[2,{signStr:a,wsUrl:u,secretVersion:l,envId:s,expiredTs:n}];throw new Error("[tcb-js-sdk] 获取实时数据推送登录票据失败")}})})},this.getWaitExpectedTimeoutLength=function(){return r.rttObserved.length?r.rttObserved.reduce(function(n,o){return n+o})/r.rttObserved.length*1.5:QD},this.ping=function(){return dr(r,void 0,void 0,function(){var n;return hr(this,function(o){switch(o.label){case 0:return n={watchId:void 0,requestId:Li(),msgType:"PING",msgData:null},[4,this.send({msg:n})];case 1:return o.sent(),[2]}})})},this.onWatchStart=function(n,o){r.queryIdClientMap.set(o,n)},this.onWatchClose=function(n,o){o&&r.queryIdClientMap.delete(o),r.watchIdClientMap.delete(n.watchId),r.virtualWSClient.delete(n),r.virtualWSClient.size||r.close(tr.NoRealtimeListeners)},this.maxReconnect=t.maxReconnect||ZD,this.reconnectInterval=t.reconnectInterval||e3,this.context=t.context}return e.prototype.clearHeartbeat=function(){this.pingTimeoutId&&clearTimeout(this.pingTimeoutId),this.pongTimeoutId&&clearTimeout(this.pongTimeoutId)},e.prototype.close=function(t){this.clearHeartbeat(),this.ws&&(this.ws.close(t,H0[t].name),this.ws=void 0)},e.prototype.watch=function(t){!this.ws&&(this.wsInitPromise===void 0||this.wsInitPromise===null)&&this.initWebSocketConnection(!1);var r=new VD(tu(tu({},t),{send:this.send,login:this.webLogin,isWSConnected:this.isWSConnected,onceWSConnected:this.onceWSConnected,getWaitExpectedTimeoutLength:this.getWaitExpectedTimeoutLength,onWatchStart:this.onWatchStart,onWatchClose:this.onWatchClose,debug:!0}));return this.virtualWSClient.add(r),this.watchIdClientMap.set(r.watchId,r),r.listener},e.prototype.heartbeat=function(t){var r=this;this.clearHeartbeat(),this.pingTimeoutId=setTimeout(function(){(function(){return dr(r,void 0,void 0,function(){var n=this;return hr(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),!this.ws||this.ws.readyState!==Vc.OPEN?[2]:(this.lastPingSendTS=Date.now(),[4,this.ping()]);case 1:return o.sent(),this.pingFailed=0,this.pongTimeoutId=setTimeout(function(){console.error("pong timed out"),n.pongMissed<r3?(n.pongMissed+=1,n.heartbeat(!0)):n.initWebSocketConnection(!0)},this.context.appConfig.realtimePongWaitTimeout),[3,3];case 2:return o.sent(),this.pingFailed<t3?(this.pingFailed+=1,this.heartbeat()):this.close(tr.HeartbeatPingError),[3,3];case 3:return[2]}})})})()},t?0:this.context.appConfig.realtimePingInterval)},e}(),K0={target:"database",entity:function(){var e=this.platform,t=e.adapter,r=e.runtime;JD(t.wsClass),YD(r)}},z0={name:"realtime",IIFE:!0,entity:function(){this.prototype.wsClientClass=i3}};try{cloudbase.registerComponent(z0),cloudbase.registerHook(K0)}catch{}function o3(e){try{e.registerComponent(z0),e.registerHook(K0)}catch(t){console.warn(t)}}var s3=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(a=e[u])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},Kc=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},a3=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},u3=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},c3=kt,l3=xu,f3=$u,J0="analytics",d3=["mall"];function h3(e){if(Object.prototype.toString.call(e).slice(8,-1)!=="Object")return!1;var t=e.report_data,r=e.report_type;return!(d3.includes(r)===!1||Object.prototype.toString.call(t).slice(8,-1)!=="Object"||t.action_time!==void 0&&!Number.isInteger(t.action_time)||typeof t.action_type!="string")}var p3=function(){function e(){}return e.prototype.analytics=function(t){return a3(this,void 0,void 0,function(){var r,n,o,i,a;return u3(this,function(u){if(!h3(t))throw new Error(JSON.stringify({code:c3.INVALID_PARAMS,msg:"[".concat(J0,".analytics] invalid report data")}));return r="analytics.report",n=t.report_data.action_time===void 0?Math.floor(Date.now()/1e3):t.report_data.action_time,o={analytics_scene:t.report_type,analytics_data:Object.assign({},t.report_data,{action_time:n})},i={requestData:o},a=this.request,a.send(r,i),[2]})})},s3([f3({customInfo:{},title:"上报调用失败",messages:["请确认以下各项：","  1 - 调用 analytics() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(l3)]}),Kc("design:type",Function),Kc("design:paramtypes",[Object]),Kc("design:returntype",Promise)],e.prototype,"analytics",null),e}(),v3=new p3,Y0={name:J0,entity:{analytics:v3.analytics}};try{cloudbase.registerComponent(Y0)}catch{}function m3(e){try{e.registerComponent(Y0)}catch(t){console.warn(t)}}var kl=function(e,t){return kl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},kl(e,t)};function g3(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");kl(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var ot=function(){return ot=Object.assign||function(t){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},ot.apply(this,arguments)};function io(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,[])).next())})}function oo(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}var si=function(e){g3(t,e);function t(r,n){var o=e.call(this,r)||this;return o.name="WxCloudSDKError",o.code=n==null?void 0:n.code,o.requestId=n==null?void 0:n.requestId,o.originError=n==null?void 0:n.originError,o}return t}(Error);function ql(){return typeof window<"u"&&window||typeof globalThis<"u"&&globalThis}function y3(){try{var e=ql();return e?typeof wx>"u"?ql().location.href:e.__wxRoute:void 0}catch{}}function _3(){var e=ql();if(e!=null&&e.navigator)return e.navigator.userAgent;if(typeof wx<"u"&&wx.getSystemInfo){var t;return wx.getSystemInfo({success:function(r){r&&(t=["brand","model","version","system","platform","SDKVersion","language"].map(function(n){return"".concat(n,": ").concat(r[n])}).join(", "))}}),t}}var b3="1.6.1",w3=function(e){var t=e.dataSourceName,r=e.methodName,n=e.params,o=e.realMethodName,i=e.callFunction,a=e.envType,u=a===void 0?"prod":a,l=e.mode;return io(void 0,void 0,void 0,function(){var s,c,f,d,v,g;return oo(this,function(b){switch(b.label){case 0:s={data:{},requestId:""},b.label=1;case 1:return b.trys.push([1,3,,4]),[4,i({name:"lowcode-datasource",data:{dataSourceName:t,methodName:r,params:n,userAgent:_3(),referrer:y3(),"x-sdk-version":b3,envType:u,mode:l}})];case 2:if(c=b.sent(),f=((v=c==null?void 0:c.result)===null||v===void 0?void 0:v.requestId)||(c==null?void 0:c.requestId)||(c==null?void 0:c.requestID),c!=null&&c.result.code)throw new si("【错误】".concat(c==null?void 0:c.result.message,`
【操作】调用 models.`).concat(t?"".concat(t,"."):"").concat(o,`
【错误码】`).concat(c==null?void 0:c.result.code,`
【请求ID】`).concat(f||"N/A"),{code:c==null?void 0:c.result.code,requestId:f});return s.data=((g=c==null?void 0:c.result)===null||g===void 0?void 0:g.data)||{},s.requestId=f,[3,4];case 3:throw d=b.sent(),d.name==="WxCloudSDKError"?d:(console.log(d),new si("【错误】".concat(d.message,`
      【操作】调用 models.`).concat(t?"".concat(t,"."):"").concat(o,`
      【请求ID】N/A`),{code:"UnknownError",originError:d}));case 4:return[2,s]}})})},Hp=function(e){var t=e.sql,r=e.params,n=e.config,o=e.callFunction,i=e.unsafe,a=i===void 0?!1:i;return io(void 0,void 0,void 0,function(){return oo(this,function(u){return[2,w3({realMethodName:"$runSQL",methodName:"callWedaApi",params:{action:"RunMysqlCommand",data:{sqlTemplate:t,config:n,parameter:a?"":Object.entries(r||{}).reduce(function(l,s){var c=s[0],f=s[1];if(f!==void 0){var d="OBJECT",v=typeof f;switch(v){case"boolean":{d="BOOLEAN";break}case"number":{d="NUMBER";break}case"string":{d="STRING";break}default:Array.isArray(f)?d="ARRAY":d="OBJECT"}l.push({key:c,type:d,value:d==="STRING"?f:JSON.stringify(f)})}return l},[])||[]}},callFunction:o,mode:"sdk"})]})})},E3=function(e){return{$runSQL:function(t,r,n){return io(this,void 0,void 0,function(){var o;return oo(this,function(i){switch(i.label){case 0:return[4,Hp({sql:t,params:r,config:ot(ot({},n),{preparedStatements:!0}),callFunction:e})];case 1:return o=i.sent(),[2,o]}})})},$runSQLRaw:function(t,r){return io(this,void 0,void 0,function(){var n;return oo(this,function(o){switch(o.label){case 0:return[4,Hp({sql:t,params:[],config:ot(ot({},r),{preparedStatements:!1}),callFunction:e})];case 1:return n=o.sent(),[2,n]}})})}}},Gp={filter:{where:{}},select:{$master:!0}};function Xr(e){return{getUrl:function(t){return"".concat(t,"/").concat(e)},method:"post"}}var S3={get:ot(ot({},Xr("get")),{defaultParams:ot({},Gp)}),list:ot(ot({},Xr("list")),{defaultParams:ot({},Gp)}),create:Xr("create"),createMany:Xr("createMany"),update:ot(ot({},Xr("update")),{method:"put"}),updateMany:ot(ot({},Xr("updateMany")),{method:"put"}),upsert:Xr("upsert"),delete:Xr("delete"),deleteMany:Xr("deleteMany")},Xs="Unknown error occurred",Vp="NotSupported",I3=function(e,t,r,n){var o=E3(e);return new Proxy({},{get:function(i,a){if(typeof a=="string")return Object.prototype.hasOwnProperty.call(o,a)?o[a]:O3(r,a,t,n)}})},Kp=function(e,t,r,n,o){return new si("【错误】".concat(e,`
【操作】调用 models.`).concat(t,".").concat(r,`
【错误码】`).concat(n,`
【请求ID】`).concat(o),{code:n,requestId:o})},O3=function(e,t,r,n){var o=new Proxy({},{get:function(i,a){if(a!=="runSQLTemplate"){var u=S3[a];if(!u){var l=new Error("不支持的操作: ".concat(a));throw new si(l.message||Xs,{originError:l,code:Vp,requestId:"N/A"})}return function(s){return s===void 0&&(s={}),io(void 0,void 0,void 0,function(){var c,f,d,v,g,b,y,w,E,A;return oo(this,function(I){switch(I.label){case 0:c=u.getUrl,f=u.method,d=u.defaultParams,v=d===void 0?{}:d,g=Object.assign({},v,s),b=g.envType==="pre"?"pre":"prod",y=[e,b,c(t)].join("/"),I.label=1;case 1:return I.trys.push([1,3,,4]),[4,r({url:y,body:JSON.stringify(g),method:f})];case 2:if(w=I.sent(),w.code)throw Kp(w==null?void 0:w.message,t,a,w==null?void 0:w.code,w==null?void 0:w.requestId);return a==="get"&&Object.assign(w,{data:(A=w.data.record)!==null&&A!==void 0?A:w.data}),[2,w];case 3:throw E=I.sent(),new si((E==null?void 0:E.message)||Xs,{originError:E});case 4:return[2]}})})}}else{if(!(n!=null&&n.sqlBaseUrl)){var l=new Error("不支持的操作: ".concat(a));throw new si(l.message||Xs,{originError:l,code:Vp,requestId:"N/A"})}return function(s){return io(void 0,void 0,void 0,function(){var c,f,d,v,g,b,y,w,E,A,I,R,L,F,U,N;return oo(this,function(W){switch(W.label){case 0:c=s.params,f=s.templateName,d=s.envType,v=d==="pre"?"pre":"prod",g=[n.sqlBaseUrl,v,f,"run"].join("/"),b=Object.entries(c||{}).reduce(function(j,X){var fe=X[0],q=X[1];if(q!==void 0){var de="OBJECT",k=typeof q;switch(k){case"boolean":{de="BOOLEAN";break}case"number":{de="NUMBER";break}case"string":{de="STRING";break}default:Array.isArray(q)?de="ARRAY":de="OBJECT"}j.push({key:fe,type:de,value:de==="STRING"?q:JSON.stringify(q)})}return j},[]),W.label=1;case 1:return W.trys.push([1,3,,4]),[4,r({url:g,body:JSON.stringify({parameter:b}),method:"POST"})];case 2:if(y=W.sent(),!((E=y==null?void 0:y.Response)===null||E===void 0)&&E.Error)throw Kp((I=(A=y==null?void 0:y.Response)===null||A===void 0?void 0:A.Error)===null||I===void 0?void 0:I.Message,t,a,(L=(R=y==null?void 0:y.Response)===null||R===void 0?void 0:R.Error)===null||L===void 0?void 0:L.Code,(F=y==null?void 0:y.Response)===null||F===void 0?void 0:F.RequestId);return[2,ot(ot({},(U=y==null?void 0:y.Response)!==null&&U!==void 0?U:{}),{data:(N=y==null?void 0:y.Response)===null||N===void 0?void 0:N.Data})];case 3:throw w=W.sent(),new si((w==null?void 0:w.message)||Xs,{originError:w});case 4:return[2]}})})}}}});return o},is=function(){return is=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},is.apply(this,arguments)},T3=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},A3=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},R3=Bg,zp="models";function C3(e){var t=this,r=e.callFunction.bind(e),n=e.request.fetch.bind(e.request),o=function(f){return T3(t,void 0,void 0,function(){var d;return A3(this,function(v){switch(v.label){case 0:return[4,n(is(is({},f),{headers:is({"Content-Type":"application/json"},f.headers)}))];case 1:return d=v.sent(),[4,d.data];case 2:return[2,v.sent()]}})})},i=e.getEndPointWithKey("GATEWAY"),a=i.BASE_URL,u=i.PROTOCOL,l="".concat(u).concat(a,"/model"),s="".concat(u).concat(a,"/sql"),c=I3(r,o,l,{sqlBaseUrl:s});return c}var Jp=new WeakMap;function x3(e){return new Proxy({},{get:function(t,r){var n=Jp.get(e);return n||(n=C3(e),Jp.set(e,n)),n[r]}})}var Q0="cloudbase_init",X0=new R3;X0.on(Q0,function(e){var t=e.data;Object.assign(t,{models:x3(t)})});var Z0={name:zp,namespace:zp,entity:new Proxy({},{get:function(e,t){console.warn("【deprecated】Accessing Cloudbase.prototype.models.".concat(t,"."))}}),injectEvents:{bus:X0,events:[Q0]}};try{cloudbase.registerComponent(Z0)}catch{}function P3(e){try{e.registerComponent(Z0)}catch(t){console.warn(t)}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Wl=function(e,t){return Wl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},Wl(e,t)};function e_(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Wl(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function so(e){if(!e)throw new TypeError("Assertion failed")}function N3(){}function $3(e){return typeof e=="object"&&e!==null||typeof e=="function"}function D3(e){if(typeof e!="function")return!1;var t=!1;try{new e({start:function(){t=!0}})}catch{}return t}function t_(e){return!(!$3(e)||typeof e.getReader!="function")}function L3(e){return!(!D3(e)||!t_(new e))}function r_(e){try{var t=e.getReader({mode:"byob"});return t.releaseLock(),!0}catch{return!1}}function U3(e){try{return new e({type:"bytes"}),!0}catch{return!1}}function F3(e){so(L3(e));var t=U3(e);return function(r,n){var o=n===void 0?{}:n,i=o.type;if(i=n_(i),i==="bytes"&&!t&&(i=void 0),r.constructor===e&&(i!=="bytes"||r_(r)))return r;if(i==="bytes"){var a=Yp(r,{type:i});return new e(a)}else{var a=Yp(r);return new e(a)}}}function Yp(e,t){var r=t===void 0?{}:t,n=r.type;so(t_(e)),so(e.locked===!1),n=n_(n);var o;return n==="bytes"?o=new j3(e):o=new M3(e),o}function n_(e){var t=String(e);if(t==="bytes")return t;if(e===void 0)return e;throw new RangeError("Invalid type is specified")}var i_=function(){function e(t){this._underlyingReader=void 0,this._readerMode=void 0,this._readableStreamController=void 0,this._pendingRead=void 0,this._underlyingStream=t,this._attachDefaultReader()}return e.prototype.start=function(t){this._readableStreamController=t},e.prototype.cancel=function(t){return so(this._underlyingReader!==void 0),this._underlyingReader.cancel(t)},e.prototype._attachDefaultReader=function(){if(this._readerMode!=="default"){this._detachReader();var t=this._underlyingStream.getReader();this._readerMode="default",this._attachReader(t)}},e.prototype._attachReader=function(t){var r=this;so(this._underlyingReader===void 0),this._underlyingReader=t;var n=this._underlyingReader.closed;n&&n.then(function(){return r._finishPendingRead()}).then(function(){t===r._underlyingReader&&r._readableStreamController.close()},function(o){t===r._underlyingReader&&r._readableStreamController.error(o)}).catch(N3)},e.prototype._detachReader=function(){this._underlyingReader!==void 0&&(this._underlyingReader.releaseLock(),this._underlyingReader=void 0,this._readerMode=void 0)},e.prototype._pullWithDefaultReader=function(){var t=this;this._attachDefaultReader();var r=this._underlyingReader.read().then(function(n){var o=t._readableStreamController;n.done?t._tryClose():o.enqueue(n.value)});return this._setPendingRead(r),r},e.prototype._tryClose=function(){try{this._readableStreamController.close()}catch{}},e.prototype._setPendingRead=function(t){var r=this,n,o=function(){r._pendingRead===n&&(r._pendingRead=void 0)};this._pendingRead=n=t.then(o,o)},e.prototype._finishPendingRead=function(){var t=this;if(this._pendingRead){var r=function(){return t._finishPendingRead()};return this._pendingRead.then(r,r)}},e}(),M3=function(e){e_(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.pull=function(){return this._pullWithDefaultReader()},t}(i_);function Qp(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function B3(e,t){var r=Qp(e),n=Qp(t);n.set(r,0)}var j3=function(e){e_(t,e);function t(r){var n=this,o=r_(r);return n=e.call(this,r)||this,n._supportsByob=o,n}return Object.defineProperty(t.prototype,"type",{get:function(){return"bytes"},enumerable:!1,configurable:!0}),t.prototype._attachByobReader=function(){if(this._readerMode!=="byob"){so(this._supportsByob),this._detachReader();var r=this._underlyingStream.getReader({mode:"byob"});this._readerMode="byob",this._attachReader(r)}},t.prototype.pull=function(){if(this._supportsByob){var r=this._readableStreamController.byobRequest;if(r)return this._pullWithByobRequest(r)}return this._pullWithDefaultReader()},t.prototype._pullWithByobRequest=function(r){var n=this;this._attachByobReader();var o=new Uint8Array(r.view.byteLength),i=this._underlyingReader.read(o).then(function(a){n._readableStreamController,a.done?(n._tryClose(),r.respond(0)):(B3(a.value,r.view),r.respond(a.value.byteLength))});return this._setPendingRead(i),i},t}(i_);function k3(e){var t,r,n,o,i,a,u;return l(),{feed:s,reset:l};function l(){t=!0,r="",n=0,o=-1,i=void 0,a=void 0,u=""}function s(f){r=r?r+f:f,t&&q3(r)&&(r=r.slice(o_.length)),t=!1;for(var d=r.length,v=0,g=!1;v<d;){g&&(r[v]===`
`&&(v+=1),g=!1);for(var b=-1,y=o,w=void 0,E=n;b<0&&E<d;E++)w=r[E],w===":"&&y<0?y=E-v:w==="\r"?(g=!0,b=E-v):w===`
`&&(b=E-v);if(b<0){n=d-v,o=y;break}else n=0,o=-1;c(r,v,y,b),v+=b+1}v===d?r="":v>0&&(r=r.slice(v))}function c(f,d,v,g){if(g===0){u.length>0&&(e({type:"event",id:i,event:a||void 0,data:u.slice(0,-1)}),u="",i=void 0),a=void 0;return}var b=v<0,y=f.slice(d,d+(b?g:v)),w=0;b?w=g:f[d+v+1]===" "?w=v+2:w=v+1;var E=d+w,A=g-w,I=f.slice(E,E+A).toString();if(y==="data")u+=I?"".concat(I,`
`):`
`;else if(y==="event")a=I;else if(y==="id"&&!I.includes("\0"))i=I;else if(y==="retry"){var R=parseInt(I,10);Number.isNaN(R)||e({type:"reconnect-interval",value:R})}}}var o_=[239,187,191];function q3(e){return o_.every(function(t,r){return e.charCodeAt(r)===t})}var s_={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(be,function(){var r=typeof be<"u"?be:self;if(typeof r.TextEncoder<"u"&&typeof r.TextDecoder<"u")return{TextEncoder:r.TextEncoder,TextDecoder:r.TextDecoder};var n=["utf8","utf-8","unicode-1-1-utf-8"],o=function(a){if(n.indexOf(a)<0&&typeof a<"u"&&a!==null)throw new RangeError("Invalid encoding type. Only utf-8 is supported");this.encoding="utf-8",this.encode=function(u){if(typeof u!="string")throw new TypeError("passed argument must be of type string");var l=unescape(encodeURIComponent(u)),s=new Uint8Array(l.length);return l.split("").forEach(function(c,f){s[f]=c.charCodeAt(0)}),s}},i=function(a,u){if(n.indexOf(a)<0&&typeof a<"u"&&a!==null)throw new RangeError("Invalid encoding type. Only utf-8 is supported");if(this.encoding="utf-8",this.ignoreBOM=!1,this.fatal=typeof u<"u"&&"fatal"in u?u.fatal:!1,typeof this.fatal!="boolean")throw new TypeError("fatal flag must be boolean");this.decode=function(l,s){if(typeof l>"u")return"";var c=typeof s<"u"&&"stream"in s?s.stream:!1;if(typeof c!="boolean")throw new TypeError("stream option must be boolean");if(ArrayBuffer.isView(l)){var f=new Uint8Array(l.buffer,l.byteOffset,l.byteLength),d=new Array(f.length);return f.forEach(function(v,g){d[g]=String.fromCharCode(v)}),decodeURIComponent(escape(d.join("")))}else throw new TypeError("passed argument must be an array buffer view")}};return{TextEncoder:o,TextDecoder:i}})})(s_);var W3=s_.exports,a_=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},u_=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},H3=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=e[i]&&function(a){return new Promise(function(u,l){a=e[i](a),o(u,l,a.done,a.value)})}}function o(i,a,u,l){Promise.resolve(l).then(function(s){i({value:s,done:u})},a)}},G3=ut,Qe=ka,c_=function(){var e;return new Qe({start:function(t){e=k3(function(r){r.type==="event"&&t.enqueue(r)})},transform:function(t){e.feed(t)}})},Xt=F3(G3),cd=function(){function e(t,r){t===void 0&&(t="utf-8"),r===void 0&&(r={});var n=this;this.transform=new Qe({transform:function(o,i){var a=n.handle.decode(new Uint8Array(o),{stream:!0});a&&i.enqueue(a)},flush:function(o){var i=n.handle.decode();i&&o.enqueue(i),o.terminate()}}),this.handle=new W3.TextDecoder(t,r)}return Object.defineProperty(e.prototype,"encoding",{get:function(){return this.handle.encoding},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fatal",{get:function(){return this.handle.fatal},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ignoreBOM",{get:function(){return this.handle.ignoreBOM},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"readable",{get:function(){return this.transform.readable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"writable",{get:function(){return this.transform.writable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return"TextDecoderStream"},enumerable:!1,configurable:!0}),e}();function Ge(e){var t=e;return t[Symbol.asyncIterator]=function(){var r=e.getReader();return{next:function(){return a_(this,void 0,void 0,function(){var n,o,i;return u_(this,function(a){switch(a.label){case 0:return[4,r.read()];case 1:return n=a.sent(),o=n.done,i=n.value,[2,o?{done:!0,value:void 0}:{done:!1,value:i}]}})})}}},t}function Ir(e){return Ge(e.pipeThrough(new cd).pipeThrough(c_()).pipeThrough(new Qe({transform:function(t,r){try{var n=JSON.parse(t.data);r.enqueue(n)}catch(o){t.data!=="[DONE]"?console.warn("Error when transforming event source data to json",o,t):r.terminate()}}})))}function V3(e){return Ge(Xt(e).pipeThrough(new cd))}function K3(e){var t,r,n,o;return a_(this,void 0,void 0,function(){var i,a,u,l,s,c,f;return u_(this,function(d){switch(d.label){case 0:i=V3(e),a="",d.label=1;case 1:d.trys.push([1,6,7,12]),u=!0,l=H3(i),d.label=2;case 2:return[4,l.next()];case 3:if(s=d.sent(),t=s.done,!!t)return[3,5];o=s.value,u=!1;try{c=o,a+=c}finally{u=!0}d.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return f=d.sent(),r={error:f},[3,12];case 7:return d.trys.push([7,,10,11]),!u&&!t&&(n=l.return)?[4,n.call(l)]:[3,9];case 8:d.sent(),d.label=9;case 9:return[3,11];case 10:if(r)throw r.error;return[7];case 11:return[7];case 12:return[2,JSON.parse(a)]}})})}function Xp(){var e,t,r=new Promise(function(n,o){e=n,t=o});return{promise:r,res:e,rej:t}}function fr(e){var t;return e.role==="assistant"&&"tool_calls"in e&&((t=e.tool_calls)===null||t===void 0?void 0:t[0])!=null}function z3(e){return{type:"function",function:{description:e.description,name:e.name,parameters:e.parameters}}}var Tn=function(){return Tn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Tn.apply(this,arguments)},pr=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},vr=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Zs=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},J3=function(){function e(t,r){this.baseUrl=r;var n=arguments[2];typeof n=="string"?this.req=function(o){var i=o.headers,a=i===void 0?{}:i,u=Zs(o,["headers"]);return t(Tn(Tn({},u),{headers:Tn(Tn({},a),{Authorization:"Bearer ".concat(n)})}))}:this.req=t}return e.prototype.list=function(t,r){return this.req({method:"get",url:this.join("bots"),data:t,timeout:r==null?void 0:r.timeout})},e.prototype.create=function(t,r){var n=t.botInfo;return this.req({method:"post",url:this.join("bots"),data:n,timeout:r==null?void 0:r.timeout})},e.prototype.get=function(t,r){var n=t.botId;return this.req({method:"get",url:this.join("bots/".concat(n)),timeout:r==null?void 0:r.timeout})},e.prototype.update=function(t,r){var n=t.botId,o=t.botInfo;return this.req({method:"PATCH",url:this.join("bots/".concat(n)),data:o,timeout:r==null?void 0:r.timeout})},e.prototype.delete=function(t,r){var n=t.botId;return this.req({method:"delete",url:this.join("bots/".concat(n)),timeout:r==null?void 0:r.timeout})},e.prototype.getChatRecords=function(t,r){return this.req({method:"get",url:this.join("bots/".concat(t.botId,"/records")),data:t,timeout:r==null?void 0:r.timeout})},e.prototype.sendFeedback=function(t,r){var n=t.userFeedback;return this.req({method:"post",url:this.join("bots/".concat(n.botId,"/feedback")),data:n,timeout:r==null?void 0:r.timeout})},e.prototype.getFeedback=function(t,r){return this.req({method:"get",url:this.join("bots/".concat(t.botId,"/feedback")),data:t,timeout:r==null?void 0:r.timeout})},e.prototype.uploadFiles=function(t,r){return pr(this,void 0,void 0,function(){return vr(this,function(n){return[2,this.req({method:"post",url:this.join("bots/".concat(t.botId,"/files")),data:t,timeout:r==null?void 0:r.timeout})]})})},e.prototype.createConversation=function(t,r){var n=t.botId,o=Zs(t,["botId"]);return pr(this,void 0,void 0,function(){return vr(this,function(i){return[2,this.req({method:"post",url:this.join("bots/".concat(n,"/conversation")),data:o,timeout:r==null?void 0:r.timeout})]})})},e.prototype.getConversation=function(t,r){var n=t.pageSize,o=n===void 0?10:n,i=t.pageNumber,a=i===void 0?1:i,u=t.botId,l=Zs(t,["pageSize","pageNumber","botId"]);return pr(this,void 0,void 0,function(){var s,c;return vr(this,function(f){if(a<1)throw new Error("pageNumber must be greater than 0");return s=o*(a-1),c=o,[2,this.req({method:"get",url:this.join("bots/".concat(u,"/conversation")),data:Tn(Tn({},l),{offset:s,limit:c}),timeout:r==null?void 0:r.timeout})]})})},e.prototype.deleteConversation=function(t,r){var n=t.botId,o=t.conversationId,i=Zs(t,["botId","conversationId"]);return pr(this,void 0,void 0,function(){return vr(this,function(a){return[2,this.req({method:"delete",url:this.join("bots/".concat(n,"/conversation/").concat(o)),data:i,timeout:r==null?void 0:r.timeout})]})})},e.prototype.speechToText=function(t,r){return pr(this,void 0,void 0,function(){return vr(this,function(n){return[2,this.req({method:"post",url:this.join("bots/".concat(t.botId,"/speech-to-text")),data:t,timeout:r==null?void 0:r.timeout})]})})},e.prototype.textToSpeech=function(t,r){return pr(this,void 0,void 0,function(){return vr(this,function(n){return[2,this.req({method:"post",url:this.join("bots/".concat(t.botId,"/text-to-speech")),data:t,timeout:r==null?void 0:r.timeout})]})})},e.prototype.getTextToSpeechResult=function(t,r){return pr(this,void 0,void 0,function(){return vr(this,function(n){return[2,this.req({method:"get",url:this.join("bots/".concat(t.botId,"/text-to-speech")),data:t,timeout:r==null?void 0:r.timeout})]})})},e.prototype.getRecommendQuestions=function(t,r){return pr(this,void 0,void 0,function(){var n;return vr(this,function(o){switch(o.label){case 0:return[4,this.req({method:"post",url:this.join("bots/".concat(t.botId,"/recommend-questions")),data:t,stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,new ea(n)]}})})},e.prototype.generateBot=function(t,r){return pr(this,void 0,void 0,function(){var n;return vr(this,function(o){switch(o.label){case 0:return[4,this.req({method:"post",url:this.join("generate-bot"),data:t,stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,new ea(n)]}})})},e.prototype.getPreview=function(t,r){return pr(this,void 0,void 0,function(){var n;return vr(this,function(o){switch(o.label){case 0:return[4,this.req({method:"post",url:this.join("preview"),data:t,stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,new ea(n)]}})})},e.prototype.generateImage=function(t,r){return this.req({method:"post",url:this.join("generate-image"),data:t,timeout:r==null?void 0:r.timeout})},e.prototype.sendMessage=function(t,r){return pr(this,void 0,void 0,function(){var n;return vr(this,function(o){switch(o.label){case 0:return[4,this.req({method:"post",url:this.join("bots/".concat(t.botId,"/send-message")),data:t,stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,new ea(n)]}})})},e.prototype.join=function(t){return"".concat(this.baseUrl,"/").concat(t)},e}(),ea=function(){function e(t){var r=Xt(t);this._eventSourceStream=r.pipeThrough(new cd).pipeThrough(c_())}return Object.defineProperty(e.prototype,"teeedStream",{get:function(){var t=this._eventSourceStream.tee(),r=t[0],n=t[1];return this._eventSourceStream=n,r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"eventSourceStream",{get:function(){return Ge(this.teeedStream)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataStream",{get:function(){return Ge(this.eventSourceStream.pipeThrough(new Qe({transform:function(t,r){try{var n=JSON.parse(t.data);r.enqueue(n)}catch(o){t.data!=="[DONE]"?console.warn("Error when transforming event source data to json",o,t):r.terminate()}}})))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textStream",{get:function(){return Ge(this.dataStream.pipeThrough(new Qe({transform:function(t,r){var n;r.enqueue((n=t==null?void 0:t.content)!==null&&n!==void 0?n:"")}})))},enumerable:!1,configurable:!0}),e}(),dt=function(){return dt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},dt.apply(this,arguments)},Zp=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},ev=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function tv(e){var t=e.messages,r=e.model,n=e.temperature,o=e.tool_choice,i=e.tools,a=e.top_p,u=function(){return o&&o!=="auto"&&console.warn("`tool_choice` is not 'auto'"),o};return dt(dt({},e),{messages:t,model:r,temperature:n,tool_choice:u(),tools:i,top_p:a})}var l_=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="zhipu/api/paas/v4/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t,r){return Zp(this,void 0,void 0,function(){var n,o;return ev(this,function(i){switch(i.label){case 0:return n=tv(t),[4,this.req({url:this.url,data:dt(dt({},n),{stream:!1}),stream:!1,timeout:r==null?void 0:r.timeout})];case 1:return o=i.sent(),[2,dt(dt({},o),{rawResponse:o})]}})})},e.prototype.doStream=function(t,r){return Zp(this,void 0,void 0,function(){var n,o,i,a,u,l;return ev(this,function(s){switch(s.label){case 0:return n=tv(t),o=null,[4,this.req({url:this.url,data:dt(dt({},n),{stream:!0}),stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return i=s.sent(),a=Xt(i),u=Ir(a),l=u.pipeThrough(new Qe({transform:function(c,f){var d=c.choices.map(function(g){var b=g.delta;return o==null&&(o=fr(b)),o?dt(dt({},g),{finish_reason:"tool_calls",delta:b}):g}),v=dt(dt({},c),{choices:d});f.enqueue(dt(dt({},v),{rawResponse:c}))}})),[2,Ge(l)]}})})},e}(),ru=function(){return ru=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ru.apply(this,arguments)};function yi(e){var t=e.messages,r=e.model,n=e.temperature,o=e.tool_choice,i=e.tools,a=e.top_p,u=function(){if(i)return i.forEach(function(s){s.type!=="function"&&console.warn("`type` in tool is not 'function'",s)}),i},l=function(){return t.forEach(function(s){"tool_calls"in s&&s.tool_calls.filter(function(c){return c.type!=="function"}).forEach(function(c){return console.warn("`type` in tool_call is not 'function'",c,s)})}),t};return ru(ru({},e),{messages:l(),model:r,tools:u(),top_p:a,tool_choice:o,temperature:n})}function nu(e){if(typeof e!="object"||e==null)return e;if(Array.isArray(e))return e.map(function(r){return nu(r)});return Object.entries(e).reduce(function(r,n){var o=n[0],i=n[1],a=t(o);return r[a]=typeof i=="object"?nu(i):i,r},{});function t(r){var n=r.replace(/[A-Z]/g,function(o){return"_".concat(o.toLowerCase())});return n.charAt(0)==="_"?n.slice(1):n}}var Nt=function(){return Nt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Nt.apply(this,arguments)},rv=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},nv=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},f_=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="hunyuan-beta/openapi/v1/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t,r){return rv(this,void 0,void 0,function(){var n;return nv(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:Nt(Nt({},yi(t)),{stream:!1}),stream:!1,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,Nt(Nt({},n),{rawResponse:n})]}})})},e.prototype.doStream=function(t,r){return rv(this,void 0,void 0,function(){var n,o,i,a,u;return nv(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:Nt(Nt({},yi(t)),{stream:!0}),stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return o=l.sent(),i=Xt(o),a=Ir(i),u=a.pipeThrough(new Qe({transform:function(s,c){var f=s.choices.map(function(v){var g=v.delta;return n==null&&(n=fr(g)),n?Nt(Nt({},v),{finish_reason:"tool_calls",delta:g}):v}),d=Nt(Nt({},s),{choices:f});c.enqueue(Nt(Nt({},d),{rawResponse:s}))}})),[2,Ge(u)]}})})},e}(),$t=function(){return $t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},$t.apply(this,arguments)},iv=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},ov=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},d_=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="hunyuan",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t,r){return iv(this,void 0,void 0,function(){var n,o;return ov(this,function(i){switch(i.label){case 0:return[4,this.req({url:this.url,headers:{"X-Tc-Action":"ChatCompletions"},data:$t($t({},yi(t)),{stream:!1}),stream:!1,timeout:r==null?void 0:r.timeout})];case 1:return n=i.sent(),o=nu(n.Response),[2,$t($t({},o),{rawResponse:n})]}})})},e.prototype.doStream=function(t,r){return iv(this,void 0,void 0,function(){var n,o,i,a,u;return ov(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,headers:{"X-Tc-Action":"ChatCompletions"},data:$t($t({},t),{stream:!0}),stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return o=l.sent(),i=Xt(o),a=Ir(i),u=a.pipeThrough(new Qe({transform:function(s,c){var f=nu(s),d=f.choices.map(function(g){var b=g.delta;return n==null&&(n=fr(b)),n?$t($t({},g),{finish_reason:"tool_calls",delta:b}):g}),v=$t($t({},f),{choices:d});c.enqueue($t($t({},v),{rawResponse:s}))}})),[2,Ge(u)]}})})},e}(),ht=function(){return ht=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ht.apply(this,arguments)},sv=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},av=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function uv(e){var t=e.messages,r=e.model,n=e.temperature,o=e.tools,i=e.top_p;return ht(ht({},e),{messages:t,model:r,tools:o,top_p:i,temperature:n})}var h_=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="ark/api/v3/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t,r){return sv(this,void 0,void 0,function(){var n;return av(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:ht(ht({},uv(t)),{stream:!1}),stream:!1,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,ht(ht({},n),{rawResponse:n})]}})})},e.prototype.doStream=function(t,r){return sv(this,void 0,void 0,function(){var n,o,i,a,u;return av(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:ht(ht({},uv(t)),{stream:!0}),stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return o=l.sent(),i=Xt(o),a=Ir(i),u=a.pipeThrough(new Qe({transform:function(s,c){var f=s.choices.map(function(v){var g=v.delta;return n==null&&(n=fr(g)),n?ht(ht({},v),{finish_reason:"tool_calls",delta:g}):v}),d=ht(ht({},s),{choices:f});c.enqueue(ht(ht({},d),{rawResponse:s}))}})),[2,Ge(u)]}})})},e}(),nt=function(){return nt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},nt.apply(this,arguments)},cv=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},lv=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function fv(e){var t=e.messages,r=e.model,n=e.temperature,o=e.tools,i=e.top_p;return nt(nt({},e),{messages:t,model:r,tools:o,top_p:i,temperature:n})}var p_=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="dashscope/compatible-mode/v1/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t,r){return cv(this,void 0,void 0,function(){var n;return lv(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:nt(nt({},fv(t)),{stream:!1}),stream:!1,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,nt(nt({},n),{rawResponse:n})]}})})},e.prototype.doStream=function(t,r){return cv(this,void 0,void 0,function(){var n,o,i,a,u;return lv(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:nt(nt({},fv(t)),{stream:!0}),stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return o=l.sent(),i=Xt(o),a=Ir(i),u=a.pipeThrough(new Qe({transform:function(s,c){var f=s.choices.map(function(v){var g=Object.assign(v.delta,{role:"assistant"});return n==null&&(n=fr(g)),n?nt(nt({},v),{finish_reason:"tool_calls",delta:g}):nt(nt({},v),{delta:g})}),d=nt(nt({},s),{choices:f});c.enqueue(nt(nt({},d),{rawResponse:s}))}})),[2,Ge(u)]}})})},e}(),it=function(){return it=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},it.apply(this,arguments)},dv=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},hv=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function pv(e){var t=e.messages,r=e.model,n=e.temperature,o=e.tools,i=e.top_p;return it(it({},e),{messages:t,model:r,tools:o,top_p:i,temperature:n})}var v_=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="01-ai/v1/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t,r){return dv(this,void 0,void 0,function(){var n;return hv(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:it(it({},pv(t)),{stream:!1}),stream:!1,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,it(it({},n),{rawResponse:n})]}})})},e.prototype.doStream=function(t,r){return dv(this,void 0,void 0,function(){var n,o,i,a,u;return hv(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:it(it({},pv(t)),{stream:!0}),stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return o=l.sent(),i=Xt(o),a=Ir(i),u=a.pipeThrough(new Qe({transform:function(s,c){var f,d,v,g,b,y;if(!((v=(d=(f=s==null?void 0:s.choices)===null||f===void 0?void 0:f[0])===null||d===void 0?void 0:d.delta)===null||v===void 0)&&v.content||!((y=(b=(g=s==null?void 0:s.choices)===null||g===void 0?void 0:g[0])===null||b===void 0?void 0:b.delta)===null||y===void 0)&&y.tool_calls){var w=s.choices.map(function(A){var I=Object.assign(A.delta,{role:"assistant"});return n==null&&(n=fr(I)),n?it(it({},A),{finish_reason:"tool_calls",delta:I}):it(it({},A),{delta:I})}),E=it(it({},s),{choices:w});c.enqueue(it(it({},E),{rawResponse:s}))}}})),[2,Ge(u)]}})})},e}(),pt=function(){return pt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},pt.apply(this,arguments)},vv=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},mv=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function gv(e){var t=e.messages,r=e.model,n=e.temperature,o=e.tools,i=e.top_p;return pt(pt({},e),{messages:t,model:r,tools:o,top_p:i,temperature:n})}var m_=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="moonshot/v1/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t,r){return vv(this,void 0,void 0,function(){var n;return mv(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:pt(pt({},gv(t)),{stream:!1}),stream:!1,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,pt(pt({},n),{rawResponse:n})]}})})},e.prototype.doStream=function(t,r){return vv(this,void 0,void 0,function(){var n,o,i,a,u;return mv(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:pt(pt({},gv(t)),{stream:!0}),stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return o=l.sent(),i=Xt(o),a=Ir(i),u=a.pipeThrough(new Qe({transform:function(s,c){var f=s.choices.map(function(v){var g=v.delta;return n==null&&(n=fr(g)),n?pt(pt({},v),{finish_reason:"tool_calls",delta:g}):v}),d=pt(pt({},s),{choices:f});c.enqueue(pt(pt({},d),{rawResponse:s}))}})),[2,Ge(u)]}})})},e}(),Dt=function(){return Dt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Dt.apply(this,arguments)},yv=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},_v=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},g_=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="hunyuan-exp/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t){return yv(this,void 0,void 0,function(){var r;return _v(this,function(n){switch(n.label){case 0:return[4,this.req({url:this.url,data:Dt(Dt({},yi(t)),{stream:!1}),stream:!1})];case 1:return r=n.sent(),[2,Dt(Dt({},r),{rawResponse:r})]}})})},e.prototype.doStream=function(t){return yv(this,void 0,void 0,function(){var r,n,o,i,a;return _v(this,function(u){switch(u.label){case 0:return r=null,[4,this.req({url:this.url,data:Dt(Dt({},yi(t)),{stream:!0}),stream:!0})];case 1:return n=u.sent(),o=Xt(n),i=Ir(o),a=i.pipeThrough(new Qe({transform:function(l,s){var c=l.choices.map(function(d){var v=d.delta;return r==null&&(r=fr(v)),r?Dt(Dt({},d),{finish_reason:"tool_calls",delta:v}):d}),f=Dt(Dt({},l),{choices:c});s.enqueue(Dt(Dt({},f),{rawResponse:l}))}})),[2,Ge(a)]}})})},e}(),Lt=function(){return Lt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Lt.apply(this,arguments)},bv=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},wv=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},y_=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="hunyuan-open/v1/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t,r){return bv(this,void 0,void 0,function(){var n;return wv(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:Lt(Lt({},yi(t)),{stream:!1}),stream:!1,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,Lt(Lt({},n),{rawResponse:n})]}})})},e.prototype.doStream=function(t,r){return bv(this,void 0,void 0,function(){var n,o,i,a,u;return wv(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:Lt(Lt({},yi(t)),{stream:!0}),stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return o=l.sent(),i=Xt(o),a=Ir(i),u=a.pipeThrough(new Qe({transform:function(s,c){var f=s.choices.map(function(v){var g=v.delta;return n==null&&(n=fr(g)),n?Lt(Lt({},v),{finish_reason:"tool_calls",delta:g}):v}),d=Lt(Lt({},s),{choices:f});c.enqueue(Lt(Lt({},d),{rawResponse:s}))}})),[2,Ge(u)]}})})},e}(),Ut=function(){return Ut=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ut.apply(this,arguments)},Ev=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Sv=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Y3=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="deepseek/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t,r){return Ev(this,void 0,void 0,function(){var n;return Sv(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:Ut(Ut({},t),{stream:!1}),stream:!1,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,Ut(Ut({},n),{rawResponse:n})]}})})},e.prototype.doStream=function(t,r){return Ev(this,void 0,void 0,function(){var n,o,i,a,u;return Sv(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:Ut(Ut({},t),{stream:!0}),stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return o=l.sent(),i=Xt(o),a=Ir(i),u=a.pipeThrough(new Qe({transform:function(s,c){var f=s.choices.map(function(v){var g=v.delta;return n==null&&(n=fr(g)),n?Ut(Ut({},v),{finish_reason:"tool_calls",delta:g}):v}),d=Ut(Ut({},s),{choices:f});c.enqueue(Ut(Ut({},d),{rawResponse:s}))}})),[2,Ge(u)]}})})},e}(),Ft=function(){return Ft=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ft.apply(this,arguments)},Iv=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Ov=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},__=function(){function e(t,r,n){n===void 0&&(n=""),this.req=t,this.baseUrl=r,this.subUrl=n}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t){return Iv(this,void 0,void 0,function(){var r;return Ov(this,function(n){switch(n.label){case 0:return[4,this.req({url:this.url,data:Ft(Ft({},t),{stream:!1}),stream:!1})];case 1:return r=n.sent(),[2,Ft(Ft({},r),{rawResponse:r})]}})})},e.prototype.doStream=function(t){return Iv(this,void 0,void 0,function(){var r,n,o,i,a;return Ov(this,function(u){switch(u.label){case 0:return r=null,[4,this.req({url:this.url,data:Ft(Ft({},t),{stream:!0}),stream:!0})];case 1:return n=u.sent(),o=Xt(n),i=Ir(o),a=i.pipeThrough(new Qe({transform:function(l,s){var c=l.choices.map(function(d){var v=d.delta;return r==null&&(r=fr(v)),r?Ft(Ft({},d),{finish_reason:"tool_calls",delta:v}):d}),f=Ft(Ft({},l),{choices:c});s.enqueue(Ft(Ft({},f),{rawResponse:l}))}})),[2,Ge(a)]}})})},e}(),iu=function(){return iu=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},iu.apply(this,arguments)},Hl=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Gl=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Q3=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},X3=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=e[i]&&function(a){return new Promise(function(u,l){a=e[i](a),o(u,l,a.done,a.value)})}}function o(i,a,u,l){Promise.resolve(l).then(function(s){i({value:s,done:u})},a)}},xr=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))};function Tv(e){var t,r=e.onStepFinish,n=e.abortSignal,o=e.maxSteps,i=e.topP,a=e.toolChoice,u=Q3(e,["onStepFinish","abortSignal","maxSteps","topP","toolChoice"]);if(o!=null&&o<1)throw new Error("`maxSteps` muse be greater than 0.");return[{onStepFinish:r,abortSignal:n,maxSteps:o},iu(iu({},u),{tools:(t=u.tools)===null||t===void 0?void 0:t.map(function(l){return"fn"in l?z3(l):l}),top_p:i??u.top_p,tool_choice:a??u.tool_choice})]}var b_=function(){function e(t){this.model=t}return e.prototype.generateText=function(t,r){var n,o;return Hl(this,void 0,void 0,function(){var i,a,u,l,s,c,f,d,v,g,b,y,w,E,A,I,R,L,F,U,N,W=this;return Gl(this,function(j){switch(j.label){case 0:return i=[],a={completion_tokens:0,prompt_tokens:0,total_tokens:0},u=Tv(t),l=u[0],s=l.onStepFinish,c=l.maxSteps,f=c===void 0?10:c,d=u[1],v=function(){return W.model.doGenerate(d,r)},[4,v()];case 1:g=j.sent(),b=1,g.rawResponse&&i.push(g.rawResponse),y=null,j.label=2;case 2:if(!(b<f&&(y=Av(g))!=null))return[3,9];w=xv(g.usage),Do(a,w),j.label=3;case 3:return j.trys.push([3,7,,8]),[4,Cv(y)];case 4:return E=j.sent(),A=g.choices[0],[4,s==null?void 0:s({finishReason:A.finish_reason,messages:d.messages.slice(),text:A.message.content,toolCall:y,toolResult:E,stepUsage:w,totalUsage:Object.assign({},a)})];case 5:return j.sent(),Rv(d.messages,A.message,E),[4,v()];case 6:return g=j.sent(),g.rawResponse&&i.push(g.rawResponse),b+=1,[3,8];case 7:return I=j.sent(),[2,{text:"",messages:d.messages,usage:a,error:I,rawResponses:i}];case 8:return[3,2];case 9:return R=(n=g==null?void 0:g.choices)===null||n===void 0?void 0:n[0],L=R==null?void 0:R.message,F=(o=L==null?void 0:L.content)!==null&&o!==void 0?o:"",U=L?xr(xr([],d.messages,!0),[L],!1):d.messages,N=xv(g.usage),Do(a,N),[4,s==null?void 0:s({finishReason:R.finish_reason,messages:U.slice(),text:F,toolCall:Av(g),toolResult:null,stepUsage:N,totalUsage:Object.assign({},a)})];case 10:return j.sent(),[2,{text:F,messages:U,usage:a,rawResponses:i}]}})})},e.prototype.streamText=function(t,r){var n;return Hl(this,void 0,void 0,function(){var o,i,a,u,l,s,c,f,d,v,g,b,y,w,E,A,I,R,L,F,U,N,W,j,X,fe,q,de,k,M,D,G,Z,ne,Ee,tt,Ct=this;return Gl(this,function(Xe){switch(Xe.label){case 0:return o={completion_tokens:0,prompt_tokens:0,total_tokens:0},i=Tv(t),a=i[0],u=a.onStepFinish,l=a.maxSteps,s=l===void 0?10:l,c=i[1],f=function(){return Ct.model.doStream(c,r)},[4,f()];case 1:d=Xe.sent(),v=1,g=null,b=function(){var he=d.tee(),B=he[0],J=he[1];return d=Ge(B),Z3(J)},Xe.label=2;case 2:return y=v<s,y?[4,b()]:[3,4];case 3:y=(g=Xe.sent())!=null,Xe.label=4;case 4:if(!y)return[3,11];w=g.message,E=g.usage,Do(o,E),A=(n=w.tool_calls)===null||n===void 0?void 0:n[0],Xe.label=5;case 5:return Xe.trys.push([5,9,,10]),[4,Cv(A)];case 6:return I=Xe.sent(),[4,u==null?void 0:u({finishReason:"tool_calls",messages:c.messages.slice(),text:w.content,toolCall:A,toolResult:I,stepUsage:E,totalUsage:Object.assign({},o)})];case 7:return Xe.sent(),Rv(c.messages,w,I),[4,f()];case 8:return d=Xe.sent(),[3,10];case 9:return R=Xe.sent(),L=d.tee(),F=L[0],U=L[1],[2,{messages:Promise.resolve(c.messages),dataStream:Ge(F),textStream:Ge(U.pipeThrough(new Qe({transform:function(he,B){var J,K,ee,_e=(ee=(K=(J=he==null?void 0:he.choices)===null||J===void 0?void 0:J[0])===null||K===void 0?void 0:K.delta)===null||ee===void 0?void 0:ee.content;typeof _e=="string"&&B.enqueue(_e)}}))),usage:Promise.resolve(o),error:R}];case 10:return[3,2];case 11:return[4,b()];case 12:return g=Xe.sent(),g?(N=g.message,W=g.usage,Do(o,W),j=xr(xr([],c.messages,!0),[N],!1),u({messages:j.slice(),finishReason:"tool_call",stepUsage:W,text:N.content,toolCall:N.tool_calls[0],totalUsage:Object.assign({},o)}),X=d.tee(),fe=X[0],q=X[1],[2,{messages:Promise.resolve(xr(xr([],c.messages,!0),[N],!1)),dataStream:Ge(fe),textStream:Ge(q.pipeThrough(new Qe({transform:function(he,B){var J,K,ee,_e=(ee=(K=(J=he==null?void 0:he.choices)===null||J===void 0?void 0:J[0])===null||K===void 0?void 0:K.delta)===null||ee===void 0?void 0:ee.content;typeof _e=="string"&&B.enqueue(_e)}}))),usage:Promise.resolve(o)}]):(de=Xp(),k=Xp(),M={role:"assistant",content:""},D="",G={completion_tokens:0,prompt_tokens:0,total_tokens:0},Z=d.pipeThrough(new Qe({transform:function(he,B){var J,K,ee,_e,S,T,$,m,h=(ee=(K=(J=he==null?void 0:he.choices)===null||J===void 0?void 0:J[0])===null||K===void 0?void 0:K.delta)===null||ee===void 0?void 0:ee.content;typeof h=="string"&&(M.content+=h);var p=(S=(_e=he==null?void 0:he.choices)===null||_e===void 0?void 0:_e[0])===null||S===void 0?void 0:S.finish_reason;p&&(D=p),!((T=he==null?void 0:he.usage)===null||T===void 0)&&T.completion_tokens&&(G.completion_tokens=he.usage.completion_tokens),!(($=he==null?void 0:he.usage)===null||$===void 0)&&$.prompt_tokens&&(G.prompt_tokens=he.usage.prompt_tokens),!((m=he==null?void 0:he.usage)===null||m===void 0)&&m.total_tokens&&(G.total_tokens=he.usage.total_tokens),B.enqueue(he)},flush:function(){de.res(xr(xr([],c.messages,!0),[M],!1)),Do(o,G),k.res(Object.assign({},o)),u==null||u({messages:xr(xr([],c.messages,!0),[M],!1),finishReason:D,text:M.content,stepUsage:G,totalUsage:Object.assign({},o)})}})),ne=Z.tee(),Ee=ne[0],tt=ne[1],[2,{messages:de.promise,dataStream:Ge(Ee),textStream:Ge(tt.pipeThrough(new Qe({transform:function(he,B){var J,K,ee,_e=(ee=(K=(J=he==null?void 0:he.choices)===null||J===void 0?void 0:J[0])===null||K===void 0?void 0:K.delta)===null||ee===void 0?void 0:ee.content;typeof _e=="string"&&B.enqueue(_e)}}))),usage:k.promise}])}})})},e}();function Av(e){var t,r=(t=e==null?void 0:e.choices)===null||t===void 0?void 0:t[0];if(!r)return null;var n=r.finish_reason,o=r.message;return n!=="tool_calls"||!o||!fr(o)?null:o.tool_calls[0]}function Rv(e,t,r){e.push(t,{role:"tool",tool_call_id:t.tool_calls[0].id,content:JSON.stringify(r)})}function Z3(e){var t,r,n,o,i,a,u,l,s,c;return Hl(this,void 0,void 0,function(){var f,d,v,g,b,y,w,E,A,I,R,L,F;return Gl(this,function(U){switch(U.label){case 0:f={completion_tokens:0,prompt_tokens:0,total_tokens:0},d=Ge(e),v={id:"",function:{name:"",arguments:""},type:""},g={role:"assistant",content:"",tool_calls:[v]},U.label=1;case 1:U.trys.push([1,6,7,12]),b=!0,y=X3(d),U.label=2;case 2:return[4,y.next()];case 3:if(w=U.sent(),t=w.done,!!t)return[3,5];o=w.value,b=!1;try{if(E=o,A=E==null?void 0:E.choices[0],!A)return[2,null];if(I=A.finish_reason,R=A.delta,I!=="tool_calls")return[2,null];if(!R)return[3,4];if(R.content&&(g.content+=R.content),!("tool_calls"in R))return[3,4];L=(i=R==null?void 0:R.tool_calls)===null||i===void 0?void 0:i[0],L!=null&&L.id&&(v.id=L.id),L!=null&&L.type&&(v.type=L.type),!((a=L==null?void 0:L.function)===null||a===void 0)&&a.name&&(v.function.name=L.function.name),!((u=L==null?void 0:L.function)===null||u===void 0)&&u.arguments&&(v.function.arguments+=L.function.arguments),!((l=E==null?void 0:E.usage)===null||l===void 0)&&l.completion_tokens&&(f.completion_tokens=E.usage.completion_tokens),!((s=E==null?void 0:E.usage)===null||s===void 0)&&s.prompt_tokens&&(f.prompt_tokens=E.usage.prompt_tokens),!((c=E==null?void 0:E.usage)===null||c===void 0)&&c.total_tokens&&(f.total_tokens=E.usage.total_tokens)}finally{b=!0}U.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return F=U.sent(),r={error:F},[3,12];case 7:return U.trys.push([7,,10,11]),!b&&!t&&(n=y.return)?[4,n.call(y)]:[3,9];case 8:U.sent(),U.label=9;case 9:return[3,11];case 10:if(r)throw r.error;return[7];case 11:return[7];case 12:return[2,{message:g,usage:f}]}})})}var ou=new Map;function Cv(e){return ou.get(e.function.name)(JSON.parse(e.function.arguments))}function xv(e){var t,r,n;return{completion_tokens:(t=e==null?void 0:e.completion_tokens)!==null&&t!==void 0?t:0,prompt_tokens:(r=e==null?void 0:e.prompt_tokens)!==null&&r!==void 0?r:0,total_tokens:(n=e==null?void 0:e.total_tokens)!==null&&n!==void 0?n:0}}function Do(e,t){e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens}var w_={hunyuan:d_,"hunyuan-beta":f_,ark:h_,dashscope:p_,"01-ai":v_,moonshot:m_,zhipu:l_,"hunyuan-exp":g_,"hunyuan-open":y_,deepseek:Y3};const eL=Object.freeze(Object.defineProperty({__proto__:null,ArkSimpleModel:h_,DSSimpleModel:p_,DefaultSimpleModel:__,HunYuanBetaSimpleModel:f_,HunYuanExpSimpleModel:g_,HunYuanOpenSimpleModel:y_,HunYuanSimpleModel:d_,MODELS:w_,MoonshotSimpleModel:m_,ReactModel:b_,YiSimpleModel:v_,ZhiPuSimpleModel:l_,toolMap:ou},Symbol.toStringTag,{value:"Module"}));var Ui=function(){return Ui=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ui.apply(this,arguments)},zc=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Jc=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Yc=w_,tL=function(){function e(t,r,n){var o=this;this.req=t,this.baseUrl=r,this.modelRequest=function(i){var a=i.url,u=i.data,l=i.headers,s=i.stream,c=i.timeout;return zc(o,void 0,void 0,function(){var f,d,v,g,b,y,w;return Jc(this,function(E){switch(E.label){case 0:return f={"Content-Type":"application/json"},s&&Object.assign(f,{Accept:"text/event-stream"}),[4,this.req.fetch({method:"post",headers:Ui(Ui((b={},b[(y=this.i18n)===null||y===void 0?void 0:y.LANG_HEADER_KEY]=(w=this.i18n)===null||w===void 0?void 0:w.lang,b),f),l),body:JSON.stringify(u),url:a,stream:s,timeout:c})];case 1:return d=E.sent(),v=d.data,g=d.header,[2,this.handleResponseData(v,g)]}})})},this.botRequest=function(i){var a=i.method,u=i.url,l=i.data,s=l===void 0?{}:l,c=i.headers,f=i.stream,d=i.timeout;return zc(o,void 0,void 0,function(){function v(L){return Object.entries(L).map(function(F){var U=F[0],N=F[1];return"".concat(U,"=").concat(N)}).join("&")}var g,b,y,w,E,A,I,R;return Jc(this,function(L){switch(L.label){case 0:return a!=="get"?[3,2]:(g=this.handleResponseData,[4,this.req.fetch({url:"".concat(u,"?").concat(v(s)),method:a,headers:c,stream:f,timeout:d})]);case 1:return[2,g.apply(this,[L.sent().data])];case 2:return b={"Content-Type":"application/json"},f&&Object.assign(b,{Accept:"text/event-stream"}),[4,this.req.fetch({url:u,body:JSON.stringify(s),headers:Ui(Ui((A={},A[(I=this.i18n)===null||I===void 0?void 0:I.LANG_HEADER_KEY]=(R=this.i18n)===null||R===void 0?void 0:R.lang,A),b),c),stream:f,method:a,timeout:d})];case 3:return y=L.sent(),w=y.data,E=y.header,[2,this.handleResponseData(w,E)]}})})},this.aiBaseUrl="".concat(r,"/ai"),this.aiBotBaseUrl="".concat(r,"/aibot"),this.bot=new J3(this.botRequest,this.aiBotBaseUrl),this.i18n=n,Pu.on(Nu,function(i){var a;o.i18n=((a=i.data)===null||a===void 0?void 0:a.i18n)||o.i18n})}return e.prototype.handleResponseData=function(t,r){var n,o;return zc(this,void 0,void 0,function(){var i,a,a;return Jc(this,function(u){switch(u.label){case 0:return i="".concat(this.i18n.t("请检查调用方式，或前往云开发 AI+ 首页查看文档"),"：https://tcb.cloud.tencent.com/dev#/ai"),typeof t=="object"&&t&&"then"in t?[4,t]:[3,2];case 1:if(a=u.sent(),typeof a=="object"&&a&&"code"in a&&a.code!=="NORMAL")throw new Error("".concat(this.i18n.t("AI+ 请求出错，错误码"),"：").concat(a.code,"，").concat(this.i18n.t("错误信息"),"：").concat(a.message,`
`).concat(i,`
`).concat(JSON.stringify(a,null,2)));return[2,t];case 2:return!((o=(n=r==null?void 0:r.get)===null||n===void 0?void 0:n.call(r,"content-type"))===null||o===void 0)&&o.includes("application/json")?[4,K3(t)]:[3,4];case 3:if(a=u.sent(),typeof a=="object"&&a&&"code"in a&&a.code!=="NORMAL")throw new Error("".concat(this.i18n.t("AI+ 请求出错，错误码"),"：").concat(a.code,"，").concat(this.i18n.t("错误信息"),"：").concat(a.message,`
`).concat(i,`
`).concat(JSON.stringify(a,null,2)));u.label=4;case 4:return[2,t]}})})},e.prototype.createModel=function(t,r){var n,o=Yc[t];if(o)n=new o(this.modelRequest,this.aiBaseUrl);else{var i=typeof(r==null?void 0:r.defaultModelSubUrl)=="string"?r.defaultModelSubUrl:"/chat/completions";n=new __(this.modelRequest,this.aiBaseUrl,"".concat(t).concat(i))}var a=new b_(n);return a},e.prototype.registerModel=function(t,r){if(Yc[t]!=null){console.warn("AI model ".concat(t," already exists!"));return}Yc[t]=r},e.prototype.registerFunctionTool=function(t){ou.has(t.name)&&console.warn("AI function tool ".concat(t.name," already exists and will be overwritten!")),ou.set(t.name,t.fn)},e}(),su=function(){return su=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},su.apply(this,arguments)},rL=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},nL=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},E_=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},iL="ai";E_(eL,["MODELS"]);var oL=function(e){var t=e.getAccessToken,r=e.req,n=function(o){return rL(void 0,void 0,void 0,function(){var i,a,u,l,s;return nL(this,function(c){switch(c.label){case 0:if(typeof r.fetch!="function")throw new Error("req.fetch is not a function");return i=o.token,a=o.headers,u=a===void 0?{}:a,l=E_(o,["token","headers"]),i==null?[3,1]:(s=i,[3,3]);case 1:return[4,t()];case 2:s=c.sent().accessToken,c.label=3;case 3:return[2,r.fetch(su({headers:su({Authorization:"Bearer ".concat(s)},u)},l))]}})})};return{download:r.download,post:r.post,upload:r.upload,fetch:n}};function sL(e){var t=e.env,r=e.baseUrl,n=e.req,o=e.getAccessToken,i=e.handleReqInstance,a=e.i18n,u=function(){if(r!=null)return r;if(t==null)throw new Error("`env` is required when `baseUrl` is not provided!");return"https://".concat(t,".api.tcloudbasegateway.com/v1")},l=function(){if(i==null){if(o==null)throw new Error("`getAccessToken` is required when `handleReqInstance` is not provided!");return oL({req:n,getAccessToken:o})}return i({req:n})};return new tL(l(),u(),a)}function aL(e){var t=this,r,n=this.request;if(n.fetch==null)throw new Error("cloudbase.request.fetch() unimplemented!");var o=function(){var a=t.getEndPointWithKey("GATEWAY"),u=a.BASE_URL,l=a.PROTOCOL;return"".concat(l).concat(u)},i=(r=e==null?void 0:e.baseUrl)!==null&&r!==void 0?r:o();return sL({req:n,baseUrl:i,handleReqInstance:function(a){var u=a.req;return u},i18n:this.config.i18n})}var uL={name:iL,entity:{ai:aL}};function cL(e){try{e.registerComponent(uL)}catch(t){console.warn(t)}}var Kn,on;(function(e){e.DocIDError="文档ID不合法",e.CollNameError="集合名称不合法",e.OpStrError="操作符不合法",e.DirectionError="排序字符不合法",e.IntergerError="must be integer",e.QueryParamTypeError="查询参数必须为对象",e.QueryParamValueError="查询参数对象值不能均为undefined"})(on||(on={}));var We={Number:"Number",Object:"Object",Array:"Array",GeoPoint:"GeoPoint",GeoLineString:"GeoLineString",GeoPolygon:"GeoPolygon",GeoMultiPoint:"GeoMultiPoint",GeoMultiLineString:"GeoMultiLineString",GeoMultiPolygon:"GeoMultiPolygon",Timestamp:"Date",ServerDate:"ServerDate",BsonDate:"BsonDate"},lL=["desc","asc"],fL=["<","<=","==",">=",">"],ni;(function(e){e.lt="<",e.gt=">",e.lte="<=",e.gte=">=",e.eq="=="})(ni||(ni={}));Kn={},Kn[ni.eq]="$eq",Kn[ni.lt]="$lt",Kn[ni.lte]="$lte",Kn[ni.gt]="$gt",Kn[ni.gte]="$gte";var kr;(function(e){e.WHERE="WHERE",e.DOC="DOC"})(kr||(kr={}));var dL=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ta=[],Pv={},hL=function(){function e(t){Object.defineProperties(this,{target:{enumerable:!1,writable:!1,configurable:!1,value:t}})}return e}(),Zt=function(e){dL(t,e);function t(r,n){var o=this;if(n!==Pv)throw new TypeError("InternalSymbol cannot be constructed with new operator");return o=e.call(this,r)||this,o}return t.for=function(r){for(var n=0,o=ta.length;n<o;n++)if(ta[n].target===r)return ta[n].instance;var i=new t(r,Pv);return ta.push({target:r,instance:i}),i},t}(hL),Es=Zt.for("UNSET_FIELD_NAME"),S_=Zt.for("UPDATE_COMMAND"),I_=Zt.for("QUERY_COMMAND"),O_=Zt.for("LOGIC_COMMAND"),T_=Zt.for("GEO_POINT"),pL=Zt.for("SYMBOL_GEO_LINE_STRING"),vL=Zt.for("SYMBOL_GEO_POLYGON"),mL=Zt.for("SYMBOL_GEO_MULTI_POINT"),gL=Zt.for("SYMBOL_GEO_MULTI_LINE_STRING"),yL=Zt.for("SYMBOL_GEO_MULTI_POLYGON"),A_=Zt.for("SERVER_DATE"),R_=Zt.for("REGEXP"),C_=function(){function e(t){var r=(t===void 0?{}:t).offset,n=r===void 0?0:r;this.offset=n}return Object.defineProperty(e.prototype,"_internalType",{get:function(){return A_},enumerable:!0,configurable:!0}),e.prototype.parse=function(){return{$date:{offset:this.offset}}},e}();function _L(e){return new C_(e)}var Qc=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(u){a={error:u}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Yu=function(){function e(){}return e.formatResDocumentData=function(t){return t.map(function(r){return e.formatField(r)})},e.formatField=function(t){var r=Object.keys(t),n={};return Array.isArray(t)&&(n=[]),r.forEach(function(o){var i=t[o],a=e.whichType(i),u;switch(a){case We.GeoPoint:u=new jt(i.coordinates[0],i.coordinates[1]);break;case We.GeoLineString:u=new Fr(i.coordinates.map(function(l){return new jt(l[0],l[1])}));break;case We.GeoPolygon:u=new li(i.coordinates.map(function(l){return new Fr(l.map(function(s){var c=Qc(s,2),f=c[0],d=c[1];return new jt(f,d)}))}));break;case We.GeoMultiPoint:u=new au(i.coordinates.map(function(l){return new jt(l[0],l[1])}));break;case We.GeoMultiLineString:u=new uu(i.coordinates.map(function(l){return new Fr(l.map(function(s){var c=Qc(s,2),f=c[0],d=c[1];return new jt(f,d)}))}));break;case We.GeoMultiPolygon:u=new Ss(i.coordinates.map(function(l){return new li(l.map(function(s){return new Fr(s.map(function(c){var f=Qc(c,2),d=f[0],v=f[1];return new jt(d,v)}))}))}));break;case We.Timestamp:u=new Date(i.$timestamp*1e3);break;case We.Object:case We.Array:u=e.formatField(i);break;case We.ServerDate:u=new Date(i.$date);break;default:u=i}Array.isArray(n)?n.push(u):n[o]=u}),n},e.whichType=function(t){var r=Object.prototype.toString.call(t).slice(8,-1);if(r===We.Timestamp)return We.BsonDate;if(r===We.Object){if(t instanceof jt)return We.GeoPoint;if(t instanceof Date)return We.Timestamp;if(t instanceof C_)return We.ServerDate;t.$timestamp?r=We.Timestamp:t.$date?r=We.ServerDate:jt.validate(t)?r=We.GeoPoint:Fr.validate(t)?r=We.GeoLineString:li.validate(t)?r=We.GeoPolygon:au.validate(t)?r=We.GeoMultiPoint:uu.validate(t)?r=We.GeoMultiLineString:Ss.validate(t)&&(r=We.GeoMultiPolygon)}return r},e.generateDocId=function(){for(var t="ABCDEFabcdef0123456789",r="",n=0;n<24;n++)r+=t.charAt(Math.floor(Math.random()*t.length));return r},e}(),Nn=function(){function e(){}return e.isGeopoint=function(t,r){if(Yu.whichType(r)!==We.Number)throw new Error("Geo Point must be number type");var n=Math.abs(r);if(t==="latitude"&&n>90)throw new Error("latitude should be a number ranges from -90 to 90");if(t==="longitude"&&n>180)throw new Error("longitude should be a number ranges from -180 to 180");return!0},e.isInteger=function(t,r){if(!Number.isInteger(r))throw new Error(t+on.IntergerError);return!0},e.isFieldOrder=function(t){if(lL.indexOf(t)===-1)throw new Error(on.DirectionError);return!0},e.isFieldPath=function(t){if(!/^[a-zA-Z0-9-_\.]/.test(t))throw new Error;return!0},e.isOperator=function(t){if(fL.indexOf(t)===-1)throw new Error(on.OpStrError);return!0},e.isCollName=function(t){if(!/^[a-zA-Z0-9]([a-zA-Z0-9-_]){1,32}$/.test(t))throw new Error(on.CollNameError);return!0},e.isDocID=function(t){if(!/^([a-fA-F0-9]){24}$/.test(t))throw new Error(on.DocIDError);return!0},e}(),Gr=function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},Un=function(e){return Gr(e)==="object"},bL=function(e){return Gr(e)==="string"},ar=function(e){return Gr(e)==="number"},ze=function(e){return Array.isArray(e)},x_=function(e){return Gr(e)==="date"},ld=function(e){return Gr(e)==="regexp"},P_=function(e){return e&&e._internalType instanceof Zt},jt=function(){function e(t,r){Nn.isGeopoint("longitude",t),Nn.isGeopoint("latitude",r),this.longitude=t,this.latitude=r}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"Point",coordinates:[this.longitude,this.latitude]},r},e.prototype.toJSON=function(){return{type:"Point",coordinates:[this.longitude,this.latitude]}},e.prototype.toReadableString=function(){return"["+this.longitude+","+this.latitude+"]"},e.validate=function(t){return t.type==="Point"&&ze(t.coordinates)&&Nn.isGeopoint("longitude",t.coordinates[0])&&Nn.isGeopoint("latitude",t.coordinates[1])},Object.defineProperty(e.prototype,"_internalType",{get:function(){return T_},enumerable:!0,configurable:!0}),e}(),wL=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Fr=function(){function e(t){if(!ze(t))throw new TypeError('"points" must be of type Point[]. Received type '+typeof t);if(t.length<2)throw new Error('"points" must contain 2 points at least');t.forEach(function(r){if(!(r instanceof jt))throw new TypeError('"points" must be of type Point[]. Received type '+typeof r+"[]")}),this.points=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"LineString",coordinates:this.points.map(function(n){return n.toJSON().coordinates})},r},e.prototype.toJSON=function(){return{type:"LineString",coordinates:this.points.map(function(t){return t.toJSON().coordinates})}},e.validate=function(t){var r,n;if(t.type!=="LineString"||!ze(t.coordinates))return!1;try{for(var o=wL(t.coordinates),i=o.next();!i.done;i=o.next()){var a=i.value;if(!ar(a[0])||!ar(a[1]))return!1}}catch(u){r={error:u}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!0},e.isClosed=function(t){var r=t.points[0],n=t.points[t.points.length-1];if(r.latitude===n.latitude&&r.longitude===n.longitude)return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return pL},enumerable:!0,configurable:!0}),e}(),Nv=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},li=function(){function e(t){if(!ze(t))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof t);if(t.length===0)throw new Error("Polygon must contain 1 linestring at least");t.forEach(function(r){if(!(r instanceof Fr))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof r+"[]");if(!Fr.isClosed(r))throw new Error("LineString "+r.points.map(function(n){return n.toReadableString()})+" is not a closed cycle")}),this.lines=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"Polygon",coordinates:this.lines.map(function(n){return n.points.map(function(o){return[o.longitude,o.latitude]})})},r},e.prototype.toJSON=function(){return{type:"Polygon",coordinates:this.lines.map(function(t){return t.points.map(function(r){return[r.longitude,r.latitude]})})}},e.validate=function(t){var r,n,o,i;if(t.type!=="Polygon"||!ze(t.coordinates))return!1;try{for(var a=Nv(t.coordinates),u=a.next();!u.done;u=a.next()){var l=u.value;if(!this.isCloseLineString(l))return!1;try{for(var s=(o=void 0,Nv(l)),c=s.next();!c.done;c=s.next()){var f=c.value;if(!ar(f[0])||!ar(f[1]))return!1}}catch(d){o={error:d}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}}}catch(d){r={error:d}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return!0},e.isCloseLineString=function(t){var r=t[0],n=t[t.length-1];return!(r[0]!==n[0]||r[1]!==n[1])},Object.defineProperty(e.prototype,"_internalType",{get:function(){return yL},enumerable:!0,configurable:!0}),e}(),EL=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},au=function(){function e(t){if(!ze(t))throw new TypeError('"points" must be of type Point[]. Received type '+typeof t);if(t.length===0)throw new Error('"points" must contain 1 point at least');t.forEach(function(r){if(!(r instanceof jt))throw new TypeError('"points" must be of type Point[]. Received type '+typeof r+"[]")}),this.points=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"MultiPoint",coordinates:this.points.map(function(n){return n.toJSON().coordinates})},r},e.prototype.toJSON=function(){return{type:"MultiPoint",coordinates:this.points.map(function(t){return t.toJSON().coordinates})}},e.validate=function(t){var r,n;if(t.type!=="MultiPoint"||!ze(t.coordinates))return!1;try{for(var o=EL(t.coordinates),i=o.next();!i.done;i=o.next()){var a=i.value;if(!ar(a[0])||!ar(a[1]))return!1}}catch(u){r={error:u}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return mL},enumerable:!0,configurable:!0}),e}(),$v=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},uu=function(){function e(t){if(!ze(t))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof t);if(t.length===0)throw new Error("Polygon must contain 1 linestring at least");t.forEach(function(r){if(!(r instanceof Fr))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof r+"[]")}),this.lines=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"MultiLineString",coordinates:this.lines.map(function(n){return n.points.map(function(o){return[o.longitude,o.latitude]})})},r},e.prototype.toJSON=function(){return{type:"MultiLineString",coordinates:this.lines.map(function(t){return t.points.map(function(r){return[r.longitude,r.latitude]})})}},e.validate=function(t){var r,n,o,i;if(t.type!=="MultiLineString"||!ze(t.coordinates))return!1;try{for(var a=$v(t.coordinates),u=a.next();!u.done;u=a.next()){var l=u.value;try{for(var s=(o=void 0,$v(l)),c=s.next();!c.done;c=s.next()){var f=c.value;if(!ar(f[0])||!ar(f[1]))return!1}}catch(d){o={error:d}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}}}catch(d){r={error:d}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return gL},enumerable:!0,configurable:!0}),e}(),ra=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ss=function(){function e(t){var r,n;if(!ze(t))throw new TypeError('"polygons" must be of type Polygon[]. Received type '+typeof t);if(t.length===0)throw new Error("MultiPolygon must contain 1 polygon at least");try{for(var o=ra(t),i=o.next();!i.done;i=o.next()){var a=i.value;if(!(a instanceof li))throw new TypeError('"polygon" must be of type Polygon[]. Received type '+typeof a+"[]")}}catch(u){r={error:u}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}this.polygons=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"MultiPolygon",coordinates:this.polygons.map(function(n){return n.lines.map(function(o){return o.points.map(function(i){return[i.longitude,i.latitude]})})})},r},e.prototype.toJSON=function(){return{type:"MultiPolygon",coordinates:this.polygons.map(function(t){return t.lines.map(function(r){return r.points.map(function(n){return[n.longitude,n.latitude]})})})}},e.validate=function(t){var r,n,o,i,a,u;if(t.type!=="MultiPolygon"||!ze(t.coordinates))return!1;try{for(var l=ra(t.coordinates),s=l.next();!s.done;s=l.next()){var c=s.value;try{for(var f=(o=void 0,ra(c)),d=f.next();!d.done;d=f.next()){var v=d.value;try{for(var g=(a=void 0,ra(v)),b=g.next();!b.done;b=g.next()){var y=b.value;if(!ar(y[0])||!ar(y[1]))return!1}}catch(w){a={error:w}}finally{try{b&&!b.done&&(u=g.return)&&u.call(g)}finally{if(a)throw a.error}}}}catch(w){o={error:w}}finally{try{d&&!d.done&&(i=f.return)&&i.call(f)}finally{if(o)throw o.error}}}}catch(w){r={error:w}}finally{try{s&&!s.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return vL},enumerable:!0,configurable:!0}),e}();const SL=Object.freeze(Object.defineProperty({__proto__:null,LineString:Fr,MultiLineString:uu,MultiPoint:au,MultiPolygon:Ss,Point:jt,Polygon:li},Symbol.toStringTag,{value:"Module"}));var sn=function(){var e;if(!Promise){e=function(){},e.promise={};var t=function(){throw new Error('Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.')};return Object.defineProperty(e.promise,"then",{get:t}),Object.defineProperty(e.promise,"catch",{get:t}),e}var r=new Promise(function(n,o){e=function(i,a){return i?o(i):n(a)}});return e.promise=r,e},Ie;(function(e){e.SET="set",e.REMOVE="remove",e.INC="inc",e.MUL="mul",e.PUSH="push",e.PULL="pull",e.PULL_ALL="pullAll",e.POP="pop",e.SHIFT="shift",e.UNSHIFT="unshift",e.ADD_TO_SET="addToSet",e.BIT="bit",e.RENAME="rename",e.MAX="max",e.MIN="min"})(Ie||(Ie={}));var Ze=function(){function e(t,r,n){this._internalType=S_,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.operator=t,this.operands=r,this.fieldName=n||Es}return e.prototype._setFieldName=function(t){var r=new e(this.operator,this.operands,t);return r},e}();function Dv(e){return e&&e instanceof Ze&&e._internalType===S_}var Qt;(function(e){e.AND="and",e.OR="or",e.NOT="not",e.NOR="nor"})(Qt||(Qt={}));var ai=function(){function e(t,r,n){if(this._internalType=O_,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.operator=t,this.operands=r,this.fieldName=n||Es,this.fieldName!==Es)if(Array.isArray(r)){r=r.slice(),this.operands=r;for(var o=0,i=r.length;o<i;o++){var a=r[o];(cu(a)||lu(a))&&(r[o]=a._setFieldName(this.fieldName))}}else{var a=r;(cu(a)||lu(a))&&(r=a._setFieldName(this.fieldName))}}return e.prototype._setFieldName=function(t){var r=this.operands.map(function(o){return o instanceof e?o._setFieldName(t):o}),n=new e(this.operator,r,t);return n},e.prototype.and=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.from(arguments);return t.unshift(this),new e(Qt.AND,t,this.fieldName)},e.prototype.or=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.from(arguments);return t.unshift(this),new e(Qt.OR,t,this.fieldName)},e}();function cu(e){return e&&e instanceof ai&&e._internalType===O_}var IL=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),pe;(function(e){e.EQ="eq",e.NEQ="neq",e.GT="gt",e.GTE="gte",e.LT="lt",e.LTE="lte",e.IN="in",e.NIN="nin",e.ALL="all",e.ELEM_MATCH="elemMatch",e.EXISTS="exists",e.SIZE="size",e.MOD="mod",e.GEO_NEAR="geoNear",e.GEO_WITHIN="geoWithin",e.GEO_INTERSECTS="geoIntersects"})(pe||(pe={}));var rt=function(e){IL(t,e);function t(r,n,o){var i=e.call(this,r,n,o)||this;return i.operator=r,i._internalType=I_,i}return t.prototype.toJSON=function(){var r,n;switch(this.operator){case pe.IN:case pe.NIN:return r={},r["$"+this.operator]=this.operands,r;default:return n={},n["$"+this.operator]=this.operands[0],n}},t.prototype._setFieldName=function(r){var n=new t(this.operator,this.operands,r);return n},t.prototype.eq=function(r){var n=new t(pe.EQ,[r],this.fieldName);return this.and(n)},t.prototype.neq=function(r){var n=new t(pe.NEQ,[r],this.fieldName);return this.and(n)},t.prototype.gt=function(r){var n=new t(pe.GT,[r],this.fieldName);return this.and(n)},t.prototype.gte=function(r){var n=new t(pe.GTE,[r],this.fieldName);return this.and(n)},t.prototype.lt=function(r){var n=new t(pe.LT,[r],this.fieldName);return this.and(n)},t.prototype.lte=function(r){var n=new t(pe.LTE,[r],this.fieldName);return this.and(n)},t.prototype.in=function(r){var n=new t(pe.IN,r,this.fieldName);return this.and(n)},t.prototype.nin=function(r){var n=new t(pe.NIN,r,this.fieldName);return this.and(n)},t.prototype.geoNear=function(r){if(!(r.geometry instanceof jt))throw new TypeError('"geometry" must be of type Point. Received type '+typeof r.geometry);if(r.maxDistance!==void 0&&!ar(r.maxDistance))throw new TypeError('"maxDistance" must be of type Number. Received type '+typeof r.maxDistance);if(r.minDistance!==void 0&&!ar(r.minDistance))throw new TypeError('"minDistance" must be of type Number. Received type '+typeof r.minDistance);var n=new t(pe.GEO_NEAR,[r],this.fieldName);return this.and(n)},t.prototype.geoWithin=function(r){if(!(r.geometry instanceof Ss)&&!(r.geometry instanceof li))throw new TypeError('"geometry" must be of type Polygon or MultiPolygon. Received type '+typeof r.geometry);var n=new t(pe.GEO_WITHIN,[r],this.fieldName);return this.and(n)},t.prototype.geoIntersects=function(r){if(!(r.geometry instanceof jt)&&!(r.geometry instanceof Fr)&&!(r.geometry instanceof li)&&!(r.geometry instanceof au)&&!(r.geometry instanceof uu)&&!(r.geometry instanceof Ss))throw new TypeError('"geometry" must be of type Point, LineString, Polygon, MultiPoint, MultiLineString or MultiPolygon. Received type '+typeof r.geometry);var n=new t(pe.GEO_INTERSECTS,[r],this.fieldName);return this.and(n)},t}(ai);function lu(e){return e&&e instanceof rt&&e._internalType===I_}function Lv(e){return lu(e)}var kn={};for(var Bn in pe)kn[Bn]="$"+Bn;for(var Bn in Qt)kn[Bn]="$"+Bn;for(var Bn in Ie)kn[Bn]="$"+Bn;kn[pe.NEQ]="$ne";kn[Ie.REMOVE]="$unset";kn[Ie.SHIFT]="$pop";kn[Ie.UNSHIFT]="$push";function Fi(e){return kn[e]||"$"+e}var Vl=function(){return Vl=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Vl.apply(this,arguments)},OL=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(u){a={error:u}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Uv=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(OL(arguments[t]));return e};function Is(e){return Kl(e,[e])}function Kl(e,t){if(P_(e))switch(e._internalType){case T_:return e.toJSON();case A_:return e.parse();case R_:return e.parse();default:return e.toJSON?e.toJSON():e}else{if(x_(e))return{$date:+e};if(ld(e))return{$regex:e.source,$options:e.flags};if(ze(e))return e.map(function(o){if(t.indexOf(o)>-1)throw new Error("Cannot convert circular structure to JSON");return Kl(o,Uv(t,[o]))});if(Un(e)){var r=Vl({},e);for(var n in r){if(t.indexOf(r[n])>-1)throw new Error("Cannot convert circular structure to JSON");r[n]=Kl(r[n],Uv(t,[r[n]]))}return r}else return e}}var zl=function(){return zl=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},zl.apply(this,arguments)},TL=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(u){a={error:u}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Fv=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(TL(arguments[t]));return e};function N_(e,t,r,n){var o=zl({},e);for(var i in e)if(!/^\$/.test(i)){var a=e[i];if(a&&Un(a)&&!t(a)){if(n.indexOf(a)>-1)throw new Error("Cannot convert circular structure to JSON");var u=Fv(r,[i]),l=Fv(n,[a]),s=N_(a,t,u,l);o[i]=s;var c=!1;for(var f in s)/^\$/.test(f)?c=!0:(o[i+"."+f]=s[f],delete o[i][f]);c||delete o[i]}}return o}function $_(e){return N_(e,Jl,[],[e])}function Mv(e,t,r){t[r]||delete e[r];for(var n in t)e[n]?ze(e[n])?e[n].push(t[n]):Un(e[n])?Un(t[n])?Object.assign(e[n],t[n]):(console.warn("unmergable condition, query is object but condition is "+Gr(t)+", can only overwrite",t,r),e[n]=t[n]):(console.warn("to-merge query is of type "+Gr(e)+", can only overwrite",e,t,r),e[n]=t[n]):e[n]=t[n]}function Jl(e){return P_(e)||x_(e)||ld(e)}function $n(e){return Is(e)}var fd=function(){function e(){}return e.encode=function(t){var r=new e;return r.encodeUpdate(t)},e.prototype.encodeUpdate=function(t){return Dv(t)?this.encodeUpdateCommand(t):Gr(t)==="object"?this.encodeUpdateObject(t):t},e.prototype.encodeUpdateCommand=function(t){if(t.fieldName===Es)throw new Error("Cannot encode a comparison command with unset field name");switch(t.operator){case Ie.PUSH:case Ie.PULL:case Ie.PULL_ALL:case Ie.POP:case Ie.SHIFT:case Ie.UNSHIFT:case Ie.ADD_TO_SET:return this.encodeArrayUpdateCommand(t);default:return this.encodeFieldUpdateCommand(t)}},e.prototype.encodeFieldUpdateCommand=function(t){var r,n,o,i,a=Fi(t.operator);switch(t.operator){case Ie.REMOVE:return r={},r[a]=(n={},n[t.fieldName]="",n),r;default:return o={},o[a]=(i={},i[t.fieldName]=t.operands[0],i),o}},e.prototype.encodeArrayUpdateCommand=function(t){var r,n,o,i,a,u,l,s,c,f,d=Fi(t.operator);switch(t.operator){case Ie.PUSH:{var v=void 0;return ze(t.operands)?v={$each:t.operands.map($n)}:v=t.operands,r={},r[d]=(n={},n[t.fieldName]=v,n),r}case Ie.UNSHIFT:{var v={$each:t.operands.map($n),$position:0};return o={},o[d]=(i={},i[t.fieldName]=v,i),o}case Ie.POP:return a={},a[d]=(u={},u[t.fieldName]=1,u),a;case Ie.SHIFT:return l={},l[d]=(s={},s[t.fieldName]=-1,s),l;default:return c={},c[d]=(f={},f[t.fieldName]=$n(t.operands),f),c}},e.prototype.encodeUpdateObject=function(t){var r=$_(t);for(var n in r)if(!/^\$/.test(n)){var o=r[n];if(Dv(o)){r[n]=o._setFieldName(n);var i=this.encodeUpdateCommand(r[n]);Mv(r,i,n)}else{r[n]=o=$n(o);var a=new Ze(Ie.SET,[o],n),i=this.encodeUpdateCommand(a);Mv(r,i,n)}}return r},e}(),Xc={};function D_(e){if(!St.wsClientClass)throw new Error("to use realtime you must import realtime module first");var t=e.config.env;return Xc[t]||(Xc[t]=new St.wsClientClass({context:{appConfig:{docSizeLimit:1e3,realtimePingInterval:1e4,realtimePongWaitTimeout:5e3,request:new St.reqClass(e.config)}}})),Xc[t]}var fu=function(){return fu=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},fu.apply(this,arguments)},Bv=function(){function e(t,r,n,o){var i=this;o===void 0&&(o={}),this.watch=function(a){var u=D_(i._db);return u.watch(fu(fu({},a),{envId:i._db.config.env,collectionName:i._coll,query:JSON.stringify({_id:i.id})}))},this._db=t,this._coll=r,this.id=n,this.request=new St.reqClass(this._db.config),this.projection=o}return e.prototype.create=function(t,r){r=r||sn();var n={collectionName:this._coll,data:Is(t)};return this.id&&(n._id=this.id),this.request.send("database.addDocument",n).then(function(o){o.code?r(0,o):r(0,{id:o.data._id,requestId:o.requestId})}).catch(function(o){r(o)}),r.promise},e.prototype.set=function(t,r){if(r=r||sn(),!this.id)return Promise.resolve({code:"INVALID_PARAM",message:"docId不能为空"});if(!t||typeof t!="object")return Promise.resolve({code:"INVALID_PARAM",message:"参数必需是非空对象"});if(t.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"不能更新_id的值"});var n=!1,o=function(u){if(typeof u=="object")for(var l in u)u[l]instanceof Ze?n=!0:typeof u[l]=="object"&&o(u[l])};if(o(t),n)return Promise.resolve({code:"DATABASE_REQUEST_FAILED",message:"update operator complicit"});var i=!1,a={collectionName:this._coll,queryType:kr.DOC,data:Is(t),multi:!1,merge:i,upsert:!0};return this.id&&(a.query={_id:this.id}),this.request.send("database.updateDocument",a).then(function(u){u.code?r(0,u):r(0,{updated:u.data.updated,upsertedId:u.data.upserted_id,requestId:u.requestId})}).catch(function(u){r(u)}),r.promise},e.prototype.update=function(t,r){if(r=r||sn(),!t||typeof t!="object")return Promise.resolve({code:"INVALID_PARAM",message:"参数必需是非空对象"});if(t.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"不能更新_id的值"});var n={_id:this.id},o=!0,i={collectionName:this._coll,data:fd.encode(t),query:n,queryType:kr.DOC,multi:!1,merge:o,upsert:!1};return this.request.send("database.updateDocument",i).then(function(a){a.code?r(0,a):r(0,{updated:a.data.updated,upsertedId:a.data.upserted_id,requestId:a.requestId})}).catch(function(a){r(a)}),r.promise},e.prototype.remove=function(t){t=t||sn();var r={_id:this.id},n={collectionName:this._coll,query:r,queryType:kr.DOC,multi:!1};return this.request.send("database.deleteDocument",n).then(function(o){o.code?t(0,o):t(0,{deleted:o.data.deleted,requestId:o.requestId})}).catch(function(o){t(o)}),t.promise},e.prototype.get=function(t){t=t||sn();var r={_id:this.id},n={collectionName:this._coll,query:r,queryType:kr.DOC,multi:!1,projection:this.projection};return this.request.send("database.queryDocument",n).then(function(o){if(o.code)t(0,o);else{var i=Yu.formatResDocumentData(o.data.list);t(0,{data:i,requestId:o.requestId})}}).catch(function(o){t(o)}),t.promise},e.prototype.field=function(t){for(var r in t)t[r]?t[r]=1:t[r]=0;return new e(this._db,this._coll,this.id,t)},e}(),du=function(){function e(){}return e.encode=function(t){var r=new AL;return r.encodeQuery(t)},e}(),AL=function(){function e(){}return e.prototype.encodeQuery=function(t,r){var n;return Jl(t)?cu(t)?this.encodeLogicCommand(t):lu(t)?this.encodeQueryCommand(t):(n={},n[r]=this.encodeQueryObject(t),n):Un(t)?this.encodeQueryObject(t):t},e.prototype.encodeRegExp=function(t){return{$regex:t.source,$options:t.flags}},e.prototype.encodeLogicCommand=function(t){var r,n,o,i,a,u,l,s=this;switch(t.operator){case Qt.NOR:case Qt.AND:case Qt.OR:{var c=Fi(t.operator),f=t.operands.map(function(g){return s.encodeQuery(g,t.fieldName)});return r={},r[c]=f,r}case Qt.NOT:{var c=Fi(t.operator),d=t.operands[0];if(ld(d))return n={},n[t.fieldName]=(o={},o[c]=this.encodeRegExp(d),o),n;var f=this.encodeQuery(d)[t.fieldName];return i={},i[t.fieldName]=(a={},a[c]=f,a),i}default:{var c=Fi(t.operator);if(t.operands.length===1){var v=this.encodeQuery(t.operands[0]);return u={},u[c]=v,u}else{var f=t.operands.map(this.encodeQuery.bind(this));return l={},l[c]=f,l}}}},e.prototype.encodeQueryCommand=function(t){return Lv(t)?this.encodeComparisonCommand(t):this.encodeComparisonCommand(t)},e.prototype.encodeComparisonCommand=function(t){var r,n,o,i,a,u,l,s,c;if(t.fieldName===Es)throw new Error("Cannot encode a comparison command with unset field name");var f=Fi(t.operator);switch(t.operator){case pe.EQ:case pe.NEQ:case pe.LT:case pe.LTE:case pe.GT:case pe.GTE:case pe.ELEM_MATCH:case pe.EXISTS:case pe.SIZE:case pe.MOD:return r={},r[t.fieldName]=(n={},n[f]=$n(t.operands[0]),n),r;case pe.IN:case pe.NIN:case pe.ALL:return o={},o[t.fieldName]=(i={},i[f]=$n(t.operands),i),o;case pe.GEO_NEAR:{var d=t.operands[0];return a={},a[t.fieldName]={$nearSphere:{$geometry:d.geometry.toJSON(),$maxDistance:d.maxDistance,$minDistance:d.minDistance}},a}case pe.GEO_WITHIN:{var d=t.operands[0];return u={},u[t.fieldName]={$geoWithin:{$geometry:d.geometry.toJSON()}},u}case pe.GEO_INTERSECTS:{var d=t.operands[0];return l={},l[t.fieldName]={$geoIntersects:{$geometry:d.geometry.toJSON()}},l}default:return s={},s[t.fieldName]=(c={},c[f]=$n(t.operands[0]),c),s}},e.prototype.encodeQueryObject=function(t){var r=$_(t);for(var n in r){var o=r[n];if(cu(o)){r[n]=o._setFieldName(n);var i=this.encodeLogicCommand(r[n]);this.mergeConditionAfterEncode(r,i,n)}else if(Lv(o)){r[n]=o._setFieldName(n);var i=this.encodeComparisonCommand(r[n]);this.mergeConditionAfterEncode(r,i,n)}else Jl(o)&&(r[n]=$n(o))}return r},e.prototype.mergeConditionAfterEncode=function(t,r,n){r[n]||delete t[n];for(var o in r)t[o]?ze(t[o])?t[o]=t[o].concat(r[o]):Un(t[o])?Un(r[o])?Object.assign(t,r):(console.warn("unmergable condition, query is object but condition is "+Gr(r)+", can only overwrite",r,n),t[o]=r[o]):(console.warn("to-merge query is of type "+Gr(t)+", can only overwrite",t,r,n),t[o]=r[o]):t[o]=r[o]},e}(),ii=function(){return ii=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ii.apply(this,arguments)},RL=function(){function e(t,r,n,o,i){var a=this;this.watch=function(u){var l=D_(a._db);return l.watch(ii(ii({},u),{envId:a._db.config.env,collectionName:a._coll,query:JSON.stringify(a._fieldFilters||{}),limit:a._queryOptions.limit,orderBy:a._fieldOrders?a._fieldOrders.reduce(function(s,c){return s[c.field]=c.direction,s},{}):void 0}))},this._db=t,this._coll=r,this._fieldFilters=n,this._fieldOrders=o||[],this._queryOptions=i||{},this._request=new St.reqClass(this._db.config)}return e.prototype.get=function(t){t=t||sn();var r=[];this._fieldOrders&&this._fieldOrders.forEach(function(o){r.push(o)});var n={collectionName:this._coll,queryType:kr.WHERE};return this._fieldFilters&&(n.query=this._fieldFilters),r.length>0&&(n.order=r),this._queryOptions.offset&&(n.offset=this._queryOptions.offset),this._queryOptions.limit?n.limit=this._queryOptions.limit<1e3?this._queryOptions.limit:1e3:n.limit=100,this._queryOptions.projection&&(n.projection=this._queryOptions.projection),this._request.send("database.queryDocument",n).then(function(o){if(o.code)t(0,o);else{var i=Yu.formatResDocumentData(o.data.list),a={data:i,requestId:o.requestId};o.total&&(a.total=o.total),o.limit&&(a.limit=o.limit),o.offset&&(a.offset=o.offset),t(0,a)}}).catch(function(o){t(o)}),t.promise},e.prototype.count=function(t){t=t||sn();var r={collectionName:this._coll,queryType:kr.WHERE};return this._fieldFilters&&(r.query=this._fieldFilters),this._request.send("database.countDocument",r).then(function(n){n.code?t(0,n):t(0,{requestId:n.requestId,total:n.data.total})}).catch(function(n){t(n)}),t.promise},e.prototype.where=function(t){if(Object.prototype.toString.call(t).slice(8,-1)!=="Object")throw Error(on.QueryParamTypeError);var r=Object.keys(t),n=r.some(function(o){return t[o]!==void 0});if(r.length&&!n)throw Error(on.QueryParamValueError);return new e(this._db,this._coll,du.encode(t),this._fieldOrders,this._queryOptions)},e.prototype.orderBy=function(t,r){Nn.isFieldPath(t),Nn.isFieldOrder(r);var n={field:t,direction:r},o=this._fieldOrders.concat(n);return new e(this._db,this._coll,this._fieldFilters,o,this._queryOptions)},e.prototype.limit=function(t){Nn.isInteger("limit",t);var r=ii({},this._queryOptions);return r.limit=t,new e(this._db,this._coll,this._fieldFilters,this._fieldOrders,r)},e.prototype.skip=function(t){Nn.isInteger("offset",t);var r=ii({},this._queryOptions);return r.offset=t,new e(this._db,this._coll,this._fieldFilters,this._fieldOrders,r)},e.prototype.update=function(t,r){if(r=r||sn(),!t||typeof t!="object")return Promise.resolve({code:"INVALID_PARAM",message:"参数必需是非空对象"});if(t.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"不能更新_id的值"});var n={collectionName:this._coll,query:this._fieldFilters,queryType:kr.WHERE,multi:!0,merge:!0,upsert:!1,data:fd.encode(t)};return this._request.send("database.updateDocument",n).then(function(o){o.code?r(0,o):r(0,{requestId:o.requestId,updated:o.data.updated,upsertId:o.data.upsert_id})}).catch(function(o){r(o)}),r.promise},e.prototype.field=function(t){for(var r in t)t[r]?typeof t[r]!="object"&&(t[r]=1):t[r]=0;var n=ii({},this._queryOptions);return n.projection=t,new e(this._db,this._coll,this._fieldFilters,this._fieldOrders,n)},e.prototype.remove=function(t){t=t||sn(),Object.keys(this._queryOptions).length>0&&console.warn("`offset`, `limit` and `projection` are not supported in remove() operation"),this._fieldOrders.length>0&&console.warn("`orderBy` is not supported in remove() operation");var r={collectionName:this._coll,query:du.encode(this._fieldFilters),queryType:kr.WHERE,multi:!0};return this._request.send("database.deleteDocument",r).then(function(n){n.code?t(0,n):t(0,{requestId:n.requestId,deleted:n.data.deleted})}).catch(function(n){t(n)}),t.promise},e}();function CL(e,t){return t={exports:{}},e(t,t.exports),t.exports}var xL=LL,PL=FL,NL=jL,Mr=[],nr=[],$L=typeof Uint8Array<"u"?Uint8Array:Array,Zc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Ti=0,DL=Zc.length;Ti<DL;++Ti)Mr[Ti]=Zc[Ti],nr[Zc.charCodeAt(Ti)]=Ti;nr[45]=62;nr[95]=63;function L_(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");r===-1&&(r=t);var n=r===t?0:4-r%4;return[r,n]}function LL(e){var t=L_(e),r=t[0],n=t[1];return(r+n)*3/4-n}function UL(e,t,r){return(t+r)*3/4-r}function FL(e){var t,r=L_(e),n=r[0],o=r[1],i=new $L(UL(e,n,o)),a=0,u=o>0?n-4:n,l;for(l=0;l<u;l+=4)t=nr[e.charCodeAt(l)]<<18|nr[e.charCodeAt(l+1)]<<12|nr[e.charCodeAt(l+2)]<<6|nr[e.charCodeAt(l+3)],i[a++]=t>>16&255,i[a++]=t>>8&255,i[a++]=t&255;return o===2&&(t=nr[e.charCodeAt(l)]<<2|nr[e.charCodeAt(l+1)]>>4,i[a++]=t&255),o===1&&(t=nr[e.charCodeAt(l)]<<10|nr[e.charCodeAt(l+1)]<<4|nr[e.charCodeAt(l+2)]>>2,i[a++]=t>>8&255,i[a++]=t&255),i}function ML(e){return Mr[e>>18&63]+Mr[e>>12&63]+Mr[e>>6&63]+Mr[e&63]}function BL(e,t,r){for(var n,o=[],i=t;i<r;i+=3)n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255),o.push(ML(n));return o.join("")}function jL(e){for(var t,r=e.length,n=r%3,o=[],i=16383,a=0,u=r-n;a<u;a+=i)o.push(BL(e,a,a+i>u?u:a+i));return n===1?(t=e[r-1],o.push(Mr[t>>2]+Mr[t<<4&63]+"==")):n===2&&(t=(e[r-2]<<8)+e[r-1],o.push(Mr[t>>10]+Mr[t>>4&63]+Mr[t<<2&63]+"=")),o.join("")}var el={byteLength:xL,toByteArray:PL,fromByteArray:NL};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var kL=function(t,r,n,o,i){var a,u,l=i*8-o-1,s=(1<<l)-1,c=s>>1,f=-7,d=n?i-1:0,v=n?-1:1,g=t[r+d];for(d+=v,a=g&(1<<-f)-1,g>>=-f,f+=l;f>0;a=a*256+t[r+d],d+=v,f-=8);for(u=a&(1<<-f)-1,a>>=-f,f+=o;f>0;u=u*256+t[r+d],d+=v,f-=8);if(a===0)a=1-c;else{if(a===s)return u?NaN:(g?-1:1)*(1/0);u=u+Math.pow(2,o),a=a-c}return(g?-1:1)*u*Math.pow(2,a-o)},qL=function(t,r,n,o,i,a){var u,l,s,c=a*8-i-1,f=(1<<c)-1,d=f>>1,v=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=o?0:a-1,b=o?1:-1,y=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(l=isNaN(r)?1:0,u=f):(u=Math.floor(Math.log(r)/Math.LN2),r*(s=Math.pow(2,-u))<1&&(u--,s*=2),u+d>=1?r+=v/s:r+=v*Math.pow(2,1-d),r*s>=2&&(u++,s/=2),u+d>=f?(l=0,u=f):u+d>=1?(l=(r*s-1)*Math.pow(2,i),u=u+d):(l=r*Math.pow(2,d-1)*Math.pow(2,i),u=0));i>=8;t[n+g]=l&255,g+=b,l/=256,i-=8);for(u=u<<i|l,c+=i;c>0;t[n+g]=u&255,g+=b,u/=256,c-=8);t[n+g-b]|=y*128},Ai={read:kL,write:qL},Qu=CL(function(e,t){var r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=w,t.INSPECT_MAX_BYTES=50;var n=2147483647;t.kMaxLength=n,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{var m=new Uint8Array(1),h={foo:function(){return 42}};return Object.setPrototypeOf(h,Uint8Array.prototype),Object.setPrototypeOf(m,h),m.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function i(m){if(m>n)throw new RangeError('The value "'+m+'" is invalid for option "size"');var h=new Uint8Array(m);return Object.setPrototypeOf(h,a.prototype),h}function a(m,h,p){if(typeof m=="number"){if(typeof h=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return c(m)}return u(m,h,p)}a.poolSize=8192;function u(m,h,p){if(typeof m=="string")return f(m,h);if(ArrayBuffer.isView(m))return v(m);if(m==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(m));if(S(m,ArrayBuffer)||m&&S(m.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(S(m,SharedArrayBuffer)||m&&S(m.buffer,SharedArrayBuffer)))return g(m,h,p);if(typeof m=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var _=m.valueOf&&m.valueOf();if(_!=null&&_!==m)return a.from(_,h,p);var O=b(m);if(O)return O;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof m[Symbol.toPrimitive]=="function")return a.from(m[Symbol.toPrimitive]("string"),h,p);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(m))}a.from=function(m,h,p){return u(m,h,p)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(m){if(typeof m!="number")throw new TypeError('"size" argument must be of type number');if(m<0)throw new RangeError('The value "'+m+'" is invalid for option "size"')}function s(m,h,p){return l(m),m<=0?i(m):h!==void 0?typeof p=="string"?i(m).fill(h,p):i(m).fill(h):i(m)}a.alloc=function(m,h,p){return s(m,h,p)};function c(m){return l(m),i(m<0?0:y(m)|0)}a.allocUnsafe=function(m){return c(m)},a.allocUnsafeSlow=function(m){return c(m)};function f(m,h){if((typeof h!="string"||h==="")&&(h="utf8"),!a.isEncoding(h))throw new TypeError("Unknown encoding: "+h);var p=E(m,h)|0,_=i(p),O=_.write(m,h);return O!==p&&(_=_.slice(0,O)),_}function d(m){for(var h=m.length<0?0:y(m.length)|0,p=i(h),_=0;_<h;_+=1)p[_]=m[_]&255;return p}function v(m){if(S(m,Uint8Array)){var h=new Uint8Array(m);return g(h.buffer,h.byteOffset,h.byteLength)}return d(m)}function g(m,h,p){if(h<0||m.byteLength<h)throw new RangeError('"offset" is outside of buffer bounds');if(m.byteLength<h+(p||0))throw new RangeError('"length" is outside of buffer bounds');var _;return h===void 0&&p===void 0?_=new Uint8Array(m):p===void 0?_=new Uint8Array(m,h):_=new Uint8Array(m,h,p),Object.setPrototypeOf(_,a.prototype),_}function b(m){if(a.isBuffer(m)){var h=y(m.length)|0,p=i(h);return p.length===0||m.copy(p,0,0,h),p}if(m.length!==void 0)return typeof m.length!="number"||T(m.length)?i(0):d(m);if(m.type==="Buffer"&&Array.isArray(m.data))return d(m.data)}function y(m){if(m>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return m|0}function w(m){return+m!=m&&(m=0),a.alloc(+m)}a.isBuffer=function(h){return h!=null&&h._isBuffer===!0&&h!==a.prototype},a.compare=function(h,p){if(S(h,Uint8Array)&&(h=a.from(h,h.offset,h.byteLength)),S(p,Uint8Array)&&(p=a.from(p,p.offset,p.byteLength)),!a.isBuffer(h)||!a.isBuffer(p))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(h===p)return 0;for(var _=h.length,O=p.length,P=0,x=Math.min(_,O);P<x;++P)if(h[P]!==p[P]){_=h[P],O=p[P];break}return _<O?-1:O<_?1:0},a.isEncoding=function(h){switch(String(h).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(h,p){if(!Array.isArray(h))throw new TypeError('"list" argument must be an Array of Buffers');if(h.length===0)return a.alloc(0);var _;if(p===void 0)for(p=0,_=0;_<h.length;++_)p+=h[_].length;var O=a.allocUnsafe(p),P=0;for(_=0;_<h.length;++_){var x=h[_];if(S(x,Uint8Array))P+x.length>O.length?a.from(x).copy(O,P):Uint8Array.prototype.set.call(O,x,P);else if(a.isBuffer(x))x.copy(O,P);else throw new TypeError('"list" argument must be an Array of Buffers');P+=x.length}return O};function E(m,h){if(a.isBuffer(m))return m.length;if(ArrayBuffer.isView(m)||S(m,ArrayBuffer))return m.byteLength;if(typeof m!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+babelHelpers.typeof(m));var p=m.length,_=arguments.length>2&&arguments[2]===!0;if(!_&&p===0)return 0;for(var O=!1;;)switch(h){case"ascii":case"latin1":case"binary":return p;case"utf8":case"utf-8":return B(m).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return p*2;case"hex":return p>>>1;case"base64":return ee(m).length;default:if(O)return _?-1:B(m).length;h=(""+h).toLowerCase(),O=!0}}a.byteLength=E;function A(m,h,p){var _=!1;if((h===void 0||h<0)&&(h=0),h>this.length||((p===void 0||p>this.length)&&(p=this.length),p<=0)||(p>>>=0,h>>>=0,p<=h))return"";for(m||(m="utf8");;)switch(m){case"hex":return D(this,h,p);case"utf8":case"utf-8":return fe(this,h,p);case"ascii":return k(this,h,p);case"latin1":case"binary":return M(this,h,p);case"base64":return X(this,h,p);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,h,p);default:if(_)throw new TypeError("Unknown encoding: "+m);m=(m+"").toLowerCase(),_=!0}}a.prototype._isBuffer=!0;function I(m,h,p){var _=m[h];m[h]=m[p],m[p]=_}a.prototype.swap16=function(){var h=this.length;if(h%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var p=0;p<h;p+=2)I(this,p,p+1);return this},a.prototype.swap32=function(){var h=this.length;if(h%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var p=0;p<h;p+=4)I(this,p,p+3),I(this,p+1,p+2);return this},a.prototype.swap64=function(){var h=this.length;if(h%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var p=0;p<h;p+=8)I(this,p,p+7),I(this,p+1,p+6),I(this,p+2,p+5),I(this,p+3,p+4);return this},a.prototype.toString=function(){var h=this.length;return h===0?"":arguments.length===0?fe(this,0,h):A.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(h){if(!a.isBuffer(h))throw new TypeError("Argument must be a Buffer");return this===h?!0:a.compare(this,h)===0},a.prototype.inspect=function(){var h="",p=t.INSPECT_MAX_BYTES;return h=this.toString("hex",0,p).replace(/(.{2})/g,"$1 ").trim(),this.length>p&&(h+=" ... "),"<Buffer "+h+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(h,p,_,O,P){if(S(h,Uint8Array)&&(h=a.from(h,h.offset,h.byteLength)),!a.isBuffer(h))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+babelHelpers.typeof(h));if(p===void 0&&(p=0),_===void 0&&(_=h?h.length:0),O===void 0&&(O=0),P===void 0&&(P=this.length),p<0||_>h.length||O<0||P>this.length)throw new RangeError("out of range index");if(O>=P&&p>=_)return 0;if(O>=P)return-1;if(p>=_)return 1;if(p>>>=0,_>>>=0,O>>>=0,P>>>=0,this===h)return 0;for(var x=P-O,z=_-p,H=Math.min(x,z),Q=this.slice(O,P),ie=h.slice(p,_),ue=0;ue<H;++ue)if(Q[ue]!==ie[ue]){x=Q[ue],z=ie[ue];break}return x<z?-1:z<x?1:0};function R(m,h,p,_,O){if(m.length===0)return-1;if(typeof p=="string"?(_=p,p=0):p>2147483647?p=2147483647:p<-2147483648&&(p=-2147483648),p=+p,T(p)&&(p=O?0:m.length-1),p<0&&(p=m.length+p),p>=m.length){if(O)return-1;p=m.length-1}else if(p<0)if(O)p=0;else return-1;if(typeof h=="string"&&(h=a.from(h,_)),a.isBuffer(h))return h.length===0?-1:L(m,h,p,_,O);if(typeof h=="number")return h=h&255,typeof Uint8Array.prototype.indexOf=="function"?O?Uint8Array.prototype.indexOf.call(m,h,p):Uint8Array.prototype.lastIndexOf.call(m,h,p):L(m,[h],p,_,O);throw new TypeError("val must be string, number or Buffer")}function L(m,h,p,_,O){var P=1,x=m.length,z=h.length;if(_!==void 0&&(_=String(_).toLowerCase(),_==="ucs2"||_==="ucs-2"||_==="utf16le"||_==="utf-16le")){if(m.length<2||h.length<2)return-1;P=2,x/=2,z/=2,p/=2}function H(Ae,at){return P===1?Ae[at]:Ae.readUInt16BE(at*P)}var Q;if(O){var ie=-1;for(Q=p;Q<x;Q++)if(H(m,Q)===H(h,ie===-1?0:Q-ie)){if(ie===-1&&(ie=Q),Q-ie+1===z)return ie*P}else ie!==-1&&(Q-=Q-ie),ie=-1}else for(p+z>x&&(p=x-z),Q=p;Q>=0;Q--){for(var ue=!0,Ce=0;Ce<z;Ce++)if(H(m,Q+Ce)!==H(h,Ce)){ue=!1;break}if(ue)return Q}return-1}a.prototype.includes=function(h,p,_){return this.indexOf(h,p,_)!==-1},a.prototype.indexOf=function(h,p,_){return R(this,h,p,_,!0)},a.prototype.lastIndexOf=function(h,p,_){return R(this,h,p,_,!1)};function F(m,h,p,_){p=Number(p)||0;var O=m.length-p;_?(_=Number(_),_>O&&(_=O)):_=O;var P=h.length;_>P/2&&(_=P/2);for(var x=0;x<_;++x){var z=parseInt(h.substr(x*2,2),16);if(T(z))return x;m[p+x]=z}return x}function U(m,h,p,_){return _e(B(h,m.length-p),m,p,_)}function N(m,h,p,_){return _e(J(h),m,p,_)}function W(m,h,p,_){return _e(ee(h),m,p,_)}function j(m,h,p,_){return _e(K(h,m.length-p),m,p,_)}a.prototype.write=function(h,p,_,O){if(p===void 0)O="utf8",_=this.length,p=0;else if(_===void 0&&typeof p=="string")O=p,_=this.length,p=0;else if(isFinite(p))p=p>>>0,isFinite(_)?(_=_>>>0,O===void 0&&(O="utf8")):(O=_,_=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var P=this.length-p;if((_===void 0||_>P)&&(_=P),h.length>0&&(_<0||p<0)||p>this.length)throw new RangeError("Attempt to write outside buffer bounds");O||(O="utf8");for(var x=!1;;)switch(O){case"hex":return F(this,h,p,_);case"utf8":case"utf-8":return U(this,h,p,_);case"ascii":case"latin1":case"binary":return N(this,h,p,_);case"base64":return W(this,h,p,_);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,h,p,_);default:if(x)throw new TypeError("Unknown encoding: "+O);O=(""+O).toLowerCase(),x=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function X(m,h,p){return h===0&&p===m.length?el.fromByteArray(m):el.fromByteArray(m.slice(h,p))}function fe(m,h,p){p=Math.min(m.length,p);for(var _=[],O=h;O<p;){var P=m[O],x=null,z=P>239?4:P>223?3:P>191?2:1;if(O+z<=p){var H,Q,ie,ue;switch(z){case 1:P<128&&(x=P);break;case 2:H=m[O+1],(H&192)===128&&(ue=(P&31)<<6|H&63,ue>127&&(x=ue));break;case 3:H=m[O+1],Q=m[O+2],(H&192)===128&&(Q&192)===128&&(ue=(P&15)<<12|(H&63)<<6|Q&63,ue>2047&&(ue<55296||ue>57343)&&(x=ue));break;case 4:H=m[O+1],Q=m[O+2],ie=m[O+3],(H&192)===128&&(Q&192)===128&&(ie&192)===128&&(ue=(P&15)<<18|(H&63)<<12|(Q&63)<<6|ie&63,ue>65535&&ue<1114112&&(x=ue))}}x===null?(x=65533,z=1):x>65535&&(x-=65536,_.push(x>>>10&1023|55296),x=56320|x&1023),_.push(x),O+=z}return de(_)}var q=4096;function de(m){var h=m.length;if(h<=q)return String.fromCharCode.apply(String,m);for(var p="",_=0;_<h;)p+=String.fromCharCode.apply(String,m.slice(_,_+=q));return p}function k(m,h,p){var _="";p=Math.min(m.length,p);for(var O=h;O<p;++O)_+=String.fromCharCode(m[O]&127);return _}function M(m,h,p){var _="";p=Math.min(m.length,p);for(var O=h;O<p;++O)_+=String.fromCharCode(m[O]);return _}function D(m,h,p){var _=m.length;(!h||h<0)&&(h=0),(!p||p<0||p>_)&&(p=_);for(var O="",P=h;P<p;++P)O+=$[m[P]];return O}function G(m,h,p){for(var _=m.slice(h,p),O="",P=0;P<_.length-1;P+=2)O+=String.fromCharCode(_[P]+_[P+1]*256);return O}a.prototype.slice=function(h,p){var _=this.length;h=~~h,p=p===void 0?_:~~p,h<0?(h+=_,h<0&&(h=0)):h>_&&(h=_),p<0?(p+=_,p<0&&(p=0)):p>_&&(p=_),p<h&&(p=h);var O=this.subarray(h,p);return Object.setPrototypeOf(O,a.prototype),O};function Z(m,h,p){if(m%1!==0||m<0)throw new RangeError("offset is not uint");if(m+h>p)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(h,p,_){h=h>>>0,p=p>>>0,_||Z(h,p,this.length);for(var O=this[h],P=1,x=0;++x<p&&(P*=256);)O+=this[h+x]*P;return O},a.prototype.readUintBE=a.prototype.readUIntBE=function(h,p,_){h=h>>>0,p=p>>>0,_||Z(h,p,this.length);for(var O=this[h+--p],P=1;p>0&&(P*=256);)O+=this[h+--p]*P;return O},a.prototype.readUint8=a.prototype.readUInt8=function(h,p){return h=h>>>0,p||Z(h,1,this.length),this[h]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(h,p){return h=h>>>0,p||Z(h,2,this.length),this[h]|this[h+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(h,p){return h=h>>>0,p||Z(h,2,this.length),this[h]<<8|this[h+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(h,p){return h=h>>>0,p||Z(h,4,this.length),(this[h]|this[h+1]<<8|this[h+2]<<16)+this[h+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(h,p){return h=h>>>0,p||Z(h,4,this.length),this[h]*16777216+(this[h+1]<<16|this[h+2]<<8|this[h+3])},a.prototype.readIntLE=function(h,p,_){h=h>>>0,p=p>>>0,_||Z(h,p,this.length);for(var O=this[h],P=1,x=0;++x<p&&(P*=256);)O+=this[h+x]*P;return P*=128,O>=P&&(O-=Math.pow(2,8*p)),O},a.prototype.readIntBE=function(h,p,_){h=h>>>0,p=p>>>0,_||Z(h,p,this.length);for(var O=p,P=1,x=this[h+--O];O>0&&(P*=256);)x+=this[h+--O]*P;return P*=128,x>=P&&(x-=Math.pow(2,8*p)),x},a.prototype.readInt8=function(h,p){return h=h>>>0,p||Z(h,1,this.length),this[h]&128?(255-this[h]+1)*-1:this[h]},a.prototype.readInt16LE=function(h,p){h=h>>>0,p||Z(h,2,this.length);var _=this[h]|this[h+1]<<8;return _&32768?_|4294901760:_},a.prototype.readInt16BE=function(h,p){h=h>>>0,p||Z(h,2,this.length);var _=this[h+1]|this[h]<<8;return _&32768?_|4294901760:_},a.prototype.readInt32LE=function(h,p){return h=h>>>0,p||Z(h,4,this.length),this[h]|this[h+1]<<8|this[h+2]<<16|this[h+3]<<24},a.prototype.readInt32BE=function(h,p){return h=h>>>0,p||Z(h,4,this.length),this[h]<<24|this[h+1]<<16|this[h+2]<<8|this[h+3]},a.prototype.readFloatLE=function(h,p){return h=h>>>0,p||Z(h,4,this.length),Ai.read(this,h,!0,23,4)},a.prototype.readFloatBE=function(h,p){return h=h>>>0,p||Z(h,4,this.length),Ai.read(this,h,!1,23,4)},a.prototype.readDoubleLE=function(h,p){return h=h>>>0,p||Z(h,8,this.length),Ai.read(this,h,!0,52,8)},a.prototype.readDoubleBE=function(h,p){return h=h>>>0,p||Z(h,8,this.length),Ai.read(this,h,!1,52,8)};function ne(m,h,p,_,O,P){if(!a.isBuffer(m))throw new TypeError('"buffer" argument must be a Buffer instance');if(h>O||h<P)throw new RangeError('"value" argument is out of bounds');if(p+_>m.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(h,p,_,O){if(h=+h,p=p>>>0,_=_>>>0,!O){var P=Math.pow(2,8*_)-1;ne(this,h,p,_,P,0)}var x=1,z=0;for(this[p]=h&255;++z<_&&(x*=256);)this[p+z]=h/x&255;return p+_},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(h,p,_,O){if(h=+h,p=p>>>0,_=_>>>0,!O){var P=Math.pow(2,8*_)-1;ne(this,h,p,_,P,0)}var x=_-1,z=1;for(this[p+x]=h&255;--x>=0&&(z*=256);)this[p+x]=h/z&255;return p+_},a.prototype.writeUint8=a.prototype.writeUInt8=function(h,p,_){return h=+h,p=p>>>0,_||ne(this,h,p,1,255,0),this[p]=h&255,p+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(h,p,_){return h=+h,p=p>>>0,_||ne(this,h,p,2,65535,0),this[p]=h&255,this[p+1]=h>>>8,p+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(h,p,_){return h=+h,p=p>>>0,_||ne(this,h,p,2,65535,0),this[p]=h>>>8,this[p+1]=h&255,p+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(h,p,_){return h=+h,p=p>>>0,_||ne(this,h,p,4,4294967295,0),this[p+3]=h>>>24,this[p+2]=h>>>16,this[p+1]=h>>>8,this[p]=h&255,p+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(h,p,_){return h=+h,p=p>>>0,_||ne(this,h,p,4,4294967295,0),this[p]=h>>>24,this[p+1]=h>>>16,this[p+2]=h>>>8,this[p+3]=h&255,p+4},a.prototype.writeIntLE=function(h,p,_,O){if(h=+h,p=p>>>0,!O){var P=Math.pow(2,8*_-1);ne(this,h,p,_,P-1,-P)}var x=0,z=1,H=0;for(this[p]=h&255;++x<_&&(z*=256);)h<0&&H===0&&this[p+x-1]!==0&&(H=1),this[p+x]=(h/z>>0)-H&255;return p+_},a.prototype.writeIntBE=function(h,p,_,O){if(h=+h,p=p>>>0,!O){var P=Math.pow(2,8*_-1);ne(this,h,p,_,P-1,-P)}var x=_-1,z=1,H=0;for(this[p+x]=h&255;--x>=0&&(z*=256);)h<0&&H===0&&this[p+x+1]!==0&&(H=1),this[p+x]=(h/z>>0)-H&255;return p+_},a.prototype.writeInt8=function(h,p,_){return h=+h,p=p>>>0,_||ne(this,h,p,1,127,-128),h<0&&(h=255+h+1),this[p]=h&255,p+1},a.prototype.writeInt16LE=function(h,p,_){return h=+h,p=p>>>0,_||ne(this,h,p,2,32767,-32768),this[p]=h&255,this[p+1]=h>>>8,p+2},a.prototype.writeInt16BE=function(h,p,_){return h=+h,p=p>>>0,_||ne(this,h,p,2,32767,-32768),this[p]=h>>>8,this[p+1]=h&255,p+2},a.prototype.writeInt32LE=function(h,p,_){return h=+h,p=p>>>0,_||ne(this,h,p,4,2147483647,-2147483648),this[p]=h&255,this[p+1]=h>>>8,this[p+2]=h>>>16,this[p+3]=h>>>24,p+4},a.prototype.writeInt32BE=function(h,p,_){return h=+h,p=p>>>0,_||ne(this,h,p,4,2147483647,-2147483648),h<0&&(h=4294967295+h+1),this[p]=h>>>24,this[p+1]=h>>>16,this[p+2]=h>>>8,this[p+3]=h&255,p+4};function Ee(m,h,p,_,O,P){if(p+_>m.length)throw new RangeError("Index out of range");if(p<0)throw new RangeError("Index out of range")}function tt(m,h,p,_,O){return h=+h,p=p>>>0,O||Ee(m,h,p,4),Ai.write(m,h,p,_,23,4),p+4}a.prototype.writeFloatLE=function(h,p,_){return tt(this,h,p,!0,_)},a.prototype.writeFloatBE=function(h,p,_){return tt(this,h,p,!1,_)};function Ct(m,h,p,_,O){return h=+h,p=p>>>0,O||Ee(m,h,p,8),Ai.write(m,h,p,_,52,8),p+8}a.prototype.writeDoubleLE=function(h,p,_){return Ct(this,h,p,!0,_)},a.prototype.writeDoubleBE=function(h,p,_){return Ct(this,h,p,!1,_)},a.prototype.copy=function(h,p,_,O){if(!a.isBuffer(h))throw new TypeError("argument should be a Buffer");if(_||(_=0),!O&&O!==0&&(O=this.length),p>=h.length&&(p=h.length),p||(p=0),O>0&&O<_&&(O=_),O===_||h.length===0||this.length===0)return 0;if(p<0)throw new RangeError("targetStart out of bounds");if(_<0||_>=this.length)throw new RangeError("Index out of range");if(O<0)throw new RangeError("sourceEnd out of bounds");O>this.length&&(O=this.length),h.length-p<O-_&&(O=h.length-p+_);var P=O-_;return this===h&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(p,_,O):Uint8Array.prototype.set.call(h,this.subarray(_,O),p),P},a.prototype.fill=function(h,p,_,O){if(typeof h=="string"){if(typeof p=="string"?(O=p,p=0,_=this.length):typeof _=="string"&&(O=_,_=this.length),O!==void 0&&typeof O!="string")throw new TypeError("encoding must be a string");if(typeof O=="string"&&!a.isEncoding(O))throw new TypeError("Unknown encoding: "+O);if(h.length===1){var P=h.charCodeAt(0);(O==="utf8"&&P<128||O==="latin1")&&(h=P)}}else typeof h=="number"?h=h&255:typeof h=="boolean"&&(h=Number(h));if(p<0||this.length<p||this.length<_)throw new RangeError("Out of range index");if(_<=p)return this;p=p>>>0,_=_===void 0?this.length:_>>>0,h||(h=0);var x;if(typeof h=="number")for(x=p;x<_;++x)this[x]=h;else{var z=a.isBuffer(h)?h:a.from(h,O),H=z.length;if(H===0)throw new TypeError('The value "'+h+'" is invalid for argument "value"');for(x=0;x<_-p;++x)this[x+p]=z[x%H]}return this};var Xe=/[^+/0-9A-Za-z-_]/g;function he(m){if(m=m.split("=")[0],m=m.trim().replace(Xe,""),m.length<2)return"";for(;m.length%4!==0;)m=m+"=";return m}function B(m,h){h=h||1/0;for(var p,_=m.length,O=null,P=[],x=0;x<_;++x){if(p=m.charCodeAt(x),p>55295&&p<57344){if(!O){if(p>56319){(h-=3)>-1&&P.push(239,191,189);continue}else if(x+1===_){(h-=3)>-1&&P.push(239,191,189);continue}O=p;continue}if(p<56320){(h-=3)>-1&&P.push(239,191,189),O=p;continue}p=(O-55296<<10|p-56320)+65536}else O&&(h-=3)>-1&&P.push(239,191,189);if(O=null,p<128){if((h-=1)<0)break;P.push(p)}else if(p<2048){if((h-=2)<0)break;P.push(p>>6|192,p&63|128)}else if(p<65536){if((h-=3)<0)break;P.push(p>>12|224,p>>6&63|128,p&63|128)}else if(p<1114112){if((h-=4)<0)break;P.push(p>>18|240,p>>12&63|128,p>>6&63|128,p&63|128)}else throw new Error("Invalid code point")}return P}function J(m){for(var h=[],p=0;p<m.length;++p)h.push(m.charCodeAt(p)&255);return h}function K(m,h){for(var p,_,O,P=[],x=0;x<m.length&&!((h-=2)<0);++x)p=m.charCodeAt(x),_=p>>8,O=p%256,P.push(O),P.push(_);return P}function ee(m){return el.toByteArray(he(m))}function _e(m,h,p,_){for(var O=0;O<_&&!(O+p>=h.length||O>=m.length);++O)h[O+p]=m[O];return O}function S(m,h){return m instanceof h||m!=null&&m.constructor!=null&&m.constructor.name!=null&&m.constructor.name===h.name}function T(m){return m!==m}var $=function(){for(var m="0123456789abcdef",h=new Array(256),p=0;p<16;++p)for(var _=p*16,O=0;O<16;++O)h[_+O]=m[p]+m[O];return h}()}),xe=Qu.Buffer;Qu.SlowBuffer;Qu.INSPECT_MAX_BYTES;Qu.kMaxLength;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Yl=function(t,r){return Yl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},Yl(t,r)};function Xu(e,t){Yl(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var fi=function(e){Xu(t,e);function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return Object.defineProperty(t.prototype,"name",{get:function(){return"BSONError"},enumerable:!1,configurable:!0}),t}(Error),Ke=function(e){Xu(t,e);function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return Object.defineProperty(t.prototype,"name",{get:function(){return"BSONTypeError"},enumerable:!1,configurable:!0}),t}(TypeError);function na(e){return e&&e.Math==Math&&e}function U_(){return na(typeof globalThis=="object"&&globalThis)||na(typeof window=="object"&&window)||na(typeof self=="object"&&self)||na(typeof global=="object"&&global)||Function("return this")()}function WL(){var e=U_();return typeof e.navigator=="object"&&e.navigator.product==="ReactNative"}var HL=function(t){var r=WL()?"BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.":"BSON: No cryptographic implementation for random bytes present, falling back to a less secure implementation.";console.warn(r);for(var n=xe.alloc(t),o=0;o<t;++o)n[o]=Math.floor(Math.random()*256);return n},GL=function(){{if(typeof window<"u"){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues)return function(t){return e.getRandomValues(xe.alloc(t))}}return typeof global<"u"&&global.crypto&&global.crypto.getRandomValues?function(t){return global.crypto.getRandomValues(xe.alloc(t))}:HL}},F_=GL();function VL(e){return["[object ArrayBuffer]","[object SharedArrayBuffer]"].includes(Object.prototype.toString.call(e))}function dd(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}function KL(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function zL(e){return Ls(e)&&Object.prototype.toString.call(e)==="[object Date]"}function Ls(e){return typeof e=="object"&&e!==null}function Zu(e,t){var r=!1;function n(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return r||(console.warn(t),r=!0),e.apply(this,o)}return n}function hu(e){if(ArrayBuffer.isView(e))return xe.from(e.buffer,e.byteOffset,e.byteLength);if(VL(e))return xe.from(e);throw new Ke("Must use either Buffer or TypedArray")}var JL=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|[0-9a-f]{12}4[0-9a-f]{3}[89ab][0-9a-f]{15})$/i,M_=function(e){return typeof e=="string"&&JL.test(e)},Ql=function(e){if(!M_(e))throw new Ke('UUID string representations must be a 32 or 36 character hex string (dashes excluded/included). Format: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" or "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".');var t=e.replace(/-/g,"");return xe.from(t,"hex")},jv=function(e,t){return t===void 0&&(t=!0),t?e.toString("hex",0,4)+"-"+e.toString("hex",4,6)+"-"+e.toString("hex",6,8)+"-"+e.toString("hex",8,10)+"-"+e.toString("hex",10,16):e.toString("hex")},YL=Math.pow(2,53),QL=-Math.pow(2,53),B_=4,di=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);if(t!=null&&typeof t!="string"&&!ArrayBuffer.isView(t)&&!(t instanceof ArrayBuffer)&&!Array.isArray(t))throw new Ke("Binary can only be constructed from string, Buffer, TypedArray, or Array<number>");this.sub_type=r??e.BSON_BINARY_SUBTYPE_DEFAULT,t==null?(this.buffer=xe.alloc(e.BUFFER_SIZE),this.position=0):(typeof t=="string"?this.buffer=xe.from(t,"binary"):Array.isArray(t)?this.buffer=xe.from(t):this.buffer=hu(t),this.position=this.buffer.byteLength)}return e.prototype.put=function(t){if(typeof t=="string"&&t.length!==1)throw new Ke("only accepts single character String");if(typeof t!="number"&&t.length!==1)throw new Ke("only accepts single character Uint8Array or Array");var r;if(typeof t=="string"?r=t.charCodeAt(0):typeof t=="number"?r=t:r=t[0],r<0||r>255)throw new Ke("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.length>this.position)this.buffer[this.position++]=r;else{var n=xe.alloc(e.BUFFER_SIZE+this.buffer.length);this.buffer.copy(n,0,0,this.buffer.length),this.buffer=n,this.buffer[this.position++]=r}},e.prototype.write=function(t,r){if(r=typeof r=="number"?r:this.position,this.buffer.length<r+t.length){var n=xe.alloc(this.buffer.length+t.length);this.buffer.copy(n,0,0,this.buffer.length),this.buffer=n}ArrayBuffer.isView(t)?(this.buffer.set(hu(t),r),this.position=r+t.byteLength>this.position?r+t.length:this.position):typeof t=="string"&&(this.buffer.write(t,r,t.length,"binary"),this.position=r+t.length>this.position?r+t.length:this.position)},e.prototype.read=function(t,r){return r=r&&r>0?r:this.position,this.buffer.slice(t,t+r)},e.prototype.value=function(t){return t=!!t,t&&this.buffer.length===this.position?this.buffer:t?this.buffer.slice(0,this.position):this.buffer.toString("binary",0,this.position)},e.prototype.length=function(){return this.position},e.prototype.toJSON=function(){return this.buffer.toString("base64")},e.prototype.toString=function(t){return this.buffer.toString(t)},e.prototype.toExtendedJSON=function(t){t=t||{};var r=this.buffer.toString("base64"),n=Number(this.sub_type).toString(16);return t.legacy?{$binary:r,$type:n.length===1?"0"+n:n}:{$binary:{base64:r,subType:n.length===1?"0"+n:n}}},e.prototype.toUUID=function(){if(this.sub_type===e.SUBTYPE_UUID)return new kv(this.buffer.slice(0,this.position));throw new fi('Binary sub_type "'.concat(this.sub_type,'" is not supported for converting to UUID. Only "').concat(e.SUBTYPE_UUID,'" is currently supported.'))},e.fromExtendedJSON=function(t,r){r=r||{};var n,o;if("$binary"in t?r.legacy&&typeof t.$binary=="string"&&"$type"in t?(o=t.$type?parseInt(t.$type,16):0,n=xe.from(t.$binary,"base64")):typeof t.$binary!="string"&&(o=t.$binary.subType?parseInt(t.$binary.subType,16):0,n=xe.from(t.$binary.base64,"base64")):"$uuid"in t&&(o=4,n=Ql(t.$uuid)),!n)throw new Ke("Unexpected Binary Extended JSON format ".concat(JSON.stringify(t)));return o===B_?new kv(n):new e(n,o)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.value(!0);return'new Binary(Buffer.from("'.concat(t.toString("hex"),'", "hex"), ').concat(this.sub_type,")")},e.BSON_BINARY_SUBTYPE_DEFAULT=0,e.BUFFER_SIZE=256,e.SUBTYPE_DEFAULT=0,e.SUBTYPE_FUNCTION=1,e.SUBTYPE_BYTE_ARRAY=2,e.SUBTYPE_UUID_OLD=3,e.SUBTYPE_UUID=4,e.SUBTYPE_MD5=5,e.SUBTYPE_ENCRYPTED=6,e.SUBTYPE_COLUMN=7,e.SUBTYPE_USER_DEFINED=128,e}();Object.defineProperty(di.prototype,"_bsontype",{value:"Binary"});var tl=16,kv=function(e){Xu(t,e);function t(r){var n=this,o,i;if(r==null)o=t.generate();else if(r instanceof t)o=xe.from(r.buffer),i=r.__id;else if(ArrayBuffer.isView(r)&&r.byteLength===tl)o=hu(r);else if(typeof r=="string")o=Ql(r);else throw new Ke("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");return n=e.call(this,o,B_)||this,n.__id=i,n}return Object.defineProperty(t.prototype,"id",{get:function(){return this.buffer},set:function(r){this.buffer=r,t.cacheHexString&&(this.__id=jv(r))},enumerable:!1,configurable:!0}),t.prototype.toHexString=function(r){if(r===void 0&&(r=!0),t.cacheHexString&&this.__id)return this.__id;var n=jv(this.id,r);return t.cacheHexString&&(this.__id=n),n},t.prototype.toString=function(r){return r?this.id.toString(r):this.toHexString()},t.prototype.toJSON=function(){return this.toHexString()},t.prototype.equals=function(r){if(!r)return!1;if(r instanceof t)return r.id.equals(this.id);try{return new t(r).id.equals(this.id)}catch{return!1}},t.prototype.toBinary=function(){return new di(this.id,di.SUBTYPE_UUID)},t.generate=function(){var r=F_(tl);return r[6]=r[6]&15|64,r[8]=r[8]&63|128,xe.from(r)},t.isValid=function(r){return r?r instanceof t?!0:typeof r=="string"?M_(r):dd(r)?r.length!==tl?!1:(r[6]&240)===64&&(r[8]&128)===128:!1:!1},t.createFromHexString=function(r){var n=Ql(r);return new t(n)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new UUID("'.concat(this.toHexString(),'")')},t}(di),ec=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);this.code=t,this.scope=r}return e.prototype.toJSON=function(){return{code:this.code,scope:this.scope}},e.prototype.toExtendedJSON=function(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}},e.fromExtendedJSON=function(t){return new e(t.$code,t.$scope)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.toJSON();return'new Code("'.concat(String(t.code),'"').concat(t.scope?", ".concat(JSON.stringify(t.scope)):"",")")},e}();Object.defineProperty(ec.prototype,"_bsontype",{value:"Code"});function XL(e){return Ls(e)&&e.$id!=null&&typeof e.$ref=="string"&&(e.$db==null||typeof e.$db=="string")}var Os=function(){function e(t,r,n,o){if(!(this instanceof e))return new e(t,r,n,o);var i=t.split(".");i.length===2&&(n=i.shift(),t=i.shift()),this.collection=t,this.oid=r,this.db=n,this.fields=o||{}}return Object.defineProperty(e.prototype,"namespace",{get:function(){return this.collection},set:function(t){this.collection=t},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){var t=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return this.db!=null&&(t.$db=this.db),t},e.prototype.toExtendedJSON=function(t){t=t||{};var r={$ref:this.collection,$id:this.oid};return t.legacy||(this.db&&(r.$db=this.db),r=Object.assign(r,this.fields)),r},e.fromExtendedJSON=function(t){var r=Object.assign({},t);return delete r.$ref,delete r.$id,delete r.$db,new e(t.$ref,t.$id,t.$db,r)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.oid===void 0||this.oid.toString===void 0?this.oid:this.oid.toString();return'new DBRef("'.concat(this.namespace,'", new ObjectId("').concat(String(t),'")').concat(this.db?', "'.concat(this.db,'"'):"",")")},e}();Object.defineProperty(Os.prototype,"_bsontype",{value:"DBRef"});var er=void 0;try{er=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}var qv=65536,ZL=1<<24,Mi=qv*qv,j_=Mi*Mi,Wv=j_/2,Hv={},Gv={},ce=function(){function e(t,r,n){if(t===void 0&&(t=0),!(this instanceof e))return new e(t,r,n);typeof t=="bigint"?Object.assign(this,e.fromBigInt(t,!!r)):typeof t=="string"?Object.assign(this,e.fromString(t,!!r)):(this.low=t|0,this.high=r|0,this.unsigned=!!n),Object.defineProperty(this,"__isLong__",{value:!0,configurable:!1,writable:!1,enumerable:!1})}return e.fromBits=function(t,r,n){return new e(t,r,n)},e.fromInt=function(t,r){var n,o,i;return r?(t>>>=0,(i=0<=t&&t<256)&&(o=Gv[t],o)?o:(n=e.fromBits(t,(t|0)<0?-1:0,!0),i&&(Gv[t]=n),n)):(t|=0,(i=-128<=t&&t<128)&&(o=Hv[t],o)?o:(n=e.fromBits(t,t<0?-1:0,!1),i&&(Hv[t]=n),n))},e.fromNumber=function(t,r){if(isNaN(t))return r?e.UZERO:e.ZERO;if(r){if(t<0)return e.UZERO;if(t>=j_)return e.MAX_UNSIGNED_VALUE}else{if(t<=-Wv)return e.MIN_VALUE;if(t+1>=Wv)return e.MAX_VALUE}return t<0?e.fromNumber(-t,r).neg():e.fromBits(t%Mi|0,t/Mi|0,r)},e.fromBigInt=function(t,r){return e.fromString(t.toString(),r)},e.fromString=function(t,r,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return e.ZERO;if(typeof r=="number"?(n=r,r=!1):r=!!r,n=n||10,n<2||36<n)throw RangeError("radix");var o;if((o=t.indexOf("-"))>0)throw Error("interior hyphen");if(o===0)return e.fromString(t.substring(1),r,n).neg();for(var i=e.fromNumber(Math.pow(n,8)),a=e.ZERO,u=0;u<t.length;u+=8){var l=Math.min(8,t.length-u),s=parseInt(t.substring(u,u+l),n);if(l<8){var c=e.fromNumber(Math.pow(n,l));a=a.mul(c).add(e.fromNumber(s))}else a=a.mul(i),a=a.add(e.fromNumber(s))}return a.unsigned=r,a},e.fromBytes=function(t,r,n){return n?e.fromBytesLE(t,r):e.fromBytesBE(t,r)},e.fromBytesLE=function(t,r){return new e(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,r)},e.fromBytesBE=function(t,r){return new e(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],r)},e.isLong=function(t){return Ls(t)&&t.__isLong__===!0},e.fromValue=function(t,r){return typeof t=="number"?e.fromNumber(t,r):typeof t=="string"?e.fromString(t,r):e.fromBits(t.low,t.high,typeof r=="boolean"?r:t.unsigned)},e.prototype.add=function(t){e.isLong(t)||(t=e.fromValue(t));var r=this.high>>>16,n=this.high&65535,o=this.low>>>16,i=this.low&65535,a=t.high>>>16,u=t.high&65535,l=t.low>>>16,s=t.low&65535,c=0,f=0,d=0,v=0;return v+=i+s,d+=v>>>16,v&=65535,d+=o+l,f+=d>>>16,d&=65535,f+=n+u,c+=f>>>16,f&=65535,c+=r+a,c&=65535,e.fromBits(d<<16|v,c<<16|f,this.unsigned)},e.prototype.and=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low&t.low,this.high&t.high,this.unsigned)},e.prototype.compare=function(t){if(e.isLong(t)||(t=e.fromValue(t)),this.eq(t))return 0;var r=this.isNegative(),n=t.isNegative();return r&&!n?-1:!r&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},e.prototype.comp=function(t){return this.compare(t)},e.prototype.divide=function(t){if(e.isLong(t)||(t=e.fromValue(t)),t.isZero())throw Error("division by zero");if(er){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var r=(this.unsigned?er.div_u:er.div_s)(this.low,this.high,t.low,t.high);return e.fromBits(r,er.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?e.UZERO:e.ZERO;var n,o,i;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return e.UZERO;if(t.gt(this.shru(1)))return e.UONE;i=e.UZERO}else{if(this.eq(e.MIN_VALUE)){if(t.eq(e.ONE)||t.eq(e.NEG_ONE))return e.MIN_VALUE;if(t.eq(e.MIN_VALUE))return e.ONE;var a=this.shr(1);return n=a.div(t).shl(1),n.eq(e.ZERO)?t.isNegative()?e.ONE:e.NEG_ONE:(o=this.sub(t.mul(n)),i=n.add(o.div(t)),i)}else if(t.eq(e.MIN_VALUE))return this.unsigned?e.UZERO:e.ZERO;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=e.ZERO}for(o=this;o.gte(t);){n=Math.max(1,Math.floor(o.toNumber()/t.toNumber()));for(var u=Math.ceil(Math.log(n)/Math.LN2),l=u<=48?1:Math.pow(2,u-48),s=e.fromNumber(n),c=s.mul(t);c.isNegative()||c.gt(o);)n-=l,s=e.fromNumber(n,this.unsigned),c=s.mul(t);s.isZero()&&(s=e.ONE),i=i.add(s),o=o.sub(c)}return i},e.prototype.div=function(t){return this.divide(t)},e.prototype.equals=function(t){return e.isLong(t)||(t=e.fromValue(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low},e.prototype.eq=function(t){return this.equals(t)},e.prototype.getHighBits=function(){return this.high},e.prototype.getHighBitsUnsigned=function(){return this.high>>>0},e.prototype.getLowBits=function(){return this.low},e.prototype.getLowBitsUnsigned=function(){return this.low>>>0},e.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(e.MIN_VALUE)?64:this.neg().getNumBitsAbs();var t=this.high!==0?this.high:this.low,r;for(r=31;r>0&&!(t&1<<r);r--);return this.high!==0?r+33:r+1},e.prototype.greaterThan=function(t){return this.comp(t)>0},e.prototype.gt=function(t){return this.greaterThan(t)},e.prototype.greaterThanOrEqual=function(t){return this.comp(t)>=0},e.prototype.gte=function(t){return this.greaterThanOrEqual(t)},e.prototype.ge=function(t){return this.greaterThanOrEqual(t)},e.prototype.isEven=function(){return(this.low&1)===0},e.prototype.isNegative=function(){return!this.unsigned&&this.high<0},e.prototype.isOdd=function(){return(this.low&1)===1},e.prototype.isPositive=function(){return this.unsigned||this.high>=0},e.prototype.isZero=function(){return this.high===0&&this.low===0},e.prototype.lessThan=function(t){return this.comp(t)<0},e.prototype.lt=function(t){return this.lessThan(t)},e.prototype.lessThanOrEqual=function(t){return this.comp(t)<=0},e.prototype.lte=function(t){return this.lessThanOrEqual(t)},e.prototype.modulo=function(t){if(e.isLong(t)||(t=e.fromValue(t)),er){var r=(this.unsigned?er.rem_u:er.rem_s)(this.low,this.high,t.low,t.high);return e.fromBits(r,er.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))},e.prototype.mod=function(t){return this.modulo(t)},e.prototype.rem=function(t){return this.modulo(t)},e.prototype.multiply=function(t){if(this.isZero())return e.ZERO;if(e.isLong(t)||(t=e.fromValue(t)),er){var r=er.mul(this.low,this.high,t.low,t.high);return e.fromBits(r,er.get_high(),this.unsigned)}if(t.isZero())return e.ZERO;if(this.eq(e.MIN_VALUE))return t.isOdd()?e.MIN_VALUE:e.ZERO;if(t.eq(e.MIN_VALUE))return this.isOdd()?e.MIN_VALUE:e.ZERO;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(e.TWO_PWR_24)&&t.lt(e.TWO_PWR_24))return e.fromNumber(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,o=this.high&65535,i=this.low>>>16,a=this.low&65535,u=t.high>>>16,l=t.high&65535,s=t.low>>>16,c=t.low&65535,f=0,d=0,v=0,g=0;return g+=a*c,v+=g>>>16,g&=65535,v+=i*c,d+=v>>>16,v&=65535,v+=a*s,d+=v>>>16,v&=65535,d+=o*c,f+=d>>>16,d&=65535,d+=i*s,f+=d>>>16,d&=65535,d+=a*l,f+=d>>>16,d&=65535,f+=n*c+o*s+i*l+a*u,f&=65535,e.fromBits(v<<16|g,f<<16|d,this.unsigned)},e.prototype.mul=function(t){return this.multiply(t)},e.prototype.negate=function(){return!this.unsigned&&this.eq(e.MIN_VALUE)?e.MIN_VALUE:this.not().add(e.ONE)},e.prototype.neg=function(){return this.negate()},e.prototype.not=function(){return e.fromBits(~this.low,~this.high,this.unsigned)},e.prototype.notEquals=function(t){return!this.equals(t)},e.prototype.neq=function(t){return this.notEquals(t)},e.prototype.ne=function(t){return this.notEquals(t)},e.prototype.or=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low|t.low,this.high|t.high,this.unsigned)},e.prototype.shiftLeft=function(t){return e.isLong(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?e.fromBits(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):e.fromBits(0,this.low<<t-32,this.unsigned)},e.prototype.shl=function(t){return this.shiftLeft(t)},e.prototype.shiftRight=function(t){return e.isLong(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?e.fromBits(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):e.fromBits(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},e.prototype.shr=function(t){return this.shiftRight(t)},e.prototype.shiftRightUnsigned=function(t){if(e.isLong(t)&&(t=t.toInt()),t&=63,t===0)return this;var r=this.high;if(t<32){var n=this.low;return e.fromBits(n>>>t|r<<32-t,r>>>t,this.unsigned)}else return t===32?e.fromBits(r,0,this.unsigned):e.fromBits(r>>>t-32,0,this.unsigned)},e.prototype.shr_u=function(t){return this.shiftRightUnsigned(t)},e.prototype.shru=function(t){return this.shiftRightUnsigned(t)},e.prototype.subtract=function(t){return e.isLong(t)||(t=e.fromValue(t)),this.add(t.neg())},e.prototype.sub=function(t){return this.subtract(t)},e.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},e.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*Mi+(this.low>>>0):this.high*Mi+(this.low>>>0)},e.prototype.toBigInt=function(){return BigInt(this.toString())},e.prototype.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},e.prototype.toBytesLE=function(){var t=this.high,r=this.low;return[r&255,r>>>8&255,r>>>16&255,r>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]},e.prototype.toBytesBE=function(){var t=this.high,r=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,r>>>24,r>>>16&255,r>>>8&255,r&255]},e.prototype.toSigned=function(){return this.unsigned?e.fromBits(this.low,this.high,!1):this},e.prototype.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(e.MIN_VALUE)){var r=e.fromNumber(t),n=this.div(r),o=n.mul(r).sub(this);return n.toString(t)+o.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var i=e.fromNumber(Math.pow(t,6),this.unsigned),a=this,u="";;){var l=a.div(i),s=a.sub(l.mul(i)).toInt()>>>0,c=s.toString(t);if(a=l,a.isZero())return c+u;for(;c.length<6;)c="0"+c;u=""+c+u}},e.prototype.toUnsigned=function(){return this.unsigned?this:e.fromBits(this.low,this.high,!0)},e.prototype.xor=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low^t.low,this.high^t.high,this.unsigned)},e.prototype.eqz=function(){return this.isZero()},e.prototype.le=function(t){return this.lessThanOrEqual(t)},e.prototype.toExtendedJSON=function(t){return t&&t.relaxed?this.toNumber():{$numberLong:this.toString()}},e.fromExtendedJSON=function(t,r){var n=e.fromString(t.$numberLong);return r&&r.relaxed?n.toNumber():n},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new Long("'.concat(this.toString(),'"').concat(this.unsigned?", true":"",")")},e.TWO_PWR_24=e.fromInt(ZL),e.MAX_UNSIGNED_VALUE=e.fromBits(-1,-1,!0),e.ZERO=e.fromInt(0),e.UZERO=e.fromInt(0,!0),e.ONE=e.fromInt(1),e.UONE=e.fromInt(1,!0),e.NEG_ONE=e.fromInt(-1),e.MAX_VALUE=e.fromBits(-1,2147483647,!1),e.MIN_VALUE=e.fromBits(0,-2147483648,!1),e}();Object.defineProperty(ce.prototype,"__isLong__",{value:!0});Object.defineProperty(ce.prototype,"_bsontype",{value:"Long"});var eU=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,tU=/^(\+|-)?(Infinity|inf)$/i,rU=/^(\+|-)?NaN$/i,Lo=6111,rl=-6176,Vv=6176,nU=34,nl=[124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),Kv=[248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),zv=[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),iU=/^([-+])?(\d+)?$/,oU=31,Jv=16383,sU=30,aU=31;function Yv(e){return!isNaN(parseInt(e,10))}function uU(e){var t=ce.fromNumber(1e9),r=ce.fromNumber(0);if(!e.parts[0]&&!e.parts[1]&&!e.parts[2]&&!e.parts[3])return{quotient:e,rem:r};for(var n=0;n<=3;n++)r=r.shiftLeft(32),r=r.add(new ce(e.parts[n],0)),e.parts[n]=r.div(t).low,r=r.modulo(t);return{quotient:e,rem:r}}function cU(e,t){if(!e&&!t)return{high:ce.fromNumber(0),low:ce.fromNumber(0)};var r=e.shiftRightUnsigned(32),n=new ce(e.getLowBits(),0),o=t.shiftRightUnsigned(32),i=new ce(t.getLowBits(),0),a=r.multiply(o),u=r.multiply(i),l=n.multiply(o),s=n.multiply(i);return a=a.add(u.shiftRightUnsigned(32)),u=new ce(u.getLowBits(),0).add(l).add(s.shiftRightUnsigned(32)),a=a.add(u.shiftRightUnsigned(32)),s=u.shiftLeft(32).add(new ce(s.getLowBits(),0)),{high:a,low:s}}function lU(e,t){var r=e.high>>>0,n=t.high>>>0;if(r<n)return!0;if(r===n){var o=e.low>>>0,i=t.low>>>0;if(o<i)return!0}return!1}function Ri(e,t){throw new Ke('"'.concat(e,'" is not a valid Decimal128 string - ').concat(t))}var hd=function(){function e(t){if(!(this instanceof e))return new e(t);if(typeof t=="string")this.bytes=e.fromString(t).bytes;else if(dd(t)){if(t.byteLength!==16)throw new Ke("Decimal128 must take a Buffer of 16 bytes");this.bytes=t}else throw new Ke("Decimal128 must take a Buffer or string")}return e.fromString=function(t){var r=!1,n=!1,o=!1,i=0,a=0,u=0,l=0,s=0,c=[0],f=0,d=0,v=0,g=0,b=0,y=0,w=new ce(0,0),E=new ce(0,0),A=0,I=0;if(t.length>=7e3)throw new Ke(""+t+" not a valid Decimal128 string");var R=t.match(eU),L=t.match(tU),F=t.match(rU);if(!R&&!L&&!F||t.length===0)throw new Ke(""+t+" not a valid Decimal128 string");if(R){var U=R[2],N=R[4],W=R[5],j=R[6];N&&j===void 0&&Ri(t,"missing exponent power"),N&&U===void 0&&Ri(t,"missing exponent base"),N===void 0&&(W||j)&&Ri(t,"missing e before exponent")}if((t[I]==="+"||t[I]==="-")&&(r=t[I++]==="-"),!Yv(t[I])&&t[I]!=="."){if(t[I]==="i"||t[I]==="I")return new e(xe.from(r?Kv:zv));if(t[I]==="N")return new e(xe.from(nl))}for(;Yv(t[I])||t[I]===".";){if(t[I]==="."){n&&Ri(t,"contains multiple periods"),n=!0,I=I+1;continue}f<34&&(t[I]!=="0"||o)&&(o||(s=a),o=!0,c[d++]=parseInt(t[I],10),f=f+1),o&&(u=u+1),n&&(l=l+1),a=a+1,I=I+1}if(n&&!a)throw new Ke(""+t+" not a valid Decimal128 string");if(t[I]==="e"||t[I]==="E"){var X=t.substr(++I).match(iU);if(!X||!X[2])return new e(xe.from(nl));b=parseInt(X[0],10),I=I+X[0].length}if(t[I])return new e(xe.from(nl));if(v=0,!f)v=0,g=0,c[0]=0,u=1,f=1,i=0;else if(g=f-1,i=u,i!==1)for(;c[s+i-1]===0;)i=i-1;for(b<=l&&l-b>16384?b=rl:b=b-l;b>Lo;){if(g=g+1,g-v>nU){var fe=c.join("");if(fe.match(/^0+$/)){b=Lo;break}Ri(t,"overflow")}b=b-1}for(;b<rl||f<u;){if(g===0&&i<f){b=rl,i=0;break}if(f<u?u=u-1:g=g-1,b<Lo)b=b+1;else{var fe=c.join("");if(fe.match(/^0+$/)){b=Lo;break}Ri(t,"overflow")}}if(g-v+1<i){var q=a;n&&(s=s+1,q=q+1),r&&(s=s+1,q=q+1);var de=parseInt(t[s+g+1],10),k=0;if(de>=5&&(k=1,de===5)){for(k=c[g]%2===1?1:0,y=s+g+2;y<q;y++)if(parseInt(t[y],10)){k=1;break}}if(k){for(var M=g;M>=0;M--)if(++c[M]>9&&(c[M]=0,M===0))if(b<Lo)b=b+1,c[M]=1;else return new e(xe.from(r?Kv:zv))}}if(w=ce.fromNumber(0),E=ce.fromNumber(0),i===0)w=ce.fromNumber(0),E=ce.fromNumber(0);else if(g-v<17){var M=v;for(E=ce.fromNumber(c[M++]),w=new ce(0,0);M<=g;M++)E=E.multiply(ce.fromNumber(10)),E=E.add(ce.fromNumber(c[M]))}else{var M=v;for(w=ce.fromNumber(c[M++]);M<=g-17;M++)w=w.multiply(ce.fromNumber(10)),w=w.add(ce.fromNumber(c[M]));for(E=ce.fromNumber(c[M++]);M<=g;M++)E=E.multiply(ce.fromNumber(10)),E=E.add(ce.fromNumber(c[M]))}var D=cU(w,ce.fromString("100000000000000000"));D.low=D.low.add(E),lU(D.low,E)&&(D.high=D.high.add(ce.fromNumber(1))),A=b+Vv;var G={low:ce.fromNumber(0),high:ce.fromNumber(0)};D.high.shiftRightUnsigned(49).and(ce.fromNumber(1)).equals(ce.fromNumber(1))?(G.high=G.high.or(ce.fromNumber(3).shiftLeft(61)),G.high=G.high.or(ce.fromNumber(A).and(ce.fromNumber(16383).shiftLeft(47))),G.high=G.high.or(D.high.and(ce.fromNumber(0x7fffffffffff)))):(G.high=G.high.or(ce.fromNumber(A&16383).shiftLeft(49)),G.high=G.high.or(D.high.and(ce.fromNumber(562949953421311)))),G.low=D.low,r&&(G.high=G.high.or(ce.fromString("9223372036854775808")));var Z=xe.alloc(16);return I=0,Z[I++]=G.low.low&255,Z[I++]=G.low.low>>8&255,Z[I++]=G.low.low>>16&255,Z[I++]=G.low.low>>24&255,Z[I++]=G.low.high&255,Z[I++]=G.low.high>>8&255,Z[I++]=G.low.high>>16&255,Z[I++]=G.low.high>>24&255,Z[I++]=G.high.low&255,Z[I++]=G.high.low>>8&255,Z[I++]=G.high.low>>16&255,Z[I++]=G.high.low>>24&255,Z[I++]=G.high.high&255,Z[I++]=G.high.high>>8&255,Z[I++]=G.high.high>>16&255,Z[I++]=G.high.high>>24&255,new e(Z)},e.prototype.toString=function(){for(var t,r=0,n=new Array(36),o=0;o<n.length;o++)n[o]=0;var i=0,a=!1,u,l={parts:[0,0,0,0]},s,c,f=[];i=0;var d=this.bytes,v=d[i++]|d[i++]<<8|d[i++]<<16|d[i++]<<24,g=d[i++]|d[i++]<<8|d[i++]<<16|d[i++]<<24,b=d[i++]|d[i++]<<8|d[i++]<<16|d[i++]<<24,y=d[i++]|d[i++]<<8|d[i++]<<16|d[i++]<<24;i=0;var w={low:new ce(v,g),high:new ce(b,y)};w.high.lessThan(ce.ZERO)&&f.push("-");var E=y>>26&oU;if(E>>3===3){if(E===sU)return f.join("")+"Infinity";if(E===aU)return"NaN";t=y>>15&Jv,u=8+(y>>14&1)}else u=y>>14&7,t=y>>17&Jv;var A=t-Vv;if(l.parts[0]=(y&16383)+((u&15)<<14),l.parts[1]=b,l.parts[2]=g,l.parts[3]=v,l.parts[0]===0&&l.parts[1]===0&&l.parts[2]===0&&l.parts[3]===0)a=!0;else for(c=3;c>=0;c--){var I=0,R=uU(l);if(l=R.quotient,I=R.rem.low,!!I)for(s=8;s>=0;s--)n[c*9+s]=I%10,I=Math.floor(I/10)}if(a)r=1,n[i]=0;else for(r=36;!n[i];)r=r-1,i=i+1;var L=r-1+A;if(L>=34||L<=-7||A>0){if(r>34)return f.push("".concat(0)),A>0?f.push("E+".concat(A)):A<0&&f.push("E".concat(A)),f.join("");f.push("".concat(n[i++])),r=r-1,r&&f.push(".");for(var o=0;o<r;o++)f.push("".concat(n[i++]));f.push("E"),L>0?f.push("+".concat(L)):f.push("".concat(L))}else if(A>=0)for(var o=0;o<r;o++)f.push("".concat(n[i++]));else{var F=r+A;if(F>0)for(var o=0;o<F;o++)f.push("".concat(n[i++]));else f.push("0");for(f.push(".");F++<0;)f.push("0");for(var o=0;o<r-Math.max(F-1,0);o++)f.push("".concat(n[i++]))}return f.join("")},e.prototype.toJSON=function(){return{$numberDecimal:this.toString()}},e.prototype.toExtendedJSON=function(){return{$numberDecimal:this.toString()}},e.fromExtendedJSON=function(t){return e.fromString(t.$numberDecimal)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new Decimal128("'.concat(this.toString(),'")')},e}();Object.defineProperty(hd.prototype,"_bsontype",{value:"Decimal128"});var tc=function(){function e(t){if(!(this instanceof e))return new e(t);t instanceof Number&&(t=t.valueOf()),this.value=+t}return e.prototype.valueOf=function(){return this.value},e.prototype.toJSON=function(){return this.value},e.prototype.toString=function(t){return this.value.toString(t)},e.prototype.toExtendedJSON=function(t){return t&&(t.legacy||t.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-".concat(this.value.toFixed(1))}:{$numberDouble:Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}},e.fromExtendedJSON=function(t,r){var n=parseFloat(t.$numberDouble);return r&&r.relaxed?n:new e(n)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.toExtendedJSON();return"new Double(".concat(t.$numberDouble,")")},e}();Object.defineProperty(tc.prototype,"_bsontype",{value:"Double"});var rc=function(){function e(t){if(!(this instanceof e))return new e(t);t instanceof Number&&(t=t.valueOf()),this.value=+t|0}return e.prototype.valueOf=function(){return this.value},e.prototype.toString=function(t){return this.value.toString(t)},e.prototype.toJSON=function(){return this.value},e.prototype.toExtendedJSON=function(t){return t&&(t.relaxed||t.legacy)?this.value:{$numberInt:this.value.toString()}},e.fromExtendedJSON=function(t,r){return r&&r.relaxed?parseInt(t.$numberInt,10):new e(t.$numberInt)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new Int32(".concat(this.valueOf(),")")},e}();Object.defineProperty(rc.prototype,"_bsontype",{value:"Int32"});var pd=function(){function e(){if(!(this instanceof e))return new e}return e.prototype.toExtendedJSON=function(){return{$maxKey:1}},e.fromExtendedJSON=function(){return new e},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new MaxKey()"},e}();Object.defineProperty(pd.prototype,"_bsontype",{value:"MaxKey"});var vd=function(){function e(){if(!(this instanceof e))return new e}return e.prototype.toExtendedJSON=function(){return{$minKey:1}},e.fromExtendedJSON=function(){return new e},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new MinKey()"},e}();Object.defineProperty(vd.prototype,"_bsontype",{value:"MinKey"});var fU=new RegExp("^[0-9a-fA-F]{24}$"),zn=null,Pr=Symbol("id"),ur=function(){function e(t){if(!(this instanceof e))return new e(t);var r;if(typeof t=="object"&&t&&"id"in t){if(typeof t.id!="string"&&!ArrayBuffer.isView(t.id))throw new Ke("Argument passed in must have an id that is of type string or Buffer");"toHexString"in t&&typeof t.toHexString=="function"?r=xe.from(t.toHexString(),"hex"):r=t.id}else r=t;if(r==null||typeof r=="number")this[Pr]=e.generate(typeof r=="number"?r:void 0);else if(ArrayBuffer.isView(r)&&r.byteLength===12)this[Pr]=r instanceof xe?r:hu(r);else if(typeof r=="string")if(r.length===12){var n=xe.from(r);if(n.byteLength===12)this[Pr]=n;else throw new Ke("Argument passed in must be a string of 12 bytes")}else if(r.length===24&&fU.test(r))this[Pr]=xe.from(r,"hex");else throw new Ke("Argument passed in must be a string of 12 bytes or a string of 24 hex characters or an integer");else throw new Ke("Argument passed in does not match the accepted types");e.cacheHexString&&(this.__id=this.id.toString("hex"))}return Object.defineProperty(e.prototype,"id",{get:function(){return this[Pr]},set:function(t){this[Pr]=t,e.cacheHexString&&(this.__id=t.toString("hex"))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"generationTime",{get:function(){return this.id.readInt32BE(0)},set:function(t){this.id.writeUInt32BE(t,0)},enumerable:!1,configurable:!0}),e.prototype.toHexString=function(){if(e.cacheHexString&&this.__id)return this.__id;var t=this.id.toString("hex");return e.cacheHexString&&!this.__id&&(this.__id=t),t},e.getInc=function(){return e.index=(e.index+1)%16777215},e.generate=function(t){typeof t!="number"&&(t=Math.floor(Date.now()/1e3));var r=e.getInc(),n=xe.alloc(12);return n.writeUInt32BE(t,0),zn===null&&(zn=F_(5)),n[4]=zn[0],n[5]=zn[1],n[6]=zn[2],n[7]=zn[3],n[8]=zn[4],n[11]=r&255,n[10]=r>>8&255,n[9]=r>>16&255,n},e.prototype.toString=function(t){return t?this.id.toString(t):this.toHexString()},e.prototype.toJSON=function(){return this.toHexString()},e.prototype.equals=function(t){if(t==null)return!1;if(t instanceof e)return this[Pr][11]===t[Pr][11]&&this[Pr].equals(t[Pr]);if(typeof t=="string"&&e.isValid(t)&&t.length===12&&dd(this.id))return t===xe.prototype.toString.call(this.id,"latin1");if(typeof t=="string"&&e.isValid(t)&&t.length===24)return t.toLowerCase()===this.toHexString();if(typeof t=="string"&&e.isValid(t)&&t.length===12)return xe.from(t).equals(this.id);if(typeof t=="object"&&"toHexString"in t&&typeof t.toHexString=="function"){var r=t.toHexString(),n=this.toHexString().toLowerCase();return typeof r=="string"&&r.toLowerCase()===n}return!1},e.prototype.getTimestamp=function(){var t=new Date,r=this.id.readUInt32BE(0);return t.setTime(Math.floor(r)*1e3),t},e.createPk=function(){return new e},e.createFromTime=function(t){var r=xe.from([0,0,0,0,0,0,0,0,0,0,0,0]);return r.writeUInt32BE(t,0),new e(r)},e.createFromHexString=function(t){if(typeof t>"u"||t!=null&&t.length!==24)throw new Ke("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");return new e(xe.from(t,"hex"))},e.isValid=function(t){if(t==null)return!1;try{return new e(t),!0}catch{return!1}},e.prototype.toExtendedJSON=function(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}},e.fromExtendedJSON=function(t){return new e(t.$oid)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new ObjectId("'.concat(this.toHexString(),'")')},e.index=Math.floor(Math.random()*16777215),e}();Object.defineProperty(ur.prototype,"generate",{value:Zu(function(e){return ur.generate(e)},"Please use the static `ObjectId.generate(time)` instead")});Object.defineProperty(ur.prototype,"getInc",{value:Zu(function(){return ur.getInc()},"Please use the static `ObjectId.getInc()` instead")});Object.defineProperty(ur.prototype,"get_inc",{value:Zu(function(){return ur.getInc()},"Please use the static `ObjectId.getInc()` instead")});Object.defineProperty(ur,"get_inc",{value:Zu(function(){return ur.getInc()},"Please use the static `ObjectId.getInc()` instead")});Object.defineProperty(ur.prototype,"_bsontype",{value:"ObjectID"});function dU(e){return e.split("").sort().join("")}var Ts=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);if(this.pattern=t,this.options=dU(r??""),this.pattern.indexOf("\0")!==-1)throw new fi("BSON Regex patterns cannot contain null bytes, found: ".concat(JSON.stringify(this.pattern)));if(this.options.indexOf("\0")!==-1)throw new fi("BSON Regex options cannot contain null bytes, found: ".concat(JSON.stringify(this.options)));for(var n=0;n<this.options.length;n++)if(!(this.options[n]==="i"||this.options[n]==="m"||this.options[n]==="x"||this.options[n]==="l"||this.options[n]==="s"||this.options[n]==="u"))throw new fi("The regular expression option [".concat(this.options[n],"] is not supported"))}return e.parseOptions=function(t){return t?t.split("").sort().join(""):""},e.prototype.toExtendedJSON=function(t){return t=t||{},t.legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}},e.fromExtendedJSON=function(t){if("$regex"in t)if(typeof t.$regex!="string"){if(t.$regex._bsontype==="BSONRegExp")return t}else return new e(t.$regex,e.parseOptions(t.$options));if("$regularExpression"in t)return new e(t.$regularExpression.pattern,e.parseOptions(t.$regularExpression.options));throw new Ke("Unexpected BSONRegExp EJSON object form: ".concat(JSON.stringify(t)))},e}();Object.defineProperty(Ts.prototype,"_bsontype",{value:"BSONRegExp"});var md=function(){function e(t){if(!(this instanceof e))return new e(t);this.value=t}return e.prototype.valueOf=function(){return this.value},e.prototype.toString=function(){return this.value},e.prototype.inspect=function(){return'new BSONSymbol("'.concat(this.value,'")')},e.prototype.toJSON=function(){return this.value},e.prototype.toExtendedJSON=function(){return{$symbol:this.value}},e.fromExtendedJSON=function(t){return new e(t.$symbol)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e}();Object.defineProperty(md.prototype,"_bsontype",{value:"Symbol"});var hU=ce,k_=function(e){Xu(t,e);function t(r,n){var o=this;return o instanceof t?(ce.isLong(r)?o=e.call(this,r.low,r.high,!0)||this:Ls(r)&&typeof r.t<"u"&&typeof r.i<"u"?o=e.call(this,r.i,r.t,!0)||this:o=e.call(this,r,n,!0)||this,Object.defineProperty(o,"_bsontype",{value:"Timestamp",writable:!1,configurable:!1,enumerable:!1}),o):new t(r,n)}return t.prototype.toJSON=function(){return{$timestamp:this.toString()}},t.fromInt=function(r){return new t(ce.fromInt(r,!0))},t.fromNumber=function(r){return new t(ce.fromNumber(r,!0))},t.fromBits=function(r,n){return new t(r,n)},t.fromString=function(r,n){return new t(ce.fromString(r,!0,n))},t.prototype.toExtendedJSON=function(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}},t.fromExtendedJSON=function(r){return new t(r.$timestamp)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new Timestamp({ t: ".concat(this.getHighBits(),", i: ").concat(this.getLowBits()," })")},t.MAX_VALUE=ce.MAX_UNSIGNED_VALUE,t}(hU);function pU(e){return Ls(e)&&Reflect.has(e,"_bsontype")&&typeof e._bsontype=="string"}var q_=2147483647,W_=-2147483648,H_=9223372036854776e3,G_=-9223372036854776e3,vU={$oid:ur,$binary:di,$uuid:di,$symbol:md,$numberInt:rc,$numberDecimal:hd,$numberDouble:tc,$numberLong:ce,$minKey:vd,$maxKey:pd,$regex:Ts,$regularExpression:Ts,$timestamp:k_};function V_(e,t){if(t===void 0&&(t={}),typeof e=="number"){if(t.relaxed||t.legacy)return e;if(Math.floor(e)===e){if(e>=W_&&e<=q_)return new rc(e);if(e>=G_&&e<=H_)return ce.fromNumber(e)}return new tc(e)}if(e==null||typeof e!="object")return e;if(e.$undefined)return null;for(var r=Object.keys(e).filter(function(f){return f.startsWith("$")&&e[f]!=null}),n=0;n<r.length;n++){var o=vU[r[n]];if(o)return o.fromExtendedJSON(e,t)}if(e.$date!=null){var i=e.$date,a=new Date;return t.legacy?typeof i=="number"?a.setTime(i):typeof i=="string"&&a.setTime(Date.parse(i)):typeof i=="string"?a.setTime(Date.parse(i)):ce.isLong(i)?a.setTime(i.toNumber()):typeof i=="number"&&t.relaxed&&a.setTime(i),a}if(e.$code!=null){var u=Object.assign({},e);return e.$scope&&(u.$scope=V_(e.$scope)),ec.fromExtendedJSON(e)}if(XL(e)||e.$dbPointer){var l=e.$ref?e:e.$dbPointer;if(l instanceof Os)return l;var s=Object.keys(l).filter(function(f){return f.startsWith("$")}),c=!0;if(s.forEach(function(f){["$ref","$id","$db"].indexOf(f)===-1&&(c=!1)}),c)return Os.fromExtendedJSON(l)}return e}function mU(e,t){return e.map(function(r,n){t.seenObjects.push({propertyName:"index ".concat(n),obj:null});try{return An(r,t)}finally{t.seenObjects.pop()}})}function Qv(e){var t=e.toISOString();return e.getUTCMilliseconds()!==0?t:t.slice(0,-5)+"Z"}function An(e,t){if((typeof e=="object"||typeof e=="function")&&e!==null){var r=t.seenObjects.findIndex(function(w){return w.obj===e});if(r!==-1){var n=t.seenObjects.map(function(w){return w.propertyName}),o=n.slice(0,r).map(function(w){return"".concat(w," -> ")}).join(""),i=n[r],a=" -> "+n.slice(r+1,n.length-1).map(function(w){return"".concat(w," -> ")}).join(""),u=n[n.length-1],l=" ".repeat(o.length+i.length/2),s="-".repeat(a.length+(i.length+u.length)/2-1);throw new Ke(`Converting circular structure to EJSON:
`+"    ".concat(o).concat(i).concat(a).concat(u,`
`)+"    ".concat(l,"\\").concat(s,"/"))}t.seenObjects[t.seenObjects.length-1].obj=e}if(Array.isArray(e))return mU(e,t);if(e===void 0)return null;if(e instanceof Date||zL(e)){var c=e.getTime(),f=c>-1&&c<2534023188e5;return t.legacy?t.relaxed&&f?{$date:e.getTime()}:{$date:Qv(e)}:t.relaxed&&f?{$date:Qv(e)}:{$date:{$numberLong:e.getTime().toString()}}}if(typeof e=="number"&&(!t.relaxed||!isFinite(e))){if(Math.floor(e)===e){var d=e>=W_&&e<=q_,v=e>=G_&&e<=H_;if(d)return{$numberInt:e.toString()};if(v)return{$numberLong:e.toString()}}return{$numberDouble:e.toString()}}if(e instanceof RegExp||KL(e)){var g=e.flags;if(g===void 0){var b=e.toString().match(/[gimuy]*$/);b&&(g=b[0])}var y=new Ts(e.source,g);return y.toExtendedJSON(t)}return e!=null&&typeof e=="object"?yU(e,t):e}var gU={Binary:function(e){return new di(e.value(),e.sub_type)},Code:function(e){return new ec(e.code,e.scope)},DBRef:function(e){return new Os(e.collection||e.namespace,e.oid,e.db,e.fields)},Decimal128:function(e){return new hd(e.bytes)},Double:function(e){return new tc(e.value)},Int32:function(e){return new rc(e.value)},Long:function(e){return ce.fromBits(e.low!=null?e.low:e.low_,e.low!=null?e.high:e.high_,e.low!=null?e.unsigned:e.unsigned_)},MaxKey:function(){return new pd},MinKey:function(){return new vd},ObjectID:function(e){return new ur(e)},ObjectId:function(e){return new ur(e)},BSONRegExp:function(e){return new Ts(e.pattern,e.options)},Symbol:function(e){return new md(e.value)},Timestamp:function(e){return k_.fromBits(e.low,e.high)}};function yU(e,t){if(e==null||typeof e!="object")throw new fi("not an object instance");var r=e._bsontype;if(typeof r>"u"){var n={};for(var o in e){t.seenObjects.push({propertyName:o,obj:null});try{var i=An(e[o],t);o==="__proto__"?Object.defineProperty(n,o,{value:i,writable:!0,enumerable:!0,configurable:!0}):n[o]=i}finally{t.seenObjects.pop()}}return n}else if(pU(e)){var a=e;if(typeof a.toExtendedJSON!="function"){var u=gU[e._bsontype];if(!u)throw new Ke("Unrecognized or invalid _bsontype: "+e._bsontype);a=u(a)}return r==="Code"&&a.scope?a=new ec(a.code,An(a.scope,t)):r==="DBRef"&&a.oid&&(a=new Os(An(a.collection,t),An(a.oid,t),An(a.db,t),An(a.fields,t))),a.toExtendedJSON(t)}else throw new fi("_bsontype must be a string, but was: "+typeof r)}var Vt;(function(e){function t(i,a){var u=Object.assign({},{relaxed:!0,legacy:!1},a);return typeof u.relaxed=="boolean"&&(u.strict=!u.relaxed),typeof u.strict=="boolean"&&(u.relaxed=!u.strict),JSON.parse(i,function(l,s){if(l.indexOf("\0")!==-1)throw new fi("BSON Document field names cannot contain null bytes, found: ".concat(JSON.stringify(l)));return V_(s,u)})}e.parse=t;function r(i,a,u,l){u!=null&&typeof u=="object"&&(l=u,u=0),a!=null&&typeof a=="object"&&!Array.isArray(a)&&(l=a,a=void 0,u=0);var s=Object.assign({relaxed:!0,legacy:!1},l,{seenObjects:[{propertyName:"(root)",obj:null}]}),c=An(i,s);return JSON.stringify(c,a,u)}e.stringify=r;function n(i,a){return a=a||{},JSON.parse(r(i,a))}e.serialize=n;function o(i,a){return a=a||{},t(JSON.stringify(i),a)}e.deserialize=o})(Vt||(Vt={}));var Xv=U_();Xv.Map?Xv.Map:function(){function e(t){t===void 0&&(t=[]),this._keys=[],this._values={};for(var r=0;r<t.length;r++)if(t[r]!=null){var n=t[r],o=n[0],i=n[1];this._keys.push(o),this._values[o]={v:i,i:this._keys.length-1}}}return e.prototype.clear=function(){this._keys=[],this._values={}},e.prototype.delete=function(t){var r=this._values[t];return r==null?!1:(delete this._values[t],this._keys.splice(r.i,1),!0)},e.prototype.entries=function(){var t=this,r=0;return{next:function(){var n=t._keys[r++];return{value:n!==void 0?[n,t._values[n].v]:void 0,done:n===void 0}}}},e.prototype.forEach=function(t,r){r=r||this;for(var n=0;n<this._keys.length;n++){var o=this._keys[n];t.call(r,this._values[o].v,o,r)}},e.prototype.get=function(t){return this._values[t]?this._values[t].v:void 0},e.prototype.has=function(t){return this._values[t]!=null},e.prototype.keys=function(){var t=this,r=0;return{next:function(){var n=t._keys[r++];return{value:n!==void 0?n:void 0,done:n===void 0}}}},e.prototype.set=function(t,r){return this._values[t]?(this._values[t].v=r,this):(this._keys.push(t),this._values[t]={v:r,i:this._keys.length-1},this)},e.prototype.values=function(){var t=this,r=0;return{next:function(){var n=t._keys[r++];return{value:n!==void 0?t._values[n].v:void 0,done:n===void 0}}}},Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!1,configurable:!0}),e}();ce.fromNumber(YL);ce.fromNumber(QL);var il=new Uint8Array(8);new DataView(il.buffer,il.byteOffset,il.byteLength);var _U=1024*1024*17;xe.alloc(_U);var bU=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},wU=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},K_=function(){function e(t,r){this._stages=[],t&&r&&(this._db=t,this._request=new St.reqClass(this._db.config),this._collectionName=r)}return e.prototype.end=function(){return bU(this,void 0,void 0,function(){var t;return wU(this,function(r){switch(r.label){case 0:if(!this._collectionName||!this._db)throw new Error("Aggregation pipeline cannot send request");return[4,this._request.send("database.aggregate",{collectionName:this._collectionName,stages:this._stages})];case 1:return t=r.sent(),t&&t.data&&t.data.list?[2,{requestId:t.requestId,data:JSON.parse(t.data.list).map(Vt.parse)}]:[2,t]}})})},e.prototype.unwrap=function(){return this._stages},e.prototype.done=function(){return this._stages.map(function(t){var r,n=t.stageKey,o=t.stageValue;return r={},r[n]=JSON.parse(o),r})},e.prototype._pipe=function(t,r){return this._stages.push({stageKey:"$"+t,stageValue:JSON.stringify(r)}),this},e.prototype.addFields=function(t){return this._pipe("addFields",t)},e.prototype.bucket=function(t){return this._pipe("bucket",t)},e.prototype.bucketAuto=function(t){return this._pipe("bucketAuto",t)},e.prototype.count=function(t){return this._pipe("count",t)},e.prototype.geoNear=function(t){return t.query&&(t.query=du.encode(t.query)),t.distanceMultiplier&&typeof t.distanceMultiplier=="number"&&(t.distanceMultiplier=t.distanceMultiplier),t.near&&(t.near=new jt(t.near.longitude,t.near.latitude).toJSON()),this._pipe("geoNear",t)},e.prototype.group=function(t){return this._pipe("group",t)},e.prototype.limit=function(t){return this._pipe("limit",t)},e.prototype.match=function(t){return this._pipe("match",du.encode(t))},e.prototype.project=function(t){return this._pipe("project",t)},e.prototype.lookup=function(t){return this._pipe("lookup",t)},e.prototype.replaceRoot=function(t){return this._pipe("replaceRoot",t)},e.prototype.sample=function(t){return this._pipe("sample",t)},e.prototype.skip=function(t){return this._pipe("skip",t)},e.prototype.sort=function(t){return this._pipe("sort",t)},e.prototype.sortByCount=function(t){return this._pipe("sortByCount",t)},e.prototype.unwind=function(t){return this._pipe("unwind",t)},e}(),EU=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),SU=function(e){EU(t,e);function t(r,n){return e.call(this,r,n)||this}return Object.defineProperty(t.prototype,"name",{get:function(){return this._coll},enumerable:!0,configurable:!0}),t.prototype.doc=function(r){if(typeof r!="string"&&typeof r!="number")throw new Error("docId必须为字符串或数字");return new Bv(this._db,this._coll,r)},t.prototype.add=function(r,n){var o=new Bv(this._db,this._coll,void 0);return o.create(r,n)},t.prototype.aggregate=function(){return new K_(this._db,this._coll)},t}(RL),IU={eq:function(e){return new rt(pe.EQ,[e])},neq:function(e){return new rt(pe.NEQ,[e])},lt:function(e){return new rt(pe.LT,[e])},lte:function(e){return new rt(pe.LTE,[e])},gt:function(e){return new rt(pe.GT,[e])},gte:function(e){return new rt(pe.GTE,[e])},in:function(e){return new rt(pe.IN,e)},nin:function(e){return new rt(pe.NIN,e)},all:function(e){return new rt(pe.ALL,e)},elemMatch:function(e){return new rt(pe.ELEM_MATCH,[e])},exists:function(e){return new rt(pe.EXISTS,[e])},size:function(e){return new rt(pe.SIZE,[e])},mod:function(e){return new rt(pe.MOD,[e])},geoNear:function(e){return new rt(pe.GEO_NEAR,[e])},geoWithin:function(e){return new rt(pe.GEO_WITHIN,[e])},geoIntersects:function(e){return new rt(pe.GEO_INTERSECTS,[e])},and:function(){var e=ze(arguments[0])?arguments[0]:Array.from(arguments);return new ai(Qt.AND,e)},nor:function(){var e=ze(arguments[0])?arguments[0]:Array.from(arguments);return new ai(Qt.NOR,e)},or:function(){var e=ze(arguments[0])?arguments[0]:Array.from(arguments);return new ai(Qt.OR,e)},not:function(){var e=ze(arguments[0])?arguments[0]:Array.from(arguments);return new ai(Qt.NOT,e)},set:function(e){return new Ze(Ie.SET,[e])},remove:function(){return new Ze(Ie.REMOVE,[])},inc:function(e){return new Ze(Ie.INC,[e])},mul:function(e){return new Ze(Ie.MUL,[e])},push:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r;if(Un(e[0])&&e[0].hasOwnProperty("each")){var n=e[0];r={$each:n.each,$position:n.position,$sort:n.sort,$slice:n.slice}}else ze(e[0])?r=e[0]:r=Array.from(e);return new Ze(Ie.PUSH,r)},pull:function(e){return new Ze(Ie.PULL,e)},pullAll:function(e){return new Ze(Ie.PULL_ALL,e)},pop:function(){return new Ze(Ie.POP,[])},shift:function(){return new Ze(Ie.SHIFT,[])},unshift:function(){var e=ze(arguments[0])?arguments[0]:Array.from(arguments);return new Ze(Ie.UNSHIFT,e)},addToSet:function(e){return new Ze(Ie.ADD_TO_SET,e)},rename:function(e){return new Ze(Ie.RENAME,[e])},bit:function(e){return new Ze(Ie.BIT,[e])},max:function(e){return new Ze(Ie.MAX,[e])},min:function(e){return new Ze(Ie.MIN,[e])},expr:function(e){return{$expr:e}},jsonSchema:function(e){return{$jsonSchema:e}},text:function(e){return bL(e)?{$search:e.search}:{$search:e.search,$language:e.language,$caseSensitive:e.caseSensitive,$diacriticSensitive:e.diacriticSensitive}},aggregate:{pipeline:function(){return new K_},abs:function(e){return new V("abs",e)},add:function(e){return new V("add",e)},ceil:function(e){return new V("ceil",e)},divide:function(e){return new V("divide",e)},exp:function(e){return new V("exp",e)},floor:function(e){return new V("floor",e)},ln:function(e){return new V("ln",e)},log:function(e){return new V("log",e)},log10:function(e){return new V("log10",e)},mod:function(e){return new V("mod",e)},multiply:function(e){return new V("multiply",e)},pow:function(e){return new V("pow",e)},sqrt:function(e){return new V("sqrt",e)},subtract:function(e){return new V("subtract",e)},trunc:function(e){return new V("trunc",e)},arrayElemAt:function(e){return new V("arrayElemAt",e)},arrayToObject:function(e){return new V("arrayToObject",e)},concatArrays:function(e){return new V("concatArrays",e)},filter:function(e){return new V("filter",e)},in:function(e){return new V("in",e)},indexOfArray:function(e){return new V("indexOfArray",e)},isArray:function(e){return new V("isArray",e)},map:function(e){return new V("map",e)},range:function(e){return new V("range",e)},reduce:function(e){return new V("reduce",e)},reverseArray:function(e){return new V("reverseArray",e)},size:function(e){return new V("size",e)},slice:function(e){return new V("slice",e)},zip:function(e){return new V("zip",e)},and:function(e){return new V("and",e)},not:function(e){return new V("not",e)},or:function(e){return new V("or",e)},cmp:function(e){return new V("cmp",e)},eq:function(e){return new V("eq",e)},gt:function(e){return new V("gt",e)},gte:function(e){return new V("gte",e)},lt:function(e){return new V("lt",e)},lte:function(e){return new V("lte",e)},neq:function(e){return new V("ne",e)},cond:function(e){return new V("cond",e)},ifNull:function(e){return new V("ifNull",e)},switch:function(e){return new V("switch",e)},dateFromParts:function(e){return new V("dateFromParts",e)},dateFromString:function(e){return new V("dateFromString",e)},dayOfMonth:function(e){return new V("dayOfMonth",e)},dayOfWeek:function(e){return new V("dayOfWeek",e)},dayOfYear:function(e){return new V("dayOfYear",e)},isoDayOfWeek:function(e){return new V("isoDayOfWeek",e)},isoWeek:function(e){return new V("isoWeek",e)},isoWeekYear:function(e){return new V("isoWeekYear",e)},millisecond:function(e){return new V("millisecond",e)},minute:function(e){return new V("minute",e)},month:function(e){return new V("month",e)},second:function(e){return new V("second",e)},hour:function(e){return new V("hour",e)},week:function(e){return new V("week",e)},year:function(e){return new V("year",e)},literal:function(e){return new V("literal",e)},mergeObjects:function(e){return new V("mergeObjects",e)},objectToArray:function(e){return new V("objectToArray",e)},allElementsTrue:function(e){return new V("allElementsTrue",e)},anyElementTrue:function(e){return new V("anyElementTrue",e)},setDifference:function(e){return new V("setDifference",e)},setEquals:function(e){return new V("setEquals",e)},setIntersection:function(e){return new V("setIntersection",e)},setIsSubset:function(e){return new V("setIsSubset",e)},setUnion:function(e){return new V("setUnion",e)},concat:function(e){return new V("concat",e)},dateToString:function(e){return new V("dateToString",e)},indexOfBytes:function(e){return new V("indexOfBytes",e)},indexOfCP:function(e){return new V("indexOfCP",e)},split:function(e){return new V("split",e)},strLenBytes:function(e){return new V("strLenBytes",e)},strLenCP:function(e){return new V("strLenCP",e)},strcasecmp:function(e){return new V("strcasecmp",e)},substr:function(e){return new V("substr",e)},substrBytes:function(e){return new V("substrBytes",e)},substrCP:function(e){return new V("substrCP",e)},toLower:function(e){return new V("toLower",e)},toUpper:function(e){return new V("toUpper",e)},meta:function(e){return new V("meta",e)},addToSet:function(e){return new V("addToSet",e)},avg:function(e){return new V("avg",e)},first:function(e){return new V("first",e)},last:function(e){return new V("last",e)},max:function(e){return new V("max",e)},min:function(e){return new V("min",e)},push:function(e){return new V("push",e)},stdDevPop:function(e){return new V("stdDevPop",e)},stdDevSamp:function(e){return new V("stdDevSamp",e)},sum:function(e){return new V("sum",e)},let:function(e){return new V("let",e)}},project:{slice:function(e){return new Zv("slice",e)},elemMatch:function(e){return new Zv("elemMatch",e)}}},V=function(){function e(t,r){this["$"+t]=r}return e}(),Zv=function(){function e(t,r){this["$"+t]=r}return e}(),OU=function(){function e(t){var r=t.regexp,n=t.options;if(!r)throw new TypeError("regexp must be a string");this.$regex=r,this.$options=n}return e.prototype.parse=function(){return{$regex:this.$regex,$options:this.$options}},Object.defineProperty(e.prototype,"_internalType",{get:function(){return R_},enumerable:!0,configurable:!0}),e}();function TU(e){return new OU(e)}var z_={INSERT_DOC_FAIL:{message:"insert document failed"},DATABASE_TRANSACTION_CONFLICT:{code:"DATABASE_TRANSACTION_CONFLICT"}},Lr=function(){return Lr=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Lr.apply(this,arguments)},Uo=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Fo=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},AU="database.getInTransaction",em="database.updateDocInTransaction",RU="database.deleteDocInTransaction",CU="database.insertDocInTransaction",tm=function(){function e(t,r,n){this._coll=r,this.id=n,this._transaction=t,this._request=this._transaction.getRequestMethod(),this._transactionId=this._transaction.getTransactionId()}return e.prototype.create=function(t){return Uo(this,void 0,void 0,function(){var r,n,o,i;return Fo(this,function(a){switch(a.label){case 0:return r={collectionName:this._coll,transactionId:this._transactionId,data:Vt.stringify(Is(t),{relaxed:!1})},this.id&&(r._id=this.id),[4,this._request.send(CU,r)];case 1:if(n=a.sent(),n.code)throw n;if(o=Vt.parse(n.inserted),i=Vt.parse(n.ok),i==1&&o==1)return[2,Lr(Lr({},n),{ok:i,inserted:o})];throw new Error(z_.INSERT_DOC_FAIL.message)}})})},e.prototype.get=function(){return Uo(this,void 0,void 0,function(){var t,r;return Fo(this,function(n){switch(n.label){case 0:return t={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}}},[4,this._request.send(AU,t)];case 1:if(r=n.sent(),r.code)throw r;return[2,{data:r.data!=="null"?Yu.formatField(Vt.parse(r.data)):Vt.parse(r.data),requestId:r.requestId}]}})})},e.prototype.set=function(t){return Uo(this,void 0,void 0,function(){var r,n;return Fo(this,function(o){switch(o.label){case 0:return r={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}},data:Vt.stringify(Is(t),{relaxed:!1}),upsert:!0},[4,this._request.send(em,r)];case 1:if(n=o.sent(),n.code)throw n;return[2,Lr(Lr({},n),{updated:Vt.parse(n.updated),upserted:n.upserted?JSON.parse(n.upserted):null})]}})})},e.prototype.update=function(t){return Uo(this,void 0,void 0,function(){var r,n;return Fo(this,function(o){switch(o.label){case 0:return r={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}},data:Vt.stringify(fd.encode(t),{relaxed:!1})},[4,this._request.send(em,r)];case 1:if(n=o.sent(),n.code)throw n;return[2,Lr(Lr({},n),{updated:Vt.parse(n.updated)})]}})})},e.prototype.delete=function(){return Uo(this,void 0,void 0,function(){var t,r;return Fo(this,function(n){switch(n.label){case 0:return t={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}}},[4,this._request.send(RU,t)];case 1:if(r=n.sent(),r.code)throw r;return[2,Lr(Lr({},r),{deleted:Vt.parse(r.deleted)})]}})})},e}(),xU=function(){function e(t,r){this._coll=r,this._transaction=t}return e}(),PU=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),NU=function(e){PU(t,e);function t(r,n){return e.call(this,r,n)||this}return Object.defineProperty(t.prototype,"name",{get:function(){return this._coll},enumerable:!0,configurable:!0}),t.prototype.doc=function(r){if(typeof r!="string"&&typeof r!="number")throw new Error("docId必须为字符串或数字");return new tm(this._transaction,this._coll,r)},t.prototype.add=function(r){var n;r._id!==void 0&&(n=r._id);var o=new tm(this._transaction,this._coll,n);return o.create(r)},t}(xU),Yi=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Qi=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},$U="database.startTransaction",DU="database.commitTransaction",LU="database.abortTransaction",J_=function(){function e(t){this._db=t,this._request=new St.reqClass(this._db.config),this.aborted=!1,this.commited=!1,this.inited=!1}return e.prototype.init=function(){return Yi(this,void 0,void 0,function(){var t;return Qi(this,function(r){switch(r.label){case 0:return[4,this._request.send($U)];case 1:if(t=r.sent(),t.code)throw t;return this.inited=!0,this._id=t.transactionId,[2]}})})},e.prototype.collection=function(t){if(!t)throw new Error("Collection name is required");return new NU(this,t)},e.prototype.getTransactionId=function(){return this._id},e.prototype.getRequestMethod=function(){return this._request},e.prototype.commit=function(){return Yi(this,void 0,void 0,function(){var t,r;return Qi(this,function(n){switch(n.label){case 0:return t={transactionId:this._id},[4,this._request.send(DU,t)];case 1:if(r=n.sent(),r.code)throw r;return this.commited=!0,[2,r]}})})},e.prototype.rollback=function(t){return Yi(this,void 0,void 0,function(){var r,n;return Qi(this,function(o){switch(o.label){case 0:return r={transactionId:this._id},[4,this._request.send(LU,r)];case 1:if(n=o.sent(),n.code)throw n;return this.aborted=!0,this.abortReason=t,[2,n]}})})},e}();function UU(){return Yi(this,void 0,void 0,function(){var e;return Qi(this,function(t){switch(t.label){case 0:return e=new J_(this),[4,e.init()];case 1:return t.sent(),[2,e]}})})}function Y_(e,t){return t===void 0&&(t=3),Yi(this,void 0,void 0,function(){var r,n,o,i,a=this;return Qi(this,function(u){switch(u.label){case 0:return u.trys.push([0,4,,10]),r=new J_(this),[4,r.init()];case 1:return u.sent(),[4,e(r)];case 2:if(n=u.sent(),r.aborted===!0)throw r.abortReason;return[4,r.commit()];case 3:return u.sent(),[2,n];case 4:if(o=u.sent(),r.inited===!1)throw o;return i=function(l){return Yi(a,void 0,void 0,function(){return Qi(this,function(s){switch(s.label){case 0:if(!(!r.aborted&&!r.commited))return[3,5];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r.rollback()];case 2:return s.sent(),[3,4];case 3:return s.sent(),[3,4];case 4:throw l;case 5:throw r.aborted===!0?r.abortReason:l}})})},t<=0?[4,i(o)]:[3,6];case 5:u.sent(),u.label=6;case 6:return o&&o.code===z_.DATABASE_TRANSACTION_CONFLICT.code?[4,Y_.bind(this)(e,--t)]:[3,8];case 7:return[2,u.sent()];case 8:return[4,i(o)];case 9:return u.sent(),[3,10];case 10:return[2]}})})}var St=function(){function e(t){this.config=t,this.Geo=SL,this.serverDate=_L,this.command=IU,this.RegExp=TU,this.startTransaction=UU,this.runTransaction=Y_,this.logicCommand=ai,this.updateCommand=Ze,this.queryCommand=rt}return e.prototype.collection=function(t){if(!t)throw new Error("Collection name is required");return new SU(this,t)},e.prototype.createCollection=function(t){var r=new e.reqClass(this.config),n={collectionName:t};return r.send("database.addCollection",n)},e}(),os=function(){return os=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},os.apply(this,arguments)},FU="database";function MU(e){var t=this.platform,r=t.adapter,n=t.runtime;return St.reqClass=this.request.constructor,St.getAccessToken=this.authInstance?this.authInstance.getAccessToken.bind(this.authInstance):function(){return""},St.runtime=n,this.wsClientClass&&(St.wsClass=r.wsClass,St.wsClientClass=this.wsClientClass),St.ws||(St.ws=null),new St(os(os(os({},this.config),{_fromApp:this}),e))}var Q_={name:FU,entity:{database:MU}};try{cloudbase.registerComponent(Q_)}catch{}function BU(e){try{e.registerComponent(Q_)}catch(t){console.warn(t)}}const jU="4.0.0",kU={version:jU};var qU=kU.version;Kt.registerVersion(qU);try{AO(Kt),BO(Kt),WO(Kt),BU(Kt),o3(Kt),m3(Kt),P3(Kt),cL(Kt),xO(Kt)}catch{}try{window.cloudbase=Kt}catch{}var am,um;const WU=((um=(am=import.meta)==null?void 0:am.env)==null?void 0:um.VITE_CLOUD_ENV_ID)||"cloud1-3gbydxui8864f9aa",X_=Kt.init({env:WU}),nc=X_.auth({persistence:"local"}),vt=X_.database();async function HU(e,t){if(!e||!t)throw new Error("请输入用户名和密码");return console.log("使用 auth.signIn 方法登录"),nc.signIn({username:e,password:t})}async function GU(){return nc.signOut()}async function go(){const e=await nc.getLoginState();if(!e)throw new Error("未登录");return e}async function gd(e){const{collection:t,pageNo:r,pageSize:n,keyword:o,typeFilter:i}=e;if(await go(),t==="sites")return await VU({pageNo:r,pageSize:n,keyword:o,typeFilter:i});if(t==="feedback"){const f={};if(o){const y=vt.RegExp({regexp:o,options:"i"}),w={地点反馈:["point"],意见建议:["suggestion"],问题反馈:["bug"],投诉:["complaint"],表扬:["praise"],其他:["other"]};let E=[];for(const[A,I]of Object.entries(w))(A.includes(o)||o.includes(A))&&E.push(...I.map(R=>({type:vt.RegExp({regexp:R,options:"i"})})));E.length>0?f.$or=[...E,{content:y},{phoneNumber:y},{nickName:y},{selectedPoint:y}]:f.$or=[{type:y},{content:y},{phoneNumber:y},{nickName:y},{selectedPoint:y}]}console.log("feedback where:",f);const d=(r-1)*n,v=await vt.collection(t).where(f).count(),g=(v==null?void 0:v.total)||0;return{list:(await vt.collection(t).where(f).orderBy("createTime","desc").skip(d).limit(n).get()).data||[],total:g}}const a={};if(o){const f=vt.RegExp({regexp:o,options:"i"});a.$or=[{name:f},{phone:f},{address:f}]}console.log("where:",a);const u=(r-1)*n,l=await vt.collection(t).where(a).count(),s=(l==null?void 0:l.total)||0;return{list:(await vt.collection(t).where(a).orderBy("name","asc").skip(u).limit(n).get()).data||[],total:s}}async function VU(e){const{pageNo:t,pageSize:r,keyword:n,typeFilter:o}=e;await go();const a=o?[o]:["toilet","warm","sinopec","partner","relay"],u={};if(n){const g=vt.RegExp({regexp:n,options:"i"});u.$or=[{name:g},{address:g},{serviceContent:g}]}const l=a.map(async g=>{try{return((await vt.collection(g).where(u).get()).data||[]).map(y=>({...y,_collection:g,type:g}))}catch{return[]}}),c=(await Promise.all(l)).flat().sort((g,b)=>(g.name||"").localeCompare(b.name||"")),f=c.length,d=(t-1)*r;return{list:c.slice(d,d+r),total:f}}async function yd(e,t,r){await go();const n={...r};delete n._id,delete n._collection,delete n._openid;const o=await vt.collection(e).doc(t).update(n);if(!o.updated||o.updated===0)throw new Error("未更新任何数据");return o}async function _d(e,t){if(await go(),e==="sites"){const i=t.type;if(!i)throw new Error("创建点位时必须指定type字段");delete t._collection;const a=await vt.collection(i).add(t),u=(a==null?void 0:a.id)||(a==null?void 0:a._id)||(a==null?void 0:a.insertedId)||(Array.isArray(a==null?void 0:a.ids)?a.ids[0]:void 0)||(Array.isArray(a==null?void 0:a.insertedIds)?a.insertedIds[0]:void 0);if(u)return u;const l=`${i}_${Date.now()}_${Math.random().toString(36).slice(2,8)}`;return await vt.collection(i).doc(l).set(t),l}const r=await vt.collection(e).add(t),n=(r==null?void 0:r.id)||(r==null?void 0:r._id)||(r==null?void 0:r.insertedId)||(Array.isArray(r==null?void 0:r.ids)?r.ids[0]:void 0)||(Array.isArray(r==null?void 0:r.insertedIds)?r.insertedIds[0]:void 0);if(n)return n;const o=`${e}_${Date.now()}_${Math.random().toString(36).slice(2,8)}`;return await vt.collection(e).doc(o).set(t),o}async function bd(e,t,r){await go();const{deleted:n}=await vt.collection(e).doc(t).remove();if(!n)throw new Error("未删除任何数据")}function KU(){return vt}function Z_(){return nc}const Ea={contact:{key:"contact",title:"联系信息",collection:"contact",searchFields:["name","phone","address"],fallbackFields:["name","phone","address","latitude","longitude","photoUrl","serviceContent","serviceTime"]},emergency:{key:"emergency",title:"紧急服务",collection:"emergency",searchFields:["name","phone","address"],fallbackFields:["name","phone","address"]},sites:{key:"sites",title:"点位修改",collection:"sites",searchFields:["name","address","serviceContent"],fallbackFields:["id","name","address","latitude","longitude","type","photoUrl","serviceContent","serviceTime"],siteTypes:{toilet:{name:"公共厕所",collection:"toilet"},warm:{name:"暖心服务站",collection:"warm"},sinopec:{name:"爱心驿站",collection:"sinopec"},partner:{name:"合作商户",collection:"partner"},relay:{name:"接力站",collection:"relay"}}},reservations:{key:"reservations",title:"预约管理",collection:"reservations",searchFields:["name","phone","address"],fallbackFields:["id","name","phone"]},feedback:{key:"feedback",title:"用户反馈",collection:"feedback",searchFields:["userName","phone","content","type"],fallbackFields:["userName","phone","content","type","createTime","status"]}},zU="contact",JU={class:"page-header"},YU={class:"header-actions"},QU={class:"layout"},XU={class:"sidebar"},ZU={class:"nav-group"},eF={class:"nav-group"},tF={class:"nav-group"},rF={class:"nav-group"},nF=vn({__name:"App",setup(e){const t=Ps(),r=ve(!0),n=ve(""),o=Ve(()=>{const d=t.currentRoute.value;return console.log("当前路由:",d),d.name==="module"?d.params.module||zU:d.name==="venue-reservations"||d.name==="event-registrations"?"reservations":d.name}),i=Ve(()=>{const d=t.currentRoute.value.name;return d==="reservations"||d==="venue-reservations"||d==="event-registrations"});go().catch(()=>t.replace({name:"login"}));function a(){r.value=!r.value}function u(){var v;t.currentRoute.value.name==="sites"?t.push({name:"sites",query:{keyword:n.value}}):(v=f.value)==null||v.reload({pageNo:1,keyword:n.value})}function l(){var d;(d=f.value)==null||d.openCreate()}async function s(){await GU(),t.replace({name:"login"})}function c(d){console.log("switch:",d),d==="sites"?t.push({name:"sites"}):d==="reservations"?(console.log("switch to reservations"),t.push({name:"reservations",params:{module:d}})):d==="feedback"?t.push({name:"feedback"}):d==="announcements"?t.push({name:"announcements"}):t.push({name:"module",params:{module:d}})}const f=ve();return(d,v)=>{const g=Hm("router-view");return oe(),ae(Me,null,[C("header",JU,[C("button",{class:"icon-btn",onClick:a,"aria-label":"展开/收起导航"},"☰"),v[7]||(v[7]=C("h1",null,"微光驿站 · 管理后台",-1)),C("div",YU,[ke(C("input",{"onUpdate:modelValue":v[0]||(v[0]=b=>n.value=b),type:"text",placeholder:"搜索关键词"},null,512),[[wr,n.value,void 0,{trim:!0}]]),C("button",{class:"btn",onClick:u},"搜索"),C("button",{class:"btn primary",onClick:l},"新建"),C("button",{class:"btn danger",onClick:s},"退出")])]),C("div",QU,[ke(C("aside",XU,[C("nav",null,[C("div",ZU,[v[8]||(v[8]=C("div",{class:"nav-group-title"},"安新地图",-1)),C("a",{class:st({active:o.value==="sites"}),href:"javascript:void(0)",onClick:v[1]||(v[1]=b=>c("sites"))},"点位修改",2)]),C("div",eF,[v[9]||(v[9]=C("div",{class:"nav-group-title"},"安新联系",-1)),C("a",{class:st({active:o.value==="contact"}),href:"javascript:void(0)",onClick:v[2]||(v[2]=b=>c("contact"))},"联系信息",2),C("a",{class:st({active:o.value==="emergency"}),href:"javascript:void(0)",onClick:v[3]||(v[3]=b=>c("emergency"))},"紧急服务",2)]),C("div",tF,[v[10]||(v[10]=C("div",{class:"nav-group-title"},"安新活动",-1)),C("a",{class:st({active:o.value==="reservations"||i.value}),href:"javascript:void(0)",onClick:v[4]||(v[4]=b=>c("reservations"))},"预约管理",2)]),C("div",rF,[v[11]||(v[11]=C("div",{class:"nav-group-title"},"其他",-1)),C("a",{class:st({active:o.value==="feedback"}),href:"javascript:void(0)",onClick:v[5]||(v[5]=b=>c("feedback"))},"用户反馈",2),C("a",{class:st({active:o.value==="announcements"}),href:"javascript:void(0)",onClick:v[6]||(v[6]=b=>c("announcements"))},"公告管理",2)])])],512),[[pn,r.value]]),Rt(g,null,{default:Mm(({Component:b})=>[(oe(),fg(nw(b),{ref_key:"pageRef",ref:f,keyword:n.value,class:"content"},null,8,["keyword"]))]),_:1})])],64)}}}),iF="modulepreload",oF=function(e){return"/"+e},rm={},nm=function(t,r,n){let o=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),u=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));o=Promise.allSettled(r.map(l=>{if(l=oF(l),l in rm)return;rm[l]=!0;const s=l.endsWith(".css"),c=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const f=document.createElement("link");if(f.rel=s?"stylesheet":iF,s||(f.as="script"),f.crossOrigin="",f.href=l,u&&f.setAttribute("nonce",u),document.head.appendChild(f),s)return new Promise((d,v)=>{f.addEventListener("load",d),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=a,window.dispatchEvent(u),!u.defaultPrevented)throw a}return o.then(a=>{for(const u of a||[])u.status==="rejected"&&i(u.reason);return t().catch(i)})},sF={class:"login-page"},aF={class:"login-container"},uF={class:"form-item"},cF={class:"form-item"},lF=["disabled"],fF={key:0,class:"error-text"},dF=vn({__name:"Login",setup(e){const t=Ps(),r=ve(""),n=ve(""),o=ve(!1),i=ve("");Z_().getLoginState().then(u=>{u&&t.replace({name:"module",params:{module:"contact"}})});async function a(){i.value="",o.value=!0;try{await HU(r.value,n.value),t.replace({name:"module",params:{module:"contact"}})}catch(u){i.value=(u==null?void 0:u.message)||"登录失败"}finally{o.value=!1}}return(u,l)=>(oe(),ae("div",sF,[C("div",aF,[l[4]||(l[4]=C("h2",null,"登录管理系统",-1)),C("div",uF,[l[2]||(l[2]=C("label",null,"用户名",-1)),ke(C("input",{"onUpdate:modelValue":l[0]||(l[0]=s=>r.value=s),type:"text",placeholder:"请输入用户名"},null,512),[[wr,r.value,void 0,{trim:!0}]])]),C("div",cF,[l[3]||(l[3]=C("label",null,"密码",-1)),ke(C("input",{"onUpdate:modelValue":l[1]||(l[1]=s=>n.value=s),type:"password",placeholder:"请输入密码"},null,512),[[wr,n.value]])]),C("button",{class:"btn primary",disabled:o.value,onClick:a},ge(o.value?"登录中...":"登录"),9,lF),i.value?(oe(),ae("div",fF,ge(i.value),1)):ln("",!0)])]))}}),hF={class:"table-wrapper"},pF={class:"actions-cell"},vF=["onClick"],mF=["onClick"],gF={key:0,class:"empty-tip"},yF={class:"pagination"},_F=["disabled"],bF=["disabled"],wF={class:"modal",role:"dialog","aria-modal":"true"},EF={class:"modal-header"},SF={class:"modal-body"},IF=["for"],OF=["id","onUpdate:modelValue"],TF=["id","onUpdate:modelValue"],AF={key:0,class:"error-text"},RF={class:"modal-footer"},CF=["disabled"],im=10,xF=vn({__name:"ModulePage",props:{keyword:{}},setup(e,{expose:t}){const r=e,n=_f(),o=Ps(),i=ve(1),a=ve(0),u=ve([]),l=ve(!1),s=ve([]),c=ve(""),f=ve(!1),d=ve(!1),v=bi({}),g=ve(!1),b=Ve(()=>n.params.module),y=Ve(()=>Ea[b.value]),w=Ve(()=>Math.max(1,Math.ceil(a.value/im)));function E(q){const de=new Set(["_id","_openid","remark"]),k=new Set;q.forEach(G=>Object.keys(G||{}).forEach(Z=>{de.has(Z)||k.add(Z)}));const M=["name","phone","address"].filter(G=>k.has(G)),D=Array.from(k).filter(G=>!M.includes(G)).sort();return[...M,...D]}function A(q){return q==null?"":typeof q=="object"?JSON.stringify(q):String(q)}function I(q){return["latitude","longitude","rphotoUrl","photoUrl","imageUrl"].includes(q)?"cell-small":/url/i.test(q)?"cell-url":""}async function R(){l.value=!0,c.value="";try{const{list:q,total:de}=await gd({collection:y.value.collection,pageNo:i.value,pageSize:im,keyword:r.keyword});u.value=q,a.value=de,s.value=q.length?E(q):y.value.fallbackFields}catch(q){c.value=(q==null?void 0:q.message)||"加载失败",/未登录|登录已过期/.test(c.value)&&o.replace({name:"login"})}finally{l.value=!1}}function L(q){q>=1&&q<=w.value&&(i.value=q,R())}function F(){d.value=!0,Object.keys(v).forEach(q=>delete v[q]),(y.value.fallbackFields||[]).forEach(q=>v[q]=""),f.value=!0}function U(q){d.value=!1,Object.keys(v).forEach(k=>delete v[k]),E([q]).forEach(k=>v[k]=q[k]??""),v._id=q._id,f.value=!0}function N(){f.value=!1}function W(q){return typeof q=="string"&&q.length>60}const j=Ve(()=>Object.keys(v).filter(q=>q!=="_id"));async function X(){g.value=!0;try{if(!v.name)throw new Error("名称不能为空");if(d.value)await _d(y.value.collection,{...v});else{const q=v._id;if(!q)throw new Error("未选择记录");const de={...v};delete de._id,await yd(y.value.collection,q,de)}N(),R()}catch(q){c.value=(q==null?void 0:q.message)||"保存失败"}g.value=!1}async function fe(q){if(confirm("确认删除该记录？该操作不可恢复。"))try{await bd(y.value.collection,q._id),R()}catch(de){alert((de==null?void 0:de.message)||"删除失败")}}return Cs(R),Ln(()=>[b.value,r.keyword],()=>{i.value=1,R()}),t({reload:R,openCreate:F}),(q,de)=>(oe(),ae("div",null,[C("div",hF,[C("table",null,[C("thead",null,[C("tr",null,[(oe(!0),ae(Me,null,Tt(s.value,k=>(oe(),ae("th",{key:k},ge(k),1))),128)),de[2]||(de[2]=C("th",{style:{width:"160px"}},"操作",-1))])]),C("tbody",null,[(oe(!0),ae(Me,null,Tt(u.value,k=>(oe(),ae("tr",{key:k._id},[(oe(!0),ae(Me,null,Tt(s.value,M=>(oe(),ae("td",{key:M,class:st(I(M))},ge(A(k[M])),3))),128)),C("td",pF,[C("button",{class:"btn sm primary",onClick:M=>U(k)},"编辑",8,vF),C("button",{class:"btn sm danger",onClick:M=>fe(k)},"删除",8,mF)])]))),128))])]),!l.value&&u.value.length===0?(oe(),ae("div",gF,"暂无数据")):ln("",!0),C("div",yF,[C("button",{class:"btn",disabled:i.value<=1,onClick:de[0]||(de[0]=k=>L(i.value-1))},"上一页",8,_F),C("span",null,"第 "+ge(i.value)+" / "+ge(w.value)+" 页（共 "+ge(a.value)+" 条）",1),C("button",{class:"btn",disabled:i.value>=w.value,onClick:de[1]||(de[1]=k=>L(i.value+1))},"下一页",8,bF)])]),ke(C("div",{class:"modal-mask",onClick:Tu(N,["self"])},null,512),[[pn,f.value]]),ke(C("div",wF,[C("div",EF,[C("h3",null,ge(d.value?"新建信息":"编辑信息"),1),C("button",{class:"icon-btn",onClick:N},"✕")]),C("div",SF,[(oe(!0),ae(Me,null,Tt(j.value,k=>(oe(),ae("div",{class:"form-item",key:k},[C("label",{for:"form-"+k},ge(k),9,IF),W(v[k])?ke((oe(),ae("textarea",{key:0,id:"form-"+k,rows:"3","onUpdate:modelValue":M=>v[k]=M},null,8,OF)),[[wr,v[k],void 0,{trim:!0}]]):ke((oe(),ae("input",{key:1,type:"text",id:"form-"+k,"onUpdate:modelValue":M=>v[k]=M},null,8,TF)),[[wr,v[k],void 0,{trim:!0}]])]))),128)),c.value?(oe(),ae("div",AF,ge(c.value),1)):ln("",!0)]),C("div",RF,[C("button",{class:"btn",onClick:N},"取消"),C("button",{class:"btn primary",disabled:g.value,onClick:X},ge(g.value?"保存中...":"保存"),9,CF)])],512),[[pn,f.value]])]))}}),PF={class:"filter-bar"},NF=["value"],$F={class:"filter-info"},DF={class:"table-wrapper"},LF={class:"actions-cell"},UF=["onClick"],FF=["onClick"],MF={key:0,class:"empty-tip"},BF={class:"pagination"},jF=["disabled"],kF=["disabled"],qF={class:"modal",role:"dialog","aria-modal":"true"},WF={class:"modal-header"},HF={class:"modal-body"},GF={class:"form-item"},VF=["disabled"],KF=["value"],zF=["for"],JF=["id","onUpdate:modelValue"],YF=["id","onUpdate:modelValue","required"],QF={key:0,class:"error-text"},XF={class:"modal-footer"},ZF=["disabled"],om=10,e5=vn({__name:"SitesPage",setup(e,{expose:t}){const r=_f(),n=Ps(),o=Ve(()=>r.query.keyword||""),i=ve(1),a=ve(0),u=ve([]),l=ve(!1),s=ve([]),c=ve(""),f=ve(""),d=ve(!1),v=ve(!1),g=bi({}),b=ve(!1),y=Ea.sites.siteTypes||{},w=Ve(()=>Math.max(1,Math.ceil(a.value/om))),E={id:"ID",name:"名称",address:"地址",latitude:"纬度",longitude:"经度",type:"类型",photoUrl:"图片链接",serviceContent:"服务内容",serviceTime:"服务时间",_collection:"所属集合"};function A(D){return E[D]||D}function I(D){return E[D]||D}function R(D){const G=new Set(["_id","_openid","remark","_collection"]),Z=new Set;D.forEach(tt=>Object.keys(tt||{}).forEach(Ct=>{G.has(Ct)||Z.add(Ct)}));const ne=["name","type","address","serviceTime"].filter(tt=>Z.has(tt)),Ee=Array.from(Z).filter(tt=>!ne.includes(tt)).sort();return[...ne,...Ee]}function L(D){return D==null?"":typeof D=="object"?JSON.stringify(D):typeof D=="string"&&y[D]?y[D].name:String(D)}function F(D){return["id","latitude","longitude","photoUrl"].includes(D)?"cell-small":/url/i.test(D)?"cell-url":""}async function U(){l.value=!0,c.value="";try{const{list:D,total:G}=await gd({collection:"sites",pageNo:i.value,pageSize:om,keyword:o.value,typeFilter:f.value});u.value=D,a.value=G,s.value=D.length?R(D):Ea.sites.fallbackFields}catch(D){c.value=(D==null?void 0:D.message)||"加载失败",/未登录|登录已过期/.test(c.value)&&n.replace({name:"login"})}finally{l.value=!1}}function N(D){D>=1&&D<=w.value&&(i.value=D,U())}function W(){i.value=1,U()}function j(){v.value=!0,Object.keys(g).forEach(D=>delete g[D]),Ea.sites.fallbackFields.forEach(D=>g[D]=""),g.type=f.value||"",d.value=!0}function X(D){v.value=!1,Object.keys(g).forEach(Z=>delete g[Z]),R([D]).forEach(Z=>g[Z]=D[Z]??""),g._id=D._id,g._collection=D._collection||D.type,d.value=!0}function fe(){d.value=!1,b.value=!1,c.value=""}function q(D){return typeof D=="string"&&D.length>60}const de=Ve(()=>Object.keys(g).filter(D=>!["_id","_collection"].includes(D)));async function k(){b.value=!0,c.value="";try{if(!g.name)throw new Error("名称不能为空");if(!g.type)throw new Error("请选择点位类型");if(v.value){const D=g.type;if(!D)throw new Error("请选择点位类型");const G={...g};delete G._id,delete G._collection,await _d(D,G)}else{const D=g._id;if(!D)throw new Error("未选择记录");const G=g._collection||g.type;if(!G)throw new Error("无法确定要更新的集合");const Z={...g};delete Z._id,delete Z._collection,await yd(G,D,Z)}fe(),U()}catch(D){c.value=(D==null?void 0:D.message)||"保存失败"}finally{b.value=!1}}async function M(D){if(confirm(`确认删除点位"${D.name}"？该操作不可恢复。`))try{const G=D._collection||D.type;if(!G)throw new Error("无法确定要删除的集合");await bd(G,D._id),U()}catch(G){alert((G==null?void 0:G.message)||"删除失败")}}return Cs(U),Ln(()=>[o.value],()=>{i.value=1,U()}),t({reload:U,openCreate:j}),(D,G)=>{var Z;return oe(),ae("div",null,[C("div",PF,[G[5]||(G[5]=C("label",null,"点位类型：",-1)),ke(C("select",{"onUpdate:modelValue":G[0]||(G[0]=ne=>f.value=ne),onChange:W,class:"filter-select"},[G[4]||(G[4]=C("option",{value:""},"全部类型",-1)),(oe(!0),ae(Me,null,Tt(cn(y),(ne,Ee)=>(oe(),ae("option",{key:Ee,value:Ee},ge(ne.name),9,NF))),128))],544),[[Pi,f.value]]),C("span",$F,"共 "+ge(a.value)+" 个点位",1)]),C("div",DF,[C("table",null,[C("thead",null,[C("tr",null,[(oe(!0),ae(Me,null,Tt(s.value,ne=>(oe(),ae("th",{key:ne},ge(A(ne)),1))),128)),G[6]||(G[6]=C("th",{style:{width:"160px"}},"操作",-1))])]),C("tbody",null,[(oe(!0),ae(Me,null,Tt(u.value,ne=>(oe(),ae("tr",{key:ne._id},[(oe(!0),ae(Me,null,Tt(s.value,Ee=>(oe(),ae("td",{key:Ee,class:st(F(Ee))},ge(L(ne[Ee])),3))),128)),C("td",LF,[C("button",{class:"btn sm primary",onClick:Ee=>X(ne)},"编辑",8,UF),C("button",{class:"btn sm danger",onClick:Ee=>M(ne)},"删除",8,FF)])]))),128))])]),!l.value&&u.value.length===0?(oe(),ae("div",MF,ge(f.value?`暂无${((Z=cn(y)[f.value])==null?void 0:Z.name)||"该类型"}点位`:"暂无点位数据"),1)):ln("",!0),C("div",BF,[C("button",{class:"btn",disabled:i.value<=1,onClick:G[1]||(G[1]=ne=>N(i.value-1))},"上一页",8,jF),C("span",null,"第 "+ge(i.value)+" / "+ge(w.value)+" 页（共 "+ge(a.value)+" 条）",1),C("button",{class:"btn",disabled:i.value>=w.value,onClick:G[2]||(G[2]=ne=>N(i.value+1))},"下一页",8,kF)])]),ke(C("div",{class:"modal-mask",onClick:Tu(fe,["self"])},null,512),[[pn,d.value]]),ke(C("div",qF,[C("div",WF,[C("h3",null,ge(v.value?"新建点位":"编辑点位"),1),C("button",{class:"icon-btn",onClick:fe},"✕")]),C("div",HF,[C("div",GF,[G[8]||(G[8]=C("label",{for:"form-type"},"点位类型 *",-1)),ke(C("select",{id:"form-type","onUpdate:modelValue":G[3]||(G[3]=ne=>g.type=ne),disabled:!v.value,required:""},[G[7]||(G[7]=C("option",{value:""},"请选择点位类型",-1)),(oe(!0),ae(Me,null,Tt(cn(y),(ne,Ee)=>(oe(),ae("option",{key:Ee,value:Ee},ge(ne.name),9,KF))),128))],8,VF),[[Pi,g.type]])]),(oe(!0),ae(Me,null,Tt(de.value,ne=>(oe(),ae("div",{class:"form-item",key:ne},[C("label",{for:"form-"+ne},ge(I(ne))+" "+ge(ne==="name"?"*":""),9,zF),q(g[ne])?ke((oe(),ae("textarea",{key:0,id:"form-"+ne,rows:"3","onUpdate:modelValue":Ee=>g[ne]=Ee},null,8,JF)),[[wr,g[ne],void 0,{trim:!0}]]):ke((oe(),ae("input",{key:1,type:"text",id:"form-"+ne,"onUpdate:modelValue":Ee=>g[ne]=Ee,required:ne==="name"},null,8,YF)),[[wr,g[ne],void 0,{trim:!0}]])]))),128)),c.value?(oe(),ae("div",QF,ge(c.value),1)):ln("",!0)]),C("div",XF,[C("button",{class:"btn",onClick:fe},"取消"),C("button",{class:"btn primary",disabled:b.value,onClick:k},ge(b.value?"保存中...":"保存"),9,ZF)])],512),[[pn,d.value]])])}}}),wd=(e,t)=>{const r=e.__vccOpts||e;for(const[n,o]of t)r[n]=o;return r},t5=wd(e5,[["__scopeId","data-v-1252f516"]]),r5={class:"page-wrapper"},n5={class:"nav-bar"},i5=vn({__name:"Reservations",setup(e){const t=Ps(),r=_f(),n=ve("venue");function o(){r.name==="event-registrations"?n.value="event":n.value="venue"}o(),Ln(()=>r.name,()=>{o()});function i(){n.value="venue",t.push({name:"venue-reservations"})}function a(){n.value="event",t.push({name:"event-registrations"})}return Cs(()=>{r.name==="reservations"&&r.fullPath==="/module/reservations"&&t.replace({name:"venue-reservations"})}),(u,l)=>{const s=Hm("router-view");return oe(),ae("div",r5,[C("nav",n5,[C("button",{class:st(["btn",{active:n.value==="venue"}]),onClick:i},"场馆预约",2),C("button",{class:st(["btn",{active:n.value==="event"}]),onClick:a},"活动报名",2)]),Rt(s)])}}}),o5=wd(i5,[["__scopeId","data-v-965e55fd"]]),s5={class:"search-bar"},a5={class:"table-wrapper"},u5={class:"actions-cell"},c5=["onClick"],l5={key:0,class:"empty-tip"},f5={class:"pagination"},d5=["disabled"],h5=["disabled"],p5={class:"modal",role:"dialog","aria-modal":"true"},v5={class:"modal-body"},m5={class:"detail-label"},g5={class:"detail-value"},y5={key:0,class:"feedback-content"},_5={key:1},sm=10,b5=vn({__name:"FeedbackPage",setup(e){const t=ve(1),r=ve(0),n=ve([]),o=ve(!1),i=ve([]),a=ve(""),u=ve(),l=ve(!1),s=ve({}),c=Ve(()=>Math.max(1,Math.ceil(r.value/sm))),f={type:"反馈类型",content:"反馈内容",createTime:"提交时间",nickName:"用户名",contact:"联系方式",selectedPoint:"选择定位",userName:"用户名",phone:"手机号",status:"状态",address:"地址",email:"邮箱"};function d(N){return f[N]||N}const v=["type","content","createTime","nickName","contact","selectedPoint"];function g(N,W,j){if(console.log(`displayValue被调用 - key: ${W}, v:`,N,"row:",j),W==="contact"){if(console.log("=== 处理联系方式字段 ==="),console.log("key:",W),console.log("v:",N),console.log("row:",j),j&&(console.log("行数据中的字段:",Object.keys(j)),console.log("phoneNumber:",j.phoneNumber),j.phoneNumber))return j.phoneNumber;if(N&&typeof N=="object"){const X=[];return N.userName&&X.push(`姓名: ${N.userName}`),N.phone&&X.push(`电话: ${N.phone}`),N.email&&X.push(`邮箱: ${N.email}`),X.length>0?X.join(", "):"无联系方式"}return N&&typeof N=="string"?N:(console.log("未找到联系方式信息，返回默认值"),"未提供")}if(N==null||N==="")return b(W);if(W==="createTime")try{return new Date(N).toLocaleString("zh-CN")}catch{return"时间格式错误"}if(W==="type")return{bug:"问题反馈",suggestion:"意见建议",complaint:"投诉",praise:"表扬",point:"地点反馈",other:"其他"}[N]||N;if(W==="selectedPoint"){if(N&&typeof N=="object"){if(N.latitude&&N.longitude)return`${N.latitude.toFixed(6)}, ${N.longitude.toFixed(6)}`;if(N.address)return N.address}return N||"未选择位置"}return W==="content"?typeof N=="string"&&N.length>50?N.substring(0,50)+"...":N:typeof N=="object"?JSON.stringify(N):String(N)}function b(N){return{type:"未分类",content:"暂无内容",createTime:"时间未知",contact:"未提供",selectedPoint:"未选择位置"}[N]||"暂无数据"}function y(N){return N==="content"?"cell-content":N==="createTime"?"cell-time":N==="status"?"cell-status":""}function w(){u.value&&clearTimeout(u.value),u.value=setTimeout(()=>{E()},500)}function E(){t.value=1,U()}function A(){a.value="",t.value=1,U()}function I(N){t.value=N,U()}function R(N){s.value=N,l.value=!0}function L(){l.value=!1,s.value={}}const F=Ve(()=>v);async function U(){o.value=!0;try{const{list:N,total:W}=await gd({collection:"feedback",pageNo:t.value,pageSize:sm,keyword:a.value});console.log("从数据库获取的原始数据:",N),console.log("数据字段:",N.length>0?Object.keys(N[0]):[]),n.value=N,r.value=W,i.value=v}catch(N){console.error("加载反馈数据失败:",N),i.value=v}finally{o.value=!1}}return Cs(()=>{U()}),(N,W)=>(oe(),ae("div",null,[C("div",s5,[ke(C("input",{"onUpdate:modelValue":W[0]||(W[0]=j=>a.value=j),placeholder:"搜索反馈类型、内容、用户名、电话号码或位置...",class:"search-input",onInput:w},null,544),[[wr,a.value]]),C("button",{class:"btn primary",onClick:E},"搜索"),C("button",{class:"btn",onClick:A},"清空")]),C("div",a5,[C("table",null,[C("thead",null,[C("tr",null,[(oe(!0),ae(Me,null,Tt(i.value,j=>(oe(),ae("th",{key:j},ge(d(j)),1))),128)),W[3]||(W[3]=C("th",{style:{width:"120px"}},"操作",-1))])]),C("tbody",null,[(oe(!0),ae(Me,null,Tt(n.value,j=>(oe(),ae("tr",{key:j._id},[(oe(!0),ae(Me,null,Tt(i.value,X=>(oe(),ae("td",{key:X,class:st(y(X))},ge(g(j[X],X,j)),3))),128)),C("td",u5,[C("button",{class:"btn sm primary",onClick:X=>R(j)},"查看详情",8,c5)])]))),128))])]),!o.value&&n.value.length===0?(oe(),ae("div",l5,"暂无反馈数据")):ln("",!0),C("div",f5,[C("button",{class:"btn",disabled:t.value<=1,onClick:W[1]||(W[1]=j=>I(t.value-1))},"上一页",8,d5),C("span",null,"第 "+ge(t.value)+" / "+ge(c.value)+" 页（共 "+ge(r.value)+" 条）",1),C("button",{class:"btn",disabled:t.value>=c.value,onClick:W[2]||(W[2]=j=>I(t.value+1))},"下一页",8,h5)])]),ke(C("div",{class:"modal-mask",onClick:Tu(L,["self"])},null,512),[[pn,l.value]]),ke(C("div",p5,[C("div",{class:"modal-header"},[W[4]||(W[4]=C("h3",null,"反馈详情",-1)),C("button",{class:"icon-btn",onClick:L},"✕")]),C("div",v5,[(oe(!0),ae(Me,null,Tt(F.value,j=>(oe(),ae("div",{class:"detail-item",key:j},[C("label",m5,ge(d(j))+"：",1),C("div",g5,[j==="content"?(oe(),ae("span",y5,ge(s.value[j]),1)):(oe(),ae("span",_5,ge(g(s.value[j],j,s.value)),1))])]))),128))]),C("div",{class:"modal-footer"},[C("button",{class:"btn",onClick:L},"关闭")])],512),[[pn,l.value]])]))}}),w5={class:"content"},E5={class:"table-wrapper"},S5={class:"toolbar"},I5={class:"cell-small total-tip"},O5={key:0,class:"error-tip"},T5=["href"],A5={key:1},R5=["title"],C5={class:"actions-cell"},x5=["onClick"],P5=["onClick"],N5={key:1,class:"empty-tip"},$5={class:"pagination"},D5=["disabled"],L5=["disabled"],U5={class:"modal",role:"dialog","aria-modal":"true"},F5={class:"modal-header"},M5={class:"modal-body"},B5={class:"form-item"},j5={class:"form-item"},k5={class:"form-item"},q5={key:0,class:"form-item"},W5={key:1,class:"form-item"},H5={key:2,class:"error-text",style:{color:"#e11d48"}},G5={class:"modal-footer"},V5=["disabled"],ol=10,K5=vn({__name:"Announcements",setup(e,{expose:t}){const r=KU(),n=ve(1),o=ve(0),i=ve([]),a=ve(!1),u=ve(""),l=ve("all"),s=ve("all"),c=ve(""),f=Ve(()=>Math.max(1,Math.ceil(o.value/ol))),d=ve(!1),v=ve(!1),g=ve(!1),b=ve(""),y=bi({title:"",type:"article",status:"active",link:"",content:""});function w(k){return k==="article"?"文章链接":"文字公告"}function E(k){return k==="active"?"生效":"未生效"}function A(k){if(!k)return"";try{return new Date(k).toLocaleString("zh-CN")}catch{return k||""}}function I(k){return k?k.length>80?k.slice(0,80)+"…":k:""}function R(k){return(k||"").replace(/\\n/g,`
`)}function L(k){return(k||"").replace(/\r?\n/g,"\\n")}async function F(){a.value=!0,b.value="",c.value="";try{const k={};if(u.value){const Z=r.RegExp({regexp:u.value,options:"i"});k.$or=[{title:Z},{content:Z}]}l.value!=="all"&&(k.type=l.value),s.value!=="all"&&(k.status=s.value);const M=(n.value-1)*ol,D=await r.collection("announcements").where(k).count();o.value=(D==null?void 0:D.total)||0;const G=await r.collection("announcements").where(k).orderBy("updated_at","desc").skip(M).limit(ol).get();i.value=G.data||[]}catch(k){const M=(k==null?void 0:k.message)||"加载失败";b.value=M,c.value=M}finally{a.value=!1}}function U(k){k>=1&&k<=f.value&&(n.value=k,F())}function N(){y._id=void 0,y.title="",y.type="article",y.status="active",y.link="",y.content=""}function W(){v.value=!0,N(),d.value=!0}function j(k){v.value=!1,y._id=k._id,y.title=k.title||"",y.type=k.type||"article",y.status=k.status||"active",y.link=k.link||"",y.content=R(k.content||""),d.value=!0}function X(){d.value=!1}async function fe(){var k,M;g.value=!0,b.value="";try{if(!y.title)throw new Error("标题不能为空");if(y.type==="article"){if(!y.link)throw new Error("文章链接不能为空");if(!/^https?:\/\//i.test(y.link))throw new Error("文章链接需以 http(s) 开头")}else if(!y.content||!y.content.trim())throw new Error("文字内容不能为空");const D=new Date().toISOString(),Z=await Z_().getLoginState(),ne=((k=Z==null?void 0:Z.user)==null?void 0:k.uid)||((M=Z==null?void 0:Z.user)==null?void 0:M.username)||"admin";if(v.value){const Ee={title:y.title,type:y.type,status:y.status,link:y.type==="article"?y.link:"",content:y.type==="text"?L(y.content):"",created_at:D,updated_at:D,created_by:ne};await _d("announcements",Ee)}else{if(!y._id)throw new Error("未选择记录");const Ee={title:y.title,type:y.type,status:y.status,link:y.type==="article"?y.link:"",content:y.type==="text"?L(y.content):"",updated_at:D};await yd("announcements",y._id,Ee)}X(),F()}catch(D){b.value=(D==null?void 0:D.message)||"保存失败"}finally{g.value=!1}}async function q(k){if(confirm("确认删除该公告？该操作不可恢复。"))try{await bd("announcements",k._id),F()}catch(M){alert((M==null?void 0:M.message)||"删除失败")}}function de(k){k!=null&&k.pageNo&&(n.value=k.pageNo),k&&"keyword"in k&&(u.value=k.keyword||""),F()}return de({pageNo:1}),t({reload:de,openCreate:W}),Ln([l,s],()=>{n.value=1,F()}),(k,M)=>(oe(),ae(Me,null,[C("div",w5,[C("div",E5,[M[15]||(M[15]=C("h2",{style:{margin:"0 0 12px 0"}},"公告管理",-1)),C("div",S5,[M[12]||(M[12]=C("label",{class:"toolbar-label"},"类型",-1)),ke(C("select",{class:"toolbar-select","onUpdate:modelValue":M[0]||(M[0]=D=>l.value=D)},M[10]||(M[10]=[C("option",{value:"all"},"全部",-1),C("option",{value:"article"},"文章链接",-1),C("option",{value:"text"},"文字公告",-1)]),512),[[Pi,l.value]]),M[13]||(M[13]=C("label",{class:"toolbar-label"},"状态",-1)),ke(C("select",{class:"toolbar-select","onUpdate:modelValue":M[1]||(M[1]=D=>s.value=D)},M[11]||(M[11]=[C("option",{value:"all"},"全部",-1),C("option",{value:"active"},"生效",-1),C("option",{value:"inactive"},"未生效",-1)]),512),[[Pi,s.value]]),C("button",{class:"btn",onClick:M[2]||(M[2]=D=>de({pageNo:1}))},"刷新"),C("button",{class:"btn primary",onClick:W},"新建公告"),C("span",I5,"共 "+ge(o.value)+" 条",1)]),c.value?(oe(),ae("div",O5,ge(c.value),1)):ln("",!0),C("table",null,[M[14]||(M[14]=C("thead",null,[C("tr",null,[C("th",{style:{width:"20%"}},"标题"),C("th",{style:{width:"8%"}},"类型"),C("th",{style:{width:"8%"}},"状态"),C("th",{style:{width:"14%"}},"创建时间"),C("th",{style:{width:"14%"}},"更新时间"),C("th",{style:{width:"30%"}},"内容/链接"),C("th",{style:{width:"160px"}},"操作")])],-1)),C("tbody",null,[(oe(!0),ae(Me,null,Tt(i.value,D=>(oe(),ae("tr",{key:D._id,class:st({"inactive-row":D.status==="inactive"})},[C("td",null,ge(D.title),1),C("td",null,[C("span",{class:st(["tag","tag-type",D.type==="article"?"tag-blue":"tag-green"])},ge(w(D.type)),3)]),C("td",null,[C("span",{class:st(["tag",D.status==="active"?"tag-success":"tag-muted"])},ge(E(D.status)),3)]),C("td",null,ge(A(D.created_at)),1),C("td",null,ge(A(D.updated_at)),1),C("td",{class:st(D.type==="text"?"cell-small":"cell-url")},[D.type==="article"?(oe(),ae(Me,{key:0},[D.link?(oe(),ae("a",{key:0,href:D.link,target:"_blank",rel:"noopener",class:"link-pill"},"打开文章",8,T5)):(oe(),ae("span",A5,"未填写链接"))],64)):(oe(),ae("span",{key:1,title:R(D.content)},ge(I(R(D.content))),9,R5))],2),C("td",C5,[C("button",{class:"btn sm primary",onClick:G=>j(D)},"编辑",8,x5),C("button",{class:"btn sm danger",onClick:G=>q(D)},"删除",8,P5)])],2))),128))])]),!a.value&&i.value.length===0?(oe(),ae("div",N5,"暂无公告")):ln("",!0),C("div",$5,[C("button",{class:"btn",disabled:n.value<=1,onClick:M[3]||(M[3]=D=>U(n.value-1))},"上一页",8,D5),C("span",null,"第 "+ge(n.value)+" / "+ge(f.value)+" 页（共 "+ge(o.value)+" 条）",1),C("button",{class:"btn",disabled:n.value>=f.value,onClick:M[4]||(M[4]=D=>U(n.value+1))},"下一页",8,L5)])])]),ke(C("div",{class:"modal-mask",onClick:Tu(X,["self"])},null,512),[[pn,d.value]]),ke(C("div",U5,[C("div",F5,[C("h3",null,ge(v.value?"新建公告":"编辑公告"),1),C("button",{class:"icon-btn",onClick:X},"✕")]),C("div",M5,[C("div",B5,[M[16]||(M[16]=C("label",{for:"title"},"标题",-1)),ke(C("input",{id:"title",type:"text","onUpdate:modelValue":M[5]||(M[5]=D=>y.title=D),placeholder:"请输入标题"},null,512),[[wr,y.title,void 0,{trim:!0}]])]),C("div",j5,[M[18]||(M[18]=C("label",{for:"type"},"类型",-1)),ke(C("select",{id:"type","onUpdate:modelValue":M[6]||(M[6]=D=>y.type=D)},M[17]||(M[17]=[C("option",{value:"article"},"文章链接",-1),C("option",{value:"text"},"文字公告",-1)]),512),[[Pi,y.type]])]),C("div",k5,[M[20]||(M[20]=C("label",{for:"status"},"状态",-1)),ke(C("select",{id:"status","onUpdate:modelValue":M[7]||(M[7]=D=>y.status=D)},M[19]||(M[19]=[C("option",{value:"active"},"生效",-1),C("option",{value:"inactive"},"未生效",-1)]),512),[[Pi,y.status]])]),y.type==="article"?(oe(),ae("div",q5,[M[21]||(M[21]=C("label",{for:"link"},"文章链接",-1)),ke(C("input",{id:"link",type:"text","onUpdate:modelValue":M[8]||(M[8]=D=>y.link=D),placeholder:"https://..."},null,512),[[wr,y.link,void 0,{trim:!0}]])])):(oe(),ae("div",W5,[M[22]||(M[22]=C("label",{for:"content"},"文字内容",-1)),ke(C("textarea",{id:"content",rows:"6","onUpdate:modelValue":M[9]||(M[9]=D=>y.content=D),placeholder:"输入文字内容（回车换行）"},null,512),[[wr,y.content]]),M[23]||(M[23]=C("div",{class:"cell-small"},"保存时会将换行转换为 \\n 存储，方便小程序解析显示。",-1))])),b.value?(oe(),ae("div",H5,ge(b.value),1)):ln("",!0)]),C("div",G5,[C("button",{class:"btn",onClick:X},"取消"),C("button",{class:"btn primary",disabled:g.value,onClick:fe},ge(g.value?"保存中...":"保存"),9,V5)])],512),[[pn,d.value]])],64))}}),z5=wd(K5,[["__scopeId","data-v-70997924"]]),J5=EE({history:Q1(),routes:[{path:"/",redirect:{name:"module",params:{module:"contact"}}},{name:"login",path:"/login",component:dF},{name:"module",path:"/module/:module",component:xF,props:!0},{name:"sites",path:"/module/sites",component:t5,props:e=>({keyword:e.query.keyword})},{name:"reservations",path:"/module/reservations",component:o5,props:!0,children:[{name:"venue-reservations",path:"venue",component:()=>nm(()=>import("./VenueReservations-DAKaHPwp.js"),__vite__mapDeps([0,1]))},{name:"event-registrations",path:"event",component:()=>nm(()=>import("./EventRegistrations-I1_4dBfM.js"),__vite__mapDeps([2,1]))},{path:"",redirect:{name:"venue-reservations"}}]},{name:"feedback",path:"/feedback",component:b5},{name:"announcements",path:"/announcements",component:z5}]});g1(nF).use(J5).mount("#app");export{Me as F,ae as a,C as b,be as c,vn as d,ln as e,Tt as f,Pi as g,Tu as h,wr as i,oe as j,Kt as k,st as n,Cs as o,ve as r,ge as t,pn as v,ke as w};
