const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/VenueReservations-C2Ysditi.js","assets/database-DSeU7js0.js","assets/EventRegistrations-CcE8pR0o.js"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();/**
* @vue/shared v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Jl(e){const t=Object.create(null);for(const r of e.split(","))t[r]=1;return r=>r in t}const Fe={},Ui=[],jr=()=>{},X_=()=>!1,hu=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Yl=e=>e.startsWith("onUpdate:"),_t=Object.assign,Ql=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},Z_=Object.prototype.hasOwnProperty,$e=(e,t)=>Z_.call(e,t),pe=Array.isArray,Fi=e=>As(e)==="[object Map]",pu=e=>As(e)==="[object Set]",_d=e=>As(e)==="[object Date]",_e=e=>typeof e=="function",ze=e=>typeof e=="string",qr=e=>typeof e=="symbol",je=e=>e!==null&&typeof e=="object",im=e=>(je(e)||_e(e))&&_e(e.then)&&_e(e.catch),om=Object.prototype.toString,As=e=>om.call(e),eb=e=>As(e).slice(8,-1),sm=e=>As(e)==="[object Object]",Xl=e=>ze(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Wo=Jl(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),vu=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},tb=/-(\w)/g,or=vu(e=>e.replace(tb,(t,r)=>r?r.toUpperCase():"")),rb=/\B([A-Z])/g,yi=vu(e=>e.replace(rb,"-$1").toLowerCase()),mu=vu(e=>e.charAt(0).toUpperCase()+e.slice(1)),rc=vu(e=>e?`on${mu(e)}`:""),xn=(e,t)=>!Object.is(e,t),ia=(e,...t)=>{for(let r=0;r<e.length;r++)e[r](...t)},nl=(e,t,r,n=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:n,value:r})},Ea=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let bd;const gu=()=>bd||(bd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Zl(e){if(pe(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],o=ze(n)?sb(n):Zl(n);if(o)for(const i in o)t[i]=o[i]}return t}else if(ze(e)||je(e))return e}const nb=/;(?![^(]*\))/g,ib=/:([^]+)/,ob=/\/\*[^]*?\*\//g;function sb(e){const t={};return e.replace(ob,"").split(nb).forEach(r=>{if(r){const n=r.split(ib);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function cn(e){let t="";if(ze(e))t=e;else if(pe(e))for(let r=0;r<e.length;r++){const n=cn(e[r]);n&&(t+=n+" ")}else if(je(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const ab="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",ub=Jl(ab);function am(e){return!!e||e===""}function cb(e,t){if(e.length!==t.length)return!1;let r=!0;for(let n=0;r&&n<e.length;n++)r=yu(e[n],t[n]);return r}function yu(e,t){if(e===t)return!0;let r=_d(e),n=_d(t);if(r||n)return r&&n?e.getTime()===t.getTime():!1;if(r=qr(e),n=qr(t),r||n)return e===t;if(r=pe(e),n=pe(t),r||n)return r&&n?cb(e,t):!1;if(r=je(e),n=je(t),r||n){if(!r||!n)return!1;const o=Object.keys(e).length,i=Object.keys(t).length;if(o!==i)return!1;for(const a in e){const u=e.hasOwnProperty(a),l=t.hasOwnProperty(a);if(u&&!l||!u&&l||!yu(e[a],t[a]))return!1}}return String(e)===String(t)}function lb(e,t){return e.findIndex(r=>yu(r,t))}const um=e=>!!(e&&e.__v_isRef===!0),Se=e=>ze(e)?e:e==null?"":pe(e)||je(e)&&(e.toString===om||!_e(e.toString))?um(e)?Se(e.value):JSON.stringify(e,cm,2):String(e),cm=(e,t)=>um(t)?cm(e,t.value):Fi(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[n,o],i)=>(r[nc(n,i)+" =>"]=o,r),{})}:pu(t)?{[`Set(${t.size})`]:[...t.values()].map(r=>nc(r))}:qr(t)?nc(t):je(t)&&!pe(t)&&!sm(t)?String(t):t,nc=(e,t="")=>{var r;return qr(e)?`Symbol(${(r=e.description)!=null?r:t})`:e};/**
* @vue/reactivity v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ft;class fb{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ft,!t&&Ft&&(this.index=(Ft.scopes||(Ft.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,r;if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].pause();for(t=0,r=this.effects.length;t<r;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,r;if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].resume();for(t=0,r=this.effects.length;t<r;t++)this.effects[t].resume()}}run(t){if(this._active){const r=Ft;try{return Ft=this,t()}finally{Ft=r}}}on(){++this._on===1&&(this.prevScope=Ft,Ft=this)}off(){this._on>0&&--this._on===0&&(Ft=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(this.effects.length=0,r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.cleanups.length=0,this.scopes){for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0}}}function db(){return Ft}let Be;const ic=new WeakSet;class lm{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ft&&Ft.active&&Ft.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,ic.has(this)&&(ic.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||dm(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,wd(this),hm(this);const t=Be,r=yr;Be=this,yr=!0;try{return this.fn()}finally{pm(this),Be=t,yr=r,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)rf(t);this.deps=this.depsTail=void 0,wd(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?ic.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){il(this)&&this.run()}get dirty(){return il(this)}}let fm=0,Ho,Go;function dm(e,t=!1){if(e.flags|=8,t){e.next=Go,Go=e;return}e.next=Ho,Ho=e}function ef(){fm++}function tf(){if(--fm>0)return;if(Go){let t=Go;for(Go=void 0;t;){const r=t.next;t.next=void 0,t.flags&=-9,t=r}}let e;for(;Ho;){let t=Ho;for(Ho=void 0;t;){const r=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(n){e||(e=n)}t=r}}if(e)throw e}function hm(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function pm(e){let t,r=e.depsTail,n=r;for(;n;){const o=n.prevDep;n.version===-1?(n===r&&(r=o),rf(n),hb(n)):t=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=o}e.deps=t,e.depsTail=r}function il(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(vm(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function vm(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===ss)||(e.globalVersion=ss,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!il(e))))return;e.flags|=2;const t=e.dep,r=Be,n=yr;Be=e,yr=!0;try{hm(e);const o=e.fn(e._value);(t.version===0||xn(o,e._value))&&(e.flags|=128,e._value=o,t.version++)}catch(o){throw t.version++,o}finally{Be=r,yr=n,pm(e),e.flags&=-3}}function rf(e,t=!1){const{dep:r,prevSub:n,nextSub:o}=e;if(n&&(n.nextSub=o,e.prevSub=void 0),o&&(o.prevSub=n,e.nextSub=void 0),r.subs===e&&(r.subs=n,!n&&r.computed)){r.computed.flags&=-5;for(let i=r.computed.deps;i;i=i.nextDep)rf(i,!0)}!t&&!--r.sc&&r.map&&r.map.delete(r.key)}function hb(e){const{prevDep:t,nextDep:r}=e;t&&(t.nextDep=r,e.prevDep=void 0),r&&(r.prevDep=t,e.nextDep=void 0)}let yr=!0;const mm=[];function ln(){mm.push(yr),yr=!1}function fn(){const e=mm.pop();yr=e===void 0?!0:e}function wd(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const r=Be;Be=void 0;try{t()}finally{Be=r}}}let ss=0;class pb{constructor(t,r){this.sub=t,this.dep=r,this.version=r.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class nf{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!Be||!yr||Be===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==Be)r=this.activeLink=new pb(Be,this),Be.deps?(r.prevDep=Be.depsTail,Be.depsTail.nextDep=r,Be.depsTail=r):Be.deps=Be.depsTail=r,gm(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const n=r.nextDep;n.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=n),r.prevDep=Be.depsTail,r.nextDep=void 0,Be.depsTail.nextDep=r,Be.depsTail=r,Be.deps===r&&(Be.deps=n)}return r}trigger(t){this.version++,ss++,this.notify(t)}notify(t){ef();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()&&r.sub.dep.notify()}finally{tf()}}}function gm(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let n=t.deps;n;n=n.nextDep)gm(n)}const r=e.dep.subs;r!==e&&(e.prevSub=r,r&&(r.nextSub=e)),e.dep.subs=e}}const ol=new WeakMap,oi=Symbol(""),sl=Symbol(""),as=Symbol("");function vt(e,t,r){if(yr&&Be){let n=ol.get(e);n||ol.set(e,n=new Map);let o=n.get(r);o||(n.set(r,o=new nf),o.map=n,o.key=r),o.track()}}function tn(e,t,r,n,o,i){const a=ol.get(e);if(!a){ss++;return}const u=l=>{l&&l.trigger()};if(ef(),t==="clear")a.forEach(u);else{const l=pe(e),s=l&&Xl(r);if(l&&r==="length"){const c=Number(n);a.forEach((f,d)=>{(d==="length"||d===as||!qr(d)&&d>=c)&&u(f)})}else switch((r!==void 0||a.has(void 0))&&u(a.get(r)),s&&u(a.get(as)),t){case"add":l?s&&u(a.get("length")):(u(a.get(oi)),Fi(e)&&u(a.get(sl)));break;case"delete":l||(u(a.get(oi)),Fi(e)&&u(a.get(sl)));break;case"set":Fi(e)&&u(a.get(oi));break}}tf()}function wi(e){const t=Ne(e);return t===e?t:(vt(t,"iterate",as),ir(e)?t:t.map(at))}function _u(e){return vt(e=Ne(e),"iterate",as),e}const vb={__proto__:null,[Symbol.iterator](){return oc(this,Symbol.iterator,at)},concat(...e){return wi(this).concat(...e.map(t=>pe(t)?wi(t):t))},entries(){return oc(this,"entries",e=>(e[1]=at(e[1]),e))},every(e,t){return Vr(this,"every",e,t,void 0,arguments)},filter(e,t){return Vr(this,"filter",e,t,r=>r.map(at),arguments)},find(e,t){return Vr(this,"find",e,t,at,arguments)},findIndex(e,t){return Vr(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Vr(this,"findLast",e,t,at,arguments)},findLastIndex(e,t){return Vr(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Vr(this,"forEach",e,t,void 0,arguments)},includes(...e){return sc(this,"includes",e)},indexOf(...e){return sc(this,"indexOf",e)},join(e){return wi(this).join(e)},lastIndexOf(...e){return sc(this,"lastIndexOf",e)},map(e,t){return Vr(this,"map",e,t,void 0,arguments)},pop(){return yo(this,"pop")},push(...e){return yo(this,"push",e)},reduce(e,...t){return Ed(this,"reduce",e,t)},reduceRight(e,...t){return Ed(this,"reduceRight",e,t)},shift(){return yo(this,"shift")},some(e,t){return Vr(this,"some",e,t,void 0,arguments)},splice(...e){return yo(this,"splice",e)},toReversed(){return wi(this).toReversed()},toSorted(e){return wi(this).toSorted(e)},toSpliced(...e){return wi(this).toSpliced(...e)},unshift(...e){return yo(this,"unshift",e)},values(){return oc(this,"values",at)}};function oc(e,t,r){const n=_u(e),o=n[t]();return n!==e&&!ir(e)&&(o._next=o.next,o.next=()=>{const i=o._next();return i.value&&(i.value=r(i.value)),i}),o}const mb=Array.prototype;function Vr(e,t,r,n,o,i){const a=_u(e),u=a!==e&&!ir(e),l=a[t];if(l!==mb[t]){const f=l.apply(e,i);return u?at(f):f}let s=r;a!==e&&(u?s=function(f,d){return r.call(this,at(f),d,e)}:r.length>2&&(s=function(f,d){return r.call(this,f,d,e)}));const c=l.call(a,s,n);return u&&o?o(c):c}function Ed(e,t,r,n){const o=_u(e);let i=r;return o!==e&&(ir(e)?r.length>3&&(i=function(a,u,l){return r.call(this,a,u,l,e)}):i=function(a,u,l){return r.call(this,a,at(u),l,e)}),o[t](i,...n)}function sc(e,t,r){const n=Ne(e);vt(n,"iterate",as);const o=n[t](...r);return(o===-1||o===!1)&&af(r[0])?(r[0]=Ne(r[0]),n[t](...r)):o}function yo(e,t,r=[]){ln(),ef();const n=Ne(e)[t].apply(e,r);return tf(),fn(),n}const gb=Jl("__proto__,__v_isRef,__isVue"),ym=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(qr));function yb(e){qr(e)||(e=String(e));const t=Ne(this);return vt(t,"has",e),t.hasOwnProperty(e)}class _m{constructor(t=!1,r=!1){this._isReadonly=t,this._isShallow=r}get(t,r,n){if(r==="__v_skip")return t.__v_skip;const o=this._isReadonly,i=this._isShallow;if(r==="__v_isReactive")return!o;if(r==="__v_isReadonly")return o;if(r==="__v_isShallow")return i;if(r==="__v_raw")return n===(o?i?Rb:Sm:i?Em:wm).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(n)?t:void 0;const a=pe(t);if(!o){let l;if(a&&(l=vb[r]))return l;if(r==="hasOwnProperty")return yb}const u=Reflect.get(t,r,yt(t)?t:n);return(qr(r)?ym.has(r):gb(r))||(o||vt(t,"get",r),i)?u:yt(u)?a&&Xl(r)?u:u.value:je(u)?o?Om(u):oo(u):u}}class bm extends _m{constructor(t=!1){super(!1,t)}set(t,r,n,o){let i=t[r];if(!this._isShallow){const l=Nn(i);if(!ir(n)&&!Nn(n)&&(i=Ne(i),n=Ne(n)),!pe(t)&&yt(i)&&!yt(n))return l?!1:(i.value=n,!0)}const a=pe(t)&&Xl(r)?Number(r)<t.length:$e(t,r),u=Reflect.set(t,r,n,yt(t)?t:o);return t===Ne(o)&&(a?xn(n,i)&&tn(t,"set",r,n):tn(t,"add",r,n)),u}deleteProperty(t,r){const n=$e(t,r);t[r];const o=Reflect.deleteProperty(t,r);return o&&n&&tn(t,"delete",r,void 0),o}has(t,r){const n=Reflect.has(t,r);return(!qr(r)||!ym.has(r))&&vt(t,"has",r),n}ownKeys(t){return vt(t,"iterate",pe(t)?"length":oi),Reflect.ownKeys(t)}}class _b extends _m{constructor(t=!1){super(!0,t)}set(t,r){return!0}deleteProperty(t,r){return!0}}const bb=new bm,wb=new _b,Eb=new bm(!0);const al=e=>e,Us=e=>Reflect.getPrototypeOf(e);function Sb(e,t,r){return function(...n){const o=this.__v_raw,i=Ne(o),a=Fi(i),u=e==="entries"||e===Symbol.iterator&&a,l=e==="keys"&&a,s=o[e](...n),c=r?al:t?Sa:at;return!t&&vt(i,"iterate",l?sl:oi),{next(){const{value:f,done:d}=s.next();return d?{value:f,done:d}:{value:u?[c(f[0]),c(f[1])]:c(f),done:d}},[Symbol.iterator](){return this}}}}function Fs(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Ib(e,t){const r={get(o){const i=this.__v_raw,a=Ne(i),u=Ne(o);e||(xn(o,u)&&vt(a,"get",o),vt(a,"get",u));const{has:l}=Us(a),s=t?al:e?Sa:at;if(l.call(a,o))return s(i.get(o));if(l.call(a,u))return s(i.get(u));i!==a&&i.get(o)},get size(){const o=this.__v_raw;return!e&&vt(Ne(o),"iterate",oi),Reflect.get(o,"size",o)},has(o){const i=this.__v_raw,a=Ne(i),u=Ne(o);return e||(xn(o,u)&&vt(a,"has",o),vt(a,"has",u)),o===u?i.has(o):i.has(o)||i.has(u)},forEach(o,i){const a=this,u=a.__v_raw,l=Ne(u),s=t?al:e?Sa:at;return!e&&vt(l,"iterate",oi),u.forEach((c,f)=>o.call(i,s(c),s(f),a))}};return _t(r,e?{add:Fs("add"),set:Fs("set"),delete:Fs("delete"),clear:Fs("clear")}:{add(o){!t&&!ir(o)&&!Nn(o)&&(o=Ne(o));const i=Ne(this);return Us(i).has.call(i,o)||(i.add(o),tn(i,"add",o,o)),this},set(o,i){!t&&!ir(i)&&!Nn(i)&&(i=Ne(i));const a=Ne(this),{has:u,get:l}=Us(a);let s=u.call(a,o);s||(o=Ne(o),s=u.call(a,o));const c=l.call(a,o);return a.set(o,i),s?xn(i,c)&&tn(a,"set",o,i):tn(a,"add",o,i),this},delete(o){const i=Ne(this),{has:a,get:u}=Us(i);let l=a.call(i,o);l||(o=Ne(o),l=a.call(i,o)),u&&u.call(i,o);const s=i.delete(o);return l&&tn(i,"delete",o,void 0),s},clear(){const o=Ne(this),i=o.size!==0,a=o.clear();return i&&tn(o,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(o=>{r[o]=Sb(o,e,t)}),r}function of(e,t){const r=Ib(e,t);return(n,o,i)=>o==="__v_isReactive"?!e:o==="__v_isReadonly"?e:o==="__v_raw"?n:Reflect.get($e(r,o)&&o in n?r:n,o,i)}const Ob={get:of(!1,!1)},Tb={get:of(!1,!0)},Ab={get:of(!0,!1)};const wm=new WeakMap,Em=new WeakMap,Sm=new WeakMap,Rb=new WeakMap;function Cb(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function xb(e){return e.__v_skip||!Object.isExtensible(e)?0:Cb(eb(e))}function oo(e){return Nn(e)?e:sf(e,!1,bb,Ob,wm)}function Im(e){return sf(e,!1,Eb,Tb,Em)}function Om(e){return sf(e,!0,wb,Ab,Sm)}function sf(e,t,r,n,o){if(!je(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=xb(e);if(i===0)return e;const a=o.get(e);if(a)return a;const u=new Proxy(e,i===2?n:r);return o.set(e,u),u}function Mi(e){return Nn(e)?Mi(e.__v_raw):!!(e&&e.__v_isReactive)}function Nn(e){return!!(e&&e.__v_isReadonly)}function ir(e){return!!(e&&e.__v_isShallow)}function af(e){return e?!!e.__v_raw:!1}function Ne(e){const t=e&&e.__v_raw;return t?Ne(t):e}function Pb(e){return!$e(e,"__v_skip")&&Object.isExtensible(e)&&nl(e,"__v_skip",!0),e}const at=e=>je(e)?oo(e):e,Sa=e=>je(e)?Om(e):e;function yt(e){return e?e.__v_isRef===!0:!1}function Ee(e){return Tm(e,!1)}function Nb(e){return Tm(e,!0)}function Tm(e,t){return yt(e)?e:new $b(e,t)}class $b{constructor(t,r){this.dep=new nf,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?t:Ne(t),this._value=r?t:at(t),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(t){const r=this._rawValue,n=this.__v_isShallow||ir(t)||Nn(t);t=n?t:Ne(t),xn(t,r)&&(this._rawValue=t,this._value=n?t:at(t),this.dep.trigger())}}function kr(e){return yt(e)?e.value:e}const Db={get:(e,t,r)=>t==="__v_raw"?e:kr(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const o=e[t];return yt(o)&&!yt(r)?(o.value=r,!0):Reflect.set(e,t,r,n)}};function Am(e){return Mi(e)?e:new Proxy(e,Db)}class Lb{constructor(t,r,n){this.fn=t,this.setter=r,this._value=void 0,this.dep=new nf(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ss-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!r,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&Be!==this)return dm(this,!0),!0}get value(){const t=this.dep.track();return vm(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Ub(e,t,r=!1){let n,o;return _e(e)?n=e:(n=e.get,o=e.set),new Lb(n,o,r)}const Ms={},Ia=new WeakMap;let Vn;function Fb(e,t=!1,r=Vn){if(r){let n=Ia.get(r);n||Ia.set(r,n=[]),n.push(e)}}function Mb(e,t,r=Fe){const{immediate:n,deep:o,once:i,scheduler:a,augmentJob:u,call:l}=r,s=I=>o?I:ir(I)||o===!1||o===0?rn(I,1):rn(I);let c,f,d,v,g=!1,b=!1;if(yt(e)?(f=()=>e.value,g=ir(e)):Mi(e)?(f=()=>s(e),g=!0):pe(e)?(b=!0,g=e.some(I=>Mi(I)||ir(I)),f=()=>e.map(I=>{if(yt(I))return I.value;if(Mi(I))return s(I);if(_e(I))return l?l(I,2):I()})):_e(e)?t?f=l?()=>l(e,2):e:f=()=>{if(d){ln();try{d()}finally{fn()}}const I=Vn;Vn=c;try{return l?l(e,3,[v]):e(v)}finally{Vn=I}}:f=jr,t&&o){const I=f,R=o===!0?1/0:o;f=()=>rn(I(),R)}const w=db(),_=()=>{c.stop(),w&&w.active&&Ql(w.effects,c)};if(i&&t){const I=t;t=(...R)=>{I(...R),_()}}let E=b?new Array(e.length).fill(Ms):Ms;const A=I=>{if(!(!(c.flags&1)||!c.dirty&&!I))if(t){const R=c.run();if(o||g||(b?R.some(($,L)=>xn($,E[L])):xn(R,E))){d&&d();const $=Vn;Vn=c;try{const L=[R,E===Ms?void 0:b&&E[0]===Ms?[]:E,v];E=R,l?l(t,3,L):t(...L)}finally{Vn=$}}}else c.run()};return u&&u(A),c=new lm(f),c.scheduler=a?()=>a(A,!1):A,v=I=>Fb(I,!1,c),d=c.onStop=()=>{const I=Ia.get(c);if(I){if(l)l(I,4);else for(const R of I)R();Ia.delete(c)}},t?n?A(!0):E=c.run():a?a(A.bind(null,!0),!0):c.run(),_.pause=c.pause.bind(c),_.resume=c.resume.bind(c),_.stop=_,_}function rn(e,t=1/0,r){if(t<=0||!je(e)||e.__v_skip||(r=r||new Set,r.has(e)))return e;if(r.add(e),t--,yt(e))rn(e.value,t,r);else if(pe(e))for(let n=0;n<e.length;n++)rn(e[n],t,r);else if(pu(e)||Fi(e))e.forEach(n=>{rn(n,t,r)});else if(sm(e)){for(const n in e)rn(e[n],t,r);for(const n of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,n)&&rn(e[n],t,r)}return e}/**
* @vue/runtime-core v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Rs(e,t,r,n){try{return n?e(...n):e()}catch(o){bu(o,t,r)}}function Wr(e,t,r,n){if(_e(e)){const o=Rs(e,t,r,n);return o&&im(o)&&o.catch(i=>{bu(i,t,r)}),o}if(pe(e)){const o=[];for(let i=0;i<e.length;i++)o.push(Wr(e[i],t,r,n));return o}}function bu(e,t,r,n=!0){const o=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:a}=t&&t.appContext.config||Fe;if(t){let u=t.parent;const l=t.proxy,s=`https://vuejs.org/error-reference/#runtime-${r}`;for(;u;){const c=u.ec;if(c){for(let f=0;f<c.length;f++)if(c[f](e,l,s)===!1)return}u=u.parent}if(i){ln(),Rs(i,null,10,[e,l,s]),fn();return}}Bb(e,r,o,n,a)}function Bb(e,t,r,n=!0,o=!1){if(o)throw e;console.error(e)}const It=[];let Pr=-1;const Bi=[];let mn=null,Ai=0;const Rm=Promise.resolve();let Oa=null;function uf(e){const t=Oa||Rm;return e?t.then(this?e.bind(this):e):t}function jb(e){let t=Pr+1,r=It.length;for(;t<r;){const n=t+r>>>1,o=It[n],i=us(o);i<e||i===e&&o.flags&2?t=n+1:r=n}return t}function cf(e){if(!(e.flags&1)){const t=us(e),r=It[It.length-1];!r||!(e.flags&2)&&t>=us(r)?It.push(e):It.splice(jb(t),0,e),e.flags|=1,Cm()}}function Cm(){Oa||(Oa=Rm.then(Pm))}function kb(e){pe(e)?Bi.push(...e):mn&&e.id===-1?mn.splice(Ai+1,0,e):e.flags&1||(Bi.push(e),e.flags|=1),Cm()}function Sd(e,t,r=Pr+1){for(;r<It.length;r++){const n=It[r];if(n&&n.flags&2){if(e&&n.id!==e.uid)continue;It.splice(r,1),r--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function xm(e){if(Bi.length){const t=[...new Set(Bi)].sort((r,n)=>us(r)-us(n));if(Bi.length=0,mn){mn.push(...t);return}for(mn=t,Ai=0;Ai<mn.length;Ai++){const r=mn[Ai];r.flags&4&&(r.flags&=-2),r.flags&8||r(),r.flags&=-2}mn=null,Ai=0}}const us=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Pm(e){try{for(Pr=0;Pr<It.length;Pr++){const t=It[Pr];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Rs(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Pr<It.length;Pr++){const t=It[Pr];t&&(t.flags&=-2)}Pr=-1,It.length=0,xm(),Oa=null,(It.length||Bi.length)&&Pm()}}let zt=null,Nm=null;function Ta(e){const t=zt;return zt=e,Nm=e&&e.type.__scopeId||null,t}function $m(e,t=zt,r){if(!t||e._n)return e;const n=(...o)=>{n._d&&$d(-1);const i=Ta(t);let a;try{a=e(...o)}finally{Ta(i),n._d&&$d(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function ut(e,t){if(zt===null)return e;const r=Iu(zt),n=e.dirs||(e.dirs=[]);for(let o=0;o<t.length;o++){let[i,a,u,l=Fe]=t[o];i&&(_e(i)&&(i={mounted:i,updated:i}),i.deep&&rn(a),n.push({dir:i,instance:r,value:a,oldValue:void 0,arg:u,modifiers:l}))}return e}function Bn(e,t,r,n){const o=e.dirs,i=t&&t.dirs;for(let a=0;a<o.length;a++){const u=o[a];i&&(u.oldValue=i[a].value);let l=u.dir[n];l&&(ln(),Wr(l,r,8,[e.el,u,e,t]),fn())}}const qb=Symbol("_vte"),Wb=e=>e.__isTeleport;function lf(e,t){e.shapeFlag&6&&e.component?(e.transition=t,lf(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}/*! #__NO_SIDE_EFFECTS__ */function Un(e,t){return _e(e)?_t({name:e.name},t,{setup:e}):e}function Dm(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function Vo(e,t,r,n,o=!1){if(pe(e)){e.forEach((g,b)=>Vo(g,t&&(pe(t)?t[b]:t),r,n,o));return}if(Ko(n)&&!o){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Vo(e,t,r,n.component.subTree);return}const i=n.shapeFlag&4?Iu(n.component):n.el,a=o?null:i,{i:u,r:l}=e,s=t&&t.r,c=u.refs===Fe?u.refs={}:u.refs,f=u.setupState,d=Ne(f),v=f===Fe?()=>!1:g=>$e(d,g);if(s!=null&&s!==l&&(ze(s)?(c[s]=null,v(s)&&(f[s]=null)):yt(s)&&(s.value=null)),_e(l))Rs(l,u,12,[a,c]);else{const g=ze(l),b=yt(l);if(g||b){const w=()=>{if(e.f){const _=g?v(l)?f[l]:c[l]:l.value;o?pe(_)&&Ql(_,i):pe(_)?_.includes(i)||_.push(i):g?(c[l]=[i],v(l)&&(f[l]=c[l])):(l.value=[i],e.k&&(c[e.k]=l.value))}else g?(c[l]=a,v(l)&&(f[l]=a)):b&&(l.value=a,e.k&&(c[e.k]=a))};a?(w.id=-1,Ht(w,r)):w()}}}gu().requestIdleCallback;gu().cancelIdleCallback;const Ko=e=>!!e.type.__asyncLoader,Lm=e=>e.type.__isKeepAlive;function Hb(e,t){Um(e,"a",t)}function Gb(e,t){Um(e,"da",t)}function Um(e,t,r=mt){const n=e.__wdc||(e.__wdc=()=>{let o=r;for(;o;){if(o.isDeactivated)return;o=o.parent}return e()});if(wu(t,n,r),r){let o=r.parent;for(;o&&o.parent;)Lm(o.parent.vnode)&&Vb(n,t,r,o),o=o.parent}}function Vb(e,t,r,n){const o=wu(t,e,n,!0);Fm(()=>{Ql(n[t],o)},r)}function wu(e,t,r=mt,n=!1){if(r){const o=r[e]||(r[e]=[]),i=t.__weh||(t.__weh=(...a)=>{ln();const u=xs(r),l=Wr(t,r,e,a);return u(),fn(),l});return n?o.unshift(i):o.push(i),i}}const dn=e=>(t,r=mt)=>{(!ls||e==="sp")&&wu(e,(...n)=>t(...n),r)},Kb=dn("bm"),Cs=dn("m"),zb=dn("bu"),Jb=dn("u"),Yb=dn("bum"),Fm=dn("um"),Qb=dn("sp"),Xb=dn("rtg"),Zb=dn("rtc");function ew(e,t=mt){wu("ec",e,t)}const Mm="components";function Bm(e,t){return km(Mm,e,!0,t)||e}const jm=Symbol.for("v-ndc");function tw(e){return ze(e)?km(Mm,e,!1)||e:e||jm}function km(e,t,r=!0,n=!1){const o=zt||mt;if(o){const i=o.type;{const u=Ww(i,!1);if(u&&(u===t||u===or(t)||u===mu(or(t))))return i}const a=Id(o[e]||i[e],t)||Id(o.appContext[e],t);return!a&&n?i:a}}function Id(e,t){return e&&(e[t]||e[or(t)]||e[mu(or(t))])}function Ot(e,t,r,n){let o;const i=r,a=pe(e);if(a||ze(e)){const u=a&&Mi(e);let l=!1,s=!1;u&&(l=!ir(e),s=Nn(e),e=_u(e)),o=new Array(e.length);for(let c=0,f=e.length;c<f;c++)o[c]=t(l?s?Sa(at(e[c])):at(e[c]):e[c],c,void 0,i)}else if(typeof e=="number"){o=new Array(e);for(let u=0;u<e;u++)o[u]=t(u+1,u,void 0,i)}else if(je(e))if(e[Symbol.iterator])o=Array.from(e,(u,l)=>t(u,l,void 0,i));else{const u=Object.keys(e);o=new Array(u.length);for(let l=0,s=u.length;l<s;l++){const c=u[l];o[l]=t(e[c],c,l,i)}}else o=[];return o}const ul=e=>e?ug(e)?Iu(e):ul(e.parent):null,zo=_t(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>ul(e.parent),$root:e=>ul(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Wm(e),$forceUpdate:e=>e.f||(e.f=()=>{cf(e.update)}),$nextTick:e=>e.n||(e.n=uf.bind(e.proxy)),$watch:e=>Ew.bind(e)}),ac=(e,t)=>e!==Fe&&!e.__isScriptSetup&&$e(e,t),rw={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:r,setupState:n,data:o,props:i,accessCache:a,type:u,appContext:l}=e;let s;if(t[0]!=="$"){const v=a[t];if(v!==void 0)switch(v){case 1:return n[t];case 2:return o[t];case 4:return r[t];case 3:return i[t]}else{if(ac(n,t))return a[t]=1,n[t];if(o!==Fe&&$e(o,t))return a[t]=2,o[t];if((s=e.propsOptions[0])&&$e(s,t))return a[t]=3,i[t];if(r!==Fe&&$e(r,t))return a[t]=4,r[t];cl&&(a[t]=0)}}const c=zo[t];let f,d;if(c)return t==="$attrs"&&vt(e.attrs,"get",""),c(e);if((f=u.__cssModules)&&(f=f[t]))return f;if(r!==Fe&&$e(r,t))return a[t]=4,r[t];if(d=l.config.globalProperties,$e(d,t))return d[t]},set({_:e},t,r){const{data:n,setupState:o,ctx:i}=e;return ac(o,t)?(o[t]=r,!0):n!==Fe&&$e(n,t)?(n[t]=r,!0):$e(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:o,propsOptions:i}},a){let u;return!!r[a]||e!==Fe&&$e(e,a)||ac(t,a)||(u=i[0])&&$e(u,a)||$e(n,a)||$e(zo,a)||$e(o.config.globalProperties,a)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:$e(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};function Od(e){return pe(e)?e.reduce((t,r)=>(t[r]=null,t),{}):e}let cl=!0;function nw(e){const t=Wm(e),r=e.proxy,n=e.ctx;cl=!1,t.beforeCreate&&Td(t.beforeCreate,e,"bc");const{data:o,computed:i,methods:a,watch:u,provide:l,inject:s,created:c,beforeMount:f,mounted:d,beforeUpdate:v,updated:g,activated:b,deactivated:w,beforeDestroy:_,beforeUnmount:E,destroyed:A,unmounted:I,render:R,renderTracked:$,renderTriggered:L,errorCaptured:D,serverPrefetch:P,expose:k,inheritAttrs:F,components:Q,directives:ce,filters:B}=t;if(s&&iw(s,n,null),a)for(const X in a){const M=a[X];_e(M)&&(n[X]=M.bind(r))}if(o){const X=o.call(r,r);je(X)&&(e.data=oo(X))}if(cl=!0,i)for(const X in i){const M=i[X],W=_e(M)?M.bind(r,r):_e(M.get)?M.get.bind(r,r):jr,te=!_e(M)&&_e(M.set)?M.set.bind(r):jr,ne=Ke({get:W,set:te});Object.defineProperty(n,X,{enumerable:!0,configurable:!0,get:()=>ne.value,set:be=>ne.value=be})}if(u)for(const X in u)qm(u[X],n,r,X);if(l){const X=_e(l)?l.call(r):l;Reflect.ownKeys(X).forEach(M=>{oa(M,X[M])})}c&&Td(c,e,"c");function re(X,M){pe(M)?M.forEach(W=>X(W.bind(r))):M&&X(M.bind(r))}if(re(Kb,f),re(Cs,d),re(zb,v),re(Jb,g),re(Hb,b),re(Gb,w),re(ew,D),re(Zb,$),re(Xb,L),re(Yb,E),re(Fm,I),re(Qb,P),pe(k))if(k.length){const X=e.exposed||(e.exposed={});k.forEach(M=>{Object.defineProperty(X,M,{get:()=>r[M],set:W=>r[M]=W,enumerable:!0})})}else e.exposed||(e.exposed={});R&&e.render===jr&&(e.render=R),F!=null&&(e.inheritAttrs=F),Q&&(e.components=Q),ce&&(e.directives=ce),P&&Dm(e)}function iw(e,t,r=jr){pe(e)&&(e=ll(e));for(const n in e){const o=e[n];let i;je(o)?"default"in o?i=_r(o.from||n,o.default,!0):i=_r(o.from||n):i=_r(o),yt(i)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:a=>i.value=a}):t[n]=i}}function Td(e,t,r){Wr(pe(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function qm(e,t,r,n){let o=n.includes(".")?rg(r,n):()=>r[n];if(ze(e)){const i=t[e];_e(i)&&si(o,i)}else if(_e(e))si(o,e.bind(r));else if(je(e))if(pe(e))e.forEach(i=>qm(i,t,r,n));else{const i=_e(e.handler)?e.handler.bind(r):t[e.handler];_e(i)&&si(o,i,e)}}function Wm(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:o,optionsCache:i,config:{optionMergeStrategies:a}}=e.appContext,u=i.get(t);let l;return u?l=u:!o.length&&!r&&!n?l=t:(l={},o.length&&o.forEach(s=>Aa(l,s,a,!0)),Aa(l,t,a)),je(t)&&i.set(t,l),l}function Aa(e,t,r,n=!1){const{mixins:o,extends:i}=t;i&&Aa(e,i,r,!0),o&&o.forEach(a=>Aa(e,a,r,!0));for(const a in t)if(!(n&&a==="expose")){const u=ow[a]||r&&r[a];e[a]=u?u(e[a],t[a]):t[a]}return e}const ow={data:Ad,props:Rd,emits:Rd,methods:Fo,computed:Fo,beforeCreate:wt,created:wt,beforeMount:wt,mounted:wt,beforeUpdate:wt,updated:wt,beforeDestroy:wt,beforeUnmount:wt,destroyed:wt,unmounted:wt,activated:wt,deactivated:wt,errorCaptured:wt,serverPrefetch:wt,components:Fo,directives:Fo,watch:aw,provide:Ad,inject:sw};function Ad(e,t){return t?e?function(){return _t(_e(e)?e.call(this,this):e,_e(t)?t.call(this,this):t)}:t:e}function sw(e,t){return Fo(ll(e),ll(t))}function ll(e){if(pe(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function wt(e,t){return e?[...new Set([].concat(e,t))]:t}function Fo(e,t){return e?_t(Object.create(null),e,t):t}function Rd(e,t){return e?pe(e)&&pe(t)?[...new Set([...e,...t])]:_t(Object.create(null),Od(e),Od(t??{})):t}function aw(e,t){if(!e)return t;if(!t)return e;const r=_t(Object.create(null),e);for(const n in t)r[n]=wt(e[n],t[n]);return r}function Hm(){return{app:null,config:{isNativeTag:X_,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uw=0;function cw(e,t){return function(n,o=null){_e(n)||(n=_t({},n)),o!=null&&!je(o)&&(o=null);const i=Hm(),a=new WeakSet,u=[];let l=!1;const s=i.app={_uid:uw++,_component:n,_props:o,_container:null,_context:i,_instance:null,version:Gw,get config(){return i.config},set config(c){},use(c,...f){return a.has(c)||(c&&_e(c.install)?(a.add(c),c.install(s,...f)):_e(c)&&(a.add(c),c(s,...f))),s},mixin(c){return i.mixins.includes(c)||i.mixins.push(c),s},component(c,f){return f?(i.components[c]=f,s):i.components[c]},directive(c,f){return f?(i.directives[c]=f,s):i.directives[c]},mount(c,f,d){if(!l){const v=s._ceVNode||At(n,o);return v.appContext=i,d===!0?d="svg":d===!1&&(d=void 0),e(v,c,d),l=!0,s._container=c,c.__vue_app__=s,Iu(v.component)}},onUnmount(c){u.push(c)},unmount(){l&&(Wr(u,s._instance,16),e(null,s._container),delete s._container.__vue_app__)},provide(c,f){return i.provides[c]=f,s},runWithContext(c){const f=ji;ji=s;try{return c()}finally{ji=f}}};return s}}let ji=null;function oa(e,t){if(mt){let r=mt.provides;const n=mt.parent&&mt.parent.provides;n===r&&(r=mt.provides=Object.create(n)),r[e]=t}}function _r(e,t,r=!1){const n=Mw();if(n||ji){let o=ji?ji._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(o&&e in o)return o[e];if(arguments.length>1)return r&&_e(t)?t.call(n&&n.proxy):t}}const Gm={},Vm=()=>Object.create(Gm),Km=e=>Object.getPrototypeOf(e)===Gm;function lw(e,t,r,n=!1){const o={},i=Vm();e.propsDefaults=Object.create(null),zm(e,t,o,i);for(const a in e.propsOptions[0])a in o||(o[a]=void 0);r?e.props=n?o:Im(o):e.type.props?e.props=o:e.props=i,e.attrs=i}function fw(e,t,r,n){const{props:o,attrs:i,vnode:{patchFlag:a}}=e,u=Ne(o),[l]=e.propsOptions;let s=!1;if((n||a>0)&&!(a&16)){if(a&8){const c=e.vnode.dynamicProps;for(let f=0;f<c.length;f++){let d=c[f];if(Eu(e.emitsOptions,d))continue;const v=t[d];if(l)if($e(i,d))v!==i[d]&&(i[d]=v,s=!0);else{const g=or(d);o[g]=fl(l,u,g,v,e,!1)}else v!==i[d]&&(i[d]=v,s=!0)}}}else{zm(e,t,o,i)&&(s=!0);let c;for(const f in u)(!t||!$e(t,f)&&((c=yi(f))===f||!$e(t,c)))&&(l?r&&(r[f]!==void 0||r[c]!==void 0)&&(o[f]=fl(l,u,f,void 0,e,!0)):delete o[f]);if(i!==u)for(const f in i)(!t||!$e(t,f))&&(delete i[f],s=!0)}s&&tn(e.attrs,"set","")}function zm(e,t,r,n){const[o,i]=e.propsOptions;let a=!1,u;if(t)for(let l in t){if(Wo(l))continue;const s=t[l];let c;o&&$e(o,c=or(l))?!i||!i.includes(c)?r[c]=s:(u||(u={}))[c]=s:Eu(e.emitsOptions,l)||(!(l in n)||s!==n[l])&&(n[l]=s,a=!0)}if(i){const l=Ne(r),s=u||Fe;for(let c=0;c<i.length;c++){const f=i[c];r[f]=fl(o,l,f,s[f],e,!$e(s,f))}}return a}function fl(e,t,r,n,o,i){const a=e[r];if(a!=null){const u=$e(a,"default");if(u&&n===void 0){const l=a.default;if(a.type!==Function&&!a.skipFactory&&_e(l)){const{propsDefaults:s}=o;if(r in s)n=s[r];else{const c=xs(o);n=s[r]=l.call(null,t),c()}}else n=l;o.ce&&o.ce._setProp(r,n)}a[0]&&(i&&!u?n=!1:a[1]&&(n===""||n===yi(r))&&(n=!0))}return n}const dw=new WeakMap;function Jm(e,t,r=!1){const n=r?dw:t.propsCache,o=n.get(e);if(o)return o;const i=e.props,a={},u=[];let l=!1;if(!_e(e)){const c=f=>{l=!0;const[d,v]=Jm(f,t,!0);_t(a,d),v&&u.push(...v)};!r&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}if(!i&&!l)return je(e)&&n.set(e,Ui),Ui;if(pe(i))for(let c=0;c<i.length;c++){const f=or(i[c]);Cd(f)&&(a[f]=Fe)}else if(i)for(const c in i){const f=or(c);if(Cd(f)){const d=i[c],v=a[f]=pe(d)||_e(d)?{type:d}:_t({},d),g=v.type;let b=!1,w=!0;if(pe(g))for(let _=0;_<g.length;++_){const E=g[_],A=_e(E)&&E.name;if(A==="Boolean"){b=!0;break}else A==="String"&&(w=!1)}else b=_e(g)&&g.name==="Boolean";v[0]=b,v[1]=w,(b||$e(v,"default"))&&u.push(f)}}const s=[a,u];return je(e)&&n.set(e,s),s}function Cd(e){return e[0]!=="$"&&!Wo(e)}const ff=e=>e==="_"||e==="__"||e==="_ctx"||e==="$stable",df=e=>pe(e)?e.map(Dr):[Dr(e)],hw=(e,t,r)=>{if(t._n)return t;const n=$m((...o)=>df(t(...o)),r);return n._c=!1,n},Ym=(e,t,r)=>{const n=e._ctx;for(const o in e){if(ff(o))continue;const i=e[o];if(_e(i))t[o]=hw(o,i,n);else if(i!=null){const a=df(i);t[o]=()=>a}}},Qm=(e,t)=>{const r=df(t);e.slots.default=()=>r},Xm=(e,t,r)=>{for(const n in t)(r||!ff(n))&&(e[n]=t[n])},pw=(e,t,r)=>{const n=e.slots=Vm();if(e.vnode.shapeFlag&32){const o=t.__;o&&nl(n,"__",o,!0);const i=t._;i?(Xm(n,t,r),r&&nl(n,"_",i,!0)):Ym(t,n)}else t&&Qm(e,t)},vw=(e,t,r)=>{const{vnode:n,slots:o}=e;let i=!0,a=Fe;if(n.shapeFlag&32){const u=t._;u?r&&u===1?i=!1:Xm(o,t,r):(i=!t.$stable,Ym(t,o)),a=t}else t&&(Qm(e,t),a={default:1});if(i)for(const u in o)!ff(u)&&a[u]==null&&delete o[u]},Ht=Cw;function mw(e){return gw(e)}function gw(e,t){const r=gu();r.__VUE__=!0;const{insert:n,remove:o,patchProp:i,createElement:a,createText:u,createComment:l,setText:s,setElementText:c,parentNode:f,nextSibling:d,setScopeId:v=jr,insertStaticContent:g}=e,b=(S,T,N,m=null,h=null,p=null,y=void 0,O=null,x=!!T.dynamicChildren)=>{if(S===T)return;S&&!_o(S,T)&&(m=U(S),be(S,h,p,!0),S=null),T.patchFlag===-2&&(x=!1,T.dynamicChildren=null);const{type:C,ref:V,shapeFlag:q}=T;switch(C){case Su:w(S,T,N,m);break;case $n:_(S,T,N,m);break;case cc:S==null&&E(T,N,m,y);break;case We:Q(S,T,N,m,h,p,y,O,x);break;default:q&1?R(S,T,N,m,h,p,y,O,x):q&6?ce(S,T,N,m,h,p,y,O,x):(q&64||q&128)&&C.process(S,T,N,m,h,p,y,O,x,Y)}V!=null&&h?Vo(V,S&&S.ref,p,T||S,!T):V==null&&S&&S.ref!=null&&Vo(S.ref,null,p,S,!0)},w=(S,T,N,m)=>{if(S==null)n(T.el=u(T.children),N,m);else{const h=T.el=S.el;T.children!==S.children&&s(h,T.children)}},_=(S,T,N,m)=>{S==null?n(T.el=l(T.children||""),N,m):T.el=S.el},E=(S,T,N,m)=>{[S.el,S.anchor]=g(S.children,T,N,m,S.el,S.anchor)},A=({el:S,anchor:T},N,m)=>{let h;for(;S&&S!==T;)h=d(S),n(S,N,m),S=h;n(T,N,m)},I=({el:S,anchor:T})=>{let N;for(;S&&S!==T;)N=d(S),o(S),S=N;o(T)},R=(S,T,N,m,h,p,y,O,x)=>{T.type==="svg"?y="svg":T.type==="math"&&(y="mathml"),S==null?$(T,N,m,h,p,y,O,x):P(S,T,h,p,y,O,x)},$=(S,T,N,m,h,p,y,O)=>{let x,C;const{props:V,shapeFlag:q,transition:J,dirs:ie}=S;if(x=S.el=a(S.type,p,V&&V.is,V),q&8?c(x,S.children):q&16&&D(S.children,x,null,m,h,uc(S,p),y,O),ie&&Bn(S,null,m,"created"),L(x,S,S.scopeId,y,m),V){for(const Ce in V)Ce!=="value"&&!Wo(Ce)&&i(x,Ce,null,V[Ce],p,m);"value"in V&&i(x,"value",null,V.value,p),(C=V.onVnodeBeforeMount)&&Tr(C,m,S)}ie&&Bn(S,null,m,"beforeMount");const se=yw(h,J);se&&J.beforeEnter(x),n(x,T,N),((C=V&&V.onVnodeMounted)||se||ie)&&Ht(()=>{C&&Tr(C,m,S),se&&J.enter(x),ie&&Bn(S,null,m,"mounted")},h)},L=(S,T,N,m,h)=>{if(N&&v(S,N),m)for(let p=0;p<m.length;p++)v(S,m[p]);if(h){let p=h.subTree;if(T===p||ig(p.type)&&(p.ssContent===T||p.ssFallback===T)){const y=h.vnode;L(S,y,y.scopeId,y.slotScopeIds,h.parent)}}},D=(S,T,N,m,h,p,y,O,x=0)=>{for(let C=x;C<S.length;C++){const V=S[C]=O?gn(S[C]):Dr(S[C]);b(null,V,T,N,m,h,p,y,O)}},P=(S,T,N,m,h,p,y)=>{const O=T.el=S.el;let{patchFlag:x,dynamicChildren:C,dirs:V}=T;x|=S.patchFlag&16;const q=S.props||Fe,J=T.props||Fe;let ie;if(N&&jn(N,!1),(ie=J.onVnodeBeforeUpdate)&&Tr(ie,N,T,S),V&&Bn(T,S,N,"beforeUpdate"),N&&jn(N,!0),(q.innerHTML&&J.innerHTML==null||q.textContent&&J.textContent==null)&&c(O,""),C?k(S.dynamicChildren,C,O,N,m,uc(T,h),p):y||M(S,T,O,null,N,m,uc(T,h),p,!1),x>0){if(x&16)F(O,q,J,N,h);else if(x&2&&q.class!==J.class&&i(O,"class",null,J.class,h),x&4&&i(O,"style",q.style,J.style,h),x&8){const se=T.dynamicProps;for(let Ce=0;Ce<se.length;Ce++){const Ae=se[Ce],ot=q[Ae],Ct=J[Ae];(Ct!==ot||Ae==="value")&&i(O,Ae,ot,Ct,h,N)}}x&1&&S.children!==T.children&&c(O,T.children)}else!y&&C==null&&F(O,q,J,N,h);((ie=J.onVnodeUpdated)||V)&&Ht(()=>{ie&&Tr(ie,N,T,S),V&&Bn(T,S,N,"updated")},m)},k=(S,T,N,m,h,p,y)=>{for(let O=0;O<T.length;O++){const x=S[O],C=T[O],V=x.el&&(x.type===We||!_o(x,C)||x.shapeFlag&198)?f(x.el):N;b(x,C,V,null,m,h,p,y,!0)}},F=(S,T,N,m,h)=>{if(T!==N){if(T!==Fe)for(const p in T)!Wo(p)&&!(p in N)&&i(S,p,T[p],null,h,m);for(const p in N){if(Wo(p))continue;const y=N[p],O=T[p];y!==O&&p!=="value"&&i(S,p,O,y,h,m)}"value"in N&&i(S,"value",T.value,N.value,h)}},Q=(S,T,N,m,h,p,y,O,x)=>{const C=T.el=S?S.el:u(""),V=T.anchor=S?S.anchor:u("");let{patchFlag:q,dynamicChildren:J,slotScopeIds:ie}=T;ie&&(O=O?O.concat(ie):ie),S==null?(n(C,N,m),n(V,N,m),D(T.children||[],N,V,h,p,y,O,x)):q>0&&q&64&&J&&S.dynamicChildren?(k(S.dynamicChildren,J,N,h,p,y,O),(T.key!=null||h&&T===h.subTree)&&Zm(S,T,!0)):M(S,T,N,V,h,p,y,O,x)},ce=(S,T,N,m,h,p,y,O,x)=>{T.slotScopeIds=O,S==null?T.shapeFlag&512?h.ctx.activate(T,N,m,y,x):B(T,N,m,h,p,y,x):fe(S,T,x)},B=(S,T,N,m,h,p,y)=>{const O=S.component=Fw(S,m,h);if(Lm(S)&&(O.ctx.renderer=Y),Bw(O,!1,y),O.asyncDep){if(h&&h.registerDep(O,re,y),!S.el){const x=O.subTree=At($n);_(null,x,T,N),S.placeholder=x.el}}else re(O,S,T,N,h,p,y)},fe=(S,T,N)=>{const m=T.component=S.component;if(Aw(S,T,N))if(m.asyncDep&&!m.asyncResolved){X(m,T,N);return}else m.next=T,m.update();else T.el=S.el,m.vnode=T},re=(S,T,N,m,h,p,y)=>{const O=()=>{if(S.isMounted){let{next:q,bu:J,u:ie,parent:se,vnode:Ce}=S;{const Ir=eg(S);if(Ir){q&&(q.el=Ce.el,X(S,q,y)),Ir.asyncDep.then(()=>{S.isUnmounted||O()});return}}let Ae=q,ot;jn(S,!1),q?(q.el=Ce.el,X(S,q,y)):q=Ce,J&&ia(J),(ot=q.props&&q.props.onVnodeBeforeUpdate)&&Tr(ot,se,q,Ce),jn(S,!0);const Ct=Pd(S),Sr=S.subTree;S.subTree=Ct,b(Sr,Ct,f(Sr.el),U(Sr),S,h,p),q.el=Ct.el,Ae===null&&Rw(S,Ct.el),ie&&Ht(ie,h),(ot=q.props&&q.props.onVnodeUpdated)&&Ht(()=>Tr(ot,se,q,Ce),h)}else{let q;const{el:J,props:ie}=T,{bm:se,m:Ce,parent:Ae,root:ot,type:Ct}=S,Sr=Ko(T);jn(S,!1),se&&ia(se),!Sr&&(q=ie&&ie.onVnodeBeforeMount)&&Tr(q,Ae,T),jn(S,!0);{ot.ce&&ot.ce._def.shadowRoot!==!1&&ot.ce._injectChildStyle(Ct);const Ir=S.subTree=Pd(S);b(null,Ir,N,m,S,h,p),T.el=Ir.el}if(Ce&&Ht(Ce,h),!Sr&&(q=ie&&ie.onVnodeMounted)){const Ir=T;Ht(()=>Tr(q,Ae,Ir),h)}(T.shapeFlag&256||Ae&&Ko(Ae.vnode)&&Ae.vnode.shapeFlag&256)&&S.a&&Ht(S.a,h),S.isMounted=!0,T=N=m=null}};S.scope.on();const x=S.effect=new lm(O);S.scope.off();const C=S.update=x.run.bind(x),V=S.job=x.runIfDirty.bind(x);V.i=S,V.id=S.uid,x.scheduler=()=>cf(V),jn(S,!0),C()},X=(S,T,N)=>{T.component=S;const m=S.vnode.props;S.vnode=T,S.next=null,fw(S,T.props,m,N),vw(S,T.children,N),ln(),Sd(S),fn()},M=(S,T,N,m,h,p,y,O,x=!1)=>{const C=S&&S.children,V=S?S.shapeFlag:0,q=T.children,{patchFlag:J,shapeFlag:ie}=T;if(J>0){if(J&128){te(C,q,N,m,h,p,y,O,x);return}else if(J&256){W(C,q,N,m,h,p,y,O,x);return}}ie&8?(V&16&&de(C,h,p),q!==C&&c(N,q)):V&16?ie&16?te(C,q,N,m,h,p,y,O,x):de(C,h,p,!0):(V&8&&c(N,""),ie&16&&D(q,N,m,h,p,y,O,x))},W=(S,T,N,m,h,p,y,O,x)=>{S=S||Ui,T=T||Ui;const C=S.length,V=T.length,q=Math.min(C,V);let J;for(J=0;J<q;J++){const ie=T[J]=x?gn(T[J]):Dr(T[J]);b(S[J],ie,N,null,h,p,y,O,x)}C>V?de(S,h,p,!0,!1,q):D(T,N,m,h,p,y,O,x,q)},te=(S,T,N,m,h,p,y,O,x)=>{let C=0;const V=T.length;let q=S.length-1,J=V-1;for(;C<=q&&C<=J;){const ie=S[C],se=T[C]=x?gn(T[C]):Dr(T[C]);if(_o(ie,se))b(ie,se,N,null,h,p,y,O,x);else break;C++}for(;C<=q&&C<=J;){const ie=S[q],se=T[J]=x?gn(T[J]):Dr(T[J]);if(_o(ie,se))b(ie,se,N,null,h,p,y,O,x);else break;q--,J--}if(C>q){if(C<=J){const ie=J+1,se=ie<V?T[ie].el:m;for(;C<=J;)b(null,T[C]=x?gn(T[C]):Dr(T[C]),N,se,h,p,y,O,x),C++}}else if(C>J)for(;C<=q;)be(S[C],h,p,!0),C++;else{const ie=C,se=C,Ce=new Map;for(C=se;C<=J;C++){const qt=T[C]=x?gn(T[C]):Dr(T[C]);qt.key!=null&&Ce.set(qt.key,C)}let Ae,ot=0;const Ct=J-se+1;let Sr=!1,Ir=0;const go=new Array(Ct);for(C=0;C<Ct;C++)go[C]=0;for(C=ie;C<=q;C++){const qt=S[C];if(ot>=Ct){be(qt,h,p,!0);continue}let Or;if(qt.key!=null)Or=Ce.get(qt.key);else for(Ae=se;Ae<=J;Ae++)if(go[Ae-se]===0&&_o(qt,T[Ae])){Or=Ae;break}Or===void 0?be(qt,h,p,!0):(go[Or-se]=C+1,Or>=Ir?Ir=Or:Sr=!0,b(qt,T[Or],N,null,h,p,y,O,x),ot++)}const md=Sr?_w(go):Ui;for(Ae=md.length-1,C=Ct-1;C>=0;C--){const qt=se+C,Or=T[qt],gd=T[qt+1],yd=qt+1<V?gd.el||gd.placeholder:m;go[C]===0?b(null,Or,N,yd,h,p,y,O,x):Sr&&(Ae<0||C!==md[Ae]?ne(Or,N,yd,2):Ae--)}}},ne=(S,T,N,m,h=null)=>{const{el:p,type:y,transition:O,children:x,shapeFlag:C}=S;if(C&6){ne(S.component.subTree,T,N,m);return}if(C&128){S.suspense.move(T,N,m);return}if(C&64){y.move(S,T,N,Y);return}if(y===We){n(p,T,N);for(let q=0;q<x.length;q++)ne(x[q],T,N,m);n(S.anchor,T,N);return}if(y===cc){A(S,T,N);return}if(m!==2&&C&1&&O)if(m===0)O.beforeEnter(p),n(p,T,N),Ht(()=>O.enter(p),h);else{const{leave:q,delayLeave:J,afterLeave:ie}=O,se=()=>{S.ctx.isUnmounted?o(p):n(p,T,N)},Ce=()=>{q(p,()=>{se(),ie&&ie()})};J?J(p,se,Ce):Ce()}else n(p,T,N)},be=(S,T,N,m=!1,h=!1)=>{const{type:p,props:y,ref:O,children:x,dynamicChildren:C,shapeFlag:V,patchFlag:q,dirs:J,cacheIndex:ie}=S;if(q===-2&&(h=!1),O!=null&&(ln(),Vo(O,null,N,S,!0),fn()),ie!=null&&(T.renderCache[ie]=void 0),V&256){T.ctx.deactivate(S);return}const se=V&1&&J,Ce=!Ko(S);let Ae;if(Ce&&(Ae=y&&y.onVnodeBeforeUnmount)&&Tr(Ae,T,S),V&6)Qe(S.component,N,m);else{if(V&128){S.suspense.unmount(N,m);return}se&&Bn(S,null,T,"beforeUnmount"),V&64?S.type.remove(S,T,N,Y,m):C&&!C.hasOnce&&(p!==We||q>0&&q&64)?de(C,T,N,!1,!0):(p===We&&q&384||!h&&V&16)&&de(x,T,N),m&&et(S)}(Ce&&(Ae=y&&y.onVnodeUnmounted)||se)&&Ht(()=>{Ae&&Tr(Ae,T,S),se&&Bn(S,null,T,"unmounted")},N)},et=S=>{const{type:T,el:N,anchor:m,transition:h}=S;if(T===We){Rt(N,m);return}if(T===cc){I(S);return}const p=()=>{o(N),h&&!h.persisted&&h.afterLeave&&h.afterLeave()};if(S.shapeFlag&1&&h&&!h.persisted){const{leave:y,delayLeave:O}=h,x=()=>y(N,p);O?O(S.el,p,x):x()}else p()},Rt=(S,T)=>{let N;for(;S!==T;)N=d(S),o(S),S=N;o(T)},Qe=(S,T,N)=>{const{bum:m,scope:h,job:p,subTree:y,um:O,m:x,a:C,parent:V,slots:{__:q}}=S;xd(x),xd(C),m&&ia(m),V&&pe(q)&&q.forEach(J=>{V.renderCache[J]=void 0}),h.stop(),p&&(p.flags|=8,be(y,S,T,N)),O&&Ht(O,T),Ht(()=>{S.isUnmounted=!0},T),T&&T.pendingBranch&&!T.isUnmounted&&S.asyncDep&&!S.asyncResolved&&S.suspenseId===T.pendingId&&(T.deps--,T.deps===0&&T.resolve())},de=(S,T,N,m=!1,h=!1,p=0)=>{for(let y=p;y<S.length;y++)be(S[y],T,N,m,h)},U=S=>{if(S.shapeFlag&6)return U(S.component.subTree);if(S.shapeFlag&128)return S.suspense.next();const T=d(S.anchor||S.el),N=T&&T[qb];return N?d(N):T};let K=!1;const G=(S,T,N)=>{S==null?T._vnode&&be(T._vnode,null,null,!0):b(T._vnode||null,S,T,null,null,null,N),T._vnode=S,K||(K=!0,Sd(),xm(),K=!1)},Y={p:b,um:be,m:ne,r:et,mt:B,mc:D,pc:M,pbc:k,n:U,o:e};return{render:G,hydrate:void 0,createApp:cw(G)}}function uc({type:e,props:t},r){return r==="svg"&&e==="foreignObject"||r==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:r}function jn({effect:e,job:t},r){r?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function yw(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function Zm(e,t,r=!1){const n=e.children,o=t.children;if(pe(n)&&pe(o))for(let i=0;i<n.length;i++){const a=n[i];let u=o[i];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=o[i]=gn(o[i]),u.el=a.el),!r&&u.patchFlag!==-2&&Zm(a,u)),u.type===Su&&(u.el=a.el),u.type===$n&&!u.el&&(u.el=a.el)}}function _w(e){const t=e.slice(),r=[0];let n,o,i,a,u;const l=e.length;for(n=0;n<l;n++){const s=e[n];if(s!==0){if(o=r[r.length-1],e[o]<s){t[n]=o,r.push(n);continue}for(i=0,a=r.length-1;i<a;)u=i+a>>1,e[r[u]]<s?i=u+1:a=u;s<e[r[i]]&&(i>0&&(t[n]=r[i-1]),r[i]=n)}}for(i=r.length,a=r[i-1];i-- >0;)r[i]=a,a=t[a];return r}function eg(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:eg(t)}function xd(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const bw=Symbol.for("v-scx"),ww=()=>_r(bw);function si(e,t,r){return tg(e,t,r)}function tg(e,t,r=Fe){const{immediate:n,deep:o,flush:i,once:a}=r,u=_t({},r),l=t&&n||!t&&i!=="post";let s;if(ls){if(i==="sync"){const v=ww();s=v.__watcherHandles||(v.__watcherHandles=[])}else if(!l){const v=()=>{};return v.stop=jr,v.resume=jr,v.pause=jr,v}}const c=mt;u.call=(v,g,b)=>Wr(v,c,g,b);let f=!1;i==="post"?u.scheduler=v=>{Ht(v,c&&c.suspense)}:i!=="sync"&&(f=!0,u.scheduler=(v,g)=>{g?v():cf(v)}),u.augmentJob=v=>{t&&(v.flags|=4),f&&(v.flags|=2,c&&(v.id=c.uid,v.i=c))};const d=Mb(e,t,u);return ls&&(s?s.push(d):l&&d()),d}function Ew(e,t,r){const n=this.proxy,o=ze(e)?e.includes(".")?rg(n,e):()=>n[e]:e.bind(n,n);let i;_e(t)?i=t:(i=t.handler,r=t);const a=xs(this),u=tg(o,i.bind(n),r);return a(),u}function rg(e,t){const r=t.split(".");return()=>{let n=e;for(let o=0;o<r.length&&n;o++)n=n[r[o]];return n}}const Sw=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${or(t)}Modifiers`]||e[`${yi(t)}Modifiers`];function Iw(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||Fe;let o=r;const i=t.startsWith("update:"),a=i&&Sw(n,t.slice(7));a&&(a.trim&&(o=r.map(c=>ze(c)?c.trim():c)),a.number&&(o=r.map(Ea)));let u,l=n[u=rc(t)]||n[u=rc(or(t))];!l&&i&&(l=n[u=rc(yi(t))]),l&&Wr(l,e,6,o);const s=n[u+"Once"];if(s){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,Wr(s,e,6,o)}}function ng(e,t,r=!1){const n=t.emitsCache,o=n.get(e);if(o!==void 0)return o;const i=e.emits;let a={},u=!1;if(!_e(e)){const l=s=>{const c=ng(s,t,!0);c&&(u=!0,_t(a,c))};!r&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!i&&!u?(je(e)&&n.set(e,null),null):(pe(i)?i.forEach(l=>a[l]=null):_t(a,i),je(e)&&n.set(e,a),a)}function Eu(e,t){return!e||!hu(t)?!1:(t=t.slice(2).replace(/Once$/,""),$e(e,t[0].toLowerCase()+t.slice(1))||$e(e,yi(t))||$e(e,t))}function Pd(e){const{type:t,vnode:r,proxy:n,withProxy:o,propsOptions:[i],slots:a,attrs:u,emit:l,render:s,renderCache:c,props:f,data:d,setupState:v,ctx:g,inheritAttrs:b}=e,w=Ta(e);let _,E;try{if(r.shapeFlag&4){const I=o||n,R=I;_=Dr(s.call(R,I,c,f,v,d,g)),E=u}else{const I=t;_=Dr(I.length>1?I(f,{attrs:u,slots:a,emit:l}):I(f,null)),E=t.props?u:Ow(u)}}catch(I){Jo.length=0,bu(I,e,1),_=At($n)}let A=_;if(E&&b!==!1){const I=Object.keys(E),{shapeFlag:R}=A;I.length&&R&7&&(i&&I.some(Yl)&&(E=Tw(E,i)),A=Ji(A,E,!1,!0))}return r.dirs&&(A=Ji(A,null,!1,!0),A.dirs=A.dirs?A.dirs.concat(r.dirs):r.dirs),r.transition&&lf(A,r.transition),_=A,Ta(w),_}const Ow=e=>{let t;for(const r in e)(r==="class"||r==="style"||hu(r))&&((t||(t={}))[r]=e[r]);return t},Tw=(e,t)=>{const r={};for(const n in e)(!Yl(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r};function Aw(e,t,r){const{props:n,children:o,component:i}=e,{props:a,children:u,patchFlag:l}=t,s=i.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&l>=0){if(l&1024)return!0;if(l&16)return n?Nd(n,a,s):!!a;if(l&8){const c=t.dynamicProps;for(let f=0;f<c.length;f++){const d=c[f];if(a[d]!==n[d]&&!Eu(s,d))return!0}}}else return(o||u)&&(!u||!u.$stable)?!0:n===a?!1:n?a?Nd(n,a,s):!0:!!a;return!1}function Nd(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let o=0;o<n.length;o++){const i=n[o];if(t[i]!==e[i]&&!Eu(r,i))return!0}return!1}function Rw({vnode:e,parent:t},r){for(;t;){const n=t.subTree;if(n.suspense&&n.suspense.activeBranch===e&&(n.el=e.el),n===e)(e=t.vnode).el=r,t=t.parent;else break}}const ig=e=>e.__isSuspense;function Cw(e,t){t&&t.pendingBranch?pe(e)?t.effects.push(...e):t.effects.push(e):kb(e)}const We=Symbol.for("v-fgt"),Su=Symbol.for("v-txt"),$n=Symbol.for("v-cmt"),cc=Symbol.for("v-stc"),Jo=[];let Jt=null;function le(e=!1){Jo.push(Jt=e?null:[])}function xw(){Jo.pop(),Jt=Jo[Jo.length-1]||null}let cs=1;function $d(e,t=!1){cs+=e,e<0&&Jt&&t&&(Jt.hasOnce=!0)}function og(e){return e.dynamicChildren=cs>0?Jt||Ui:null,xw(),cs>0&&Jt&&Jt.push(e),e}function ve(e,t,r,n,o,i){return og(j(e,t,r,n,o,i,!0))}function sg(e,t,r,n,o){return og(At(e,t,r,n,o,!0))}function Ra(e){return e?e.__v_isVNode===!0:!1}function _o(e,t){return e.type===t.type&&e.key===t.key}const ag=({key:e})=>e??null,sa=({ref:e,ref_key:t,ref_for:r})=>(typeof e=="number"&&(e=""+e),e!=null?ze(e)||yt(e)||_e(e)?{i:zt,r:e,k:t,f:!!r}:e:null);function j(e,t=null,r=null,n=0,o=null,i=e===We?0:1,a=!1,u=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&ag(t),ref:t&&sa(t),scopeId:Nm,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:zt};return u?(hf(l,r),i&128&&e.normalize(l)):r&&(l.shapeFlag|=ze(r)?8:16),cs>0&&!a&&Jt&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&Jt.push(l),l}const At=Pw;function Pw(e,t=null,r=null,n=0,o=null,i=!1){if((!e||e===jm)&&(e=$n),Ra(e)){const u=Ji(e,t,!0);return r&&hf(u,r),cs>0&&!i&&Jt&&(u.shapeFlag&6?Jt[Jt.indexOf(e)]=u:Jt.push(u)),u.patchFlag=-2,u}if(Hw(e)&&(e=e.__vccOpts),t){t=Nw(t);let{class:u,style:l}=t;u&&!ze(u)&&(t.class=cn(u)),je(l)&&(af(l)&&!pe(l)&&(l=_t({},l)),t.style=Zl(l))}const a=ze(e)?1:ig(e)?128:Wb(e)?64:je(e)?4:_e(e)?2:0;return j(e,t,r,n,o,a,i,!0)}function Nw(e){return e?af(e)||Km(e)?_t({},e):e:null}function Ji(e,t,r=!1,n=!1){const{props:o,ref:i,patchFlag:a,children:u,transition:l}=e,s=t?Dw(o||{},t):o,c={__v_isVNode:!0,__v_skip:!0,type:e.type,props:s,key:s&&ag(s),ref:t&&t.ref?r&&i?pe(i)?i.concat(sa(t)):[i,sa(t)]:sa(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==We?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ji(e.ssContent),ssFallback:e.ssFallback&&Ji(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&n&&lf(c,l.clone(c)),c}function $w(e=" ",t=0){return At(Su,null,e,t)}function Yi(e="",t=!1){return t?(le(),sg($n,null,e)):At($n,null,e)}function Dr(e){return e==null||typeof e=="boolean"?At($n):pe(e)?At(We,null,e.slice()):Ra(e)?gn(e):At(Su,null,String(e))}function gn(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Ji(e)}function hf(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(pe(t))r=16;else if(typeof t=="object")if(n&65){const o=t.default;o&&(o._c&&(o._d=!1),hf(e,o()),o._c&&(o._d=!0));return}else{r=32;const o=t._;!o&&!Km(t)?t._ctx=zt:o===3&&zt&&(zt.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else _e(t)?(t={default:t,_ctx:zt},r=32):(t=String(t),n&64?(r=16,t=[$w(t)]):r=8);e.children=t,e.shapeFlag|=r}function Dw(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const o in n)if(o==="class")t.class!==n.class&&(t.class=cn([t.class,n.class]));else if(o==="style")t.style=Zl([t.style,n.style]);else if(hu(o)){const i=t[o],a=n[o];a&&i!==a&&!(pe(i)&&i.includes(a))&&(t[o]=i?[].concat(i,a):a)}else o!==""&&(t[o]=n[o])}return t}function Tr(e,t,r,n=null){Wr(e,t,7,[r,n])}const Lw=Hm();let Uw=0;function Fw(e,t,r){const n=e.type,o=(t?t.appContext:e.appContext)||Lw,i={uid:Uw++,vnode:e,type:n,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new fb(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Jm(n,o),emitsOptions:ng(n,o),emit:null,emitted:null,propsDefaults:Fe,inheritAttrs:n.inheritAttrs,ctx:Fe,data:Fe,props:Fe,attrs:Fe,slots:Fe,refs:Fe,setupState:Fe,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=Iw.bind(null,i),e.ce&&e.ce(i),i}let mt=null;const Mw=()=>mt||zt;let Ca,dl;{const e=gu(),t=(r,n)=>{let o;return(o=e[r])||(o=e[r]=[]),o.push(n),i=>{o.length>1?o.forEach(a=>a(i)):o[0](i)}};Ca=t("__VUE_INSTANCE_SETTERS__",r=>mt=r),dl=t("__VUE_SSR_SETTERS__",r=>ls=r)}const xs=e=>{const t=mt;return Ca(e),e.scope.on(),()=>{e.scope.off(),Ca(t)}},Dd=()=>{mt&&mt.scope.off(),Ca(null)};function ug(e){return e.vnode.shapeFlag&4}let ls=!1;function Bw(e,t=!1,r=!1){t&&dl(t);const{props:n,children:o}=e.vnode,i=ug(e);lw(e,n,i,t),pw(e,o,r||t);const a=i?jw(e,t):void 0;return t&&dl(!1),a}function jw(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,rw);const{setup:n}=r;if(n){ln();const o=e.setupContext=n.length>1?qw(e):null,i=xs(e),a=Rs(n,e,0,[e.props,o]),u=im(a);if(fn(),i(),(u||e.sp)&&!Ko(e)&&Dm(e),u){if(a.then(Dd,Dd),t)return a.then(l=>{Ld(e,l)}).catch(l=>{bu(l,e,0)});e.asyncDep=a}else Ld(e,a)}else cg(e)}function Ld(e,t,r){_e(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:je(t)&&(e.setupState=Am(t)),cg(e)}function cg(e,t,r){const n=e.type;e.render||(e.render=n.render||jr);{const o=xs(e);ln();try{nw(e)}finally{fn(),o()}}}const kw={get(e,t){return vt(e,"get",""),e[t]}};function qw(e){const t=r=>{e.exposed=r||{}};return{attrs:new Proxy(e.attrs,kw),slots:e.slots,emit:e.emit,expose:t}}function Iu(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Am(Pb(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in zo)return zo[r](e)},has(t,r){return r in t||r in zo}})):e.proxy}function Ww(e,t=!0){return _e(e)?e.displayName||e.name:e.name||t&&e.__name}function Hw(e){return _e(e)&&"__vccOpts"in e}const Ke=(e,t)=>Ub(e,t,ls);function lg(e,t,r){const n=arguments.length;return n===2?je(t)&&!pe(t)?Ra(t)?At(e,null,[t]):At(e,t):At(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&Ra(r)&&(r=[r]),At(e,t,r))}const Gw="3.5.18";/**
* @vue/runtime-dom v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let hl;const Ud=typeof window<"u"&&window.trustedTypes;if(Ud)try{hl=Ud.createPolicy("vue",{createHTML:e=>e})}catch{}const fg=hl?e=>hl.createHTML(e):e=>e,Vw="http://www.w3.org/2000/svg",Kw="http://www.w3.org/1998/Math/MathML",Zr=typeof document<"u"?document:null,Fd=Zr&&Zr.createElement("template"),zw={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const o=t==="svg"?Zr.createElementNS(Vw,e):t==="mathml"?Zr.createElementNS(Kw,e):r?Zr.createElement(e,{is:r}):Zr.createElement(e);return e==="select"&&n&&n.multiple!=null&&o.setAttribute("multiple",n.multiple),o},createText:e=>Zr.createTextNode(e),createComment:e=>Zr.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Zr.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,r,n,o,i){const a=r?r.previousSibling:t.lastChild;if(o&&(o===i||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),r),!(o===i||!(o=o.nextSibling)););else{Fd.innerHTML=fg(n==="svg"?`<svg>${e}</svg>`:n==="mathml"?`<math>${e}</math>`:e);const u=Fd.content;if(n==="svg"||n==="mathml"){const l=u.firstChild;for(;l.firstChild;)u.appendChild(l.firstChild);u.removeChild(l)}t.insertBefore(u,r)}return[a?a.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}},Jw=Symbol("_vtc");function Yw(e,t,r){const n=e[Jw];n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}const xa=Symbol("_vod"),dg=Symbol("_vsh"),fi={beforeMount(e,{value:t},{transition:r}){e[xa]=e.style.display==="none"?"":e.style.display,r&&t?r.beforeEnter(e):bo(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:n}){!t!=!r&&(n?t?(n.beforeEnter(e),bo(e,!0),n.enter(e)):n.leave(e,()=>{bo(e,!1)}):bo(e,t))},beforeUnmount(e,{value:t}){bo(e,t)}};function bo(e,t){e.style.display=t?e[xa]:"none",e[dg]=!t}const Qw=Symbol(""),Xw=/(^|;)\s*display\s*:/;function Zw(e,t,r){const n=e.style,o=ze(r);let i=!1;if(r&&!o){if(t)if(ze(t))for(const a of t.split(";")){const u=a.slice(0,a.indexOf(":")).trim();r[u]==null&&aa(n,u,"")}else for(const a in t)r[a]==null&&aa(n,a,"");for(const a in r)a==="display"&&(i=!0),aa(n,a,r[a])}else if(o){if(t!==r){const a=n[Qw];a&&(r+=";"+a),n.cssText=r,i=Xw.test(r)}}else t&&e.removeAttribute("style");xa in e&&(e[xa]=i?n.display:"",e[dg]&&(n.display="none"))}const Md=/\s*!important$/;function aa(e,t,r){if(pe(r))r.forEach(n=>aa(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=eE(e,t);Md.test(r)?e.setProperty(yi(n),r.replace(Md,""),"important"):e[n]=r}}const Bd=["Webkit","Moz","ms"],lc={};function eE(e,t){const r=lc[t];if(r)return r;let n=or(t);if(n!=="filter"&&n in e)return lc[t]=n;n=mu(n);for(let o=0;o<Bd.length;o++){const i=Bd[o]+n;if(i in e)return lc[t]=i}return t}const jd="http://www.w3.org/1999/xlink";function kd(e,t,r,n,o,i=ub(t)){n&&t.startsWith("xlink:")?r==null?e.removeAttributeNS(jd,t.slice(6,t.length)):e.setAttributeNS(jd,t,r):r==null||i&&!am(r)?e.removeAttribute(t):e.setAttribute(t,i?"":qr(r)?String(r):r)}function qd(e,t,r,n,o){if(t==="innerHTML"||t==="textContent"){r!=null&&(e[t]=t==="innerHTML"?fg(r):r);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const u=i==="OPTION"?e.getAttribute("value")||"":e.value,l=r==null?e.type==="checkbox"?"on":"":String(r);(u!==l||!("_value"in e))&&(e.value=l),r==null&&e.removeAttribute(t),e._value=r;return}let a=!1;if(r===""||r==null){const u=typeof e[t];u==="boolean"?r=am(r):r==null&&u==="string"?(r="",a=!0):u==="number"&&(r=0,a=!0)}try{e[t]=r}catch{}a&&e.removeAttribute(o||t)}function zn(e,t,r,n){e.addEventListener(t,r,n)}function tE(e,t,r,n){e.removeEventListener(t,r,n)}const Wd=Symbol("_vei");function rE(e,t,r,n,o=null){const i=e[Wd]||(e[Wd]={}),a=i[t];if(n&&a)a.value=n;else{const[u,l]=nE(t);if(n){const s=i[t]=sE(n,o);zn(e,u,s,l)}else a&&(tE(e,u,a,l),i[t]=void 0)}}const Hd=/(?:Once|Passive|Capture)$/;function nE(e){let t;if(Hd.test(e)){t={};let n;for(;n=e.match(Hd);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):yi(e.slice(2)),t]}let fc=0;const iE=Promise.resolve(),oE=()=>fc||(iE.then(()=>fc=0),fc=Date.now());function sE(e,t){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;Wr(aE(n,r.value),t,5,[n])};return r.value=e,r.attached=oE(),r}function aE(e,t){if(pe(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>o=>!o._stopped&&n&&n(o))}else return t}const Gd=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,uE=(e,t,r,n,o,i)=>{const a=o==="svg";t==="class"?Yw(e,n,a):t==="style"?Zw(e,r,n):hu(t)?Yl(t)||rE(e,t,r,n,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):cE(e,t,n,a))?(qd(e,t,n),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&kd(e,t,n,a,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!ze(n))?qd(e,or(t),n,i,t):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),kd(e,t,n,a))};function cE(e,t,r,n){if(n)return!!(t==="innerHTML"||t==="textContent"||t in e&&Gd(t)&&_e(r));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const o=e.tagName;if(o==="IMG"||o==="VIDEO"||o==="CANVAS"||o==="SOURCE")return!1}return Gd(t)&&ze(r)?!1:t in e}const Pa=e=>{const t=e.props["onUpdate:modelValue"]||!1;return pe(t)?r=>ia(t,r):t};function lE(e){e.target.composing=!0}function Vd(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const ki=Symbol("_assign"),Dn={created(e,{modifiers:{lazy:t,trim:r,number:n}},o){e[ki]=Pa(o);const i=n||o.props&&o.props.type==="number";zn(e,t?"change":"input",a=>{if(a.target.composing)return;let u=e.value;r&&(u=u.trim()),i&&(u=Ea(u)),e[ki](u)}),r&&zn(e,"change",()=>{e.value=e.value.trim()}),t||(zn(e,"compositionstart",lE),zn(e,"compositionend",Vd),zn(e,"change",Vd))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:r,modifiers:{lazy:n,trim:o,number:i}},a){if(e[ki]=Pa(a),e.composing)return;const u=(i||e.type==="number")&&!/^0\d/.test(e.value)?Ea(e.value):e.value,l=t??"";u!==l&&(document.activeElement===e&&e.type!=="range"&&(n&&t===r||o&&e.value.trim()===l)||(e.value=l))}},Kd={deep:!0,created(e,{value:t,modifiers:{number:r}},n){const o=pu(t);zn(e,"change",()=>{const i=Array.prototype.filter.call(e.options,a=>a.selected).map(a=>r?Ea(Na(a)):Na(a));e[ki](e.multiple?o?new Set(i):i:i[0]),e._assigning=!0,uf(()=>{e._assigning=!1})}),e[ki]=Pa(n)},mounted(e,{value:t}){zd(e,t)},beforeUpdate(e,t,r){e[ki]=Pa(r)},updated(e,{value:t}){e._assigning||zd(e,t)}};function zd(e,t){const r=e.multiple,n=pe(t);if(!(r&&!n&&!pu(t))){for(let o=0,i=e.options.length;o<i;o++){const a=e.options[o],u=Na(a);if(r)if(n){const l=typeof u;l==="string"||l==="number"?a.selected=t.some(s=>String(s)===String(u)):a.selected=lb(t,u)>-1}else a.selected=t.has(u);else if(yu(Na(a),t)){e.selectedIndex!==o&&(e.selectedIndex=o);return}}!r&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Na(e){return"_value"in e?e._value:e.value}const fE=["ctrl","shift","alt","meta"],dE={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>fE.some(r=>e[`${r}Key`]&&!t.includes(r))},pf=(e,t)=>{const r=e._withMods||(e._withMods={}),n=t.join(".");return r[n]||(r[n]=(o,...i)=>{for(let a=0;a<t.length;a++){const u=dE[t[a]];if(u&&u(o,t))return}return e(o,...i)})},hE=_t({patchProp:uE},zw);let Jd;function pE(){return Jd||(Jd=mw(hE))}const vE=(...e)=>{const t=pE().createApp(...e),{mount:r}=t;return t.mount=n=>{const o=gE(n);if(!o)return;const i=t._component;!_e(i)&&!i.render&&!i.template&&(i.template=o.innerHTML),o.nodeType===1&&(o.textContent="");const a=r(o,!1,mE(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),a},t};function mE(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function gE(e){return ze(e)?document.querySelector(e):e}/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const Ri=typeof document<"u";function hg(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function yE(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&hg(e.default)}const Pe=Object.assign;function dc(e,t){const r={};for(const n in t){const o=t[n];r[n]=wr(o)?o.map(e):e(o)}return r}const Yo=()=>{},wr=Array.isArray,pg=/#/g,_E=/&/g,bE=/\//g,wE=/=/g,EE=/\?/g,vg=/\+/g,SE=/%5B/g,IE=/%5D/g,mg=/%5E/g,OE=/%60/g,gg=/%7B/g,TE=/%7C/g,yg=/%7D/g,AE=/%20/g;function vf(e){return encodeURI(""+e).replace(TE,"|").replace(SE,"[").replace(IE,"]")}function RE(e){return vf(e).replace(gg,"{").replace(yg,"}").replace(mg,"^")}function pl(e){return vf(e).replace(vg,"%2B").replace(AE,"+").replace(pg,"%23").replace(_E,"%26").replace(OE,"`").replace(gg,"{").replace(yg,"}").replace(mg,"^")}function CE(e){return pl(e).replace(wE,"%3D")}function xE(e){return vf(e).replace(pg,"%23").replace(EE,"%3F")}function PE(e){return e==null?"":xE(e).replace(bE,"%2F")}function fs(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const NE=/\/$/,$E=e=>e.replace(NE,"");function hc(e,t,r="/"){let n,o={},i="",a="";const u=t.indexOf("#");let l=t.indexOf("?");return u<l&&u>=0&&(l=-1),l>-1&&(n=t.slice(0,l),i=t.slice(l+1,u>-1?u:t.length),o=e(i)),u>-1&&(n=n||t.slice(0,u),a=t.slice(u,t.length)),n=FE(n??t,r),{fullPath:n+(i&&"?")+i+a,path:n,query:o,hash:fs(a)}}function DE(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function Yd(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function LE(e,t,r){const n=t.matched.length-1,o=r.matched.length-1;return n>-1&&n===o&&Qi(t.matched[n],r.matched[o])&&_g(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function Qi(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function _g(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!UE(e[r],t[r]))return!1;return!0}function UE(e,t){return wr(e)?Qd(e,t):wr(t)?Qd(t,e):e===t}function Qd(e,t){return wr(t)?e.length===t.length&&e.every((r,n)=>r===t[n]):e.length===1&&e[0]===t}function FE(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),n=e.split("/"),o=n[n.length-1];(o===".."||o===".")&&n.push("");let i=r.length-1,a,u;for(a=0;a<n.length;a++)if(u=n[a],u!==".")if(u==="..")i>1&&i--;else break;return r.slice(0,i).join("/")+"/"+n.slice(a).join("/")}const pn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var ds;(function(e){e.pop="pop",e.push="push"})(ds||(ds={}));var Qo;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Qo||(Qo={}));function ME(e){if(!e)if(Ri){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),$E(e)}const BE=/^[^#]+#/;function jE(e,t){return e.replace(BE,"#")+t}function kE(e,t){const r=document.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{behavior:t.behavior,left:n.left-r.left-(t.left||0),top:n.top-r.top-(t.top||0)}}const Ou=()=>({left:window.scrollX,top:window.scrollY});function qE(e){let t;if("el"in e){const r=e.el,n=typeof r=="string"&&r.startsWith("#"),o=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!o)return;t=kE(o,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function Xd(e,t){return(history.state?history.state.position-t:-1)+e}const vl=new Map;function WE(e,t){vl.set(e,t)}function HE(e){const t=vl.get(e);return vl.delete(e),t}let GE=()=>location.protocol+"//"+location.host;function bg(e,t){const{pathname:r,search:n,hash:o}=t,i=e.indexOf("#");if(i>-1){let u=o.includes(e.slice(i))?e.slice(i).length:1,l=o.slice(u);return l[0]!=="/"&&(l="/"+l),Yd(l,"")}return Yd(r,e)+n+o}function VE(e,t,r,n){let o=[],i=[],a=null;const u=({state:d})=>{const v=bg(e,location),g=r.value,b=t.value;let w=0;if(d){if(r.value=v,t.value=d,a&&a===g){a=null;return}w=b?d.position-b.position:0}else n(v);o.forEach(_=>{_(r.value,g,{delta:w,type:ds.pop,direction:w?w>0?Qo.forward:Qo.back:Qo.unknown})})};function l(){a=r.value}function s(d){o.push(d);const v=()=>{const g=o.indexOf(d);g>-1&&o.splice(g,1)};return i.push(v),v}function c(){const{history:d}=window;d.state&&d.replaceState(Pe({},d.state,{scroll:Ou()}),"")}function f(){for(const d of i)d();i=[],window.removeEventListener("popstate",u),window.removeEventListener("beforeunload",c)}return window.addEventListener("popstate",u),window.addEventListener("beforeunload",c,{passive:!0}),{pauseListeners:l,listen:s,destroy:f}}function Zd(e,t,r,n=!1,o=!1){return{back:e,current:t,forward:r,replaced:n,position:window.history.length,scroll:o?Ou():null}}function KE(e){const{history:t,location:r}=window,n={value:bg(e,r)},o={value:t.state};o.value||i(n.value,{back:null,current:n.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(l,s,c){const f=e.indexOf("#"),d=f>-1?(r.host&&document.querySelector("base")?e:e.slice(f))+l:GE()+e+l;try{t[c?"replaceState":"pushState"](s,"",d),o.value=s}catch(v){console.error(v),r[c?"replace":"assign"](d)}}function a(l,s){const c=Pe({},t.state,Zd(o.value.back,l,o.value.forward,!0),s,{position:o.value.position});i(l,c,!0),n.value=l}function u(l,s){const c=Pe({},o.value,t.state,{forward:l,scroll:Ou()});i(c.current,c,!0);const f=Pe({},Zd(n.value,l,null),{position:c.position+1},s);i(l,f,!1),n.value=l}return{location:n,state:o,push:u,replace:a}}function zE(e){e=ME(e);const t=KE(e),r=VE(e,t.state,t.location,t.replace);function n(i,a=!0){a||r.pauseListeners(),history.go(i)}const o=Pe({location:"",base:e,go:n,createHref:jE.bind(null,e)},t,r);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>t.state.value}),o}function JE(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),zE(e)}function YE(e){return typeof e=="string"||e&&typeof e=="object"}function wg(e){return typeof e=="string"||typeof e=="symbol"}const Eg=Symbol("");var eh;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(eh||(eh={}));function Xi(e,t){return Pe(new Error,{type:e,[Eg]:!0},t)}function Kr(e,t){return e instanceof Error&&Eg in e&&(t==null||!!(e.type&t))}const th="[^/]+?",QE={sensitive:!1,strict:!1,start:!0,end:!0},XE=/[.+*?^${}()[\]/\\]/g;function ZE(e,t){const r=Pe({},QE,t),n=[];let o=r.start?"^":"";const i=[];for(const s of e){const c=s.length?[]:[90];r.strict&&!s.length&&(o+="/");for(let f=0;f<s.length;f++){const d=s[f];let v=40+(r.sensitive?.25:0);if(d.type===0)f||(o+="/"),o+=d.value.replace(XE,"\\$&"),v+=40;else if(d.type===1){const{value:g,repeatable:b,optional:w,regexp:_}=d;i.push({name:g,repeatable:b,optional:w});const E=_||th;if(E!==th){v+=10;try{new RegExp(`(${E})`)}catch(I){throw new Error(`Invalid custom RegExp for param "${g}" (${E}): `+I.message)}}let A=b?`((?:${E})(?:/(?:${E}))*)`:`(${E})`;f||(A=w&&s.length<2?`(?:/${A})`:"/"+A),w&&(A+="?"),o+=A,v+=20,w&&(v+=-8),b&&(v+=-20),E===".*"&&(v+=-50)}c.push(v)}n.push(c)}if(r.strict&&r.end){const s=n.length-1;n[s][n[s].length-1]+=.7000000000000001}r.strict||(o+="/?"),r.end?o+="$":r.strict&&!o.endsWith("/")&&(o+="(?:/|$)");const a=new RegExp(o,r.sensitive?"":"i");function u(s){const c=s.match(a),f={};if(!c)return null;for(let d=1;d<c.length;d++){const v=c[d]||"",g=i[d-1];f[g.name]=v&&g.repeatable?v.split("/"):v}return f}function l(s){let c="",f=!1;for(const d of e){(!f||!c.endsWith("/"))&&(c+="/"),f=!1;for(const v of d)if(v.type===0)c+=v.value;else if(v.type===1){const{value:g,repeatable:b,optional:w}=v,_=g in s?s[g]:"";if(wr(_)&&!b)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const E=wr(_)?_.join("/"):_;if(!E)if(w)d.length<2&&(c.endsWith("/")?c=c.slice(0,-1):f=!0);else throw new Error(`Missing required param "${g}"`);c+=E}}return c||"/"}return{re:a,score:n,keys:i,parse:u,stringify:l}}function e1(e,t){let r=0;for(;r<e.length&&r<t.length;){const n=t[r]-e[r];if(n)return n;r++}return e.length<t.length?e.length===1&&e[0]===80?-1:1:e.length>t.length?t.length===1&&t[0]===80?1:-1:0}function Sg(e,t){let r=0;const n=e.score,o=t.score;for(;r<n.length&&r<o.length;){const i=e1(n[r],o[r]);if(i)return i;r++}if(Math.abs(o.length-n.length)===1){if(rh(n))return 1;if(rh(o))return-1}return o.length-n.length}function rh(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const t1={type:0,value:""},r1=/[a-zA-Z0-9_]/;function n1(e){if(!e)return[[]];if(e==="/")return[[t1]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(v){throw new Error(`ERR (${r})/"${s}": ${v}`)}let r=0,n=r;const o=[];let i;function a(){i&&o.push(i),i=[]}let u=0,l,s="",c="";function f(){s&&(r===0?i.push({type:0,value:s}):r===1||r===2||r===3?(i.length>1&&(l==="*"||l==="+")&&t(`A repeatable param (${s}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:s,regexp:c,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):t("Invalid state to consume buffer"),s="")}function d(){s+=l}for(;u<e.length;){if(l=e[u++],l==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:l==="/"?(s&&f(),a()):l===":"?(f(),r=1):d();break;case 4:d(),r=n;break;case 1:l==="("?r=2:r1.test(l)?d():(f(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&u--);break;case 2:l===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+l:r=3:c+=l;break;case 3:f(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&u--,c="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${s}"`),f(),a(),o}function i1(e,t,r){const n=ZE(n1(e.path),r),o=Pe(n,{record:e,parent:t,children:[],alias:[]});return t&&!o.record.aliasOf==!t.record.aliasOf&&t.children.push(o),o}function o1(e,t){const r=[],n=new Map;t=sh({strict:!1,end:!0,sensitive:!1},t);function o(f){return n.get(f)}function i(f,d,v){const g=!v,b=ih(f);b.aliasOf=v&&v.record;const w=sh(t,f),_=[b];if("alias"in f){const I=typeof f.alias=="string"?[f.alias]:f.alias;for(const R of I)_.push(ih(Pe({},b,{components:v?v.record.components:b.components,path:R,aliasOf:v?v.record:b})))}let E,A;for(const I of _){const{path:R}=I;if(d&&R[0]!=="/"){const $=d.record.path,L=$[$.length-1]==="/"?"":"/";I.path=d.record.path+(R&&L+R)}if(E=i1(I,d,w),v?v.alias.push(E):(A=A||E,A!==E&&A.alias.push(E),g&&f.name&&!oh(E)&&a(f.name)),Ig(E)&&l(E),b.children){const $=b.children;for(let L=0;L<$.length;L++)i($[L],E,v&&v.children[L])}v=v||E}return A?()=>{a(A)}:Yo}function a(f){if(wg(f)){const d=n.get(f);d&&(n.delete(f),r.splice(r.indexOf(d),1),d.children.forEach(a),d.alias.forEach(a))}else{const d=r.indexOf(f);d>-1&&(r.splice(d,1),f.record.name&&n.delete(f.record.name),f.children.forEach(a),f.alias.forEach(a))}}function u(){return r}function l(f){const d=u1(f,r);r.splice(d,0,f),f.record.name&&!oh(f)&&n.set(f.record.name,f)}function s(f,d){let v,g={},b,w;if("name"in f&&f.name){if(v=n.get(f.name),!v)throw Xi(1,{location:f});w=v.record.name,g=Pe(nh(d.params,v.keys.filter(A=>!A.optional).concat(v.parent?v.parent.keys.filter(A=>A.optional):[]).map(A=>A.name)),f.params&&nh(f.params,v.keys.map(A=>A.name))),b=v.stringify(g)}else if(f.path!=null)b=f.path,v=r.find(A=>A.re.test(b)),v&&(g=v.parse(b),w=v.record.name);else{if(v=d.name?n.get(d.name):r.find(A=>A.re.test(d.path)),!v)throw Xi(1,{location:f,currentLocation:d});w=v.record.name,g=Pe({},d.params,f.params),b=v.stringify(g)}const _=[];let E=v;for(;E;)_.unshift(E.record),E=E.parent;return{name:w,path:b,params:g,matched:_,meta:a1(_)}}e.forEach(f=>i(f));function c(){r.length=0,n.clear()}return{addRoute:i,resolve:s,removeRoute:a,clearRoutes:c,getRoutes:u,getRecordMatcher:o}}function nh(e,t){const r={};for(const n of t)n in e&&(r[n]=e[n]);return r}function ih(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:s1(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function s1(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const n in e.components)t[n]=typeof r=="object"?r[n]:r;return t}function oh(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function a1(e){return e.reduce((t,r)=>Pe(t,r.meta),{})}function sh(e,t){const r={};for(const n in e)r[n]=n in t?t[n]:e[n];return r}function u1(e,t){let r=0,n=t.length;for(;r!==n;){const i=r+n>>1;Sg(e,t[i])<0?n=i:r=i+1}const o=c1(e);return o&&(n=t.lastIndexOf(o,n-1)),n}function c1(e){let t=e;for(;t=t.parent;)if(Ig(t)&&Sg(e,t)===0)return t}function Ig({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function l1(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let o=0;o<n.length;++o){const i=n[o].replace(vg," "),a=i.indexOf("="),u=fs(a<0?i:i.slice(0,a)),l=a<0?null:fs(i.slice(a+1));if(u in t){let s=t[u];wr(s)||(s=t[u]=[s]),s.push(l)}else t[u]=l}return t}function ah(e){let t="";for(let r in e){const n=e[r];if(r=CE(r),n==null){n!==void 0&&(t+=(t.length?"&":"")+r);continue}(wr(n)?n.map(i=>i&&pl(i)):[n&&pl(n)]).forEach(i=>{i!==void 0&&(t+=(t.length?"&":"")+r,i!=null&&(t+="="+i))})}return t}function f1(e){const t={};for(const r in e){const n=e[r];n!==void 0&&(t[r]=wr(n)?n.map(o=>o==null?null:""+o):n==null?n:""+n)}return t}const d1=Symbol(""),uh=Symbol(""),Tu=Symbol(""),mf=Symbol(""),ml=Symbol("");function wo(){let e=[];function t(n){return e.push(n),()=>{const o=e.indexOf(n);o>-1&&e.splice(o,1)}}function r(){e=[]}return{add:t,list:()=>e.slice(),reset:r}}function yn(e,t,r,n,o,i=a=>a()){const a=n&&(n.enterCallbacks[o]=n.enterCallbacks[o]||[]);return()=>new Promise((u,l)=>{const s=d=>{d===!1?l(Xi(4,{from:r,to:t})):d instanceof Error?l(d):YE(d)?l(Xi(2,{from:t,to:d})):(a&&n.enterCallbacks[o]===a&&typeof d=="function"&&a.push(d),u())},c=i(()=>e.call(n&&n.instances[o],t,r,s));let f=Promise.resolve(c);e.length<3&&(f=f.then(s)),f.catch(d=>l(d))})}function pc(e,t,r,n,o=i=>i()){const i=[];for(const a of e)for(const u in a.components){let l=a.components[u];if(!(t!=="beforeRouteEnter"&&!a.instances[u]))if(hg(l)){const c=(l.__vccOpts||l)[t];c&&i.push(yn(c,r,n,a,u,o))}else{let s=l();i.push(()=>s.then(c=>{if(!c)throw new Error(`Couldn't resolve component "${u}" at "${a.path}"`);const f=yE(c)?c.default:c;a.mods[u]=c,a.components[u]=f;const v=(f.__vccOpts||f)[t];return v&&yn(v,r,n,a,u,o)()}))}}return i}function ch(e){const t=_r(Tu),r=_r(mf),n=Ke(()=>{const l=kr(e.to);return t.resolve(l)}),o=Ke(()=>{const{matched:l}=n.value,{length:s}=l,c=l[s-1],f=r.matched;if(!c||!f.length)return-1;const d=f.findIndex(Qi.bind(null,c));if(d>-1)return d;const v=lh(l[s-2]);return s>1&&lh(c)===v&&f[f.length-1].path!==v?f.findIndex(Qi.bind(null,l[s-2])):d}),i=Ke(()=>o.value>-1&&g1(r.params,n.value.params)),a=Ke(()=>o.value>-1&&o.value===r.matched.length-1&&_g(r.params,n.value.params));function u(l={}){if(m1(l)){const s=t[kr(e.replace)?"replace":"push"](kr(e.to)).catch(Yo);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>s),s}return Promise.resolve()}return{route:n,href:Ke(()=>n.value.href),isActive:i,isExactActive:a,navigate:u}}function h1(e){return e.length===1?e[0]:e}const p1=Un({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:ch,setup(e,{slots:t}){const r=oo(ch(e)),{options:n}=_r(Tu),o=Ke(()=>({[fh(e.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[fh(e.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const i=t.default&&h1(t.default(r));return e.custom?i:lg("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:o.value},i)}}}),v1=p1;function m1(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function g1(e,t){for(const r in t){const n=t[r],o=e[r];if(typeof n=="string"){if(n!==o)return!1}else if(!wr(o)||o.length!==n.length||n.some((i,a)=>i!==o[a]))return!1}return!0}function lh(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const fh=(e,t,r)=>e??t??r,y1=Un({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const n=_r(ml),o=Ke(()=>e.route||n.value),i=_r(uh,0),a=Ke(()=>{let s=kr(i);const{matched:c}=o.value;let f;for(;(f=c[s])&&!f.components;)s++;return s}),u=Ke(()=>o.value.matched[a.value]);oa(uh,Ke(()=>a.value+1)),oa(d1,u),oa(ml,o);const l=Ee();return si(()=>[l.value,u.value,e.name],([s,c,f],[d,v,g])=>{c&&(c.instances[f]=s,v&&v!==c&&s&&s===d&&(c.leaveGuards.size||(c.leaveGuards=v.leaveGuards),c.updateGuards.size||(c.updateGuards=v.updateGuards))),s&&c&&(!v||!Qi(c,v)||!d)&&(c.enterCallbacks[f]||[]).forEach(b=>b(s))},{flush:"post"}),()=>{const s=o.value,c=e.name,f=u.value,d=f&&f.components[c];if(!d)return dh(r.default,{Component:d,route:s});const v=f.props[c],g=v?v===!0?s.params:typeof v=="function"?v(s):v:null,w=lg(d,Pe({},g,t,{onVnodeUnmounted:_=>{_.component.isUnmounted&&(f.instances[c]=null)},ref:l}));return dh(r.default,{Component:w,route:s})||w}}});function dh(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const _1=y1;function b1(e){const t=o1(e.routes,e),r=e.parseQuery||l1,n=e.stringifyQuery||ah,o=e.history,i=wo(),a=wo(),u=wo(),l=Nb(pn);let s=pn;Ri&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=dc.bind(null,U=>""+U),f=dc.bind(null,PE),d=dc.bind(null,fs);function v(U,K){let G,Y;return wg(U)?(G=t.getRecordMatcher(U),Y=K):Y=U,t.addRoute(Y,G)}function g(U){const K=t.getRecordMatcher(U);K&&t.removeRoute(K)}function b(){return t.getRoutes().map(U=>U.record)}function w(U){return!!t.getRecordMatcher(U)}function _(U,K){if(K=Pe({},K||l.value),typeof U=="string"){const N=hc(r,U,K.path),m=t.resolve({path:N.path},K),h=o.createHref(N.fullPath);return Pe(N,m,{params:d(m.params),hash:fs(N.hash),redirectedFrom:void 0,href:h})}let G;if(U.path!=null)G=Pe({},U,{path:hc(r,U.path,K.path).path});else{const N=Pe({},U.params);for(const m in N)N[m]==null&&delete N[m];G=Pe({},U,{params:f(N)}),K.params=f(K.params)}const Y=t.resolve(G,K),ge=U.hash||"";Y.params=c(d(Y.params));const S=DE(n,Pe({},U,{hash:RE(ge),path:Y.path})),T=o.createHref(S);return Pe({fullPath:S,hash:ge,query:n===ah?f1(U.query):U.query||{}},Y,{redirectedFrom:void 0,href:T})}function E(U){return typeof U=="string"?hc(r,U,l.value.path):Pe({},U)}function A(U,K){if(s!==U)return Xi(8,{from:K,to:U})}function I(U){return L(U)}function R(U){return I(Pe(E(U),{replace:!0}))}function $(U){const K=U.matched[U.matched.length-1];if(K&&K.redirect){const{redirect:G}=K;let Y=typeof G=="function"?G(U):G;return typeof Y=="string"&&(Y=Y.includes("?")||Y.includes("#")?Y=E(Y):{path:Y},Y.params={}),Pe({query:U.query,hash:U.hash,params:Y.path!=null?{}:U.params},Y)}}function L(U,K){const G=s=_(U),Y=l.value,ge=U.state,S=U.force,T=U.replace===!0,N=$(G);if(N)return L(Pe(E(N),{state:typeof N=="object"?Pe({},ge,N.state):ge,force:S,replace:T}),K||G);const m=G;m.redirectedFrom=K;let h;return!S&&LE(n,Y,G)&&(h=Xi(16,{to:m,from:Y}),ne(Y,Y,!0,!1)),(h?Promise.resolve(h):k(m,Y)).catch(p=>Kr(p)?Kr(p,2)?p:te(p):M(p,m,Y)).then(p=>{if(p){if(Kr(p,2))return L(Pe({replace:T},E(p.to),{state:typeof p.to=="object"?Pe({},ge,p.to.state):ge,force:S}),K||m)}else p=Q(m,Y,!0,T,ge);return F(m,Y,p),p})}function D(U,K){const G=A(U,K);return G?Promise.reject(G):Promise.resolve()}function P(U){const K=Rt.values().next().value;return K&&typeof K.runWithContext=="function"?K.runWithContext(U):U()}function k(U,K){let G;const[Y,ge,S]=w1(U,K);G=pc(Y.reverse(),"beforeRouteLeave",U,K);for(const N of Y)N.leaveGuards.forEach(m=>{G.push(yn(m,U,K))});const T=D.bind(null,U,K);return G.push(T),de(G).then(()=>{G=[];for(const N of i.list())G.push(yn(N,U,K));return G.push(T),de(G)}).then(()=>{G=pc(ge,"beforeRouteUpdate",U,K);for(const N of ge)N.updateGuards.forEach(m=>{G.push(yn(m,U,K))});return G.push(T),de(G)}).then(()=>{G=[];for(const N of S)if(N.beforeEnter)if(wr(N.beforeEnter))for(const m of N.beforeEnter)G.push(yn(m,U,K));else G.push(yn(N.beforeEnter,U,K));return G.push(T),de(G)}).then(()=>(U.matched.forEach(N=>N.enterCallbacks={}),G=pc(S,"beforeRouteEnter",U,K,P),G.push(T),de(G))).then(()=>{G=[];for(const N of a.list())G.push(yn(N,U,K));return G.push(T),de(G)}).catch(N=>Kr(N,8)?N:Promise.reject(N))}function F(U,K,G){u.list().forEach(Y=>P(()=>Y(U,K,G)))}function Q(U,K,G,Y,ge){const S=A(U,K);if(S)return S;const T=K===pn,N=Ri?history.state:{};G&&(Y||T?o.replace(U.fullPath,Pe({scroll:T&&N&&N.scroll},ge)):o.push(U.fullPath,ge)),l.value=U,ne(U,K,G,T),te()}let ce;function B(){ce||(ce=o.listen((U,K,G)=>{if(!Qe.listening)return;const Y=_(U),ge=$(Y);if(ge){L(Pe(ge,{replace:!0,force:!0}),Y).catch(Yo);return}s=Y;const S=l.value;Ri&&WE(Xd(S.fullPath,G.delta),Ou()),k(Y,S).catch(T=>Kr(T,12)?T:Kr(T,2)?(L(Pe(E(T.to),{force:!0}),Y).then(N=>{Kr(N,20)&&!G.delta&&G.type===ds.pop&&o.go(-1,!1)}).catch(Yo),Promise.reject()):(G.delta&&o.go(-G.delta,!1),M(T,Y,S))).then(T=>{T=T||Q(Y,S,!1),T&&(G.delta&&!Kr(T,8)?o.go(-G.delta,!1):G.type===ds.pop&&Kr(T,20)&&o.go(-1,!1)),F(Y,S,T)}).catch(Yo)}))}let fe=wo(),re=wo(),X;function M(U,K,G){te(U);const Y=re.list();return Y.length?Y.forEach(ge=>ge(U,K,G)):console.error(U),Promise.reject(U)}function W(){return X&&l.value!==pn?Promise.resolve():new Promise((U,K)=>{fe.add([U,K])})}function te(U){return X||(X=!U,B(),fe.list().forEach(([K,G])=>U?G(U):K()),fe.reset()),U}function ne(U,K,G,Y){const{scrollBehavior:ge}=e;if(!Ri||!ge)return Promise.resolve();const S=!G&&HE(Xd(U.fullPath,0))||(Y||!G)&&history.state&&history.state.scroll||null;return uf().then(()=>ge(U,K,S)).then(T=>T&&qE(T)).catch(T=>M(T,U,K))}const be=U=>o.go(U);let et;const Rt=new Set,Qe={currentRoute:l,listening:!0,addRoute:v,removeRoute:g,clearRoutes:t.clearRoutes,hasRoute:w,getRoutes:b,resolve:_,options:e,push:I,replace:R,go:be,back:()=>be(-1),forward:()=>be(1),beforeEach:i.add,beforeResolve:a.add,afterEach:u.add,onError:re.add,isReady:W,install(U){const K=this;U.component("RouterLink",v1),U.component("RouterView",_1),U.config.globalProperties.$router=K,Object.defineProperty(U.config.globalProperties,"$route",{enumerable:!0,get:()=>kr(l)}),Ri&&!et&&l.value===pn&&(et=!0,I(o.location).catch(ge=>{}));const G={};for(const ge in pn)Object.defineProperty(G,ge,{get:()=>l.value[ge],enumerable:!0});U.provide(Tu,K),U.provide(mf,Im(G)),U.provide(ml,l);const Y=U.unmount;Rt.add(U),U.unmount=function(){Rt.delete(U),Rt.size<1&&(s=pn,ce&&ce(),ce=null,l.value=pn,et=!1,X=!1),Y()}}};function de(U){return U.reduce((K,G)=>K.then(()=>P(G)),Promise.resolve())}return Qe}function w1(e,t){const r=[],n=[],o=[],i=Math.max(t.matched.length,e.matched.length);for(let a=0;a<i;a++){const u=t.matched[a];u&&(e.matched.find(s=>Qi(s,u))?n.push(u):r.push(u));const l=e.matched[a];l&&(t.matched.find(s=>Qi(s,l))||o.push(l))}return[r,n,o]}function Ps(){return _r(Tu)}function gf(e){return _r(mf)}var Og="@cloudbase/js-sdk";function E1(e){Og=e}function Au(){return Og}var Tg="https:";function S1(e){Tg=e}function I1(){return Tg}var Ru="https://support.qq.com/products/148793",jt={INVALID_PARAMS:"INVALID_PARAMS",INVALID_OPERATION:"INVALID_OPERATION",OPERATION_FAIL:"OPERATION_FAIL"},$a;(function(e){e.local="local",e.none="none",e.session="session"})($a||($a={}));var yf=function(){function e(){}return e}(),Ag=function(){function e(){}return e}();function ua(e,t,r){r===void 0&&(r={});var n=/\?/.test(t),o="";for(var i in r)o===""?!n&&(t+="?"):o+="&",o+=i+"="+encodeURIComponent(r[i]);return t+=o,/^http(s)?\:\/\//.test(t)?t:""+e+t}const O1=Object.freeze(Object.defineProperty({__proto__:null,AbstractSDKRequest:yf,AbstractStorage:Ag,get StorageType(){return $a},formatUrl:ua},Symbol.toStringTag,{value:"Module"}));function Rg(e){return Object.prototype.toString.call(e)==="[object Array]"}function Cg(e){return typeof e=="string"}function T1(e){return Object.prototype.toString.call(e)==="[object Object]"}function A1(e,t){return e instanceof t}function xg(e){return Object.prototype.toString.call(e)==="[object FormData]"}function R1(){return Math.random().toString(16).slice(2)}function C1(){var e=new Date().getTime(),t=(Date==null?void 0:Date.now)&&Date.now()*1e3||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var n=Math.random()*16;return e>0?(n=(e+n)%16|0,e=Math.floor(e/16)):(n=(t+n)%16|0,t=Math.floor(t/16)),(r==="x"?n:n&7|8).toString(16)})}function Pg(e,t,r){r===void 0&&(r={});var n=/\?/.test(t),o="";return Object.keys(r).forEach(function(i){o===""?!n&&(t+="?"):o+="&",o+="".concat(i,"=").concat(encodeURIComponent(r[i]))}),t+=o,/^http(s)?:\/\//.test(t)?t:"".concat(e).concat(t)}function x1(e){e===void 0&&(e={});var t=[];return Object.keys(e).forEach(function(r){t.push("".concat(r,"=").concat(encodeURIComponent(e[r])))}),t.join("&")}function Ng(e,t,r){if(r===void 0&&(r=null),e&&typeof e=="function")return e(t,r);if(t)throw t;return r}function qi(e,t){console.warn("[".concat(Au(),"][").concat(e,"]:").concat(t))}var P1=function(e){e=e.replace(/^\?/,"");var t={},r=e.split("&");return r.forEach(function(n){var o=n.split("="),i=o[0],a=o[1];i=decodeURIComponent(i),a=decodeURIComponent(a),i&&(t[i]?Array.isArray(t[i])?t[i].push(a):t[i]=[t[i],a]:t[i]=a)}),t},N1=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ct=function(){return ct=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ct.apply(this,arguments)},vc=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},mc=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},$1=function(e){N1(t,e);function t(r){var n=e.call(this)||this,o=r.timeout,i=r.timeoutMsg,a=r.restrictedMethods;return n.timeout=o||0,n.timeoutMsg=i||"请求超时",n.restrictedMethods=a||["get","post","upload","download"],n}return t.prototype.get=function(r){return this.request(ct(ct({},r),{method:"get"}),this.restrictedMethods.includes("get"))},t.prototype.post=function(r){return this.request(ct(ct({},r),{method:"post"}),this.restrictedMethods.includes("post"))},t.prototype.put=function(r){return this.request(ct(ct({},r),{method:"put"}))},t.prototype.upload=function(r){var n=r.data,o=r.file,i=r.name,a=r.method,u=r.headers,l=u===void 0?{}:u,s={post:"post",put:"put"}[a==null?void 0:a.toLowerCase()]||"put",c=new FormData;return s==="post"?(Object.keys(n).forEach(function(f){c.append(f,n[f])}),c.append("key",i),c.append("file",o),this.request(ct(ct({},r),{data:c,method:s}),this.restrictedMethods.includes("upload"))):this.request(ct(ct({},r),{method:"put",headers:l,body:o}),this.restrictedMethods.includes("upload"))},t.prototype.download=function(r){return vc(this,void 0,void 0,function(){var n,o,i,a;return mc(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,this.get(ct(ct({},r),{headers:{},responseType:"blob"}))];case 1:return n=u.sent().data,o=window.URL.createObjectURL(new Blob([n])),i=decodeURIComponent(new URL(r.url).pathname.split("/").pop()||""),a=document.createElement("a"),a.href=o,a.setAttribute("download",i),a.style.display="none",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(o),document.body.removeChild(a),[3,3];case 2:return u.sent(),[3,3];case 3:return[2,new Promise(function(l){l({statusCode:200,tempFilePath:r.url})})]}})})},t.prototype.fetch=function(r){var n;return vc(this,void 0,void 0,function(){var o,i,a,u,l,s,c,f,d,v,g,b=this;return mc(this,function(w){switch(w.label){case 0:return o=new AbortController,i=r.url,a=r.enableAbort,u=a===void 0?!1:a,l=r.stream,s=l===void 0?!1:l,c=r.signal,f=r.timeout,d=f??this.timeout,c&&(c.aborted&&o.abort(),c.addEventListener("abort",function(){return o.abort()})),v=null,u&&d&&(v=setTimeout(function(){console.warn(b.timeoutMsg),o.abort(new Error(b.timeoutMsg))},d)),[4,fetch(i,ct(ct({},r),{signal:o.signal})).then(function(_){return vc(b,void 0,void 0,function(){var E,A,I;return mc(this,function(R){switch(R.label){case 0:return clearTimeout(v),_.ok?(E=_,[3,3]):[3,1];case 1:return I=(A=Promise).reject,[4,_.json()];case 2:E=I.apply(A,[R.sent()]),R.label=3;case 3:return[2,E]}})})}).catch(function(_){return clearTimeout(v),Promise.reject(_)})];case 1:return g=w.sent(),[2,{data:s?g.body:!((n=g.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?g.json():g.text(),statusCode:g.status,header:g.headers}]}})})},t.prototype.request=function(r,n){var o=this;n===void 0&&(n=!1);var i=String(r.method).toLowerCase()||"get";return new Promise(function(a){var u=r.url,l=r.headers,s=l===void 0?{}:l,c=r.data,f=r.responseType,d=r.withCredentials,v=r.body,g=r.onUploadProgress,b=Pg(I1(),u,i==="get"?c:{}),w=new XMLHttpRequest;w.open(i,b),f&&(w.responseType=f),Object.keys(s).forEach(function(A){w.setRequestHeader(A,s[A])});var _;g&&w.upload.addEventListener("progress",g),w.onreadystatechange=function(){var A={};if(w.readyState===4){var I=w.getAllResponseHeaders(),R=I.trim().split(/[\r\n]+/),$={};R.forEach(function(L){var D=L.split(": "),P=D.shift().toLowerCase(),k=D.join(": ");$[P]=k}),A.header=$,A.statusCode=w.status;try{A.data=f==="blob"?w.response:JSON.parse(w.responseText)}catch{A.data=f==="blob"?w.response:w.responseText}clearTimeout(_),a(A)}},n&&o.timeout&&(_=setTimeout(function(){console.warn(o.timeoutMsg),w.abort()},o.timeout));var E;xg(c)?E=c:s["content-type"]==="application/x-www-form-urlencoded"?E=x1(c):v?E=v:E=c?JSON.stringify(c):void 0,d&&(w.withCredentials=!0),w.send(E)})},t}(yf);function D1(){var e={type:"default",root:window,reqClass:$1,wsClass:WebSocket,localStorage};return e}var gl=function(){return gl=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},gl.apply(this,arguments)},yl;(function(e){e.WEB="web",e.WX_MP="wx_mp"})(yl||(yl={}));function L1(e,t){for(var r=Rg(e)?e:[e],n=0,o=r;n<o.length;n++){var i=o[n],a=i.isMatch,u=i.genAdapter,l=i.runtime;if(a())return{adapter:gl({isMatch:a},u(t)),runtime:l}}}function U1(){return{adapter:D1(),runtime:yl.WEB}}var Bs={},F1=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),gc=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,[])).next())})},yc=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},_c=function(e){F1(t,e);function t(r){var n=e.call(this)||this;return n.root=r,r.tcbCacheObject||(r.tcbCacheObject={}),n}return t.prototype.setItem=function(r,n){this.root.tcbCacheObject[r]=n},t.prototype.getItem=function(r){return this.root.tcbCacheObject[r]},t.prototype.removeItem=function(r){delete this.root.tcbCacheObject[r]},t.prototype.clear=function(){delete this.root.tcbCacheObject},t}(Ag);function M1(e,t){switch(e){case"local":return t.localStorage?t.localStorage:(qi(jt.INVALID_PARAMS,"localStorage is not supported on current platform"),new _c(t.root));case"none":return new _c(t.root);default:return t.localStorage?t.localStorage:(qi(jt.INVALID_PARAMS,"localStorage is not supported on current platform"),new _c(t.root))}}var B1=function(){function e(t){this.keys={};var r=t.persistence,n=t.platformInfo,o=n===void 0?{}:n,i=t.keys,a=i===void 0?{}:i;this.platformInfo=o,this.storage||(this.persistenceTag=this.platformInfo.adapter.primaryStorage||r,this.storage=M1(this.persistenceTag,this.platformInfo.adapter),this.keys=a)}return Object.defineProperty(e.prototype,"mode",{get:function(){return this.storage.mode||"sync"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"persistence",{get:function(){return this.persistenceTag},enumerable:!1,configurable:!0}),e.prototype.setStore=function(t,r,n){if(this.mode==="async"){qi(jt.INVALID_OPERATION,"current platform's storage is asynchronous, please use setStoreAsync insteed");return}if(this.storage)try{var o={version:n||"localCachev1",content:r};this.storage.setItem(t,JSON.stringify(o))}catch(i){throw new Error(JSON.stringify({code:jt.OPERATION_FAIL,msg:"[".concat(Au(),"][").concat(jt.OPERATION_FAIL,"]setStore failed"),info:i}))}},e.prototype.setStoreAsync=function(t,r,n){return gc(this,void 0,void 0,function(){var o;return yc(this,function(i){switch(i.label){case 0:if(!this.storage)return[2];i.label=1;case 1:return i.trys.push([1,3,,4]),o={version:n||"localCachev1",content:r},[4,this.storage.setItem(t,JSON.stringify(o))];case 2:return i.sent(),[3,4];case 3:return i.sent(),[2];case 4:return[2]}})})},e.prototype.getStore=function(t,r){var n;if(this.mode==="async"){qi(jt.INVALID_OPERATION,"current platform's storage is asynchronous, please use getStoreAsync insteed");return}try{if(typeof process<"u"&&(!((n=Bs)===null||n===void 0)&&n.tcb_token))return Bs.tcb_token;if(!this.storage)return""}catch{return""}r=r||"localCachev1";var o=this.storage.getItem(t);if(!o)return"";if(o.indexOf(r)>=0){var i=JSON.parse(o);return i.content}return""},e.prototype.getStoreAsync=function(t,r){var n;return gc(this,void 0,void 0,function(){var o,i;return yc(this,function(a){switch(a.label){case 0:try{if(typeof process<"u"&&(!((n=Bs)===null||n===void 0)&&n.tcb_token))return[2,Bs.tcb_token];if(!this.storage)return[2,""]}catch{return[2,""]}return r=r||"localCachev1",[4,this.storage.getItem(t)];case 1:return o=a.sent(),o?o.indexOf(r)>=0?(i=JSON.parse(o),[2,i.content]):[2,""]:[2,""]}})})},e.prototype.removeStore=function(t){if(this.mode==="async"){qi(jt.INVALID_OPERATION,"current platform's storage is asynchronous, please use removeStoreAsync insteed");return}this.storage.removeItem(t)},e.prototype.removeStoreAsync=function(t){return gc(this,void 0,void 0,function(){return yc(this,function(r){switch(r.label){case 0:return[4,this.storage.removeItem(t)];case 1:return r.sent(),[2]}})})},e}(),j1=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),k1=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))};function q1(e,t,r){r[e]=r[e]||[],r[e].push(t)}function W1(e,t,r){if(r!=null&&r[e]){var n=r[e].indexOf(t);n!==-1&&r[e].splice(n,1)}}var $g=function(){function e(t,r){this.data=r||null,this.name=t}return e}(),H1=function(e){j1(t,e);function t(r,n){var o=e.call(this,"error",{error:r,data:n})||this;return o.error=r,o}return t}($g),Dg=function(){function e(){this.listeners={}}return e.prototype.on=function(t,r){return q1(t,r,this.listeners),this},e.prototype.off=function(t,r){return W1(t,r,this.listeners),this},e.prototype.fire=function(t,r){if(A1(t,H1))return console.error(t.error),this;var n=Cg(t)?new $g(t,r||{}):t,o=n.name;if(this.listens(o)){n.target=this;for(var i=this.listeners[o]?k1([],this.listeners[o],!0):[],a=0,u=i;a<u.length;a++){var l=u[a];l.call(this,n)}}return this},e.prototype.listens=function(t){return this.listeners[t]&&this.listeners[t].length>0},e}(),Cu=new Dg,xu="lang_change";typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.indexOf("Firefox");function Pu(e){return e.mode,e.customInfo,e.title,e.messages,function(t,r,n){}}function _l(e){this.message=e}_l.prototype=new Error,_l.prototype.name="InvalidCharacterError";typeof window<"u"&&window.atob&&window.atob.bind(window);function hh(e){this.message=e}hh.prototype=new Error,hh.prototype.name="InvalidTokenError";/**
 * @license
 * web-streams-polyfill v4.2.0
 * Copyright 2025 Mattias Buelens, Diwank Singh Tomer and other contributors.
 * This code is released under the MIT license.
 * SPDX-License-Identifier: MIT
 */function hs(){}function Ze(e){return typeof e=="object"&&e!==null||typeof e=="function"}const Lg=hs;function Oe(e,t){try{Object.defineProperty(e,"name",{value:t,configurable:!0})}catch{}}const _f=Promise,G1=Promise.resolve.bind(_f),V1=Promise.prototype.then,K1=Promise.reject.bind(_f),z1=G1;function Je(e){return new _f(e)}function Te(e){return Je(t=>t(e))}function oe(e){return K1(e)}function Fr(e,t,r){return V1.call(e,t,r)}function kt(e,t,r){Fr(Fr(e,t,r),void 0,Lg)}function bc(e,t){kt(e,t)}function bl(e,t){kt(e,void 0,t)}function un(e,t,r){return Fr(e,t,r)}function so(e){Fr(e,void 0,Lg)}let ai=e=>{if(typeof queueMicrotask=="function")ai=queueMicrotask;else{const t=Te(void 0);ai=r=>Fr(t,r)}return ai(e)};function di(e,t,r){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,r)}function hn(e,t,r){try{return Te(di(e,t,r))}catch(n){return oe(n)}}class ur{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(t){const r=this._back;let n=r;r._elements.length===16383&&(n={_elements:[],_next:void 0}),r._elements.push(t),n!==r&&(this._back=n,r._next=n),++this._size}shift(){const t=this._front;let r=t;const n=this._cursor;let o=n+1;const i=t._elements,a=i[n];return o===16384&&(r=t._next,o=0),--this._size,this._cursor=o,t!==r&&(this._front=r),i[n]=void 0,a}forEach(t){let r=this._cursor,n=this._front,o=n._elements;for(;!(r===o.length&&n._next===void 0||r===o.length&&(n=n._next,o=n._elements,r=0,o.length===0));)t(o[r]),++r}peek(){const t=this._front,r=this._cursor;return t._elements[r]}}const Ug=Symbol("[[AbortSteps]]"),Fg=Symbol("[[ErrorSteps]]"),bf=Symbol("[[CancelSteps]]"),wf=Symbol("[[PullSteps]]"),Ef=Symbol("[[ReleaseSteps]]");function Mg(e,t){e._ownerReadableStream=t,t._reader=e,t._state==="readable"?wl(e):t._state==="closed"?function(r){wl(r),jg(r)}(e):Bg(e,t._storedError)}function Sf(e,t){return vr(e._ownerReadableStream,t)}function sn(e){const t=e._ownerReadableStream;t._state==="readable"?If(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):function(r,n){Bg(r,n)}(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),t._readableStreamController[Ef](),t._reader=void 0,e._ownerReadableStream=void 0}function Da(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function wl(e){e._closedPromise=Je((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r})}function Bg(e,t){wl(e),If(e,t)}function If(e,t){e._closedPromise_reject!==void 0&&(so(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function jg(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}const ph=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},J1=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function an(e,t){if(e!==void 0&&typeof(r=e)!="object"&&typeof r!="function")throw new TypeError(`${t} is not an object.`);var r}function cr(e,t){if(typeof e!="function")throw new TypeError(`${t} is not a function.`)}function kg(e,t){if(!function(r){return typeof r=="object"&&r!==null||typeof r=="function"}(e))throw new TypeError(`${t} is not an object.`)}function hi(e,t,r){if(e===void 0)throw new TypeError(`Parameter ${t} is required in '${r}'.`)}function vh(e,t,r){if(e===void 0)throw new TypeError(`${t} is required in '${r}'.`)}function qg(e){return Number(e)}function mh(e){return e===0?0:e}function Of(e,t){const r=Number.MAX_SAFE_INTEGER;let n=Number(e);if(n=mh(n),!ph(n))throw new TypeError(`${t} is not a finite number`);if(n=function(o){return mh(J1(o))}(n),n<0||n>r)throw new TypeError(`${t} is outside the accepted range of 0 to ${r}, inclusive`);return ph(n)&&n!==0?n:0}function Tf(e,t){if(!vn(e))throw new TypeError(`${t} is not a ReadableStream.`)}function Wi(e){return new Jn(e)}function Wg(e,t){e._reader._readRequests.push(t)}function Af(e,t,r){const n=e._reader._readRequests.shift();r?n._closeSteps():n._chunkSteps(t)}function Nu(e){return e._reader._readRequests.length}function Hg(e){const t=e._reader;return t!==void 0&&!!Tn(t)}class Jn{constructor(t){if(hi(t,1,"ReadableStreamDefaultReader"),Tf(t,"First parameter"),An(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");Mg(this,t),this._readRequests=new ur}get closed(){return Tn(this)?this._closedPromise:oe(js("closed"))}cancel(t=void 0){return Tn(this)?this._ownerReadableStream===void 0?oe(Da("cancel")):Sf(this,t):oe(js("cancel"))}read(){if(!Tn(this))return oe(js("read"));if(this._ownerReadableStream===void 0)return oe(Da("read from"));let t,r;const n=Je((o,i)=>{t=o,r=i});return ps(this,{_chunkSteps:o=>t({value:o,done:!1}),_closeSteps:()=>t({value:void 0,done:!0}),_errorSteps:o=>r(o)}),n}releaseLock(){if(!Tn(this))throw js("releaseLock");this._ownerReadableStream!==void 0&&function(t){sn(t);const r=new TypeError("Reader was released");Gg(t,r)}(this)}}function Tn(e){return!!Ze(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readRequests")&&e instanceof Jn}function ps(e,t){const r=e._ownerReadableStream;r._disturbed=!0,r._state==="closed"?t._closeSteps():r._state==="errored"?t._errorSteps(r._storedError):r._readableStreamController[wf](t)}function Gg(e,t){const r=e._readRequests;e._readRequests=new ur,r.forEach(n=>{n._errorSteps(t)})}function js(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}var wc,Ec,Sc;function Mo(e){return e.slice()}function Vg(e,t,r,n,o){new Uint8Array(e).set(new Uint8Array(r,n,o),t)}Object.defineProperties(Jn.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),Oe(Jn.prototype.cancel,"cancel"),Oe(Jn.prototype.read,"read"),Oe(Jn.prototype.releaseLock,"releaseLock"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Jn.prototype,Symbol.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});let pi=e=>(pi=typeof e.transfer=="function"?t=>t.transfer():typeof structuredClone=="function"?t=>structuredClone(t,{transfer:[t]}):t=>t,pi(e)),vi=e=>(vi=typeof e.detached=="boolean"?t=>t.detached:t=>t.byteLength===0,vi(e));function Kg(e,t,r){if(e.slice)return e.slice(t,r);const n=r-t,o=new ArrayBuffer(n);return Vg(o,0,e,t,n),o}function Bo(e,t){const r=e[t];if(r!=null){if(typeof r!="function")throw new TypeError(`${String(t)} is not a function`);return r}}function gh(e){try{const t=e.done,r=e.value;return Fr(z1(r),n=>({done:t,value:n}))}catch(t){return oe(t)}}const Ns=(Sc=(wc=Symbol.asyncIterator)!==null&&wc!==void 0?wc:(Ec=Symbol.for)===null||Ec===void 0?void 0:Ec.call(Symbol,"Symbol.asyncIterator"))!==null&&Sc!==void 0?Sc:"@@asyncIterator";function zg(e,t="sync",r){if(r===void 0)if(t==="async"){if((r=Bo(e,Ns))===void 0)return function(o){const i={next(){let a;try{a=Jg(o)}catch(u){return oe(u)}return gh(a)},return(a){let u;try{const l=Bo(o.iterator,"return");if(l===void 0)return Te({done:!0,value:a});u=di(l,o.iterator,[a])}catch(l){return oe(l)}return Ze(u)?gh(u):oe(new TypeError("The iterator.return() method must return an object"))}};return{iterator:i,nextMethod:i.next,done:!1}}(zg(e,"sync",Bo(e,Symbol.iterator)))}else r=Bo(e,Symbol.iterator);if(r===void 0)throw new TypeError("The object is not iterable");const n=di(r,e,[]);if(!Ze(n))throw new TypeError("The iterator method must return an object");return{iterator:n,nextMethod:n.next,done:!1}}function Jg(e){const t=di(e.nextMethod,e.iterator,[]);if(!Ze(t))throw new TypeError("The iterator.next() method must return an object");return t}class Yg{constructor(t,r){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=t,this._preventCancel=r}next(){const t=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?un(this._ongoingPromise,t,t):t(),this._ongoingPromise}return(t){const r=()=>this._returnSteps(t);return this._ongoingPromise=this._ongoingPromise?un(this._ongoingPromise,r,r):r(),this._ongoingPromise}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});const t=this._reader;let r,n;const o=Je((i,a)=>{r=i,n=a});return ps(t,{_chunkSteps:i=>{this._ongoingPromise=void 0,ai(()=>r({value:i,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,sn(t),r({value:void 0,done:!0})},_errorSteps:i=>{this._ongoingPromise=void 0,this._isFinished=!0,sn(t),n(i)}}),o}_returnSteps(t){if(this._isFinished)return Promise.resolve({value:t,done:!0});this._isFinished=!0;const r=this._reader;if(!this._preventCancel){const n=Sf(r,t);return sn(r),un(n,()=>({value:t,done:!0}))}return sn(r),Te({value:t,done:!0})}}const Qg={next(){return yh(this)?this._asyncIteratorImpl.next():oe(_h("next"))},return(e){return yh(this)?this._asyncIteratorImpl.return(e):oe(_h("return"))},[Ns](){return this}};function yh(e){if(!Ze(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof Yg}catch{return!1}}function _h(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}Object.defineProperty(Qg,Ns,{enumerable:!1});const Xg=Number.isNaN||function(e){return e!=e};function bh(e){const t=Kg(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(t)}function El(e){const t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function Rf(e,t,r){if(typeof(n=r)!="number"||Xg(n)||n<0||r===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");var n;e._queue.push({value:t,size:r}),e._queueTotalSize+=r}function Fn(e){e._queue=new ur,e._queueTotalSize=0}function Zg(e){return e===DataView}class Ci{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Ic(this))throw Oc("view");return this._view}respond(t){if(!Ic(this))throw Oc("respond");if(hi(t,1,"respond"),t=Of(t,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(vi(this._view.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be used as a response");da(this._associatedReadableByteStreamController,t)}respondWithNewView(t){if(!Ic(this))throw Oc("respondWithNewView");if(hi(t,1,"respondWithNewView"),!ArrayBuffer.isView(t))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(vi(t.buffer))throw new TypeError("The given view's buffer has been detached and so cannot be used as a response");ha(this._associatedReadableByteStreamController,t)}}Object.defineProperties(Ci.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),Oe(Ci.prototype.respond,"respond"),Oe(Ci.prototype.respondWithNewView,"respondWithNewView"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Ci.prototype,Symbol.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class In{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!Yn(this))throw Eo("byobRequest");return Il(this)}get desiredSize(){if(!Yn(this))throw Eo("desiredSize");return ly(this)}close(){if(!Yn(this))throw Eo("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");const t=this._controlledReadableByteStream._state;if(t!=="readable")throw new TypeError(`The stream (in ${t} state) is not in the readable state and cannot be closed`);jo(this)}enqueue(t){if(!Yn(this))throw Eo("enqueue");if(hi(t,1,"enqueue"),!ArrayBuffer.isView(t))throw new TypeError("chunk must be an array buffer view");if(t.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(t.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");const r=this._controlledReadableByteStream._state;if(r!=="readable")throw new TypeError(`The stream (in ${r} state) is not in the readable state and cannot be enqueued to`);fa(this,t)}error(t=void 0){if(!Yn(this))throw Eo("error");nr(this,t)}[bf](t){ey(this),Fn(this);const r=this._cancelAlgorithm(t);return $u(this),r}[wf](t){const r=this._controlledReadableByteStream;if(this._queueTotalSize>0)return void cy(this,t);const n=this._autoAllocateChunkSize;if(n!==void 0){let o;try{o=new ArrayBuffer(n)}catch(a){return void t._errorSteps(a)}const i={buffer:o,bufferByteLength:n,byteOffset:0,byteLength:n,bytesFilled:0,minimumFill:1,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(i)}Wg(r,t),_i(this)}[Ef](){if(this._pendingPullIntos.length>0){const t=this._pendingPullIntos.peek();t.readerType="none",this._pendingPullIntos=new ur,this._pendingPullIntos.push(t)}}}function Yn(e){return!!Ze(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")&&e instanceof In}function Ic(e){return!!Ze(e)&&!!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")&&e instanceof Ci}function _i(e){if(function(r){const n=r._controlledReadableByteStream;return n._state!=="readable"||r._closeRequested||!r._started?!1:!!(Hg(n)&&Nu(n)>0||xf(n)&&hy(n)>0||ly(r)>0)}(e)){if(e._pulling)return void(e._pullAgain=!0);e._pulling=!0,kt(e._pullAlgorithm(),()=>(e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,_i(e)),null),r=>(nr(e,r),null))}}function ey(e){Cf(e),e._pendingPullIntos=new ur}function ty(e,t){let r=!1;e._state==="closed"&&(r=!0);const n=ry(t);t.readerType==="default"?Af(e,n,r):function(o,i,a){const u=o._reader,l=u._readIntoRequests.shift();a?l._closeSteps(i):l._chunkSteps(i)}(e,n,r)}function ca(e,t){for(let r=0;r<t.length;++r)ty(e,t[r])}function ry(e){const t=e.bytesFilled,r=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/r)}function la(e,t,r,n){e._queue.push({buffer:t,byteOffset:r,byteLength:n}),e._queueTotalSize+=n}function ny(e,t,r,n){let o;try{o=Kg(t,r,r+n)}catch(i){throw nr(e,i),i}la(e,o,0,n)}function iy(e,t){t.bytesFilled>0&&ny(e,t.buffer,t.byteOffset,t.bytesFilled),Hi(e)}function oy(e,t){const r=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),n=t.bytesFilled+r;let o=r,i=!1;const a=n-n%t.elementSize;a>=t.minimumFill&&(o=a-t.bytesFilled,i=!0);const u=e._queue;for(;o>0;){const l=u.peek(),s=Math.min(o,l.byteLength),c=t.byteOffset+t.bytesFilled;Vg(t.buffer,c,l.buffer,l.byteOffset,s),l.byteLength===s?u.shift():(l.byteOffset+=s,l.byteLength-=s),e._queueTotalSize-=s,sy(e,s,t),o-=s}return i}function sy(e,t,r){r.bytesFilled+=t}function ay(e){e._queueTotalSize===0&&e._closeRequested?($u(e),$s(e._controlledReadableByteStream)):_i(e)}function Cf(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function Sl(e){const t=[];for(;e._pendingPullIntos.length>0&&e._queueTotalSize!==0;){const r=e._pendingPullIntos.peek();oy(e,r)&&(Hi(e),t.push(r))}return t}function Y1(e,t,r,n){const o=e._controlledReadableByteStream,i=t.constructor,a=function(d){return Zg(d)?1:d.BYTES_PER_ELEMENT}(i),{byteOffset:u,byteLength:l}=t,s=r*a;let c;try{c=pi(t.buffer)}catch(d){return void n._errorSteps(d)}const f={buffer:c,bufferByteLength:c.byteLength,byteOffset:u,byteLength:l,bytesFilled:0,minimumFill:s,elementSize:a,viewConstructor:i,readerType:"byob"};if(e._pendingPullIntos.length>0)return e._pendingPullIntos.push(f),void wh(o,n);if(o._state==="closed"){const d=new i(f.buffer,f.byteOffset,0);return void n._closeSteps(d)}if(e._queueTotalSize>0){if(oy(e,f)){const d=ry(f);return ay(e),void n._chunkSteps(d)}if(e._closeRequested){const d=new TypeError("Insufficient bytes to fill elements in the given buffer");return nr(e,d),void n._errorSteps(d)}}e._pendingPullIntos.push(f),wh(o,n),_i(e)}function uy(e,t){const r=e._pendingPullIntos.peek();Cf(e),e._controlledReadableByteStream._state==="closed"?function(n,o){o.readerType==="none"&&Hi(n);const i=n._controlledReadableByteStream;if(xf(i)){const a=[];for(;a.length<hy(i);)a.push(Hi(n));ca(i,a)}}(e,r):function(n,o,i){if(sy(0,o,i),i.readerType==="none"){iy(n,i);const l=Sl(n);return void ca(n._controlledReadableByteStream,l)}if(i.bytesFilled<i.minimumFill)return;Hi(n);const a=i.bytesFilled%i.elementSize;if(a>0){const l=i.byteOffset+i.bytesFilled;ny(n,i.buffer,l-a,a)}i.bytesFilled-=a;const u=Sl(n);ty(n._controlledReadableByteStream,i),ca(n._controlledReadableByteStream,u)}(e,t,r),_i(e)}function Hi(e){return e._pendingPullIntos.shift()}function $u(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function jo(e){const t=e._controlledReadableByteStream;if(!e._closeRequested&&t._state==="readable")if(e._queueTotalSize>0)e._closeRequested=!0;else{if(e._pendingPullIntos.length>0){const r=e._pendingPullIntos.peek();if(r.bytesFilled%r.elementSize!==0){const n=new TypeError("Insufficient bytes to fill elements in the given buffer");throw nr(e,n),n}}$u(e),$s(t)}}function fa(e,t){const r=e._controlledReadableByteStream;if(e._closeRequested||r._state!=="readable")return;const{buffer:n,byteOffset:o,byteLength:i}=t;if(vi(n))throw new TypeError("chunk's buffer is detached and so cannot be enqueued");const a=pi(n);if(e._pendingPullIntos.length>0){const u=e._pendingPullIntos.peek();if(vi(u.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be filled with an enqueued chunk");Cf(e),u.buffer=pi(u.buffer),u.readerType==="none"&&iy(e,u)}Hg(r)?(function(u){const l=u._controlledReadableByteStream._reader;for(;l._readRequests.length>0;){if(u._queueTotalSize===0)return;cy(u,l._readRequests.shift())}}(e),Nu(r)===0?la(e,a,o,i):(e._pendingPullIntos.length>0&&Hi(e),Af(r,new Uint8Array(a,o,i),!1))):xf(r)?(la(e,a,o,i),ca(r,Sl(e))):la(e,a,o,i),_i(e)}function nr(e,t){const r=e._controlledReadableByteStream;r._state==="readable"&&(ey(e),Fn(e),$u(e),$y(r,t))}function cy(e,t){const r=e._queue.shift();e._queueTotalSize-=r.byteLength,ay(e);const n=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);t._chunkSteps(n)}function Il(e){if(e._byobRequest===null&&e._pendingPullIntos.length>0){const t=e._pendingPullIntos.peek(),r=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled),n=Object.create(Ci.prototype);(function(o,i,a){o._associatedReadableByteStreamController=i,o._view=a})(n,e,r),e._byobRequest=n}return e._byobRequest}function ly(e){const t=e._controlledReadableByteStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function da(e,t){const r=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(t===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(r.bytesFilled+t>r.byteLength)throw new RangeError("bytesWritten out of range")}r.buffer=pi(r.buffer),uy(e,t)}function ha(e,t){const r=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(t.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(r.byteOffset+r.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(r.bufferByteLength!==t.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(r.bytesFilled+t.byteLength>r.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");const n=t.byteLength;r.buffer=pi(t.buffer),uy(e,n)}function fy(e,t,r,n,o,i,a){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=null,t._queue=t._queueTotalSize=void 0,Fn(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=i,t._pullAlgorithm=n,t._cancelAlgorithm=o,t._autoAllocateChunkSize=a,t._pendingPullIntos=new ur,e._readableStreamController=t,kt(Te(r()),()=>(t._started=!0,_i(t),null),u=>(nr(t,u),null))}function Oc(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function Eo(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function Q1(e,t){if((e=`${e}`)!="byob")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function dy(e){return new Qn(e)}function wh(e,t){e._reader._readIntoRequests.push(t)}function hy(e){return e._reader._readIntoRequests.length}function xf(e){const t=e._reader;return t!==void 0&&!!ri(t)}Object.defineProperties(In.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),Oe(In.prototype.close,"close"),Oe(In.prototype.enqueue,"enqueue"),Oe(In.prototype.error,"error"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(In.prototype,Symbol.toStringTag,{value:"ReadableByteStreamController",configurable:!0});class Qn{constructor(t){if(hi(t,1,"ReadableStreamBYOBReader"),Tf(t,"First parameter"),An(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!Yn(t._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");Mg(this,t),this._readIntoRequests=new ur}get closed(){return ri(this)?this._closedPromise:oe(ks("closed"))}cancel(t=void 0){return ri(this)?this._ownerReadableStream===void 0?oe(Da("cancel")):Sf(this,t):oe(ks("cancel"))}read(t,r={}){if(!ri(this))return oe(ks("read"));if(!ArrayBuffer.isView(t))return oe(new TypeError("view must be an array buffer view"));if(t.byteLength===0)return oe(new TypeError("view must have non-zero byteLength"));if(t.buffer.byteLength===0)return oe(new TypeError("view's buffer must have non-zero byteLength"));if(vi(t.buffer))return oe(new TypeError("view's buffer has been detached"));let n;try{n=function(l,s){var c;return an(l,s),{min:Of((c=l==null?void 0:l.min)!==null&&c!==void 0?c:1,`${s} has member 'min' that`)}}(r,"options")}catch(l){return oe(l)}const o=n.min;if(o===0)return oe(new TypeError("options.min must be greater than 0"));if(function(l){return Zg(l.constructor)}(t)){if(o>t.byteLength)return oe(new RangeError("options.min must be less than or equal to view's byteLength"))}else if(o>t.length)return oe(new RangeError("options.min must be less than or equal to view's length"));if(this._ownerReadableStream===void 0)return oe(Da("read from"));let i,a;const u=Je((l,s)=>{i=l,a=s});return py(this,t,o,{_chunkSteps:l=>i({value:l,done:!1}),_closeSteps:l=>i({value:l,done:!0}),_errorSteps:l=>a(l)}),u}releaseLock(){if(!ri(this))throw ks("releaseLock");this._ownerReadableStream!==void 0&&function(t){sn(t);const r=new TypeError("Reader was released");vy(t,r)}(this)}}function ri(e){return!!Ze(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")&&e instanceof Qn}function py(e,t,r,n){const o=e._ownerReadableStream;o._disturbed=!0,o._state==="errored"?n._errorSteps(o._storedError):Y1(o._readableStreamController,t,r,n)}function vy(e,t){const r=e._readIntoRequests;e._readIntoRequests=new ur,r.forEach(n=>{n._errorSteps(t)})}function ks(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function vs(e,t){const{highWaterMark:r}=e;if(r===void 0)return t;if(Xg(r)||r<0)throw new RangeError("Invalid highWaterMark");return r}function La(e){const{size:t}=e;return t||(()=>1)}function Ua(e,t){an(e,t);const r=e==null?void 0:e.highWaterMark,n=e==null?void 0:e.size;return{highWaterMark:r===void 0?void 0:qg(r),size:n===void 0?void 0:X1(n,`${t} has member 'size' that`)}}function X1(e,t){return cr(e,t),r=>qg(e(r))}function Z1(e,t,r){return cr(e,r),n=>hn(e,t,[n])}function eS(e,t,r){return cr(e,r),()=>hn(e,t,[])}function tS(e,t,r){return cr(e,r),n=>di(e,t,[n])}function rS(e,t,r){return cr(e,r),(n,o)=>hn(e,t,[n,o])}function my(e,t){if(!xi(e))throw new TypeError(`${t} is not a WritableStream.`)}Object.defineProperties(Qn.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),Oe(Qn.prototype.cancel,"cancel"),Oe(Qn.prototype.read,"read"),Oe(Qn.prototype.releaseLock,"releaseLock"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Qn.prototype,Symbol.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});class Xn{constructor(t={},r={}){t===void 0?t=null:kg(t,"First parameter");const n=Ua(r,"Second parameter"),o=function(a,u){an(a,u);const l=a==null?void 0:a.abort,s=a==null?void 0:a.close,c=a==null?void 0:a.start,f=a==null?void 0:a.type,d=a==null?void 0:a.write;return{abort:l===void 0?void 0:Z1(l,a,`${u} has member 'abort' that`),close:s===void 0?void 0:eS(s,a,`${u} has member 'close' that`),start:c===void 0?void 0:tS(c,a,`${u} has member 'start' that`),write:d===void 0?void 0:rS(d,a,`${u} has member 'write' that`),type:f}}(t,"First parameter");if(yy(this),o.type!==void 0)throw new RangeError("Invalid type is specified");const i=La(n);(function(a,u,l,s){const c=Object.create(ms.prototype);let f,d,v,g;f=u.start!==void 0?()=>u.start(c):()=>{},d=u.write!==void 0?b=>u.write(b,c):()=>Te(void 0),v=u.close!==void 0?()=>u.close():()=>Te(void 0),g=u.abort!==void 0?b=>u.abort(b):()=>Te(void 0),Oy(a,c,f,d,v,g,l,s)})(this,o,vs(n,1),i)}get locked(){if(!xi(this))throw Ws("locked");return Gi(this)}abort(t=void 0){return xi(this)?Gi(this)?oe(new TypeError("Cannot abort a stream that already has a writer")):Fa(this,t):oe(Ws("abort"))}close(){return xi(this)?Gi(this)?oe(new TypeError("Cannot close a stream that already has a writer")):Mr(this)?oe(new TypeError("Cannot close an already-closing stream")):_y(this):oe(Ws("close"))}getWriter(){if(!xi(this))throw Ws("getWriter");return gy(this)}}function gy(e){return new _n(e)}function yy(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new ur,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function xi(e){return!!Ze(e)&&!!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")&&e instanceof Xn}function Gi(e){return e._writer!==void 0}function Fa(e,t){var r;if(e._state==="closed"||e._state==="errored")return Te(void 0);e._writableStreamController._abortReason=t,(r=e._writableStreamController._abortController)===null||r===void 0||r.abort(t);const n=e._state;if(n==="closed"||n==="errored")return Te(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let o=!1;n==="erroring"&&(o=!0,t=void 0);const i=Je((a,u)=>{e._pendingAbortRequest={_promise:void 0,_resolve:a,_reject:u,_reason:t,_wasAlreadyErroring:o}});return e._pendingAbortRequest._promise=i,o||Pf(e,t),i}function _y(e){const t=e._state;if(t==="closed"||t==="errored")return oe(new TypeError(`The stream (in ${t} state) is not in the writable state and cannot be closed`));const r=Je((i,a)=>{const u={_resolve:i,_reject:a};e._closeRequest=u}),n=e._writer;var o;return n!==void 0&&e._backpressure&&t==="writable"&&Uf(n),Rf(o=e._writableStreamController,Iy,0),Du(o),r}function Ol(e,t){e._state!=="writable"?Nf(e):Pf(e,t)}function Pf(e,t){const r=e._writableStreamController;e._state="erroring",e._storedError=t;const n=e._writer;n!==void 0&&wy(n,t),!function(o){return!(o._inFlightWriteRequest===void 0&&o._inFlightCloseRequest===void 0)}(e)&&r._started&&Nf(e)}function Nf(e){e._state="errored",e._writableStreamController[Fg]();const t=e._storedError;if(e._writeRequests.forEach(n=>{n._reject(t)}),e._writeRequests=new ur,e._pendingAbortRequest===void 0)return void qs(e);const r=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,r._wasAlreadyErroring)return r._reject(t),void qs(e);kt(e._writableStreamController[Ug](r._reason),()=>(r._resolve(),qs(e),null),n=>(r._reject(n),qs(e),null))}function Mr(e){return e._closeRequest!==void 0||e._inFlightCloseRequest!==void 0}function qs(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);const t=e._writer;t!==void 0&&Lf(t,e._storedError)}function $f(e,t){const r=e._writer;r!==void 0&&t!==e._backpressure&&(t?function(n){Lu(n)}(r):Uf(r)),e._backpressure=t}Object.defineProperties(Xn.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),Oe(Xn.prototype.abort,"abort"),Oe(Xn.prototype.close,"close"),Oe(Xn.prototype.getWriter,"getWriter"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Xn.prototype,Symbol.toStringTag,{value:"WritableStream",configurable:!0});class _n{constructor(t){if(hi(t,1,"WritableStreamDefaultWriter"),my(t,"First parameter"),Gi(t))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=t,t._writer=this;const r=t._state;if(r==="writable")!Mr(t)&&t._backpressure?Lu(this):Eh(this),pa(this);else if(r==="erroring")Tl(this,t._storedError),pa(this);else if(r==="closed")Eh(this),pa(n=this),Cy(n);else{const o=t._storedError;Tl(this,o),Ry(this,o)}var n}get closed(){return kn(this)?this._closedPromise:oe(qn("closed"))}get desiredSize(){if(!kn(this))throw qn("desiredSize");if(this._ownerWritableStream===void 0)throw ko("desiredSize");return function(t){const r=t._ownerWritableStream,n=r._state;return n==="errored"||n==="erroring"?null:n==="closed"?0:Ty(r._writableStreamController)}(this)}get ready(){return kn(this)?this._readyPromise:oe(qn("ready"))}abort(t=void 0){return kn(this)?this._ownerWritableStream===void 0?oe(ko("abort")):function(r,n){return Fa(r._ownerWritableStream,n)}(this,t):oe(qn("abort"))}close(){if(!kn(this))return oe(qn("close"));const t=this._ownerWritableStream;return t===void 0?oe(ko("close")):Mr(t)?oe(new TypeError("Cannot close an already-closing stream")):by(this)}releaseLock(){if(!kn(this))throw qn("releaseLock");this._ownerWritableStream!==void 0&&Ey(this)}write(t=void 0){return kn(this)?this._ownerWritableStream===void 0?oe(ko("write to")):Sy(this,t):oe(qn("write"))}}function kn(e){return!!Ze(e)&&!!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")&&e instanceof _n}function by(e){return _y(e._ownerWritableStream)}function nS(e,t){e._closedPromiseState==="pending"?Lf(e,t):function(r,n){Ry(r,n)}(e,t)}function wy(e,t){e._readyPromiseState==="pending"?xy(e,t):function(r,n){Tl(r,n)}(e,t)}function Ey(e){const t=e._ownerWritableStream,r=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");wy(e,r),nS(e,r),t._writer=void 0,e._ownerWritableStream=void 0}function Sy(e,t){const r=e._ownerWritableStream,n=r._writableStreamController,o=function(u,l){if(u._strategySizeAlgorithm===void 0)return 1;try{return u._strategySizeAlgorithm(l)}catch(s){return gs(u,s),1}}(n,t);if(r!==e._ownerWritableStream)return oe(ko("write to"));const i=r._state;if(i==="errored")return oe(r._storedError);if(Mr(r)||i==="closed")return oe(new TypeError("The stream is closing or closed and cannot be written to"));if(i==="erroring")return oe(r._storedError);const a=function(u){return Je((l,s)=>{const c={_resolve:l,_reject:s};u._writeRequests.push(c)})}(r);return function(u,l,s){try{Rf(u,l,s)}catch(f){return void gs(u,f)}const c=u._controlledWritableStream;!Mr(c)&&c._state==="writable"&&$f(c,Df(u)),Du(u)}(n,t,o),a}Object.defineProperties(_n.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),Oe(_n.prototype.abort,"abort"),Oe(_n.prototype.close,"close"),Oe(_n.prototype.releaseLock,"releaseLock"),Oe(_n.prototype.write,"write"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(_n.prototype,Symbol.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});const Iy={};class ms{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Tc(this))throw Ac("abortReason");return this._abortReason}get signal(){if(!Tc(this))throw Ac("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(t=void 0){if(!Tc(this))throw Ac("error");this._controlledWritableStream._state==="writable"&&Ay(this,t)}[Ug](t){const r=this._abortAlgorithm(t);return Ma(this),r}[Fg](){Fn(this)}}function Tc(e){return!!Ze(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")&&e instanceof ms}function Oy(e,t,r,n,o,i,a,u){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,Fn(t),t._abortReason=void 0,t._abortController=function(){if(typeof AbortController=="function")return new AbortController}(),t._started=!1,t._strategySizeAlgorithm=u,t._strategyHWM=a,t._writeAlgorithm=n,t._closeAlgorithm=o,t._abortAlgorithm=i;const l=Df(t);$f(e,l),kt(Te(r()),()=>(t._started=!0,Du(t),null),s=>(t._started=!0,Ol(e,s),null))}function Ma(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Ty(e){return e._strategyHWM-e._queueTotalSize}function Du(e){const t=e._controlledWritableStream;if(!e._started||t._inFlightWriteRequest!==void 0)return;if(t._state==="erroring")return void Nf(t);if(e._queue.length===0)return;const r=e._queue.peek().value;r===Iy?function(n){const o=n._controlledWritableStream;(function(a){a._inFlightCloseRequest=a._closeRequest,a._closeRequest=void 0})(o),El(n);const i=n._closeAlgorithm();Ma(n),kt(i,()=>(function(a){a._inFlightCloseRequest._resolve(void 0),a._inFlightCloseRequest=void 0,a._state==="erroring"&&(a._storedError=void 0,a._pendingAbortRequest!==void 0&&(a._pendingAbortRequest._resolve(),a._pendingAbortRequest=void 0)),a._state="closed";const u=a._writer;u!==void 0&&Cy(u)}(o),null),a=>(function(u,l){u._inFlightCloseRequest._reject(l),u._inFlightCloseRequest=void 0,u._pendingAbortRequest!==void 0&&(u._pendingAbortRequest._reject(l),u._pendingAbortRequest=void 0),Ol(u,l)}(o,a),null))}(e):function(n,o){const i=n._controlledWritableStream;(function(u){u._inFlightWriteRequest=u._writeRequests.shift()})(i);const a=n._writeAlgorithm(o);kt(a,()=>{(function(l){l._inFlightWriteRequest._resolve(void 0),l._inFlightWriteRequest=void 0})(i);const u=i._state;if(El(n),!Mr(i)&&u==="writable"){const l=Df(n);$f(i,l)}return Du(n),null},u=>(i._state==="writable"&&Ma(n),function(l,s){l._inFlightWriteRequest._reject(s),l._inFlightWriteRequest=void 0,Ol(l,s)}(i,u),null))}(e,r)}function gs(e,t){e._controlledWritableStream._state==="writable"&&Ay(e,t)}function Df(e){return Ty(e)<=0}function Ay(e,t){const r=e._controlledWritableStream;Ma(e),Pf(r,t)}function Ws(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function Ac(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function qn(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function ko(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function pa(e){e._closedPromise=Je((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r,e._closedPromiseState="pending"})}function Ry(e,t){pa(e),Lf(e,t)}function Lf(e,t){e._closedPromise_reject!==void 0&&(so(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function Cy(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function Lu(e){e._readyPromise=Je((t,r)=>{e._readyPromise_resolve=t,e._readyPromise_reject=r}),e._readyPromiseState="pending"}function Tl(e,t){Lu(e),xy(e,t)}function Eh(e){Lu(e),Uf(e)}function xy(e,t){e._readyPromise_reject!==void 0&&(so(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function Uf(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}Object.defineProperties(ms.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ms.prototype,Symbol.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});const Sh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:void 0,iS=function(){const e=Sh==null?void 0:Sh.DOMException;return function(t){if(typeof t!="function"&&typeof t!="object"||t.name!=="DOMException")return!1;try{return new t,!0}catch{return!1}}(e)?e:void 0}()||function(){const e=function(t,r){this.message=t||"",this.name=r||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return Oe(e,"DOMException"),e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}();function Ih(e,t,r,n,o,i){const a=Wi(e),u=gy(t);e._disturbed=!0;let l=!1,s=Te(void 0);return Je((c,f)=>{let d;if(i!==void 0){if(d=()=>{const R=i.reason!==void 0?i.reason:new iS("Aborted","AbortError"),$=[];n||$.push(()=>t._state==="writable"?Fa(t,R):Te(void 0)),o||$.push(()=>e._state==="readable"?vr(e,R):Te(void 0)),E(()=>Promise.all($.map(L=>L())),!0,R)},i.aborted)return void d();i.addEventListener("abort",d)}var v,g,b;if(_(e,a._closedPromise,R=>(n?A(!0,R):E(()=>Fa(t,R),!0,R),null)),_(t,u._closedPromise,R=>(o?A(!0,R):E(()=>vr(e,R),!0,R),null)),v=e,g=a._closedPromise,b=()=>(r?A():E(()=>function(R){const $=R._ownerWritableStream,L=$._state;return Mr($)||L==="closed"?Te(void 0):L==="errored"?oe($._storedError):by(R)}(u)),null),v._state==="closed"?b():bc(g,b),Mr(t)||t._state==="closed"){const R=new TypeError("the destination writable stream closed before all data could be piped to it");o?A(!0,R):E(()=>vr(e,R),!0,R)}function w(){const R=s;return Fr(s,()=>R!==s?w():void 0)}function _(R,$,L){R._state==="errored"?L(R._storedError):bl($,L)}function E(R,$,L){function D(){return kt(R(),()=>I($,L),P=>I(!0,P)),null}l||(l=!0,t._state!=="writable"||Mr(t)?D():bc(w(),D))}function A(R,$){l||(l=!0,t._state!=="writable"||Mr(t)?I(R,$):bc(w(),()=>I(R,$)))}function I(R,$){return Ey(u),sn(a),i!==void 0&&i.removeEventListener("abort",d),R?f($):c(void 0),null}so(Je((R,$)=>{(function L(D){D?R():Fr(l?Te(!0):Fr(u._readyPromise,()=>Je((P,k)=>{ps(a,{_chunkSteps:F=>{s=Fr(Sy(u,F),void 0,hs),P(!1)},_closeSteps:()=>P(!0),_errorSteps:k})})),L,$)})(!1)}))})}class On{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Hs(this))throw Gs("desiredSize");return Ff(this)}close(){if(!Hs(this))throw Gs("close");if(!eo(this))throw new TypeError("The stream is not in a state that permits close");mi(this)}enqueue(t=void 0){if(!Hs(this))throw Gs("enqueue");if(!eo(this))throw new TypeError("The stream is not in a state that permits enqueue");return Zi(this,t)}error(t=void 0){if(!Hs(this))throw Gs("error");br(this,t)}[bf](t){Fn(this);const r=this._cancelAlgorithm(t);return Ba(this),r}[wf](t){const r=this._controlledReadableStream;if(this._queue.length>0){const n=El(this);this._closeRequested&&this._queue.length===0?(Ba(this),$s(r)):ys(this),t._chunkSteps(n)}else Wg(r,t),ys(this)}[Ef](){}}function Hs(e){return!!Ze(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")&&e instanceof On}function ys(e){if(Py(e)){if(e._pulling)return void(e._pullAgain=!0);e._pulling=!0,kt(e._pullAlgorithm(),()=>(e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,ys(e)),null),t=>(br(e,t),null))}}function Py(e){const t=e._controlledReadableStream;return!eo(e)||!e._started?!1:An(t)&&Nu(t)>0?!0:Ff(e)>0}function Ba(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function mi(e){if(!eo(e))return;const t=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(Ba(e),$s(t))}function Zi(e,t){if(!eo(e))return;const r=e._controlledReadableStream;if(An(r)&&Nu(r)>0)Af(r,t,!1);else{let n;try{n=e._strategySizeAlgorithm(t)}catch(o){throw br(e,o),o}try{Rf(e,t,n)}catch(o){throw br(e,o),o}}ys(e)}function br(e,t){const r=e._controlledReadableStream;r._state==="readable"&&(Fn(e),Ba(e),$y(r,t))}function Ff(e){const t=e._controlledReadableStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function eo(e){const t=e._controlledReadableStream._state;return!e._closeRequested&&t==="readable"}function Ny(e,t,r,n,o,i,a){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,Fn(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=a,t._strategyHWM=i,t._pullAlgorithm=n,t._cancelAlgorithm=o,e._readableStreamController=t,kt(Te(r()),()=>(t._started=!0,ys(t),null),u=>(br(t,u),null))}function Gs(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function oS(e,t){return Yn(e._readableStreamController)?function(r){let n,o,i,a,u,l=Wi(r),s=!1,c=!1,f=!1,d=!1,v=!1;const g=Je(L=>{u=L});function b(L){bl(L._closedPromise,D=>(L!==l||(nr(i._readableStreamController,D),nr(a._readableStreamController,D),d&&v||u(void 0)),null))}function w(){ri(l)&&(sn(l),l=Wi(r),b(l)),ps(l,{_chunkSteps:L=>{ai(()=>{c=!1,f=!1;const D=L;let P=L;if(!d&&!v)try{P=bh(L)}catch(k){return nr(i._readableStreamController,k),nr(a._readableStreamController,k),void u(vr(r,k))}d||fa(i._readableStreamController,D),v||fa(a._readableStreamController,P),s=!1,c?E():f&&A()})},_closeSteps:()=>{s=!1,d||jo(i._readableStreamController),v||jo(a._readableStreamController),i._readableStreamController._pendingPullIntos.length>0&&da(i._readableStreamController,0),a._readableStreamController._pendingPullIntos.length>0&&da(a._readableStreamController,0),d&&v||u(void 0)},_errorSteps:()=>{s=!1}})}function _(L,D){Tn(l)&&(sn(l),l=dy(r),b(l));const P=D?a:i,k=D?i:a;py(l,L,1,{_chunkSteps:F=>{ai(()=>{c=!1,f=!1;const Q=D?v:d;if(D?d:v)Q||ha(P._readableStreamController,F);else{let ce;try{ce=bh(F)}catch(B){return nr(P._readableStreamController,B),nr(k._readableStreamController,B),void u(vr(r,B))}Q||ha(P._readableStreamController,F),fa(k._readableStreamController,ce)}s=!1,c?E():f&&A()})},_closeSteps:F=>{s=!1;const Q=D?v:d,ce=D?d:v;Q||jo(P._readableStreamController),ce||jo(k._readableStreamController),F!==void 0&&(Q||ha(P._readableStreamController,F),!ce&&k._readableStreamController._pendingPullIntos.length>0&&da(k._readableStreamController,0)),Q&&ce||u(void 0)},_errorSteps:()=>{s=!1}})}function E(){if(s)return c=!0,Te(void 0);s=!0;const L=Il(i._readableStreamController);return L===null?w():_(L._view,!1),Te(void 0)}function A(){if(s)return f=!0,Te(void 0);s=!0;const L=Il(a._readableStreamController);return L===null?w():_(L._view,!0),Te(void 0)}function I(L){if(d=!0,n=L,v){const D=Mo([n,o]),P=vr(r,D);u(P)}return g}function R(L){if(v=!0,o=L,d){const D=Mo([n,o]),P=vr(r,D);u(P)}return g}function $(){}return i=Th($,E,I),a=Th($,A,R),b(l),[i,a]}(e):function(r){const n=Wi(r);let o,i,a,u,l,s=!1,c=!1,f=!1,d=!1;const v=Je(E=>{l=E});function g(){return s?(c=!0,Te(void 0)):(s=!0,ps(n,{_chunkSteps:E=>{ai(()=>{c=!1;const A=E,I=E;f||Zi(a._readableStreamController,A),d||Zi(u._readableStreamController,I),s=!1,c&&g()})},_closeSteps:()=>{s=!1,f||mi(a._readableStreamController),d||mi(u._readableStreamController),f&&d||l(void 0)},_errorSteps:()=>{s=!1}}),Te(void 0))}function b(E){if(f=!0,o=E,d){const A=Mo([o,i]),I=vr(r,A);l(I)}return v}function w(E){if(d=!0,i=E,f){const A=Mo([o,i]),I=vr(r,A);l(I)}return v}function _(){}return a=_s(_,g,b),u=_s(_,g,w),bl(n._closedPromise,E=>(br(a._readableStreamController,E),br(u._readableStreamController,E),f&&d||l(void 0),null)),[a,u]}(e)}function sS(e){return Ze(t=e)&&t.getReader!==void 0?function(r){let n;function o(){let a;try{a=r.read()}catch(u){return oe(u)}return un(a,u=>{if(!Ze(u))throw new TypeError("The promise returned by the reader.read() method must fulfill with an object");if(u.done)mi(n._readableStreamController);else{const l=u.value;Zi(n._readableStreamController,l)}})}function i(a){try{return Te(r.cancel(a))}catch(u){return oe(u)}}return n=_s(hs,o,i,0),n}(e.getReader()):function(r){let n;const o=zg(r,"async");function i(){let u;try{u=Jg(o)}catch(l){return oe(l)}return un(Te(u),l=>{if(!Ze(l))throw new TypeError("The promise returned by the iterator.next() method must fulfill with an object");if(l.done)mi(n._readableStreamController);else{const s=l.value;Zi(n._readableStreamController,s)}})}function a(u){const l=o.iterator;let s;try{s=Bo(l,"return")}catch(c){return oe(c)}return s===void 0?Te(void 0):un(hn(s,l,[u]),c=>{if(!Ze(c))throw new TypeError("The promise returned by the iterator.return() method must fulfill with an object")})}return n=_s(hs,i,a,0),n}(e);var t}function aS(e,t,r){return cr(e,r),n=>hn(e,t,[n])}function uS(e,t,r){return cr(e,r),n=>hn(e,t,[n])}function cS(e,t,r){return cr(e,r),n=>di(e,t,[n])}function lS(e,t){if((e=`${e}`)!="bytes")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function Oh(e,t){an(e,t);const r=e==null?void 0:e.preventAbort,n=e==null?void 0:e.preventCancel,o=e==null?void 0:e.preventClose,i=e==null?void 0:e.signal;return i!==void 0&&function(a,u){if(!function(l){if(typeof l!="object"||l===null)return!1;try{return typeof l.aborted=="boolean"}catch{return!1}}(a))throw new TypeError(`${u} is not an AbortSignal.`)}(i,`${t} has member 'signal' that`),{preventAbort:!!r,preventCancel:!!n,preventClose:!!o,signal:i}}Object.defineProperties(On.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),Oe(On.prototype.close,"close"),Oe(On.prototype.enqueue,"enqueue"),Oe(On.prototype.error,"error"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(On.prototype,Symbol.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});let st=class{constructor(t={},r={}){t===void 0?t=null:kg(t,"First parameter");const n=Ua(r,"Second parameter"),o=function(i,a){an(i,a);const u=i,l=u==null?void 0:u.autoAllocateChunkSize,s=u==null?void 0:u.cancel,c=u==null?void 0:u.pull,f=u==null?void 0:u.start,d=u==null?void 0:u.type;return{autoAllocateChunkSize:l===void 0?void 0:Of(l,`${a} has member 'autoAllocateChunkSize' that`),cancel:s===void 0?void 0:aS(s,u,`${a} has member 'cancel' that`),pull:c===void 0?void 0:uS(c,u,`${a} has member 'pull' that`),start:f===void 0?void 0:cS(f,u,`${a} has member 'start' that`),type:d===void 0?void 0:lS(d,`${a} has member 'type' that`)}}(t,"First parameter");if(Mf(this),o.type==="bytes"){if(n.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");(function(i,a,u){const l=Object.create(In.prototype);let s,c,f;s=a.start!==void 0?()=>a.start(l):()=>{},c=a.pull!==void 0?()=>a.pull(l):()=>Te(void 0),f=a.cancel!==void 0?v=>a.cancel(v):()=>Te(void 0);const d=a.autoAllocateChunkSize;if(d===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");fy(i,l,s,c,f,u,d)})(this,o,vs(n,0))}else{const i=La(n);(function(a,u,l,s){const c=Object.create(On.prototype);let f,d,v;f=u.start!==void 0?()=>u.start(c):()=>{},d=u.pull!==void 0?()=>u.pull(c):()=>Te(void 0),v=u.cancel!==void 0?g=>u.cancel(g):()=>Te(void 0),Ny(a,c,f,d,v,l,s)})(this,o,vs(n,1),i)}}get locked(){if(!vn(this))throw Wn("locked");return An(this)}cancel(t=void 0){return vn(this)?An(this)?oe(new TypeError("Cannot cancel a stream that already has a reader")):vr(this,t):oe(Wn("cancel"))}getReader(t=void 0){if(!vn(this))throw Wn("getReader");return function(r,n){an(r,n);const o=r==null?void 0:r.mode;return{mode:o===void 0?void 0:Q1(o,`${n} has member 'mode' that`)}}(t,"First parameter").mode===void 0?Wi(this):dy(this)}pipeThrough(t,r={}){if(!vn(this))throw Wn("pipeThrough");hi(t,1,"pipeThrough");const n=function(i,a){an(i,a);const u=i==null?void 0:i.readable;vh(u,"readable","ReadableWritablePair"),Tf(u,`${a} has member 'readable' that`);const l=i==null?void 0:i.writable;return vh(l,"writable","ReadableWritablePair"),my(l,`${a} has member 'writable' that`),{readable:u,writable:l}}(t,"First parameter"),o=Oh(r,"Second parameter");if(An(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(Gi(n.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");return so(Ih(this,n.writable,o.preventClose,o.preventAbort,o.preventCancel,o.signal)),n.readable}pipeTo(t,r={}){if(!vn(this))return oe(Wn("pipeTo"));if(t===void 0)return oe("Parameter 1 is required in 'pipeTo'.");if(!xi(t))return oe(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let n;try{n=Oh(r,"Second parameter")}catch(o){return oe(o)}return An(this)?oe(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):Gi(t)?oe(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Ih(this,t,n.preventClose,n.preventAbort,n.preventCancel,n.signal)}tee(){if(!vn(this))throw Wn("tee");return Mo(oS(this))}values(t=void 0){if(!vn(this))throw Wn("values");return function(r,n){const o=Wi(r),i=new Yg(o,n),a=Object.create(Qg);return a._asyncIteratorImpl=i,a}(this,function(r,n){return an(r,n),{preventCancel:!!(r==null?void 0:r.preventCancel)}}(t,"First parameter").preventCancel)}[Ns](t){return this.values(t)}static from(t){return sS(t)}};function _s(e,t,r,n=1,o=()=>1){const i=Object.create(st.prototype);return Mf(i),Ny(i,Object.create(On.prototype),e,t,r,n,o),i}function Th(e,t,r){const n=Object.create(st.prototype);return Mf(n),fy(n,Object.create(In.prototype),e,t,r,0,void 0),n}function Mf(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function vn(e){return!!Ze(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")&&e instanceof st}function An(e){return e._reader!==void 0}function vr(e,t){if(e._disturbed=!0,e._state==="closed")return Te(void 0);if(e._state==="errored")return oe(e._storedError);$s(e);const r=e._reader;if(r!==void 0&&ri(r)){const n=r._readIntoRequests;r._readIntoRequests=new ur,n.forEach(o=>{o._closeSteps(void 0)})}return un(e._readableStreamController[bf](t),hs)}function $s(e){e._state="closed";const t=e._reader;if(t!==void 0&&(jg(t),Tn(t))){const r=t._readRequests;t._readRequests=new ur,r.forEach(n=>{n._closeSteps()})}}function $y(e,t){e._state="errored",e._storedError=t;const r=e._reader;r!==void 0&&(If(r,t),Tn(r)?Gg(r,t):vy(r,t))}function Wn(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}Object.defineProperties(st,{from:{enumerable:!0}}),Object.defineProperties(st.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),Oe(st.from,"from"),Oe(st.prototype.cancel,"cancel"),Oe(st.prototype.getReader,"getReader"),Oe(st.prototype.pipeThrough,"pipeThrough"),Oe(st.prototype.pipeTo,"pipeTo"),Oe(st.prototype.tee,"tee"),Oe(st.prototype.values,"values"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(st.prototype,Symbol.toStringTag,{value:"ReadableStream",configurable:!0}),Object.defineProperty(st.prototype,Ns,{value:st.prototype.values,writable:!0,configurable:!0});const fS=e=>e.byteLength;Oe(fS,"size");const dS=()=>1;Oe(dS,"size");function hS(e,t,r){return cr(e,r),n=>hn(e,t,[n])}function pS(e,t,r){return cr(e,r),n=>di(e,t,[n])}function vS(e,t,r){return cr(e,r),(n,o)=>hn(e,t,[n,o])}function mS(e,t,r){return cr(e,r),n=>hn(e,t,[n])}let ja=class{constructor(t={},r={},n={}){t===void 0&&(t=null);const o=Ua(r,"Second parameter"),i=Ua(n,"Third parameter"),a=function(d,v){an(d,v);const g=d==null?void 0:d.cancel,b=d==null?void 0:d.flush,w=d==null?void 0:d.readableType,_=d==null?void 0:d.start,E=d==null?void 0:d.transform,A=d==null?void 0:d.writableType;return{cancel:g===void 0?void 0:mS(g,d,`${v} has member 'cancel' that`),flush:b===void 0?void 0:hS(b,d,`${v} has member 'flush' that`),readableType:w,start:_===void 0?void 0:pS(_,d,`${v} has member 'start' that`),transform:E===void 0?void 0:vS(E,d,`${v} has member 'transform' that`),writableType:A}}(t,"First parameter");if(a.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(a.writableType!==void 0)throw new RangeError("Invalid writableType specified");const u=vs(i,0),l=La(i),s=vs(o,1),c=La(o);let f;(function(d,v,g,b,w,_){function E(){return v}function A(D){return function(P,k){const F=P._transformStreamController;return P._backpressure?un(P._backpressureChangePromise,()=>{const Q=P._writable;if(Q._state==="erroring")throw Q._storedError;return Rh(F,k)}):Rh(F,k)}(d,D)}function I(D){return function(P,k){const F=P._transformStreamController;if(F._finishPromise!==void 0)return F._finishPromise;const Q=P._readable;F._finishPromise=Je((B,fe)=>{F._finishPromise_resolve=B,F._finishPromise_reject=fe});const ce=F._cancelAlgorithm(k);return va(F),kt(ce,()=>(Q._state==="errored"?Ei(F,Q._storedError):(br(Q._readableStreamController,k),Rc(F)),null),B=>(br(Q._readableStreamController,B),Ei(F,B),null)),F._finishPromise}(d,D)}function R(){return function(D){const P=D._transformStreamController;if(P._finishPromise!==void 0)return P._finishPromise;const k=D._readable;P._finishPromise=Je((Q,ce)=>{P._finishPromise_resolve=Q,P._finishPromise_reject=ce});const F=P._flushAlgorithm();return va(P),kt(F,()=>(k._state==="errored"?Ei(P,k._storedError):(mi(k._readableStreamController),Rc(P)),null),Q=>(br(k._readableStreamController,Q),Ei(P,Q),null)),P._finishPromise}(d)}function $(){return function(D){return ka(D,!1),D._backpressureChangePromise}(d)}function L(D){return function(P,k){const F=P._transformStreamController;if(F._finishPromise!==void 0)return F._finishPromise;const Q=P._writable;F._finishPromise=Je((B,fe)=>{F._finishPromise_resolve=B,F._finishPromise_reject=fe});const ce=F._cancelAlgorithm(k);return va(F),kt(ce,()=>(Q._state==="errored"?Ei(F,Q._storedError):(gs(Q._writableStreamController,k),Al(P),Rc(F)),null),B=>(gs(Q._writableStreamController,B),Al(P),Ei(F,B),null)),F._finishPromise}(d,D)}d._writable=function(D,P,k,F,Q=1,ce=()=>1){const B=Object.create(Xn.prototype);return yy(B),Oy(B,Object.create(ms.prototype),D,P,k,F,Q,ce),B}(E,A,R,I,g,b),d._readable=_s(E,$,L,w,_),d._backpressure=void 0,d._backpressureChangePromise=void 0,d._backpressureChangePromise_resolve=void 0,ka(d,!0),d._transformStreamController=void 0})(this,Je(d=>{f=d}),s,c,u,l),function(d,v){const g=Object.create(Zn.prototype);let b,w,_;b=v.transform!==void 0?E=>v.transform(E,g):E=>{try{return Ly(g,E),Te(void 0)}catch(A){return oe(A)}},w=v.flush!==void 0?()=>v.flush(g):()=>Te(void 0),_=v.cancel!==void 0?E=>v.cancel(E):()=>Te(void 0),function(E,A,I,R,$){A._controlledTransformStream=E,E._transformStreamController=A,A._transformAlgorithm=I,A._flushAlgorithm=R,A._cancelAlgorithm=$,A._finishPromise=void 0,A._finishPromise_resolve=void 0,A._finishPromise_reject=void 0}(d,g,b,w,_)}(this,a),a.start!==void 0?f(a.start(this._transformStreamController)):f(void 0)}get readable(){if(!Ah(this))throw Ch("readable");return this._readable}get writable(){if(!Ah(this))throw Ch("writable");return this._writable}};function Ah(e){return!!Ze(e)&&!!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")&&e instanceof ja}function Dy(e,t){br(e._readable._readableStreamController,t),Bf(e,t)}function Bf(e,t){va(e._transformStreamController),gs(e._writable._writableStreamController,t),Al(e)}function Al(e){e._backpressure&&ka(e,!1)}function ka(e,t){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=Je(r=>{e._backpressureChangePromise_resolve=r}),e._backpressure=t}Object.defineProperties(ja.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ja.prototype,Symbol.toStringTag,{value:"TransformStream",configurable:!0});class Zn{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Vs(this))throw Ks("desiredSize");return Ff(this._controlledTransformStream._readable._readableStreamController)}enqueue(t=void 0){if(!Vs(this))throw Ks("enqueue");Ly(this,t)}error(t=void 0){if(!Vs(this))throw Ks("error");var r;r=t,Dy(this._controlledTransformStream,r)}terminate(){if(!Vs(this))throw Ks("terminate");(function(t){const r=t._controlledTransformStream;mi(r._readable._readableStreamController);const n=new TypeError("TransformStream terminated");Bf(r,n)})(this)}}function Vs(e){return!!Ze(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")&&e instanceof Zn}function va(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0,e._cancelAlgorithm=void 0}function Ly(e,t){const r=e._controlledTransformStream,n=r._readable._readableStreamController;if(!eo(n))throw new TypeError("Readable side is not in a state that permits enqueue");try{Zi(n,t)}catch(i){throw Bf(r,i),r._readable._storedError}(function(i){return!Py(i)})(n)!==r._backpressure&&ka(r,!0)}function Rh(e,t){return un(e._transformAlgorithm(t),void 0,r=>{throw Dy(e._controlledTransformStream,r),r})}function Ks(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function Rc(e){e._finishPromise_resolve!==void 0&&(e._finishPromise_resolve(),e._finishPromise_resolve=void 0,e._finishPromise_reject=void 0)}function Ei(e,t){e._finishPromise_reject!==void 0&&(so(e._finishPromise),e._finishPromise_reject(t),e._finishPromise_resolve=void 0,e._finishPromise_reject=void 0)}function Ch(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}Object.defineProperties(Zn.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),Oe(Zn.prototype.enqueue,"enqueue"),Oe(Zn.prototype.error,"error"),Oe(Zn.prototype.terminate,"terminate"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Zn.prototype,Symbol.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});var gS=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),qa=function(){return qa=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},qa.apply(this,arguments)},yS=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},_S=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function bS(){if(typeof wx>"u"||typeof Page>"u"||!wx.getSystemInfoSync||!wx.getStorageSync||!wx.setStorageSync||!wx.connectSocket||!wx.request)return!1;try{if(!wx.getSystemInfoSync()||wx.getSystemInfoSync().AppPlatform==="qq")return!1}catch{return!1}return!0}function wS(){return typeof App>"u"&&typeof getApp>"u"&&!wx.onAppHide&&!wx.offAppHide&&!wx.onAppShow&&!wx.offAppShow}var xh="Error when aborting requestTask",ES=function(e){gS(t,e);function t(r){r===void 0&&(r={});var n=e.call(this)||this,o=r.timeout,i=r.timeoutMsg,a=r.restrictedMethods;return n._timeout=o||0,n._timeoutMsg=i||"请求超时",n._restrictedMethods=a||["get","post","upload","download"],n}return t.prototype.post=function(r){var n=this;return new Promise(function(o,i){var a=r.url,u=r.data,l=r.headers,s=wx.request({url:ua("https:",a),data:u,timeout:n._timeout,method:"POST",header:l,success:function(c){o(c)},fail:function(c){i(c)},complete:function(c){if(!(!c||!c.errMsg)&&!(!n._timeout||n._restrictedMethods.indexOf("post")===-1)){var f=c.errMsg;if(f==="request:fail timeout"){console.warn(n._timeoutMsg);try{s.abort()}catch{}}}}})})},t.prototype.upload=function(r){var n=this,o=this;return new Promise(function(i){return yS(n,void 0,void 0,function(){var a,u,l,s,c,f;return _S(this,function(d){return a=r.url,u=r.file,l=r.data,s=r.headers,c=r.onUploadProgress,f=wx.uploadFile({url:a,filePath:u,name:"file",formData:qa({},l),header:s,timeout:this._timeout,success:function(v){var g={statusCode:v.statusCode,data:v.data||{}};v.statusCode===200&&l.success_action_status&&(g.statusCode=parseInt(l.success_action_status,10)),i(g)},fail:function(v){i(v)},complete:function(v){if(!(!v||!v.errMsg)&&!(!o._timeout||o._restrictedMethods.indexOf("upload")===-1)){var g=v.errMsg;if(g==="request:fail timeout"){console.warn(o._timeoutMsg);try{f.abort()}catch{}}}}}),c&&f.onProgressUpdate(function(v){c(v)}),[2]})})})},t.prototype.download=function(r){var n=this,o=this;return new Promise(function(i,a){var u=r.url,l=r.headers,s=wx.downloadFile({url:ua("https:",u),header:l,timeout:n._timeout,success:function(c){c.statusCode===200&&c.tempFilePath?i({statusCode:200,tempFilePath:c.tempFilePath}):i(c)},fail:function(c){a(c)},complete:function(c){if(!(!c||!c.errMsg)&&!(!o._timeout||o._restrictedMethods.indexOf("download")===-1)){var f=c.errMsg;if(f==="request:fail timeout"){console.warn(o._timeoutMsg);try{s.abort()}catch{}}}}})})},t.prototype.fetch=function(r){var n=r.url,o=r.body,i=r.enableAbort,a=r.headers,u=r.method,l=r.stream,s=l===void 0?!1:l,c=r.signal,f=r.timeout,d=this,v=f??this._timeout,g=null,b=new st({start:function(w){g=w},cancel:function(){g=null}});return new Promise(function(w,_){s&&w({data:b});var E=wx.request({url:ua("https:",n),data:o,timeout:v,method:u.toUpperCase(),header:a,success:function(I){var R;(R=g)===null||R===void 0||R.close(),!s&&w(I)},fail:function(I){var R;if((R=g)===null||R===void 0||R.close(),_(I),s)throw I},complete:function(I){if(!(!I||!I.errMsg)&&!(!v||d._restrictedMethods.indexOf("post")===-1||!i)){var R=I.errMsg;if(R==="request:fail timeout"){console.warn(d._timeoutMsg);try{E.abort()}catch($){console.warn(xh,$)}}}},enableChunked:s});if(E.onChunkReceived(function(I){var R;(R=g)===null||R===void 0||R.enqueue(new Uint8Array(I.data))}),c){var A=function(){try{E.abort()}catch(I){console.warn(xh,I)}};c.aborted?A():c.addEventListener("abort",function(){return A()})}})},t}(yf),SS={setItem:function(e,t){wx.setStorageSync(e,t)},getItem:function(e){return wx.getStorageSync(e)},removeItem:function(e){wx.removeStorageSync(e)},clear:function(){wx.clearStorageSync()}},IS=function(){function e(t,r){r===void 0&&(r={});var n=wx.connectSocket(qa({url:t},r)),o={set onopen(i){n.onOpen(i)},set onmessage(i){n.onMessage(i)},set onclose(i){n.onClose(i)},set onerror(i){n.onError(i)},send:function(i){return n.send({data:i})},close:function(i,a){return n.close({code:i,reason:a})},get readyState(){return n.readyState},CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3};return o}return e}();function OS(){var e={root:{},reqClass:ES,wsClass:IS,localStorage:SS,primaryStorage:$a.local,getAppSign:function(){var t=wx.getAccountInfoSync();return wS()?t&&t.plugin?t.plugin.appId:"":t&&t.miniProgram?t.miniProgram.appId:""}};return e}var en={genAdapter:OS,isMatch:bS,runtime:"wx_mp"},Wa=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},Ha=jt,Ph={};function TS(e,t){var r=t.name,n=t.namespace,o=t.entity,i=t.injectEvents,a=t.IIFE,u=a===void 0?!1:a;if(Ph[r]||n&&e[n])throw new Error(JSON.stringify({code:Ha.INVALID_OPERATION,msg:"Duplicate component ".concat(r)}));if(u){if(!o||typeof o!="function")throw new Error(JSON.stringify({code:Ha.INVALID_PARAMS,msg:"IIFE component's entity must be a function"}));o.call(e)}if(Ph[r]=t,n?e.prototype[n]=o:Uy(e.prototype,o),i){var l=i.bus,s=i.events;if(!l||!s||s.length===0)return;var c=e.prototype.fire||function(){};e.prototype.events||(e.prototype.events={});var f=e.prototype.events||{};f[r]?e.prototype.events[r].events=Wa(Wa([],e.prototype.events[r].events,!0),s,!0):e.prototype.events[r]={bus:l,events:s},e.prototype.fire=function(d,v){c(d,v);for(var g=Object.keys(this.events),b=0,w=g;b<w.length;b++){var _=w[b],E=this.events[_],A=E.bus,I=E.events;if(I.includes(d)){A.fire(d,v);break}}}}}function Uy(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:{var r=t;return new Date(r.getTime())}case Object:e===void 0&&(e={});break;case Array:e=[];break;default:return t}for(var n=Object.keys(t),o=0,i=n;o<i.length;o++){var a=i[o];Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=Uy(e[a],t[a]))}return e}function AS(e,t){var r=t.entity,n=t.target;if(Object.prototype.hasOwnProperty.call(e,n))throw new Error(JSON.stringify({code:Ha.INVALID_OPERATION,msg:"target:".concat(n," is not exist")}));var o=e.prototype[n];if(typeof o!="function")throw new Error(JSON.stringify({code:Ha.INVALID_OPERATION,msg:"target:".concat(n," is not a function which is the only type supports hook")}));e.prototype[n]=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];return r.call.apply(r,Wa([this],i,!1)),o.call.apply(o,Wa([this],i,!1))}}var Xr={},Pi=function(){return Pi=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Pi.apply(this,arguments)},RS="user_info",Nh=B1,Rl={},Cl={};function $h(e){var t=e.env,r=e.platformInfo,n="".concat(RS,"_").concat(t),o={userInfoKey:n};Rl[t]=Rl[t]||new Nh(Pi(Pi({},e),{keys:o,platformInfo:r})),Cl[t]=Cl[t]||new Nh(Pi(Pi({},e),{keys:o,platformInfo:r,persistence:"local"}))}function CS(e){return Rl[e]}function Fy(e){return Cl[e]}var Ga=function(){return Ga=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ga.apply(this,arguments)},xS=E1,PS=S1,My="",By="@cloudbase/js-sdk";function NS(e){My=e}function jf(){return My}function $S(e){By=e,xS(e)}function DS(){return By}var LS="2020-01-10",jy=[],US=["env","endPointKey","region"],Dh="https:";function ky(e){return jy.find(function(t){return US.filter(function(r){return e[r]!=null}).every(function(r){return t[r]===e[r]})})}function Va(e){var t,r,n=ky(e);n?(e.baseUrl!=null&&(n.baseUrl=e.baseUrl),e.protocol!=null&&(n.protocol=e.protocol)):jy.push(Ga(Ga({},e),{protocol:(t=e.protocol)!==null&&t!==void 0?t:Dh})),e.endPointKey==="CLOUD_API"&&PS((r=e.protocol)!==null&&r!==void 0?r:Dh)}function kf(e,t,r){return ky({env:e,endPointKey:t,region:r})}function FS(e,t){Va({endPointKey:"GATEWAY",env:e,baseUrl:"//".concat(e,".api.tcloudbasegateway.com/v1"),protocol:t})}function MS(e,t,r){var n=t?"//".concat(e,".").concat(t,".tcb-api.tencentcloudapi.com/web"):"//".concat(e,".ap-shanghai.tcb-api.tencentcloudapi.com/web");Va({env:e,region:t,baseUrl:n,protocol:r,endPointKey:"CLOUD_API"})}function Lh(e){var t=kf(e,"CLOUD_API"),r=t.protocol,n=t.baseUrl,o="".concat(r).concat(n);return o.match(/(http(s)?:)?\/\/([^/?#]*)/)[0]}var Uh;(function(e){e.NULL="NULL",e.ANONYMOUS="ANONYMOUS",e.WECHAT="WECHAT",e.WECHAT_PUBLIC="WECHAT-PUBLIC",e.WECHAT_OPEN="WECHAT-OPEN",e.CUSTOM="CUSTOM",e.EMAIL="EMAIL",e.USERNAME="USERNAME",e.PHONE="PHONE"})(Uh||(Uh={}));var Re=function(){return Re=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Re.apply(this,arguments)},zr=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Jr=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},BS=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},jS=jt,kS=R1,qS=xg,Fh=Pg,WS=["auth.getJwt","auth.logout","auth.signInWithTicket","auth.signInAnonymously","auth.signIn","auth.fetchAccessTokenWithRefreshToken","auth.signUpWithEmailAndPassword","auth.activateEndUserMail","auth.sendPasswordResetEmail","auth.resetPasswordWithToken","auth.isUsernameRegistered"];function Cc(e,t,r){var n=e[t];e[t]=function(o){var i={},a={};r.forEach(function(l){var s=l.call(e,o),c=s.data,f=s.headers;Object.assign(i,c),Object.assign(a,f)});var u=o.data;return u&&function(){if(qS(u)){Object.keys(i).forEach(function(l){u.append(l,i[l])});return}o.data=Re(Re({},u),i)}(),o.headers=Re(Re({},o.headers||{}),a),n.call(e,o)}}function xc(){var e=kS();return{data:{seqId:e},headers:{"X-SDK-Version":"@cloudbase/js-sdk/".concat(jf()),"x-seqid":e}}}var HS=function(){function e(t){var r=this;this.throwWhenRequestFail=!1,this.config=t;var n={timeout:this.config.timeout,timeoutMsg:"[@cloudbase/js-sdk] 请求在".concat(this.config.timeout/1e3,"s内未完成，已中断"),restrictedMethods:["post","put"]};this.reqClass=new Xr.adapter.reqClass(n),this.throwWhenRequestFail=t.throw||!1,this.localCache=Fy(this.config.env),Cc(this.reqClass,"post",[xc]),Cc(this.reqClass,"upload",[xc]),Cc(this.reqClass,"download",[xc]),Cu.on(xu,function(o){var i;r.config.i18n=((i=o.data)===null||i===void 0?void 0:i.i18n)||r.config.i18n})}return e.prototype.getDefaultHeaders=function(){var t,r,n;return t={},t[(r=this.config.i18n)===null||r===void 0?void 0:r.LANG_HEADER_KEY]=(n=this.config.i18n)===null||n===void 0?void 0:n.lang,t},e.prototype.post=function(t){return zr(this,void 0,void 0,function(){var r;return Jr(this,function(n){switch(n.label){case 0:return[4,this.reqClass.post(Re(Re({},t),{headers:Re(Re({},t.headers),this.getDefaultHeaders())}))];case 1:return r=n.sent(),[2,r]}})})},e.prototype.upload=function(t){return zr(this,void 0,void 0,function(){var r;return Jr(this,function(n){switch(n.label){case 0:return[4,this.reqClass.upload(Re(Re({},t),{headers:Re(Re({},t.headers),this.getDefaultHeaders())}))];case 1:return r=n.sent(),[2,r]}})})},e.prototype.download=function(t){return zr(this,void 0,void 0,function(){var r;return Jr(this,function(n){switch(n.label){case 0:return[4,this.reqClass.download(Re(Re({},t),{headers:Re(Re({},t.headers),this.getDefaultHeaders())}))];case 1:return r=n.sent(),[2,r]}})})},e.prototype.getBaseEndPoint=function(){return Lh(this.config.env)},e.prototype.getOauthAccessTokenV2=function(t){return zr(this,void 0,void 0,function(){var r,n;return Jr(this,function(o){switch(o.label){case 0:return[4,t.getAccessToken()];case 1:return r=o.sent(),[4,t.getCredentials()];case 2:return n=o.sent(),[2,{accessToken:r,accessTokenExpire:new Date(n.expires_at).getTime()}]}})})},e.prototype.request=function(t,r,n){var o,i;return zr(this,void 0,void 0,function(){var a,u,l,s,c,f,d,v,g,b,w,_,E,A,I,R,$,L,D,P;return Jr(this,function(k){switch(k.label){case 0:if(a="x-tcb-trace_".concat(this.config.env),u="application/x-www-form-urlencoded",l=Re({action:t,dataVersion:LS,env:this.config.env},r),WS.indexOf(t)!==-1)return[3,2];if(s=this.config._fromApp,!s.oauthInstance)throw new Error("you can't request without auth");return c=s.oauthInstance,f=c.oauth2client,d=l,[4,this.getOauthAccessTokenV2(f)];case 1:d.access_token=k.sent().accessToken,k.label=2;case 2:return t==="storage.uploadFile"?(v=new FormData,Object.keys(v).forEach(function(F){Object.prototype.hasOwnProperty.call(v,F)&&v[F]!==void 0&&v.append(F,l[F])}),u="multipart/form-data"):(u="application/json;charset=UTF-8",v={},Object.keys(l).forEach(function(F){l[F]!==void 0&&(v[F]=l[F])})),g={headers:Re({"content-type":u},this.getDefaultHeaders())},n!=null&&n.onUploadProgress&&(g.onUploadProgress=n.onUploadProgress),this.config.region&&(g.headers["X-TCB-Region"]=this.config.region),b=this.localCache.getStore(a),b&&(g.headers["X-TCB-Trace"]=b),w=(n==null?void 0:n.parse)!==void 0?n.parse:r.parse,_=(n==null?void 0:n.inQuery)!==void 0?n.inQuery:r.inQuery,E=(n==null?void 0:n.search)!==void 0?n.search:r.search,A=Re(Re({},(n==null?void 0:n.defaultQuery)||{}),{env:this.config.env}),w&&(A.parse=!0),_&&(A=Re(Re({},_),A)),I=kf(this.config.env,"CLOUD_API"),R=I.baseUrl,$=I.protocol,n.pathname?L=Fh($,"".concat((o=Lh(this.config.env))===null||o===void 0?void 0:o.replace(/^https?:/,""),"/").concat(n.pathname),A):L=Fh($,R,A),E&&(L+=E),[4,this.post(Re({url:L,data:v},g))];case 3:if(D=k.sent(),P=(i=D.header)===null||i===void 0?void 0:i["x-tcb-trace"],P&&this.localCache.setStore(a,P),Number(D.status)!==200&&Number(D.statusCode)!==200||!D.data)throw new Error("network request error");return[2,D]}})})},e.prototype.fetch=function(t){var r,n,o,i,a,u,l,s;return zr(this,void 0,void 0,function(){var c,f,d,v,g,b,w,_,E=this;return Jr(this,function(A){switch(A.label){case 0:c=t.token,f=t.headers,d=f===void 0?{}:f,v=BS(t,["token","headers"]),g=function(){return zr(E,void 0,void 0,function(){var I,R,$;return Jr(this,function(L){switch(L.label){case 0:if(c!=null)return[2,c];if(I=this.config._fromApp,!I.oauthInstance)throw new Error("you can't request without auth");return R=I.oauthInstance,$=R.oauth2client,[4,this.getOauthAccessTokenV2($)];case 1:return[2,L.sent().accessToken]}})})},b=function(){return zr(E,void 0,void 0,function(){var I,R,$,L,D;return Jr(this,function(P){switch(P.label){case 0:return R=(I=this.reqClass).fetch,L={},D={"X-SDK-Version":"@cloudbase/js-sdk/".concat(jf())},$="Bearer ".concat,[4,g()];case 1:return[2,R.apply(I,[Re.apply(void 0,[(L.headers=Re.apply(void 0,[Re.apply(void 0,[(D.Authorization=$.apply("Bearer ",[P.sent()]),D),this.getDefaultHeaders()]),d]),L),v])])]}})})},A.label=1;case 1:return A.trys.push([1,3,,6]),[4,b()];case 2:return w=A.sent(),[2,w];case 3:if(_=A.sent(),(_==null?void 0:_.code)!=="ACCESS_TOKEN_EXPIRED")return[3,5];if(typeof((i=(o=(n=(r=this.config)===null||r===void 0?void 0:r._fromApp)===null||n===void 0?void 0:n.oauthInstance)===null||o===void 0?void 0:o.authApi)===null||i===void 0?void 0:i.refreshTokenForce)!="function")throw _;return[4,(s=(l=(u=(a=this.config)===null||a===void 0?void 0:a._fromApp)===null||u===void 0?void 0:u.oauthInstance)===null||l===void 0?void 0:l.authApi)===null||s===void 0?void 0:s.refreshTokenForce()];case 4:return A.sent(),[2,b()];case 5:throw _;case 6:return[2]}})})},e.prototype.send=function(t,r,n){return r===void 0&&(r={}),n===void 0&&(n={}),zr(this,void 0,void 0,function(){var o;return Jr(this,function(i){switch(i.label){case 0:return[4,this.request(t,r,Re(Re({},n),{onUploadProgress:r.onUploadProgress}))];case 1:if(o=i.sent(),o.data.code&&this.throwWhenRequestFail)throw new Error(JSON.stringify({code:jS.OPERATION_FAIL,msg:"[".concat(o.data.code,"] ").concat(o.data.message)}));return[2,o.data]}})})},e}(),qy={};function GS(e){qy[e.env]=new HS(Re(Re({},e),{throw:!0}))}function VS(e){return qy[e]}var Pc,Ka;(function(e){e.ZH="zh-CN",e.EN="en-US"})(Ka||(Ka={}));var KS="Accept-Language",zS=(Pc={},Pc[Ka.EN]={"请检查调用方式，或前往云开发 AI+ 首页查看文档":"Please check the calling method or visit the AI+ homepage to view the documentation","AI+ 请求出错，错误码":"AI+ request error, error code",错误信息:"error message",未实现:"not implemented","小程序不支持 wasm 加载":"wasm loading is not supported in mini programs","小程序不支持动态 js 加载":"dynamic js loading is not supported in mini programs",请求超时:"request timeout","缺少 privatelink sdk 地址":"missing privatelink sdk address"},Pc),Mh=function(e,t){var r;return((r=zS[t])===null||r===void 0?void 0:r[e])||e},JS=function(e){return"lang_".concat(e.clientId||e.env)},YS=function(e,t){var r,n,o=JS(t),i=(e.adapter||{}).localStorage,a=t.lang||((r=i==null?void 0:i.getItem)===null||r===void 0?void 0:r.call(i,o))||Ka.ZH;return(n=i==null?void 0:i.setItem)===null||n===void 0||n.call(i,o,a),new Proxy({t:function(u){return Mh(u,a)},LANG_HEADER_KEY:KS,lang:a},{get:function(u,l){var s;return l==="lang"&&((s=i==null?void 0:i.getItem)===null||s===void 0?void 0:s.call(i,o))||u[l]},set:function(u,l,s){var c;return l==="lang"&&s!==u[l]&&(u[l]=s,u.t=function(f){return Mh(f,s)},(c=i==null?void 0:i.setItem)===null||c===void 0||c.call(i,o,s),Cu.fire(xu,{i18n:u})),u[l]=s,!0}})},ye=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function QS(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}),r}var we={},Tt={};Object.defineProperty(Tt,"__esModule",{value:!0});Tt.COMMUNITY_SITE_URL=Tt.IS_DEBUG_MODE=Tt.getProtocol=Tt.setProtocol=Tt.getSdkName=Tt.setSdkName=void 0;var Wy="@cloudbase/js-sdk";function XS(e){Wy=e}Tt.setSdkName=XS;function ZS(){return Wy}Tt.getSdkName=ZS;var Hy="https:";function eI(e){Hy=e}Tt.setProtocol=eI;function tI(){return Hy}Tt.getProtocol=tI;Tt.IS_DEBUG_MODE=!1;Tt.COMMUNITY_SITE_URL="https://support.qq.com/products/148793";var Uu={};Object.defineProperty(Uu,"__esModule",{value:!0});Uu.ERRORS=void 0;Uu.ERRORS={INVALID_PARAMS:"INVALID_PARAMS",INVALID_SYNTAX:"INVALID_SYNTAX",INVALID_OPERATION:"INVALID_OPERATION",OPERATION_FAIL:"OPERATION_FAIL",NETWORK_ERROR:"NETWORK_ERROR",UNKOWN_ERROR:"UNKOWN_ERROR"};(function(e){var t=ye&&ye.__createBinding||(Object.create?function(n,o,i,a){a===void 0&&(a=i);var u=Object.getOwnPropertyDescriptor(o,i);(!u||("get"in u?!o.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return o[i]}}),Object.defineProperty(n,a,u)}:function(n,o,i,a){a===void 0&&(a=i),n[a]=o[i]}),r=ye&&ye.__exportStar||function(n,o){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(o,i)&&t(o,n,i)};Object.defineProperty(e,"__esModule",{value:!0}),e.OATUH_LOGINTYPE=void 0,r(Tt,e),r(Uu,e),e.OATUH_LOGINTYPE="constants"})(we);var bs=function(){return bs=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},bs.apply(this,arguments)},Gy=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Vy=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function rI(e,t){var r,n,o;return Gy(this,void 0,void 0,function(){var i,a,u,l,s,c,f,d,v,g,b,w,_,E,A,I;return Vy(this,function(R){switch(R.label){case 0:if(i=e||{},a=i.name,u=i.body,l=i.path,s=l===void 0?"":l,c=i.method,f=c===void 0?"POST":c,d=i.headers,v=d===void 0?{}:d,g=i.token,!a)throw new Error(JSON.stringify({code:we.ERRORS.INVALID_PARAMS,msg:"[apis] invalid api name"}));return b=this.getEndPointWithKey("GATEWAY"),w=b.BASE_URL,_=b.PROTOCOL,E="".concat(_).concat(w,"/apis/").concat(a),A=s.startsWith("/")?s:"/".concat(s),[4,this.request.fetch(bs({url:"".concat(E).concat(A),method:f||"POST",headers:bs({"Content-Type":"application/json; charset=utf-8"},v),body:u,token:((r=g==null?void 0:g.trim)===null||r===void 0?void 0:r.call(g))||((o=(n=v.Authorization)===null||n===void 0?void 0:n.replace)===null||o===void 0?void 0:o.call(n,/^Bearer /,""))||""},t))];case 1:return I=R.sent(),[4,I.data];case 2:return[2,R.sent()]}})})}var nI=["GET","POST","PUT","DELETE","HEAD","OPTIONS","PATCH","REQUEST"];function iI(e){var t=this;return new Proxy({},{get:function(r,n){if(typeof n!="string")throw new Error("[apis] method must be string");var o=n.toLocaleUpperCase();if(!nI.includes(o))throw new Error("[apis] invalid method: ".concat(n));return function(i,a){return Gy(t,void 0,void 0,function(){return Vy(this,function(u){switch(u.label){case 0:return[4,rI.call(this,bs({name:e,method:(o==="REQUEST"?i.method:o)||"POST"},i),a)];case 1:return[2,u.sent()]}})})}}})}function oI(){var e=this;return new Proxy({},{get:function(t,r){if(typeof r=="string")return iI.call(e,r)}})}var Xo=function(){return Xo=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Xo.apply(this,arguments)},Bh=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(a=e[u])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},Si=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},sI=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},aI=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},uI=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},cI=L1,lI=U1,zs=jt,jh=Ru,kh=qi,qh=Pu,fI={timeout:15e3,persistence:"local"},Wh=1e3*60*10,Hh=100,Gh={},dI=function(){function e(t){this.cloudbaseConfig=t||this.cloudbaseConfig,this.authInstance=null,this.oauthInstance=null,this.version=jf()}return Object.defineProperty(e.prototype,"config",{get:function(){return this.cloudbaseConfig},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"platform",{get:function(){return Xr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cache",{get:function(){return CS(this.cloudbaseConfig.env)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localCache",{get:function(){return Fy(this.cloudbaseConfig.env)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"request",{get:function(){return VS(this.cloudbaseConfig.env)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apis",{get:function(){return oI.call(this)},enumerable:!1,configurable:!0}),e.prototype.init=function(t){var r;if(!t.env)throw new Error(JSON.stringify({code:zs.INVALID_PARAMS,msg:"env must not be specified"}));Xr.adapter||this.useDefaultAdapter();var n={timeout:t.timeout||5e3,timeoutMsg:"[".concat(DS(),"][REQUEST TIMEOUT] request had been abort since didn't finished within").concat(t.timeout/1e3,"s")};this.requestClient=new Xr.adapter.reqClass(n),this.cloudbaseConfig=Xo(Xo(Xo({},fI),t),{i18n:YS(Xr,t)}),delete this.cloudbaseConfig.lang,this.cloudbaseConfig.timeout=this.formatTimeout(this.cloudbaseConfig.timeout);var o=this.cloudbaseConfig,i=o.env,a=o.persistence,u=o.debug,l=o.timeout,s=o.oauthClient,c=o.i18n;$h({env:i,persistence:a,debug:u,platformInfo:this.platform}),MS(i,t.region||""),FS(i);var f=new e(this.cloudbaseConfig);return GS({env:i,region:t.region||"",timeout:l,oauthClient:s,_fromApp:f,i18n:c}),f.requestClient=this.requestClient,(r=this===null||this===void 0?void 0:this.fire)===null||r===void 0||r.call(this,"cloudbase_init",f),f},e.prototype.updateConfig=function(t){var r=t.persistence,n=t.debug;this.cloudbaseConfig.persistence=r,this.cloudbaseConfig.debug=n,$h({env:this.cloudbaseConfig.env,persistence:r,debug:n,platformInfo:this.platform})},e.prototype.updateLang=function(t){var r;!t||t===((r=this.cloudbaseConfig.i18n)===null||r===void 0?void 0:r.lang)||(this.cloudbaseConfig.i18n.lang=t)},e.prototype.registerExtension=function(t){Gh[t.name]=t},e.prototype.invokeExtension=function(t,r){return sI(this,void 0,void 0,function(){var n;return aI(this,function(o){switch(o.label){case 0:if(n=Gh[t],!n)throw new Error(JSON.stringify({code:zs.INVALID_PARAMS,msg:"extension:".concat(t," must be registered before invoke")}));return[4,n.invoke(r,this)];case 1:return[2,o.sent()]}})})},e.prototype.useAdapters=function(t,r){var n=cI(t,r)||{},o=n.adapter,i=n.runtime;o&&(Xr.adapter=o),i&&(Xr.runtime=i)},e.prototype.registerHook=function(t){AS(e,t)},e.prototype.registerComponent=function(t){TS(e,t)},e.prototype.registerVersion=function(t){NS(t),this.version=t},e.prototype.registerSdkName=function(t){$S(t)},e.prototype.registerEndPoint=function(t,r){Va({baseUrl:t,protocol:r,env:this.config.env,endPointKey:"CLOUD_API"})},e.prototype.registerEndPointWithKey=function(t){Va({env:this.config.env,endPointKey:t.key,baseUrl:t.url,protocol:t.protocol})},e.prototype.getEndPointWithKey=function(t){var r=kf(this.config.env,t);return{BASE_URL:r.baseUrl,PROTOCOL:r.protocol}},e.prototype.parseCaptcha=function(t){var r={},n=t.match(/^(data:.*?)(\?[^#\s]*)?$/);if(n){t=n[1];var o=n[2];o&&(r=P1(o))}var i=r.token,a=uI(r,["token"]);return/^data:/.test(t)&&!i?{error:"invalid_argument",error_description:"invalid captcha data: ".concat(t)}:i?{state:a.state,token:i,captchaData:t}:{error:"unimplemented",error_description:"need to impl captcha data"}},e.prototype.useDefaultAdapter=function(){var t=lI(),r=t.adapter,n=t.runtime;Xr.adapter=r,Xr.runtime=n},e.prototype.formatTimeout=function(t){switch(!0){case t>Wh:return kh(zs.INVALID_PARAMS,"timeout is greater than maximum value[10min]"),Wh;case t<Hh:return kh(zs.INVALID_PARAMS,"timeout is less than maximum value[100ms]"),Hh;default:return t}},Bh([qh({mode:"sync",title:"Cloudbase 初始化失败",messages:["请确认以下各项：","  1 - 调用 cloudbase.init() 的语法或参数是否正确","  2 - 如果是非浏览器环境，是否配置了安全应用来源（https://docs.cloudbase.net/api-reference/webv3/adapter#%E7%AC%AC-2-%E6%AD%A5%E9%85%8D%E7%BD%AE%E5%AE%89%E5%85%A8%E5%BA%94%E7%94%A8%E6%9D%A5%E6%BA%90）","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(jh)]}),Si("design:type",Function),Si("design:paramtypes",[Object]),Si("design:returntype",e)],e.prototype,"init",null),Bh([qh({title:"调用扩展能力失败",messages:["请确认以下各项：","  1 - 调用 invokeExtension() 的语法或参数是否正确","  2 - 被调用的扩展能力是否已经安装并通过 registerExtension() 注册","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(jh)]}),Si("design:type",Function),Si("design:paramtypes",[String,Object]),Si("design:returntype",Promise)],e.prototype,"invokeExtension",null),e}(),Vt=new dI;Vt.useAdapters(en);const Fu="/auth";var me;(function(e){e.AUTH_SIGN_UP_URL="/v1/signup",e.AUTH_TOKEN_URL="/v1/token",e.AUTH_REVOKE_URL="/v1/revoke",e.WEDA_USER_URL="/v1/plugin/weda/userinfo",e.AUTH_RESET_PASSWORD="/v1/reset",e.AUTH_GET_DEVICE_CODE="/v1/device/code",e.CHECK_USERNAME="/v1/checkUsername",e.CHECK_IF_USER_EXIST="/v1/checkIfUserExist",e.GET_PROVIDER_TYPE="/v1/mgr/provider/providerSubType",e.AUTH_SIGN_IN_URL="/v1/signin",e.AUTH_SIGN_IN_ANONYMOUSLY_URL="/v1/signin/anonymously",e.AUTH_SIGN_IN_WITH_PROVIDER_URL="/v1/signin/with/provider",e.AUTH_SIGN_IN_WITH_WECHAT_URL="/v1/signin/wechat/noauth",e.AUTH_SIGN_IN_CUSTOM="/v1/signin/custom",e.PROVIDER_TOKEN_URL="/v1/provider/token",e.PROVIDER_URI_URL="/v1/provider/uri",e.USER_ME_URL="/v1/user/me",e.AUTH_SIGNOUT_URL="/v1/user/signout",e.USER_QUERY_URL="/v1/user/query",e.USER_PRIFILE_URL="/v1/user/profile",e.USER_BASIC_EDIT_URL="/v1/user/basic/edit",e.USER_TRANS_BY_PROVIDER_URL="/v1/user/trans/by/provider",e.PROVIDER_LIST="/v1/user/provider",e.PROVIDER_BIND_URL="/v1/user/provider/bind",e.PROVIDER_UNBIND_URL="/v1/user/provider",e.CHECK_PWD_URL="/v1/user/sudo",e.SUDO_URL="/v1/user/sudo",e.BIND_CONTACT_URL="/v1/user/contact",e.AUTH_SET_PASSWORD="/v1/user/password",e.AUTHORIZE_DEVICE_URL="/v1/user/device/authorize",e.AUTHORIZE_URL="/v1/user/authorize",e.AUTHORIZE_INFO_URL="/v1/user/authorize/info",e.AUTHORIZED_DEVICES_DELETE_URL="/v1/user/authorized/devices/",e.AUTH_REVOKE_ALL_URL="/v1/user/revoke/all",e.GET_USER_BEHAVIOR_LOG="/v1/user/security/history",e.VERIFICATION_URL="/v1/verification",e.VERIFY_URL="/v1/verification/verify",e.CAPTCHA_DATA_URL="/v1/captcha/data",e.VERIFY_CAPTCHA_DATA_URL="/v1/captcha/data/verify",e.GET_CAPTCHA_URL="/v1/captcha/init",e.GET_MINIPROGRAM_QRCODE="/v1/qrcode/generate",e.GET_MINIPROGRAM_QRCODE_STATUS="/v1/qrcode/get/status"})(me||(me={}));var Vi;(function(e){e.AUTH_SIGN_IN_URL="/v2/signin/username",e.AUTH_TOKEN_URL="/v2/token",e.USER_ME_URL="/v2/user/me",e.VERIFY_URL="/v2/signin/verificationcode",e.AUTH_SIGN_IN_WITH_PROVIDER_URL="/v2/signin/with/provider",e.AUTH_PUBLIC_KEY="/v2/signin/publichkey",e.AUTH_RESET_PASSWORD="/v2/signin/password/update"})(Vi||(Vi={}));var Vh;(function(e){e.REGISTER="REGISTER",e.SIGN_IN="SIGN_IN",e.PASSWORD_RESET="PASSWORD_RESET",e.EMAIL_ADDRESS_CHANGE="EMAIL_ADDRESS_CHANGE",e.PHONE_NUMBER_CHANGE="PHONE_NUMBER_CHANGE"})(Vh||(Vh={}));var St;(function(e){e.UNREACHABLE="unreachable",e.LOCAL="local",e.CANCELLED="cancelled",e.UNKNOWN="unknown",e.UNAUTHENTICATED="unauthenticated",e.RESOURCE_EXHAUSTED="resource_exhausted",e.FAILED_PRECONDITION="failed_precondition",e.INVALID_ARGUMENT="invalid_argument",e.DEADLINE_EXCEEDED="deadline_exceeded",e.NOT_FOUND="not_found",e.ALREADY_EXISTS="already_exists",e.PERMISSION_DENIED="permission_denied",e.ABORTED="aborted",e.OUT_OF_RANGE="out_of_range",e.UNIMPLEMENTED="unimplemented",e.INTERNAL="internal",e.UNAVAILABLE="unavailable",e.DATA_LOSS="data_loss",e.INVALID_PASSWORD="invalid_password",e.PASSWORD_NOT_SET="password_not_set",e.INVALID_STATUS="invalid_status",e.USER_PENDING="user_pending",e.USER_BLOCKED="user_blocked",e.INVALID_VERIFICATION_CODE="invalid_verification_code",e.TWO_FACTOR_REQUIRED="two_factor_required",e.INVALID_TWO_FACTOR="invalid_two_factor",e.INVALID_TWO_FACTOR_RECOVERY="invalid_two_factor_recovery",e.UNDER_REVIEW="under_review",e.INVALID_REQUEST="invalid_request",e.UNAUTHORIZED_CLIENT="unauthorized_client",e.ACCESS_DENIED="access_denied",e.UNSUPPORTED_RESPONSE_TYPE="unsupported_response_type",e.INVALID_SCOPE="invalid_scope",e.INVALID_GRANT="invalid_grant",e.SERVER_ERROR="server_error",e.TEMPORARILY_UNAVAILABLE="temporarily_unavailable",e.INTERACTION_REQUIRED="interaction_required",e.LOGIN_REQUIRED="login_required",e.ACCOUNT_SELECTION_REQUIRED="account_selection_required",e.CONSENT_REQUIRED="consent_required",e.INVALID_REQUEST_URI="invalid_request_uri",e.INVALID_REQUEST_OBJECT="invalid_request_object",e.REQUEST_NOT_SUPPORTED="request_not_supported",e.REQUEST_URI_NOT_SUPPORTED="request_uri_not_supported",e.REGISTRATION_NOT_SUPPORTED="registration_not_supported",e.CAPTCHA_REQUIRED="captcha_required",e.CAPTCHA_INVALID="captcha_invalid"})(St||(St={}));var Kh;(function(e){e.CLIENT_ID="client_id",e.CLIENT_SECRET="client_secret",e.RESPONSE_TYPE="response_type",e.SCOPE="scope",e.STATE="state",e.REDIRECT_URI="redirect_uri",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ERROR_URI="error_uri",e.GRANT_TYPE="grant_type",e.CODE="code",e.ACCESS_TOKEN="access_token",e.TOKEN_TYPE="token_type",e.EXPIRES_IN="expires_in",e.USERNAME="username",e.PASSWORD="password",e.REFRESH_TOKEN="refresh_token"})(Kh||(Kh={}));function Ky(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}const xl=e=>{const t=n=>{for(const o in e)e.hasOwnProperty(o)&&(n[o]=xl(e[o]));return n},r=e==null?"NullOrUndefined":Object.prototype.toString.call(e).slice(8,-1);if(["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"].includes(r))return e.slice();switch(r){case"Object":return t(Object.create(Object.getPrototypeOf(e)));case"Array":return t([]);case"Date":return new Date(e.valueOf());case"RegExp":return new RegExp(e.source,(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.sticky?"y":"")+(e.unicode?"u":""));default:return e}},zh=e=>{const t=/^(?:http(s)?:\/\/[^\/]+)?(\/[^\?#]*)/,r=e.match(t);return r&&r[2]||""};let So=new Map;class zy{constructor(t){this.clientId=(t==null?void 0:t.clientId)||"",So=So||new Map}async run(t,r){t=`${this.clientId}_${t}`;let n=So.get(t);return n||(n=new Promise((o,i)=>{(async()=>{try{await this.runIdlePromise();const a=r();o(await a)}catch(a){i(a)}finally{So.delete(t)}})()}),So.set(t,n)),n}runIdlePromise(){return Promise.resolve()}}const Js="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function hI(e){e=String(e);let t,r,n,o,i="",a=0;const u=e.length%3;for(;a<e.length;){if((r=e.charCodeAt(a++))>255||(n=e.charCodeAt(a++))>255||(o=e.charCodeAt(a++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");t=r<<16|n<<8|o,i+=Js.charAt(t>>18&63)+Js.charAt(t>>12&63)+Js.charAt(t>>6&63)+Js.charAt(t&63)}return u?i.slice(0,u-3)+"===".substring(u):i}function pI(){if(typeof wx>"u"||typeof Page>"u"||!wx.getSystemInfoSync||!wx.getStorageSync||!wx.setStorageSync||!wx.connectSocket||!wx.request)return!1;try{if(!wx.getSystemInfoSync()||wx.getSystemInfoSync().AppPlatform==="qq")return!1}catch{return!1}return!0}const Jh="x-request-id",Yh="x-device-id",Qh="device_id",vI=async function(e,t){let r=null,n=null;try{const o=Object.assign({},t);o.method||(o.method="GET"),o.body&&typeof o.body!="string"&&(o.body=JSON.stringify(o.body));const a=await(await fetch(e,o)).json();a!=null&&a.error?(n=a,n.error_uri=new URL(e).pathname):r=a}catch(o){n={error:St.UNREACHABLE,error_description:o.message,error_uri:new URL(e).pathname}}if(n)throw n;return r};function mI(){return Ky()}class gI{constructor(t){this._env=(t==null?void 0:t.env)||""}async getItem(t){return window.localStorage.getItem(`${t}${this._env}`)}async removeItem(t){window.localStorage.removeItem(`${t}${this._env}`)}async setItem(t,r){window.localStorage.setItem(`${t}${this._env}`,r)}getItemSync(t){return window.localStorage.getItem(`${t}${this._env}`)}removeItemSync(t){window.localStorage.removeItem(`${t}${this._env}`)}setItemSync(t,r){window.localStorage.setItem(`${t}${this._env}`,r)}}const Wf=new gI;function Jy(e){let t=!0;return e!=null&&e.expires_at&&(e!=null&&e.access_token)&&(t=e.expires_at<new Date),t}class yI{constructor(t){this.credentials=null,this.singlePromise=null,this.tokenSectionName=t.tokenSectionName,this.storage=t.storage,this.clientId=t.clientId,this.singlePromise=new zy({clientId:this.clientId}),this.credentials=t.credentials||null,this.credentials&&this.setCredentials(this.credentials)}getStorageCredentialsSync(){let t=null;const r=this.storage.getItemSync(this.tokenSectionName);if(r!=null)try{t=JSON.parse(r),t!=null&&t.expires_at&&(t.expires_at=new Date(t.expires_at))}catch{this.storage.removeItem(this.tokenSectionName),t=null}return t}async setCredentials(t){if(t!=null&&t.expires_in){if(t!=null&&t.expires_at||(t.expires_at=new Date(Date.now()+(t.expires_in-30)*1e3)),this.storage){const r=JSON.stringify(t);await this.storage.setItem(this.tokenSectionName,r)}this.credentials=t}else this.storage&&await this.storage.removeItem(this.tokenSectionName),this.credentials=null}async getCredentials(){return this.singlePromise.run("getCredentials",async()=>(Jy(this.credentials)&&(this.credentials=await this.getStorageCredentials()),this.credentials))}async getStorageCredentials(){return this.singlePromise.run("_getStorageCredentials",async()=>{let t=null;const r=await this.storage.getItem(this.tokenSectionName);if(r!=null)try{t=JSON.parse(r),t!=null&&t.expires_at&&(t.expires_at=new Date(t.expires_at))}catch{await this.storage.removeItem(this.tokenSectionName),t=null}return t})}}class mr{constructor(t){this.singlePromise=null,t.clientSecret||(t.clientSecret=""),!t.clientId&&t.env&&(t.clientId=t.env),this.apiOrigin=t.apiOrigin,this.apiPath=t.apiPath||Fu,this.clientId=t.clientId,this.i18n=t.i18n,this.publishable_key=t.publishable_key,this.singlePromise=new zy({clientId:this.clientId}),this.retry=this.formatRetry(t.retry,mr.defaultRetry),t.baseRequest?this.baseRequest=t.baseRequest:this.baseRequest=vI,this.tokenInURL=t.tokenInURL,this.headers=t.headers,this.storage=t.storage||Wf,this.localCredentials=new yI({tokenSectionName:`credentials_${t.clientId}`,storage:this.storage,clientId:t.clientId,credentials:this.publishable_key?{access_token:this.publishable_key,token_type:"Bearer",scope:"publishable_key",expires_at:new Date(+new Date+ +new Date),expires_in:+new Date+ +new Date}:null}),this.clientSecret=t.clientSecret,t.clientId&&(this.basicAuth=`Basic ${hI(`${t.clientId}:${this.clientSecret}`)}`),this.wxCloud=t.wxCloud;try{pI()&&this.wxCloud===void 0&&t.env&&(wx.cloud.init({env:t.env}),this.wxCloud=wx.cloud)}catch{}this.refreshTokenFunc=t.refreshTokenFunc||this.defaultRefreshTokenFunc,this.anonymousSignInFunc=t.anonymousSignInFunc,this.onCredentialsError=t.onCredentialsError,Cu.on(xu,r=>{var n;this.i18n=((n=r.data)==null?void 0:n.i18n)||this.i18n})}setCredentials(t){return this.localCredentials.setCredentials(t)}async getAccessToken(){const t=await this.getCredentials();if(t!=null&&t.access_token)return Promise.resolve(t.access_token);const r={error:St.UNAUTHENTICATED};return Promise.reject(r)}async request(t,r){var a,u;r||(r={});const n=this.formatRetry(r.retry,this.retry);if(r.headers={...r.headers,[(a=this.i18n)==null?void 0:a.LANG_HEADER_KEY]:(u=this.i18n)==null?void 0:u.lang},this.headers&&(r.headers={...this.headers,...r.headers}),r.headers[Jh]||(r.headers[Jh]=mI()),!r.headers[Yh]){const l=await this.getDeviceId();r.headers[Yh]=l}if(r!=null&&r.withBasicAuth&&this.basicAuth&&(r.headers.Authorization=this.basicAuth),r!=null&&r.withCredentials){const l=await this.getCredentials();l&&(this.tokenInURL?(t.indexOf("?")<0&&(t+="?"),t+=`access_token=${l.access_token}`):r.headers.Authorization=`${l.token_type} ${l.access_token}`)}else this.clientId&&t.indexOf("client_id")<0&&(t+=t.indexOf("?")<0?"?":"&",t+=`client_id=${this.clientId}`);t.startsWith("/")&&(t=`${this.apiOrigin}${this.apiPath}${t}`);let o=null;const i=n+1;for(let l=0;l<i;l++){try{r.useWxCloud?o=await this.wxCloudCallFunction(t,r):o=await this.baseRequest(t,r);break}catch(s){if(r.withCredentials&&s&&s.error===St.UNAUTHENTICATED)return await this.setCredentials(null),Promise.reject(s);if(l===n||!s||s.error!=="unreachable")return Promise.reject(s)}await this.sleep(mr.retryInterval)}return o}async wxCloudCallFunction(t,r){var i;let n=null,o=null;try{let a="";try{a=await wx.getRendererUserAgent()}catch{}const{result:u}=await this.wxCloud.callFunction({name:"httpOverCallFunction",data:{url:t,method:r.method,headers:{origin:"https://servicewechat.com","User-Agent":a,...r.headers},body:r.body}});(i=u==null?void 0:u.body)!=null&&i.error_code?(o=u==null?void 0:u.body,o.error_uri=zh(t)):n=u==null?void 0:u.body}catch(a){o={error:St.UNREACHABLE,error_description:a.message,error_uri:zh(t)}}if(o)throw o;return n}async getCredentials(){var r,n,o;let t=await this.localCredentials.getCredentials();if(!t){const i="credentials not found";return(r=this.onCredentialsError)==null||r.call(this,{msg:i}),this.unAuthenticatedError(i)}if(Jy(t))if(t.refresh_token)try{t=await this.refreshToken(t)}catch(i){if(t.scope==="anonymous")t=await this.anonymousLogin(t);else return(n=this.onCredentialsError)==null||n.call(this,{msg:i.error_description}),Promise.reject(i)}else if(t.scope==="anonymous")t=await this.anonymousLogin(t);else{const i="no refresh token found in credentials";return(o=this.onCredentialsError)==null||o.call(this,{msg:i}),this.unAuthenticatedError(i)}return t}getCredentialsSync(){return this.localCredentials.getStorageCredentialsSync()}getCredentialsAsync(){return this.getCredentials()}async getScope(){var r;const t=await this.localCredentials.getCredentials();if(!t){const n="credentials not found";return(r=this.onCredentialsError)==null||r.call(this,{msg:n}),this.unAuthenticatedError(n)}return t.scope}async getGroups(){var r;const t=await this.localCredentials.getCredentials();if(!t){const n="credentials not found";return(r=this.onCredentialsError)==null||r.call(this,{msg:n}),this.unAuthenticatedError(n)}return t.groups}async refreshToken(t){return this.singlePromise.run("_refreshToken",async()=>{var r,n,o;if(!t||!t.refresh_token){const i="no refresh token found in credentials";return(r=this.onCredentialsError)==null||r.call(this,{msg:i}),this.unAuthenticatedError(i)}try{const i=await this.refreshTokenFunc(t.refresh_token,t);return await this.localCredentials.setCredentials(i),i}catch(i){if(i.error===St.INVALID_GRANT){await this.localCredentials.setCredentials(null);const a=i.error_description;return(n=this.onCredentialsError)==null||n.call(this,{msg:a}),this.unAuthenticatedError(a)}return(o=this.onCredentialsError)==null||o.call(this,{msg:i.error_description}),Promise.reject(i)}})}async anonymousLogin(t){return this.singlePromise.run("_anonymousLogin",async()=>(this.anonymousSignInFunc?t=await this.anonymousSignInFunc(t)||await this.localCredentials.getCredentials():t=await this.anonymousSignIn(t),t))}checkRetry(t){let r=null;if((typeof t!="number"||t<mr.minRetry||t>mr.maxRetry)&&(r={error:St.UNREACHABLE,error_description:"wrong options param: retry"}),r)throw r;return t}formatRetry(t,r){return typeof t>"u"?r:this.checkRetry(t)}async sleep(t){return new Promise(r=>{setTimeout(()=>{r()},t)})}async anonymousSignIn(t){return this.singlePromise.run("_anonymous",async()=>{if(!t||t.scope!=="anonymous")return this.unAuthenticatedError("no anonymous in credentials");try{const r=await this.request(me.AUTH_SIGN_IN_ANONYMOUSLY_URL,{method:"POST",withBasicAuth:!0,body:{}});return await this.localCredentials.setCredentials(r),r}catch(r){return r.error===St.INVALID_GRANT?(await this.localCredentials.setCredentials(null),this.unAuthenticatedError(r.error_description)):Promise.reject(r)}})}async defaultRefreshTokenFunc(t,r){var i;if(t===void 0||t===""){const a="refresh token not found";return(i=this.onCredentialsError)==null||i.call(this,{msg:a}),this.unAuthenticatedError(a)}let n=me.AUTH_TOKEN_URL;return(r==null?void 0:r.version)==="v2"&&(n=Vi.AUTH_TOKEN_URL),{...await this.request(n,{method:"POST",body:{client_id:this.clientId,client_secret:this.clientSecret,grant_type:"refresh_token",refresh_token:t}}),version:(r==null?void 0:r.version)||"v1"}}async getDeviceId(){if(this.deviceID)return this.deviceID;let t=await this.storage.getItem(Qh);return typeof t=="string"&&t.length>=16&&t.length<=48||(t=Ky(),await this.storage.setItem(Qh,t)),this.deviceID=t,t}unAuthenticatedError(t){const r={error:St.UNAUTHENTICATED,error_description:t};return Promise.reject(r)}}mr.defaultRetry=2;mr.minRetry=0;mr.maxRetry=5;mr.retryInterval=1e3;function Yy(){if(typeof globalThis>"u")return!1;const{wx:e}=globalThis;if(typeof e>"u"||globalThis.Page===void 0||!e.getSystemInfoSync||!e.getStorageSync||!e.setStorageSync||!e.connectSocket||!e.request)return!1;try{if(!e.getSystemInfoSync()||e.getSystemInfoSync().AppPlatform==="qq")return!1}catch{return!1}return!0}let ws=!1;function Xh(){ws=ws||typeof window!==void 0&&window.__wxjs_environment==="miniprogram"}try{Yy()||(ws=ws||!!navigator.userAgent.match(/miniprogram/i)||window.__wxjs_environment==="miniprogram",window&&window.WeixinJSBridge&&window.WeixinJSBridge.invoke?Xh():typeof document<"u"&&document.addEventListener("WeixinJSBridgeReady",Xh,!1))}catch{}function Zh(){return ws}class qo{constructor(t){if(this.params={},typeof t=="string")this.parse(t);else if(t&&typeof t=="object")for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&this.append(r,t[r])}parse(t){t.split("&").forEach(n=>{const[o,i]=n.split("=").map(decodeURIComponent);this.append(o,i)})}append(t,r){this.params[t]?this.params[t]=this.params[t].concat([r]):this.params[t]=[r]}get(t){return this.params[t]?this.params[t][0]:null}getAll(t){return this.params[t]||[]}delete(t){delete this.params[t]}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}set(t,r){this.params[t]=[r]}toString(){const t=[];for(const r in this.params)Object.prototype.hasOwnProperty.call(this.params,r)&&this.params[r].forEach(n=>{t.push(`${encodeURIComponent(r)}=${encodeURIComponent(n)}`)});return t.join("&")}}class _I{constructor(t){t.openURIWithCallback||(t.openURIWithCallback=this.getDefaultOpenURIWithCallback()),t.storage||(t.storage=Wf),this.config=t,this.tokenSectionName=`captcha_${t.clientId}`}isMatch(){var t,r,n;return((n=(r=(t=this.config)==null?void 0:t.adapter)==null?void 0:r.isMatch)==null?void 0:n.call(r))||Yy()}async request(t,r){r||(r={}),r.method||(r.method="GET");const n=`${r.method}:${t}`;let o=t;r.withCaptcha&&(o=await this.appendCaptchaTokenToURL(t,n,!1));let i;try{i=await this.config.request(o,r)}catch(a){return a.error===St.CAPTCHA_REQUIRED||a.error===St.CAPTCHA_INVALID?(t=await this.appendCaptchaTokenToURL(t,n,a.error===St.CAPTCHA_INVALID),this.config.request(t,r)):Promise.reject(a)}return i}getDefaultOpenURIWithCallback(){if(!this.isMatch()&&!Zh()&&(window.location.search.indexOf("__captcha")>0&&(document.body.style.display="none"),document.getElementById("captcha_panel_wrap")===null)){const t=document.createElement("div");t.style.cssText="background-color: rgba(0, 0, 0, 0.7);position: fixed;left: 0px;right: 0px;top: 0px;bottom: 0px;padding: 9vw 0 0 0;display: none;z-index:100;",t.setAttribute("id","captcha_panel_wrap"),setTimeout(()=>{document.body.appendChild(t)},0)}return this.defaultOpenURIWithCallback}async defaultOpenURIWithCallback(t,r){const{width:n="355px",height:o="355px"}=r||{};if(t.match(/^(data:.*)$/))return Promise.reject({error:St.UNIMPLEMENTED,error_description:"need to impl captcha data"});const a=document.getElementById("captcha_panel_wrap"),u=document.createElement("iframe");return a.innerHTML="",u.setAttribute("src",t),u.setAttribute("id","review-panel-iframe"),u.style.cssText=`min-width:${n};display:block;height:${o};margin:0 auto;background-color: rgb(255, 255, 255);border: none;`,a.appendChild(u),a.style.display="block",new Promise((l,s)=>{u.onload=function(){try{const c=window.location,f=u.contentWindow.location;if(f.host+f.pathname===c.host+c.pathname){a.style.display="none";const d=new qo(f.search),v=d.get("captcha_token");return v?l({captcha_token:v,expires_in:Number(d.get("expires_in"))}):s({error:d.get("error"),error_description:d.get("error_description")})}a.style.display="block"}catch{a.style.display="block"}}})}async getCaptchaToken(t,r){if(!t){const i=await this.findCaptchaToken();if(i)return i}let n;if(!this.isMatch()&&!Zh()){const i=`${window.location.origin+window.location.pathname}?__captcha=on`;if(n=await this.config.request(me.GET_CAPTCHA_URL,{method:"POST",body:{client_id:this.config.clientId,redirect_uri:i,state:r},withCredentials:!1}),n.captcha_token){const a={captcha_token:n.captcha_token,expires_in:n.expires_in};return this.saveCaptchaToken(a),n.captcha_token}}else{const i=await this.config.request(me.CAPTCHA_DATA_URL,{method:"POST",body:{state:r,redirect_uri:""},withCredentials:!1});n={url:`${i.data}?state=${encodeURIComponent(r)}&token=${encodeURIComponent(i.token)}`}}const o=await this.config.openURIWithCallback(n.url);return this.saveCaptchaToken(o),o.captcha_token}async appendCaptchaTokenToURL(t,r,n){const o=await this.getCaptchaToken(n,r);return t.indexOf("?")>0?t+=`&captcha_token=${o}`:t+=`?captcha_token=${o}`,t}async saveCaptchaToken(t){t.expires_at=new Date(Date.now()+(t.expires_in-10)*1e3);const r=JSON.stringify(t);await this.config.storage.setItem(this.tokenSectionName,r)}async findCaptchaToken(){const t=await this.config.storage.getItem(this.tokenSectionName);if(t!=null)try{const r=JSON.parse(t);return r!=null&&r.expires_at&&(r.expires_at=new Date(r.expires_at)),r.expires_at<new Date?null:r.captcha_token}catch{return await this.config.storage.removeItem(this.tokenSectionName),null}return null}}var bI={};function Nc(e,t){var n;const r=()=>{try{return require("../utils/encrypt")}catch{return}};try{if((((n=t==null?void 0:t.root)==null?void 0:n.globalThis)||globalThis).IS_MP_BUILD)return;if(!bI.IS_MP_BUILD&&e)return r()}catch{if(e)return r()}}let wI=class ma{static parseParamsToSearch(t){return Object.keys(t).forEach(n=>{t[n]||delete t[n]}),new qo(t).toString()}constructor(t){let{request:r}=t,n=t.credentialsClient;if(!n){const o={apiOrigin:t.apiOrigin,apiPath:t.apiPath,clientId:t.clientId,storage:t.storage,env:t.env,baseRequest:t.baseRequest,anonymousSignInFunc:t.anonymousSignInFunc,wxCloud:t.wxCloud,onCredentialsError:t.onCredentialsError,headers:t.headers||{},i18n:t.i18n,publishable_key:t.publishable_key};n=new mr(o)}if(!r){const o=n.request.bind(n),i=new _I({clientId:t.clientId,request:o,storage:t.storage,adapter:t.adapter,...t.captchaOptions});r=i.request.bind(i)}this.config={env:t.env,apiOrigin:t.apiOrigin,apiPath:t.apiPath,clientId:t.clientId,request:r,credentialsClient:n,storage:t.storage||Wf,adapter:t.adapter}}getParamsByVersion(t,r){var i;const n=xl(t),o=((i={v2:Vi}[n==null?void 0:n.version])==null?void 0:i[r])||me[r];return n&&delete n.version,{params:n,url:o}}async signIn(t){const r=t.version||"v1",n=this.getParamsByVersion(t,"AUTH_SIGN_IN_URL");n.params.query&&delete n.params.query;const o=await this.getEncryptParams(n.params),i=await this.config.request(n.url,{method:"POST",body:o});return await this.config.credentialsClient.setCredentials({...i,version:r}),Promise.resolve(i)}async signInAnonymously(t={},r=!1){const n=await this.config.request(me.AUTH_SIGN_IN_ANONYMOUSLY_URL,{method:"POST",body:t,useWxCloud:r});return await this.config.credentialsClient.setCredentials(n),Promise.resolve(n)}async signUp(t){const r=await this.config.request(me.AUTH_SIGN_UP_URL,{method:"POST",body:t});return await this.config.credentialsClient.setCredentials(r),Promise.resolve(r)}async signOut(t){let r={};if(t){try{r=await this.config.request(me.AUTH_SIGNOUT_URL,{method:"POST",withCredentials:!0,body:t})}catch(i){i.error!==St.UNAUTHENTICATED&&console.log("sign_out_error",i)}return await this.config.credentialsClient.setCredentials(),r}const n=await this.config.credentialsClient.getAccessToken(),o=await this.config.request(me.AUTH_REVOKE_URL,{method:"POST",body:{token:n}});return await this.config.credentialsClient.setCredentials(),Promise.resolve(o)}async revokeAllDevices(){await this.config.request(me.AUTH_REVOKE_ALL_URL,{method:"DELETE",withCredentials:!0})}async revokeDevice(t){await this.config.request(me.AUTHORIZED_DEVICES_DELETE_URL+t.device_id,{method:"DELETE",withCredentials:!0})}async getVerification(t,r){let n=!1;return(t.target==="CUR_USER"||await this.hasLoginState())&&(n=!0),this.config.request(me.VERIFICATION_URL,{method:"POST",body:t,withCaptcha:(r==null?void 0:r.withCaptcha)||!1,withCredentials:n})}async verify(t){const r=this.getParamsByVersion(t,"VERIFY_URL"),n=await this.config.request(r.url,{method:"POST",body:r.params});return(t==null?void 0:t.version)==="v2"&&await this.config.credentialsClient.setCredentials({...n,version:"v2"}),n}async genProviderRedirectUri(t){const{provider_redirect_uri:r,other_params:n={},...o}=t;r&&!o.redirect_uri&&(o.redirect_uri=r);let i=`${me.PROVIDER_URI_URL}?${ma.parseParamsToSearch(o)}`;return Object.keys(n).forEach(a=>{const u=n[a];a==="sign_out_uri"&&!((u==null?void 0:u.length)>0)||(i+=`&other_params[${a}]=${encodeURIComponent(u)}`)}),this.config.request(i,{method:"GET"})}async grantProviderToken(t,r=!1){return this.config.request(me.PROVIDER_TOKEN_URL,{method:"POST",body:t,useWxCloud:r})}async patchProviderToken(t){return this.config.request(me.PROVIDER_TOKEN_URL,{method:"PATCH",body:t})}async signInWithProvider(t,r=!1){const n=this.getParamsByVersion(t,"AUTH_SIGN_IN_WITH_PROVIDER_URL"),o=await this.config.request(n.url,{method:"POST",body:n.params,useWxCloud:r});return await this.config.credentialsClient.setCredentials({...o,version:(t==null?void 0:t.version)||"v1"}),Promise.resolve(o)}async signInCustom(t){const r=await this.config.request(me.AUTH_SIGN_IN_CUSTOM,{method:"POST",body:t});return await this.config.credentialsClient.setCredentials(r),Promise.resolve(r)}async signInWithWechat(t={}){const r=await this.config.request(me.AUTH_SIGN_IN_WITH_WECHAT_URL,{method:"POST",body:t});return await this.config.credentialsClient.setCredentials(r),Promise.resolve(r)}async bindWithProvider(t){return this.config.request(me.PROVIDER_BIND_URL,{method:"POST",body:t,withCredentials:!0})}async getUserProfile(t){return this.getUserInfo(t)}async getUserInfo(t={}){var o;const r=this.getParamsByVersion(t,"USER_ME_URL");if((o=r.params)!=null&&o.query){const i=new qo(r.params.query);r.url+=`?${i.toString()}`}const n=await this.config.request(r.url,{method:"GET",withCredentials:!0});return n.sub&&(n.uid=n.sub),n}async getWedaUserInfo(){return await this.config.request(me.WEDA_USER_URL,{method:"GET",withCredentials:!0})}async deleteMe(t){const r=this.getParamsByVersion(t,"USER_ME_URL"),n=`${r.url}?${ma.parseParamsToSearch(r.params)}`;return this.config.request(n,{method:"DELETE",withCredentials:!0})}async hasLoginState(){try{return await this.config.credentialsClient.getAccessToken(),!0}catch{return!1}}hasLoginStateSync(){return this.config.credentialsClient.getCredentialsSync()}async getLoginState(){return this.config.credentialsClient.getCredentialsAsync()}async transByProvider(t){return this.config.request(me.USER_TRANS_BY_PROVIDER_URL,{method:"PATCH",body:t,withCredentials:!0})}async grantToken(t){const r=this.getParamsByVersion(t,"AUTH_TOKEN_URL");return this.config.request(r.url,{method:"POST",body:r.params})}async getProviders(){return this.config.request(me.PROVIDER_LIST,{method:"GET",withCredentials:!0})}async unbindProvider(t){return this.config.request(`${me.PROVIDER_UNBIND_URL}/${t.provider_id}`,{method:"DELETE",withCredentials:!0})}async checkPassword(t){return this.config.request(`${me.CHECK_PWD_URL}`,{method:"POST",withCredentials:!0,body:t})}async editContact(t){return this.config.request(`${me.BIND_CONTACT_URL}`,{method:"PATCH",withCredentials:!0,body:t})}async setPassword(t){return this.config.request(`${me.AUTH_SET_PASSWORD}`,{method:"PATCH",withCredentials:!0,body:t})}async updatePasswordByOld(t){const r=await this.sudo({password:t.old_password});return this.setPassword({sudo_token:r.sudo_token,new_password:t.new_password})}async sudo(t){return this.config.request(`${me.SUDO_URL}`,{method:"POST",withCredentials:!0,body:t})}async sendVerificationCodeToCurrentUser(t){return t.target="CUR_USER",this.config.request(me.VERIFICATION_URL,{method:"POST",body:t,withCredentials:!0,withCaptcha:!0})}async changeBoundProvider(t){return this.config.request(`${me.PROVIDER_LIST}/${t.provider_id}/trans`,{method:"POST",body:{provider_trans_token:t.trans_token},withCredentials:!0})}async setUserProfile(t){return this.config.request(me.USER_PRIFILE_URL,{method:"PATCH",body:t,withCredentials:!0})}async updateUserBasicInfo(t){return this.config.request(me.USER_BASIC_EDIT_URL,{method:"POST",withCredentials:!0,body:t})}async queryUserProfile(t){const r=new qo(t);return this.config.request(`${me.USER_QUERY_URL}?${r.toString()}`,{method:"GET",withCredentials:!0})}setCustomSignFunc(t){this.getCustomSignTicketFn=t}async signInWithCustomTicket(){const t=this.getCustomSignTicketFn;if(!t)return Promise.reject({error:"failed_precondition",error_description:"please use setCustomSignFunc to set custom sign function"});const r=await t();return this.signInCustom({provider_id:"custom",ticket:r})}async resetPassword(t){return this.config.request(me.AUTH_RESET_PASSWORD,{method:"POST",body:t})}async authorize(t){return this.config.request(me.AUTHORIZE_URL,{method:"POST",withCredentials:!0,body:t})}async authorizeDevice(t){return this.config.request(me.AUTHORIZE_DEVICE_URL,{method:"POST",withCredentials:!0,body:t})}async deviceAuthorize(t){return this.config.request(me.AUTH_GET_DEVICE_CODE,{method:"POST",body:t,withCredentials:!0})}async authorizeInfo(t){const r=`${me.AUTHORIZE_INFO_URL}?${ma.parseParamsToSearch(t)}`;let n=!0,o=!1;return await this.hasLoginState()&&(o=!0,n=!1),this.config.request(r,{method:"GET",withBasicAuth:n,withCredentials:o})}async checkUsername(t){return this.config.request(me.CHECK_USERNAME,{method:"GET",body:t,withCredentials:!0})}async checkIfUserExist(t){const r=new qo(t);return this.config.request(`${me.CHECK_IF_USER_EXIST}?${r.toString()}`,{method:"GET"})}async loginScope(){return this.config.credentialsClient.getScope()}async loginGroups(){return this.config.credentialsClient.getGroups()}async refreshTokenForce(t){const r=await this.config.credentialsClient.getCredentials();return await this.config.credentialsClient.refreshToken({...r,version:(t==null?void 0:t.version)||"v1"})}async getCredentials(){return this.config.credentialsClient.getCredentials()}async getPublicKey(){return this.config.request(Vi.AUTH_PUBLIC_KEY,{method:"POST",body:{}})}async getEncryptParams(t){const{isEncrypt:r}=t;delete t.isEncrypt;const n=xl(t),o=Nc(r,this.config.adapter);if(!o)return t;let i="",a="";try{const u=await this.getPublicKey();if(i=u.public_key,a=u.public_key_thumbprint,!i||!a)throw u}catch(u){throw u}return{params:o.getEncryptInfo({publicKey:i,payload:n}),public_key_thumbprint:a}}async getProviderSubType(){return this.config.request(me.GET_PROVIDER_TYPE,{method:"POST",body:{provider_id:"weda"}})}async verifyCaptchaData({token:t,key:r}){return this.config.request(me.VERIFY_CAPTCHA_DATA_URL,{method:"POST",body:{token:t,key:r},withCredentials:!1})}async createCaptchaData({state:t,redirect_uri:r=void 0}){return this.config.request(me.CAPTCHA_DATA_URL,{method:"POST",body:{state:t,redirect_uri:r},withCredentials:!1})}async getMiniProgramCode(t){return this.config.request(me.GET_MINIPROGRAM_QRCODE,{method:"POST",body:t})}async getMiniProgramQrCodeStatus(t){return this.config.request(me.GET_MINIPROGRAM_QRCODE_STATUS,{method:"POST",body:t})}async getUserBehaviorLog(t){const r={LOGIN:"query[action]=USER_LOGIN",MODIFY:"ne_query[action]=USER_LOGIN"},n=`${me.GET_USER_BEHAVIOR_LOG}?${r[t.type]}&limit=${t.limit}${t.page_token?`&page_token=${t.page_token}`:""}`;return this.config.request(n,{method:"GET",withCredentials:!0})}async modifyPassword(t){let r="",n="";const o=Nc(!0,this.config.adapter);if(!o)throw new Error("do not support encrypt, a encrypt util required.");try{const u=await this.getPublicKey();if(r=u.public_key,n=u.public_key_thumbprint,!r||!n)throw u}catch(u){throw u}const i=t.password?o.getEncryptInfo({publicKey:r,payload:t.password}):"",a=o.getEncryptInfo({publicKey:r,payload:t.new_password});return this.config.request(me.USER_BASIC_EDIT_URL,{method:"POST",withCredentials:!0,body:{user_id:t.user_id,encrypt_password:i,encrypt_new_password:a,public_key_thumbprint:n}})}async modifyPasswordWithoutLogin(t){let r="",n="";const o=Nc(!0,this.config.adapter);if(!o)throw new Error("do not support encrypt, a encrypt util required.");try{const u=await this.getPublicKey();if(r=u.public_key,n=u.public_key_thumbprint,!r||!n)throw u}catch(u){throw u}const i=t.password?o.getEncryptInfo({publicKey:r,payload:t.password}):"",a=o.getEncryptInfo({publicKey:r,payload:t.new_password});return this.config.request(Vi.AUTH_RESET_PASSWORD,{method:"POST",body:{username:t.username,password:i,new_password:a,public_key_thumbprint:n}})}};class EI{constructor(t){const{apiOrigin:r,apiPath:n=Fu,clientId:o,env:i,storage:a,request:u,baseRequest:l,anonymousSignInFunc:s,wxCloud:c,adapter:f,onCredentialsError:d,headers:v,i18n:g,publishable_key:b}=t;this.oauth2client=new mr({apiOrigin:r,apiPath:n,clientId:o,env:i,storage:a,baseRequest:l||u,anonymousSignInFunc:s,wxCloud:c,onCredentialsError:d,headers:v||{},i18n:g,publishable_key:b}),this.authApi=new wI({credentialsClient:this.oauth2client,...t,request:u?this.oauth2client.request.bind(this.oauth2client):void 0,adapter:f})}}var ue={};Object.defineProperty(ue,"__esModule",{value:!0});ue.parseQueryString=ue.transformPhone=ue.sleep=ue.printGroupLog=Bu=ue.throwError=ue.printInfo=ue.printError=za=ue.printWarn=ue.execCallback=ue.createPromiseCallback=ue.removeParam=ue.getHash=ue.getQuery=ue.toQueryString=ue.formatUrl=ue.generateRequestId=ue.genSeqId=ue.isFormData=ue.isInstanceOf=ue.isNull=ue.isPalinObject=ue.isUndefined=ue.isString=ue.isArray=void 0;var Mu=we;function SI(e){return Object.prototype.toString.call(e)==="[object Array]"}ue.isArray=SI;function II(e){return typeof e=="string"}ue.isString=II;function OI(e){return typeof e>"u"}ue.isUndefined=OI;function TI(e){return Object.prototype.toString.call(e)==="[object Object]"}ue.isPalinObject=TI;function AI(e){return Object.prototype.toString.call(e)==="[object Null]"}ue.isNull=AI;function RI(e,t){return e instanceof t}ue.isInstanceOf=RI;function CI(e){return Object.prototype.toString.call(e)==="[object FormData]"}ue.isFormData=CI;function xI(){return Math.random().toString(16).slice(2)}ue.genSeqId=xI;function PI(){var e=new Date().getTime(),t=(Date==null?void 0:Date.now)&&Date.now()*1e3||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var n=Math.random()*16;return e>0?(n=(e+n)%16|0,e=Math.floor(e/16)):(n=(t+n)%16|0,t=Math.floor(t/16)),(r==="x"?n:n&7|8).toString(16)})}ue.generateRequestId=PI;function NI(e,t,r){r===void 0&&(r={});var n=/\?/.test(t),o="";return Object.keys(r).forEach(function(i){o===""?!n&&(t+="?"):o+="&",o+="".concat(i,"=").concat(encodeURIComponent(r[i]))}),t+=o,/^http(s)?:\/\//.test(t)?t:"".concat(e).concat(t)}ue.formatUrl=NI;function $I(e){e===void 0&&(e={});var t=[];return Object.keys(e).forEach(function(r){t.push("".concat(r,"=").concat(encodeURIComponent(e[r])))}),t.join("&")}ue.toQueryString=$I;function DI(e,t){if(typeof window>"u")return!1;var r=t||window.location.search,n=new RegExp("(^|&)".concat(e,"=([^&]*)(&|$)")),o=r.substr(r.indexOf("?")+1).match(n);return o!=null?o[2]:""}ue.getQuery=DI;var LI=function(e){if(typeof window>"u")return"";var t=window.location.hash.match(new RegExp("[#?&/]".concat(e,"=([^&#]*)")));return t?t[1]:""};ue.getHash=LI;function UI(e,t){var r=t.split("?")[0],n,o=[],i=t.indexOf("?")!==-1?t.split("?")[1]:"";if(i!==""){o=i.split("&");for(var a=o.length-1;a>=0;a-=1)n=o[a].split("=")[0],n===e&&o.splice(a,1);r="".concat(r,"?").concat(o.join("&"))}return r}ue.removeParam=UI;function FI(){var e;if(!Promise){e=function(){},e.promise={};var t=function(){throw new Error('Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.')};return Object.defineProperty(e.promise,"then",{get:t}),Object.defineProperty(e.promise,"catch",{get:t}),e}var r=new Promise(function(n,o){e=function(i,a){return i?o(i):n(a)}});return e.promise=r,e}ue.createPromiseCallback=FI;function MI(e,t,r){if(r===void 0&&(r=null),e&&typeof e=="function")return e(t,r);if(t)throw t;return r}ue.execCallback=MI;function BI(e,t){console.warn("[".concat((0,Mu.getSdkName)(),"][").concat(e,"]:").concat(t))}var za=ue.printWarn=BI;function jI(e,t){console.error({code:e,msg:"[".concat((0,Mu.getSdkName)(),"][").concat(e,"]:").concat(t)})}ue.printError=jI;function kI(e,t){console.log("[".concat((0,Mu.getSdkName)(),"][").concat(e,"]:").concat(t))}ue.printInfo=kI;function qI(e,t){throw new Error(JSON.stringify({code:e,msg:"[".concat((0,Mu.getSdkName)(),"][").concat(e,"]:").concat(t)}))}var Bu=ue.throwError=qI;function WI(e){var t,r=e.title,n=e.subtitle,o=n===void 0?"":n,i=e.content,a=i===void 0?[]:i,u=e.printTrace,l=u===void 0?!1:u,s=e.collapsed,c=s===void 0?!1:s;c?(console.groupCollapsed||console.error)(r,o):(console.group||console.error)(r,o);for(var f=0,d=a;f<d.length;f++){var v=d[f],g=v.type,b=v.body;switch(g){case"info":console.log(b);break;case"warn":console.warn(b);break;case"error":console.error(b);break}}l&&(console.trace||console.log)("stack trace:"),(t=console.groupEnd)===null||t===void 0||t.call(console)}ue.printGroupLog=WI;var HI=function(e){return e===void 0&&(e=0),new Promise(function(t){return setTimeout(t,e)})};ue.sleep=HI;function GI(e){return"+86".concat(e)}ue.transformPhone=GI;var VI=function(e){e=e.replace(/^\?/,"");var t={},r=e.split("&");return r.forEach(function(n){var o=n.split("="),i=o[0],a=o[1];i=decodeURIComponent(i),a=decodeURIComponent(a),i&&(t[i]?Array.isArray(t[i])?t[i].push(a):t[i]=[t[i],a]:t[i]=a)}),t};ue.parseQueryString=VI;var De={},ju={},KI=ye&&ye.__awaiter||function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},zI=ye&&ye.__generator||function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(ju,"__esModule",{value:!0});ju.catchErrorsDecorator=void 0;var ep=ue,JI=we,Zo=!1;typeof navigator<"u"&&navigator.userAgent&&(Zo=navigator.userAgent.indexOf("Firefox")!==-1);var YI=Zo?/(\.js\/)?__decorate(\$\d+)?<@.*\d$/:/(\/\w+\.js\.)?__decorate(\$\d+)?\s*\(.*\)$/,Qy=/https?:\/\/.+:\d*\/.*\.js:\d+:\d+/;function QI(e){var t=e.mode,r=t===void 0?"async":t,n=e.customInfo,o=n===void 0?{}:n,i=e.title,a=e.messages,u=a===void 0?[]:a;return function(l,s,c){if(JI.IS_DEBUG_MODE){var f=o.className||l.constructor.name,d=o.methodName||s,v=c.value,g=XI(new Error);r==="sync"?c.value=function(){for(var b=[],w=0;w<arguments.length;w++)b[w]=arguments[w];var _=tp({err:new Error,className:f,methodName:d,sourceLink:g});try{return v.apply(this,b)}catch(D){var E=D,A=D.message,I=D.error,R=D.error_description,$={title:i||"".concat(f,".").concat(d," failed"),content:[{type:"error",body:D}]};if(A&&/^\{.*\}$/.test(A)){var L=JSON.parse(A);$.subtitle=A,L.code&&(_?(_.code=L.code,_.msg=L.msg):(D.code=L.code,D.message=L.msg),E=_||D,$.content=u.map(function(P){return{type:"info",body:P}}))}throw I&&R&&($.subtitle=R,_?(_.code=I,_.msg=R):(D.code=I,D.message=R),E=_||D,$.content=u.map(function(P){return{type:"info",body:P}})),(0,ep.printGroupLog)($),E}}:c.value=function(){for(var b=[],w=0;w<arguments.length;w++)b[w]=arguments[w];return KI(this,void 0,void 0,function(){var _,E,A,I,R,$,L,D;return zI(this,function(P){switch(P.label){case 0:_=tp({err:new Error,className:f,methodName:d,sourceLink:g}),P.label=1;case 1:return P.trys.push([1,3,,4]),[4,v.apply(this,b)];case 2:return[2,P.sent()];case 3:throw E=P.sent(),A=E,I=E.message,R=E.error,$=E.error_description,L={title:i||"".concat(f,".").concat(d," failed"),content:[{type:"error",body:E}]},I&&/^\{.*\}$/.test(I)&&(D=JSON.parse(I),L.subtitle=D,D.code&&(_?(_.code=D.code,_.message=D.msg):(E.code=D.code,E.message=D.msg),A=_||E,L.content=u.map(function(k){return{type:"info",body:k}}))),R&&$&&(L.subtitle=$,_?(_.code=R,_.msg=$):(E.code=R,E.message=$),A=_||E,L.content=u.map(function(k){return{type:"info",body:k}})),(0,ep.printGroupLog)(L),A;case 4:return[2]}})})}}}}ju.catchErrorsDecorator=QI;function XI(e){var t="",r=e.stack.split(`
`),n=r.findIndex(function(i){return YI.test(i)});if(n!==-1){var o=Qy.exec(r[n+1]||"");t=o?o[0]:""}return t}function tp(e){var t=e.err,r=e.className,n=e.methodName,o=e.sourceLink;if(!o)return null;var i=t.stack.split(`
`),a=Zo?/^catchErrorsDecorator\/<\/descriptor.value@.*\d$/:new RegExp("".concat(r,"\\.descriptor.value\\s*\\[as\\s").concat(n,"\\]\\s*\\(.*\\)$")),u=Zo?/^catchErrorsDecorator\/<\/descriptor.value/:new RegExp("".concat(r,"\\.descriptor.value\\s*\\[as\\s").concat(n,"\\]")),l=i.findIndex(function(f){return a.test(f)}),s;if(l!==-1){var c=i.filter(function(f,d){return d>l});c.unshift(i[l].replace(u,"".concat(r,".").concat(n)).replace(Qy,o)),s=new Error,s.stack="".concat(Zo?"@debugger":"Error",`
`).concat(c.join(`
`))}return s}(function(e){var t=ye&&ye.__createBinding||(Object.create?function(n,o,i,a){a===void 0&&(a=i);var u=Object.getOwnPropertyDescriptor(o,i);(!u||("get"in u?!o.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return o[i]}}),Object.defineProperty(n,a,u)}:function(n,o,i,a){a===void 0&&(a=i),n[a]=o[i]}),r=ye&&ye.__exportStar||function(n,o){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(o,i)&&t(o,n,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(ju,e)})(De);var Kt={},ZI=ye&&ye.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),eO=ye&&ye.__spreadArray||function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))};Object.defineProperty(Kt,"__esModule",{value:!0});Kt.removeEventListener=Kt.activateEvent=Kt.addEventListener=e0=Kt.CloudbaseEventEmitter=Kt.IErrorEvent=Kt.CloudbaseEvent=void 0;var rp=ue;function tO(e,t,r){r[e]=r[e]||[],r[e].push(t)}function rO(e,t,r){if(r!=null&&r[e]){var n=r[e].indexOf(t);n!==-1&&r[e].splice(n,1)}}var Hf=function(){function e(t,r){this.data=r||null,this.name=t}return e}();Kt.CloudbaseEvent=Hf;var Xy=function(e){ZI(t,e);function t(r,n){var o=e.call(this,"error",{error:r,data:n})||this;return o.error=r,o}return t}(Hf);Kt.IErrorEvent=Xy;var Zy=function(){function e(){this.listeners={}}return e.prototype.on=function(t,r){return tO(t,r,this.listeners),this},e.prototype.off=function(t,r){return rO(t,r,this.listeners),this},e.prototype.fire=function(t,r){if((0,rp.isInstanceOf)(t,Xy))return console.error(t.error),this;var n=(0,rp.isString)(t)?new Hf(t,r||{}):t,o=n.name;if(this.listens(o)){n.target=this;for(var i=this.listeners[o]?eO([],this.listeners[o],!0):[],a=0,u=i;a<u.length;a++){var l=u[a];l.call(this,n)}}return this},e.prototype.listens=function(t){return this.listeners[t]&&this.listeners[t].length>0},e}(),e0=Kt.CloudbaseEventEmitter=Zy,Gf=new Zy;function nO(e,t){Gf.on(e,t)}Kt.addEventListener=nO;function iO(e,t){t===void 0&&(t={}),Gf.fire(e,t)}Kt.activateEvent=iO;function oO(e,t){Gf.off(e,t)}Kt.removeEventListener=oO;var Vf={};const t0=QS(O1);var Ys={},sO=ye&&ye.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),$c=ye&&ye.__awaiter||function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Dc=ye&&ye.__generator||function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(Vf,"__esModule",{value:!0});var r0=Vf.CloudbaseCache=void 0,aO=t0,es=ue,bn=we,Lc=function(e){sO(t,e);function t(r){var n=e.call(this)||this;return n.root=r,r.tcbCacheObject||(r.tcbCacheObject={}),n}return t.prototype.setItem=function(r,n){this.root.tcbCacheObject[r]=n},t.prototype.getItem=function(r){return this.root.tcbCacheObject[r]},t.prototype.removeItem=function(r){delete this.root.tcbCacheObject[r]},t.prototype.clear=function(){delete this.root.tcbCacheObject},t}(aO.AbstractStorage);function uO(e,t){switch(e){case"local":return t.localStorage?t.localStorage:((0,es.printWarn)(bn.ERRORS.INVALID_PARAMS,"localStorage is not supported on current platform"),new Lc(t.root));case"none":return new Lc(t.root);default:return t.localStorage?t.localStorage:((0,es.printWarn)(bn.ERRORS.INVALID_PARAMS,"localStorage is not supported on current platform"),new Lc(t.root))}}var cO=function(){function e(t){this.keys={};var r=t.persistence,n=t.platformInfo,o=n===void 0?{}:n,i=t.keys,a=i===void 0?{}:i;this.platformInfo=o,this.storage||(this.persistenceTag=this.platformInfo.adapter.primaryStorage||r,this.storage=uO(this.persistenceTag,this.platformInfo.adapter),this.keys=a)}return Object.defineProperty(e.prototype,"mode",{get:function(){return this.storage.mode||"sync"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"persistence",{get:function(){return this.persistenceTag},enumerable:!1,configurable:!0}),e.prototype.setStore=function(t,r,n){if(this.mode==="async"){(0,es.printWarn)(bn.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use setStoreAsync insteed");return}if(this.storage)try{var o={version:n||"localCachev1",content:r};this.storage.setItem(t,JSON.stringify(o))}catch(i){throw new Error(JSON.stringify({code:bn.ERRORS.OPERATION_FAIL,msg:"[".concat((0,bn.getSdkName)(),"][").concat(bn.ERRORS.OPERATION_FAIL,"]setStore failed"),info:i}))}},e.prototype.setStoreAsync=function(t,r,n){return $c(this,void 0,void 0,function(){var o;return Dc(this,function(i){switch(i.label){case 0:if(!this.storage)return[2];i.label=1;case 1:return i.trys.push([1,3,,4]),o={version:n||"localCachev1",content:r},[4,this.storage.setItem(t,JSON.stringify(o))];case 2:return i.sent(),[3,4];case 3:return i.sent(),[2];case 4:return[2]}})})},e.prototype.getStore=function(t,r){var n;if(this.mode==="async"){(0,es.printWarn)(bn.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use getStoreAsync insteed");return}try{if(typeof process<"u"&&(!((n=Ys)===null||n===void 0)&&n.tcb_token))return Ys.tcb_token;if(!this.storage)return""}catch{return""}r=r||"localCachev1";var o=this.storage.getItem(t);if(!o)return"";if(o.indexOf(r)>=0){var i=JSON.parse(o);return i.content}return""},e.prototype.getStoreAsync=function(t,r){var n;return $c(this,void 0,void 0,function(){var o,i;return Dc(this,function(a){switch(a.label){case 0:try{if(typeof process<"u"&&(!((n=Ys)===null||n===void 0)&&n.tcb_token))return[2,Ys.tcb_token];if(!this.storage)return[2,""]}catch{return[2,""]}return r=r||"localCachev1",[4,this.storage.getItem(t)];case 1:return o=a.sent(),o?o.indexOf(r)>=0?(i=JSON.parse(o),[2,i.content]):[2,""]:[2,""]}})})},e.prototype.removeStore=function(t){if(this.mode==="async"){(0,es.printWarn)(bn.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use removeStoreAsync insteed");return}this.storage.removeItem(t)},e.prototype.removeStoreAsync=function(t){return $c(this,void 0,void 0,function(){return Dc(this,function(r){switch(r.label){case 0:return[4,this.storage.removeItem(t)];case 1:return r.sent(),[2]}})})},e}();r0=Vf.CloudbaseCache=cO;var n0={},to={},lO=ye&&ye.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),lt=ye&&ye.__assign||function(){return lt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},lt.apply(this,arguments)},Uc=ye&&ye.__awaiter||function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Fc=ye&&ye.__generator||function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(to,"__esModule",{value:!0});to.WebRequest=to.genAdapter=void 0;var fO=t0,Mc=ue,dO=Tt,i0=function(e){lO(t,e);function t(r){var n=e.call(this)||this,o=r.timeout,i=r.timeoutMsg,a=r.restrictedMethods;return n.timeout=o||0,n.timeoutMsg=i||"请求超时",n.restrictedMethods=a||["get","post","upload","download"],n}return t.prototype.get=function(r){return this.request(lt(lt({},r),{method:"get"}),this.restrictedMethods.includes("get"))},t.prototype.post=function(r){return this.request(lt(lt({},r),{method:"post"}),this.restrictedMethods.includes("post"))},t.prototype.put=function(r){return this.request(lt(lt({},r),{method:"put"}))},t.prototype.upload=function(r){var n=r.data,o=r.file,i=r.name,a=r.method,u=r.headers,l=u===void 0?{}:u,s={post:"post",put:"put"}[a==null?void 0:a.toLowerCase()]||"put",c=new FormData;return s==="post"?(Object.keys(n).forEach(function(f){c.append(f,n[f])}),c.append("key",i),c.append("file",o),this.request(lt(lt({},r),{data:c,method:s}),this.restrictedMethods.includes("upload"))):this.request(lt(lt({},r),{method:"put",headers:l,body:o}),this.restrictedMethods.includes("upload"))},t.prototype.download=function(r){return Uc(this,void 0,void 0,function(){var n,o,i,a;return Fc(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,this.get(lt(lt({},r),{headers:{},responseType:"blob"}))];case 1:return n=u.sent().data,o=window.URL.createObjectURL(new Blob([n])),i=decodeURIComponent(new URL(r.url).pathname.split("/").pop()||""),a=document.createElement("a"),a.href=o,a.setAttribute("download",i),a.style.display="none",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(o),document.body.removeChild(a),[3,3];case 2:return u.sent(),[3,3];case 3:return[2,new Promise(function(l){l({statusCode:200,tempFilePath:r.url})})]}})})},t.prototype.fetch=function(r){var n;return Uc(this,void 0,void 0,function(){var o,i,a,u,l,s,c,f,d,v,g,b=this;return Fc(this,function(w){switch(w.label){case 0:return o=new AbortController,i=r.url,a=r.enableAbort,u=a===void 0?!1:a,l=r.stream,s=l===void 0?!1:l,c=r.signal,f=r.timeout,d=f??this.timeout,c&&(c.aborted&&o.abort(),c.addEventListener("abort",function(){return o.abort()})),v=null,u&&d&&(v=setTimeout(function(){console.warn(b.timeoutMsg),o.abort(new Error(b.timeoutMsg))},d)),[4,fetch(i,lt(lt({},r),{signal:o.signal})).then(function(_){return Uc(b,void 0,void 0,function(){var E,A,I;return Fc(this,function(R){switch(R.label){case 0:return clearTimeout(v),_.ok?(E=_,[3,3]):[3,1];case 1:return I=(A=Promise).reject,[4,_.json()];case 2:E=I.apply(A,[R.sent()]),R.label=3;case 3:return[2,E]}})})}).catch(function(_){return clearTimeout(v),Promise.reject(_)})];case 1:return g=w.sent(),[2,{data:s?g.body:!((n=g.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?g.json():g.text(),statusCode:g.status,header:g.headers}]}})})},t.prototype.request=function(r,n){var o=this;n===void 0&&(n=!1);var i=String(r.method).toLowerCase()||"get";return new Promise(function(a){var u=r.url,l=r.headers,s=l===void 0?{}:l,c=r.data,f=r.responseType,d=r.withCredentials,v=r.body,g=r.onUploadProgress,b=(0,Mc.formatUrl)((0,dO.getProtocol)(),u,i==="get"?c:{}),w=new XMLHttpRequest;w.open(i,b),f&&(w.responseType=f),Object.keys(s).forEach(function(A){w.setRequestHeader(A,s[A])});var _;g&&w.upload.addEventListener("progress",g),w.onreadystatechange=function(){var A={};if(w.readyState===4){var I=w.getAllResponseHeaders(),R=I.trim().split(/[\r\n]+/),$={};R.forEach(function(L){var D=L.split(": "),P=D.shift().toLowerCase(),k=D.join(": ");$[P]=k}),A.header=$,A.statusCode=w.status;try{A.data=f==="blob"?w.response:JSON.parse(w.responseText)}catch{A.data=f==="blob"?w.response:w.responseText}clearTimeout(_),a(A)}},n&&o.timeout&&(_=setTimeout(function(){console.warn(o.timeoutMsg),w.abort()},o.timeout));var E;(0,Mc.isFormData)(c)?E=c:s["content-type"]==="application/x-www-form-urlencoded"?E=(0,Mc.toQueryString)(c):v?E=v:E=c?JSON.stringify(c):void 0,d&&(w.withCredentials=!0),w.send(E)})},t}(fO.AbstractSDKRequest);to.WebRequest=i0;function hO(){var e={type:"default",root:window,reqClass:i0,wsClass:WebSocket,localStorage};return e}to.genAdapter=hO;(function(e){var t=ye&&ye.__assign||function(){return t=Object.assign||function(c){for(var f,d=1,v=arguments.length;d<v;d++){f=arguments[d];for(var g in f)Object.prototype.hasOwnProperty.call(f,g)&&(c[g]=f[g])}return c},t.apply(this,arguments)},r=ye&&ye.__createBinding||(Object.create?function(c,f,d,v){v===void 0&&(v=d);var g=Object.getOwnPropertyDescriptor(f,d);(!g||("get"in g?!f.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return f[d]}}),Object.defineProperty(c,v,g)}:function(c,f,d,v){v===void 0&&(v=d),c[v]=f[d]}),n=ye&&ye.__setModuleDefault||(Object.create?function(c,f){Object.defineProperty(c,"default",{enumerable:!0,value:f})}:function(c,f){c.default=f}),o=ye&&ye.__importStar||function(c){if(c&&c.__esModule)return c;var f={};if(c!=null)for(var d in c)d!=="default"&&Object.prototype.hasOwnProperty.call(c,d)&&r(f,c,d);return n(f,c),f};Object.defineProperty(e,"__esModule",{value:!0}),e.useDefaultAdapter=e.useAdapters=e.RUNTIME=void 0;var i=o(to),a=ue,u;(function(c){c.WEB="web",c.WX_MP="wx_mp"})(u=e.RUNTIME||(e.RUNTIME={}));function l(c,f){for(var d=(0,a.isArray)(c)?c:[c],v=0,g=d;v<g.length;v++){var b=g[v],w=b.isMatch,_=b.genAdapter,E=b.runtime;if(w())return{adapter:t({isMatch:w},_(f)),runtime:E}}}e.useAdapters=l;function s(){return{adapter:i.genAdapter(),runtime:u.WEB}}e.useDefaultAdapter=s})(n0);var gr=function(){return gr=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},gr.apply(this,arguments)},ts=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},rs=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},o0=function(){function e(t){var r,n;try{this.localStorage=(t==null?void 0:t.localStorage)||(((n=(r=t==null?void 0:t.adapter)===null||r===void 0?void 0:r.root)===null||n===void 0?void 0:n.globalThis)||globalThis).localStorage}catch{this.localStorage=(t==null?void 0:t.localStorage)||{}}}return e.prototype.getItem=function(t){return ts(this,void 0,void 0,function(){return rs(this,function(r){return[2,this.localStorage.getItem(t)]})})},e.prototype.removeItem=function(t){return ts(this,void 0,void 0,function(){return rs(this,function(r){return this.localStorage.removeItem(t),[2]})})},e.prototype.setItem=function(t,r){return ts(this,void 0,void 0,function(){return rs(this,function(n){return this.localStorage.setItem(t,r),[2]})})},e.prototype.getItemSync=function(t){return this.localStorage.getItem(t)},e.prototype.setItemSync=function(t,r){this.localStorage.setItem(t,r)},e.prototype.removeItemSync=function(t){this.localStorage.removeItem(t)},e}(),pO=/^[^:]+:\/\/[^/]+(\/[^?#]+)/,s0=function(e,t){var r,n,o,i=(r=t==null?void 0:t.headers)===null||r===void 0?void 0:r["x-request-id"];return e||(e={}),(e!=null&&e.code||!((n=e==null?void 0:e.data)===null||n===void 0)&&n.error_code)&&(e={error:e.code||e.data.error,error_description:e.data.error_description||e.message||e.code||e.data.error_code,request_id:e.requestId,error_code:(o=e.data)===null||o===void 0?void 0:o.error_code}),e!=null&&e.request_id||(e.request_id=e.request_id||i),e!=null&&e.error?(e.error_uri=mO(t==null?void 0:t.url),e):(e==null?void 0:e.data)||{}};function vO(e){return function(t,r){return ts(this,void 0,void 0,function(){return rs(this,function(n){return[2,new Promise(function(o,i){var a=Object.assign({},r);a.body&&typeof a.body!="string"&&(a.body=JSON.stringify(a.body));var u=wx.request({url:t,data:a.body,timeout:e._timeout,method:a.method||"GET",header:a.headers,success:function(l){l=s0(l,gr(gr({},r),{url:t})),l.error&&i(l),o(l)},fail:function(l){i({error:"unreachable",error_description:l.message})},complete:function(l){if(!(!l||!l.errMsg)&&!(!e._timeout||e._restrictedMethods.indexOf("request")===-1)){var s=l.errMsg;if(s==="request:fail timeout"){console.warn(e._timeoutMsg);try{u.abort()}catch{}}}}})})]})})}}function mO(e){return pO.test(e)?RegExp.$1:e}var gO=function(e,t){var r=gr({},e);try{if(!(e!=null&&e.storage)&&(t!=null&&t.localStorage)&&(r.storage=new o0({localStorage:t.localStorage,adapter:t})),!e.captchaOptions&&(t!=null&&t.captchaOptions)&&(r.captchaOptions=t.captchaOptions),!e.baseRequest&&!e.request&&(t!=null&&t.reqClass)){var n={timeout:1e4,restrictedMethods:["get","post","upload","download","request"]},o=new t.reqClass(n);r.baseRequest=function(i,a){var u;return ts(this,void 0,void 0,function(){var l,s,c,f;return rs(this,function(d){switch(d.label){case 0:if(l={},s=((u=a.method)===null||u===void 0?void 0:u.toLocaleLowerCase())||"get",c=o==null?void 0:o[s],typeof c!="function")throw new Error("invalid 【".concat(s,"】 request method"));d.label=1;case 1:return d.trys.push([1,3,,4]),(!a.headers["content-type"]||a.headers["content-type"].includes("application/json"))&&typeof a.body!="string"&&(a.data=a.data||a.body,a.body=JSON.stringify(a.body)),[4,c(gr({url:i},a))];case 2:return l=d.sent(),l=s0(l,gr(gr({},a),{url:i})),[3,4];case 3:throw f=d.sent(),l=f,f;case 4:if(l!=null&&l.error)throw l;return[2,l]}})})}}}catch(i){console.error("user adapter generate fail:",i)}return r},yO=function(e,t){if(!en.isMatch()||e.storage&&e.baseRequest)return e;var r=gr({},e),n={};try{var o=en.genAdapter(),i=o.localStorage,a=o.reqClass;if(i&&(n.storage=new o0({localStorage:i,adapter:t})),a){var u=new a({timeout:1e4,restrictedMethods:["get","post","upload","download","request"]});n.request=vO(u)}return r.captchaOptions&&(n.baseRequest=n.request,n.request=void 0),gr(gr({},r),n)}catch(l){console.error("adapter generate fail:",l)}return r},_O=function(e){return e.adapter&&e.adapter.type!=="default"?gO(e,e.adapter):yO(e,e.adapter)},gt=function(){return gt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},gt.apply(this,arguments)},Ue=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(a=e[u])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},z=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},Z=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},ee=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},bO="auth",ga={SIGN_OUT:"sign_out",SIGN_IN:"sign_in",CREDENTIALS_ERROR:"credentials_error"},ya={LOGIN_STATE_CHANGED:"loginStateChanged"},_a=new e0,wO=function(e){_a.fire(ya.LOGIN_STATE_CHANGED,gt(gt({},e),{eventType:ga.CREDENTIALS_ERROR}))},EO=function(){function e(t){var r=t.cache,n=t.oauthInstance;this.cache=r,this.oauthInstance=n,this.setUserInfo()}return e.prototype.checkLocalInfo=function(){return Z(this,void 0,void 0,function(){return ee(this,function(t){return this.uid=this.getLocalUserInfo("uid"),this.gender=this.getLocalUserInfo("gender"),this.picture=this.getLocalUserInfo("picture"),this.email=this.getLocalUserInfo("email"),this.emailVerified=this.getLocalUserInfo("email_verified"),this.phoneNumber=this.getLocalUserInfo("phone_number"),this.username=this.getLocalUserInfo("username"),this.name=this.getLocalUserInfo("name"),this.birthdate=this.getLocalUserInfo("birthdate"),this.zoneinfo=this.getLocalUserInfo("zoneinfo"),this.locale=this.getLocalUserInfo("locale"),this.sub=this.getLocalUserInfo("sub"),this.createdFrom=this.getLocalUserInfo("created_from"),this.providers=this.getLocalUserInfo("providers"),[2]})})},e.prototype.checkLocalInfoAsync=function(){return Z(this,void 0,void 0,function(){var t,r,n,o;return ee(this,function(i){switch(i.label){case 0:return t=this,[4,this.getLocalUserInfoAsync("uid")];case 1:return t.uid=i.sent(),r=this,[4,this.getLocalUserInfoAsync("gender")];case 2:return r.gender=i.sent(),this.picture=this.getLocalUserInfo("picture"),n=this,[4,this.getLocalUserInfoAsync("email")];case 3:return n.email=i.sent(),this.emailVerified=this.getLocalUserInfo("email_verified"),this.phoneNumber=this.getLocalUserInfo("phone_number"),o=this,[4,this.getLocalUserInfoAsync("username")];case 4:return o.username=i.sent(),this.name=this.getLocalUserInfo("name"),this.birthdate=this.getLocalUserInfo("birthdate"),this.zoneinfo=this.getLocalUserInfo("zoneinfo"),this.locale=this.getLocalUserInfo("locale"),this.sub=this.getLocalUserInfo("sub"),this.createdFrom=this.getLocalUserInfo("created_from"),this.providers=this.getLocalUserInfo("providers"),[2]}})})},e.prototype.update=function(t){return Z(this,void 0,void 0,function(){var r;return ee(this,function(n){switch(n.label){case 0:return[4,this.oauthInstance.authApi.setUserProfile(gt({},t))];case 1:return r=n.sent(),this.setLocalUserInfo(r),[2]}})})},e.prototype.updateUserBasicInfo=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.authApi.updateUserBasicInfo(gt({},t))];case 1:return r.sent(),this.setLocalUserInfo({username:t.username}),[2]}})})},e.prototype.updatePassword=function(t,r){return this.oauthInstance.authApi.updatePasswordByOld({old_password:r,new_password:t})},e.prototype.updateUsername=function(t){return typeof t!="string"&&Bu(we.ERRORS.INVALID_PARAMS,"username must be a string"),this.update({username:t})},e.prototype.refresh=function(t){return Z(this,void 0,void 0,function(){var r;return ee(this,function(n){switch(n.label){case 0:return[4,this.oauthInstance.authApi.getUserInfo(t)];case 1:return r=n.sent(),this.setLocalUserInfo(r),[2,r]}})})},e.prototype.getLocalUserInfo=function(t){var r=this.cache.keys.userInfoKey,n=this.cache.getStore(r);return n[t]},e.prototype.getLocalUserInfoAsync=function(t){return Z(this,void 0,void 0,function(){var r,n;return ee(this,function(o){switch(o.label){case 0:return r=this.cache.keys.userInfoKey,[4,this.cache.getStoreAsync(r)];case 1:return n=o.sent(),[2,n[t]]}})})},e.prototype.setUserInfo=function(){var t=this,r=this.cache.keys.userInfoKey,n=this.cache.getStore(r);["uid","email","name","gender","picture","email_verified","phone_number","birthdate","zoneinfo","locale","sub","created_from","providers","username"].forEach(function(o){t[o]=n[o]})},e.prototype.setLocalUserInfo=function(t){var r=this.cache.keys.userInfoKey;this.cache.setStore(r,t),this.setUserInfo()},Ue([De.catchErrorsDecorator({title:"更新用户信息失败",messages:["请确认以下各项：","  1 - 调用 User.update() 的语法或参数是否正确","  2 - 用户信息中是否包含非法值","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],e.prototype,"update",null),Ue([De.catchErrorsDecorator({title:"更新密码失败",messages:["请确认以下各项：","  1 - 调用 User.updatePassword() 的语法或参数是否正确","  3 - 新密码中是否包含非法字符","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[String,String]),z("design:returntype",void 0)],e.prototype,"updatePassword",null),Ue([De.catchErrorsDecorator({title:"更新用户名失败",messages:["请确认以下各项：","  1 - 调用 User.updateUsername() 的语法或参数是否正确","  2 - 当前环境是否开通了用户名密码登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[String]),z("design:returntype",void 0)],e.prototype,"updateUsername",null),Ue([De.catchErrorsDecorator({title:"刷新本地用户信息失败",messages:["请确认以下各项：","  1 - 调用 User.refresh() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],e.prototype,"refresh",null),e}(),Bc=function(){function e(t){var r=t.envId,n=t.cache,o=t.oauthInstance;r||Bu(we.ERRORS.INVALID_PARAMS,"envId is not defined"),this.cache=n,this.oauthInstance=o,this.user=new EO({cache:this.cache,oauthInstance:o})}return e.prototype.checkLocalState=function(){var t;this.oauthLoginState=(t=this.oauthInstance)===null||t===void 0?void 0:t.authApi.hasLoginStateSync(),this.user.checkLocalInfo()},e.prototype.checkLocalStateAsync=function(){var t;return Z(this,void 0,void 0,function(){return ee(this,function(r){switch(r.label){case 0:return[4,(t=this.oauthInstance)===null||t===void 0?void 0:t.authApi.getLoginState()];case 1:return r.sent(),[4,this.user.checkLocalInfoAsync()];case 2:return r.sent(),[2]}})})},e}(),SO=function(){function e(t){this.config=t,this.cache=t.cache,this.oauthInstance=t.oauthInstance,t.publishable_key&&this.createLoginState()}return e.prototype.bindPhoneNumber=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.editContact(t)]})})},e.prototype.unbindProvider=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.unbindProvider(t)]})})},e.prototype.bindEmail=function(t){return this.oauthInstance.authApi.editContact(t)},e.prototype.verify=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.verify(t)]})})},e.prototype.getVerification=function(t,r){return Z(this,void 0,void 0,function(){return ee(this,function(n){return[2,this.oauthInstance.authApi.getVerification(t,r)]})})},Object.defineProperty(e.prototype,"currentUser",{get:function(){if(this.cache.mode==="async"){za(we.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use getCurrentUser insteed");return}var t=this.hasLoginState();return t&&t.user||null},enumerable:!1,configurable:!0}),e.prototype.getCurrentUser=function(){return Z(this,void 0,void 0,function(){var t;return ee(this,function(r){switch(r.label){case 0:return[4,this.getLoginState()];case 1:return t=r.sent(),t?[4,t.user.checkLocalInfoAsync()]:[3,3];case 2:return r.sent(),[2,t.user||null];case 3:return[2,null]}})})},e.prototype.signInAnonymously=function(t){return t===void 0&&(t={}),Z(this,void 0,void 0,function(){return ee(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.authApi.signInAnonymously(t)];case 1:return r.sent(),[2,this.createLoginState()]}})})},e.prototype.signInAnonymouslyInWx=function(t){var r=t===void 0?{}:t,n=r.useWxCloud;return Z(this,void 0,void 0,function(){var o,i,a=this;return ee(this,function(u){switch(u.label){case 0:if(!en.isMatch())throw Error("wx api undefined");return o=wx.getAccountInfoSync().miniProgram,i=function(l){return Z(a,void 0,void 0,function(){var s,c,f;return ee(this,function(d){switch(d.label){case 0:s=void 0,c=void 0,d.label=1;case 1:return d.trys.push([1,4,,5]),[4,this.oauthInstance.authApi.grantProviderToken({provider_id:o==null?void 0:o.appId,provider_code:l,provider_params:{provider_code_type:"open_id",appid:o==null?void 0:o.appId}},n)];case 2:if(s=d.sent(),s!=null&&s.error_code||!s.provider_token)throw s;return[4,this.oauthInstance.authApi.signInAnonymously({provider_token:s.provider_token},n)];case 3:if(c=d.sent(),c!=null&&c.error_code)throw c;return[3,5];case 4:throw f=d.sent(),f;case 5:return[2]}})})},[4,new Promise(function(l,s){wx.login({success:function(c){return Z(a,void 0,void 0,function(){var f;return ee(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),[4,i(c.code)];case 1:return d.sent(),l(!0),[3,3];case 2:return f=d.sent(),s(f),[3,3];case 3:return[2]}})})},fail:function(c){var f=new Error(c==null?void 0:c.errMsg);f.code=c==null?void 0:c.errno,s(f)}})})];case 1:return u.sent(),[2,this.createLoginState(void 0,{asyncRefreshUser:!0})]}})})},e.prototype.bindOpenId=function(){return Z(this,void 0,void 0,function(){var t,r,n=this;return ee(this,function(o){switch(o.label){case 0:if(!en.isMatch())throw Error("wx api undefined");return t=wx.getAccountInfoSync().miniProgram,r=function(i){return Z(n,void 0,void 0,function(){var a,u;return ee(this,function(l){switch(l.label){case 0:a=void 0,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,this.oauthInstance.authApi.grantProviderToken({provider_id:t==null?void 0:t.appId,provider_code:i,provider_params:{provider_code_type:"open_id",appid:t==null?void 0:t.appId}})];case 2:if(a=l.sent(),a!=null&&a.error_code||!a.provider_token)throw a;return[4,this.oauthInstance.authApi.bindWithProvider({provider_token:a.provider_token})];case 3:return l.sent(),[3,5];case 4:throw u=l.sent(),u;case 5:return[2]}})})},[4,new Promise(function(i,a){wx.login({success:function(u){return Z(n,void 0,void 0,function(){var l;return ee(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,r(u.code)];case 1:return s.sent(),i(!0),[3,3];case 2:return l=s.sent(),a(l),[3,3];case 3:return[2]}})})},fail:function(u){var l=new Error(u==null?void 0:u.errMsg);l.code=u==null?void 0:u.errno,a(l)}})})];case 1:return o.sent(),[2]}})})},e.prototype.signInWithOpenId=function(t){var r=t===void 0?{}:t,n=r.useWxCloud,o=n===void 0?!0:n;return Z(this,void 0,void 0,function(){var i,a,u=this;return ee(this,function(l){switch(l.label){case 0:if(!en.isMatch())throw Error("wx api undefined");return i=wx.getAccountInfoSync().miniProgram,a=function(s){return Z(u,void 0,void 0,function(){var c,f,d;return ee(this,function(v){switch(v.label){case 0:c=void 0,f=void 0,v.label=1;case 1:return v.trys.push([1,4,,5]),[4,this.oauthInstance.authApi.grantProviderToken({provider_id:i==null?void 0:i.appId,provider_code:s,provider_params:{provider_code_type:"open_id",appid:i==null?void 0:i.appId}},o)];case 2:if(c=v.sent(),c!=null&&c.error_code||!c.provider_token)throw c;return[4,this.oauthInstance.authApi.signInWithProvider({provider_token:c.provider_token},o)];case 3:if(f=v.sent(),f!=null&&f.error_code)throw f;return[3,5];case 4:throw d=v.sent(),d;case 5:return[4,this.oauthInstance.oauth2client.setCredentials(f)];case 6:return v.sent(),[2]}})})},[4,new Promise(function(s,c){wx.login({success:function(f){return Z(u,void 0,void 0,function(){var d;return ee(this,function(v){switch(v.label){case 0:return v.trys.push([0,2,,3]),[4,a(f.code)];case 1:return v.sent(),s(!0),[3,3];case 2:return d=v.sent(),c(d),[3,3];case 3:return[2]}})})},fail:function(f){var d=new Error(f==null?void 0:f.errMsg);d.code=f==null?void 0:f.errno,c(d)}})})];case 1:return l.sent(),[2,this.createLoginState()]}})})},e.prototype.signInWithUnionId=function(){return Z(this,void 0,void 0,function(){var t,r=this;return ee(this,function(n){switch(n.label){case 0:if(!en.isMatch())throw Error("wx api undefined");n.label=1;case 1:return n.trys.push([1,3,,4]),[4,new Promise(function(o,i){var a=wx.getAccountInfoSync().miniProgram;wx.login({success:function(u){return Z(r,void 0,void 0,function(){var l,s,c,f,d;return ee(this,function(v){switch(v.label){case 0:l=a==null?void 0:a.appId,v.label=1;case 1:return v.trys.push([1,4,,5]),[4,this.oauthInstance.authApi.grantProviderToken({provider_code:u.code,provider_id:l,provider_params:{provider_code_type:"union_id",appid:a==null?void 0:a.appId}})];case 2:return s=v.sent(),c=s.provider_token,c?[4,this.oauthInstance.authApi.signInWithProvider({provider_id:l,provider_token:c})]:(i(s),[2]);case 3:return f=v.sent(),f!=null&&f.error_code?(i(f),[2]):(o(!0),[3,5]);case 4:return d=v.sent(),i(d),[3,5];case 5:return[2]}})})},fail:function(u){var l=new Error(u==null?void 0:u.errMsg);l.code=u==null?void 0:u.errno,i(l)}})})];case 2:return n.sent(),[3,4];case 3:throw t=n.sent(),t;case 4:return[2,this.createLoginState()]}})})},e.prototype.signInWithPhoneAuth=function(t){var r=t.phoneCode,n=r===void 0?"":r;return Z(this,void 0,void 0,function(){var o,i,a,u,l,s;return ee(this,function(c){switch(c.label){case 0:if(!en.isMatch())throw Error("wx api undefined");return o=wx.getAccountInfoSync().miniProgram,i={provider_params:{provider_code_type:"phone"},provider_id:o.appId},[4,wx.login()];case 1:a=c.sent().code,i.provider_code=a,c.label=2;case 2:return c.trys.push([2,6,,7]),[4,this.oauthInstance.authApi.grantProviderToken(i)];case 3:if(u=c.sent(),u.error_code)throw u;return[4,this.oauthInstance.authApi.patchProviderToken({provider_token:u.provider_token,provider_id:o.appId,provider_params:{code:n,provider_code_type:"phone"}})];case 4:if(u=c.sent(),u.error_code)throw u;return[4,this.oauthInstance.authApi.signInWithProvider({provider_token:u.provider_token})];case 5:if(l=c.sent(),l!=null&&l.error_code)throw l;return[3,7];case 6:throw s=c.sent(),s;case 7:return[2,this.createLoginState()]}})})},e.prototype.signInWithSms=function(t){var r=t.verificationInfo,n=r===void 0?{verification_id:"",is_user:!1}:r,o=t.verificationCode,i=o===void 0?"":o,a=t.phoneNum,u=a===void 0?"":a,l=t.bindInfo,s=l===void 0?void 0:l;return Z(this,void 0,void 0,function(){return ee(this,function(c){try{return[2,this.signInWithUsername({verificationInfo:n,verificationCode:i,bindInfo:s,username:u,loginType:"sms"})]}catch(f){throw f}return[2]})})},e.prototype.signInWithEmail=function(t){var r=t.verificationInfo,n=r===void 0?{verification_id:"",is_user:!1}:r,o=t.verificationCode,i=o===void 0?"":o,a=t.bindInfo,u=a===void 0?void 0:a,l=t.email,s=l===void 0?"":l;return Z(this,void 0,void 0,function(){return ee(this,function(c){try{return[2,this.signInWithUsername({verificationInfo:n,verificationCode:i,bindInfo:u,username:s,loginType:"email"})]}catch(f){throw f}return[2]})})},e.prototype.setCustomSignFunc=function(t){this.oauthInstance.authApi.setCustomSignFunc(t)},e.prototype.signInWithCustomTicket=function(){return Z(this,void 0,void 0,function(){return ee(this,function(t){switch(t.label){case 0:return[4,this.oauthInstance.authApi.signInWithCustomTicket()];case 1:return t.sent(),[2,this.createLoginState()]}})})},e.prototype.signIn=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.authApi.signIn(t)];case 1:return r.sent(),[2,this.createLoginState(t)]}})})},e.prototype.signUp=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.authApi.signUp(t)];case 1:return r.sent(),[2,this.createLoginState()]}})})},e.prototype.setPassword=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.setPassword(t)]})})},e.prototype.isUsernameRegistered=function(t){return Z(this,void 0,void 0,function(){var r;return ee(this,function(n){switch(n.label){case 0:return typeof t!="string"&&Bu(we.ERRORS.INVALID_PARAMS,"username must be a string"),[4,this.oauthInstance.authApi.checkIfUserExist({username:t})];case 1:return r=n.sent().exist,[2,r]}})})},e.prototype.signOut=function(t){return Z(this,void 0,void 0,function(){var r,n;return ee(this,function(o){switch(o.label){case 0:return r=this.cache.keys.userInfoKey,[4,this.oauthInstance.authApi.signOut(t)];case 1:return n=o.sent(),[4,this.cache.removeStoreAsync(r)];case 2:return o.sent(),_a.fire(ya.LOGIN_STATE_CHANGED,{eventType:ga.SIGN_OUT}),[2,n]}})})},e.prototype.hasLoginState=function(){var t;if(this.cache.mode==="async"){za(we.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use getLoginState insteed");return}var r=(t=this.oauthInstance)===null||t===void 0?void 0:t.authApi.hasLoginStateSync();if(r){var n=new Bc({envId:this.config.env,cache:this.cache,oauthInstance:this.oauthInstance});return n}return null},e.prototype.getLoginState=function(){return Z(this,void 0,void 0,function(){var t,r;return ee(this,function(n){switch(n.label){case 0:t=null,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.oauthInstance.authApi.getLoginState()];case 2:return t=n.sent(),[3,4];case 3:return n.sent(),[2,null];case 4:return t?(r=new Bc({envId:this.config.env,cache:this.cache,oauthInstance:this.oauthInstance}),[2,r]):[2,null]}})})},e.prototype.getUserInfo=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.getUserInfo(t)]})})},e.prototype.getWedaUserInfo=function(){return Z(this,void 0,void 0,function(){return ee(this,function(t){return[2,this.oauthInstance.authApi.getWedaUserInfo()]})})},e.prototype.updateUserBasicInfo=function(t){return Z(this,void 0,void 0,function(){var r;return ee(this,function(n){switch(n.label){case 0:return[4,this.getLoginState()];case 1:return r=n.sent(),r?[4,r.user.updateUserBasicInfo(t)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.getAuthHeader=function(){return console.error("Auth.getAuthHeader API 已废弃"),{}},e.prototype.bindWithProvider=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.bindWithProvider(t)]})})},e.prototype.queryUser=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.queryUserProfile(t)]})})},e.prototype.getAccessToken=function(){return Z(this,void 0,void 0,function(){var t;return ee(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.oauth2client.getAccessToken()];case 1:return t=r.sent(),[2,{accessToken:t,env:this.config.env}]}})})},e.prototype.grantProviderToken=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.grantProviderToken(t)]})})},e.prototype.patchProviderToken=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.patchProviderToken(t)]})})},e.prototype.signInWithProvider=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.authApi.signInWithProvider(t)];case 1:return r.sent(),[2,this.createLoginState(t)]}})})},e.prototype.signInWithWechat=function(t){return t===void 0&&(t={}),Z(this,void 0,void 0,function(){return ee(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.authApi.signInWithWechat(t)];case 1:return r.sent(),[2,this.createLoginState(t)]}})})},e.prototype.grantToken=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.authApi.grantToken(t)];case 1:return r.sent(),[2,this.createLoginState()]}})})},e.prototype.genProviderRedirectUri=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.genProviderRedirectUri(t)]})})},e.prototype.resetPassword=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.resetPassword(t)]})})},e.prototype.deviceAuthorize=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.deviceAuthorize(t)]})})},e.prototype.sudo=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.sudo(t)]})})},e.prototype.deleteMe=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.deleteMe(t)]})})},e.prototype.getProviders=function(){return Z(this,void 0,void 0,function(){return ee(this,function(t){return[2,this.oauthInstance.authApi.getProviders()]})})},e.prototype.loginScope=function(){return Z(this,void 0,void 0,function(){return ee(this,function(t){return[2,this.oauthInstance.authApi.loginScope()]})})},e.prototype.loginGroups=function(){return Z(this,void 0,void 0,function(){return ee(this,function(t){return[2,this.oauthInstance.authApi.loginGroups()]})})},e.prototype.onLoginStateChanged=function(t){return Z(this,void 0,void 0,function(){var r,n=this;return ee(this,function(o){switch(o.label){case 0:return _a.on(ya.LOGIN_STATE_CHANGED,function(i){return Z(n,void 0,void 0,function(){var a,u,l;return ee(this,function(s){switch(s.label){case 0:return((l=i==null?void 0:i.data)===null||l===void 0?void 0:l.eventType)===ga.CREDENTIALS_ERROR?[3,2]:[4,this.getLoginState()];case 1:return u=s.sent(),[3,3];case 2:u={},s.label=3;case 3:return a=u,t.call(this,gt(gt({},i),a)),[2]}})})}),[4,this.getLoginState()];case 1:return r=o.sent(),t.call(this,r),[2]}})})},e.prototype.refreshTokenForce=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.refreshTokenForce(t)]})})},e.prototype.getCredentials=function(){return Z(this,void 0,void 0,function(){return ee(this,function(t){return[2,this.oauthInstance.authApi.getCredentials()]})})},e.prototype.setCredentials=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.oauth2client.setCredentials(t)];case 1:return r.sent(),[2]}})})},e.prototype.getProviderSubType=function(){return Z(this,void 0,void 0,function(){return ee(this,function(t){return[2,this.oauthInstance.authApi.getProviderSubType()]})})},e.prototype.createCaptchaData=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.createCaptchaData(t)]})})},e.prototype.verifyCaptchaData=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.verifyCaptchaData(t)]})})},e.prototype.getMiniProgramQrCode=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.getMiniProgramCode(t)]})})},e.prototype.getMiniProgramQrCodeStatus=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.getMiniProgramQrCodeStatus(t)]})})},e.prototype.modifyPassword=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.modifyPassword(t)]})})},e.prototype.modifyPasswordWithoutLogin=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.modifyPasswordWithoutLogin(t)]})})},e.prototype.getUserBehaviorLog=function(t){return Z(this,void 0,void 0,function(){return ee(this,function(r){return[2,this.oauthInstance.authApi.getUserBehaviorLog(t)]})})},e.prototype.toDefaultLoginPage=function(t){return t===void 0&&(t={}),Z(this,void 0,void 0,function(){var r,n,o,i;return ee(this,function(a){return r=t.config_version||"env",en.isMatch()?wx.navigateTo({url:"/packages/$wd_system/pages/login/index"}):(n=t.redirect_uri||window.location.href,o=new URL(n),i="".concat(o.origin,"/__auth/?app_id=").concat(t.app_id||"","&env_id=").concat(this.config.env,"&client_id=").concat(this.config.clientId,"&config_version=").concat(r,"&redirect_uri=").concat(encodeURIComponent(n)),window.location.href=i),[2]})})},e.prototype.createLoginState=function(t,r){return Z(this,void 0,void 0,function(){var n;return ee(this,function(o){switch(o.label){case 0:return n=new Bc({envId:this.config.env,cache:this.cache,oauthInstance:this.oauthInstance}),[4,n.checkLocalStateAsync()];case 1:return o.sent(),r!=null&&r.asyncRefreshUser?(n.user.refresh(t),[3,4]):[3,2];case 2:return[4,n.user.refresh(t)];case 3:o.sent(),o.label=4;case 4:return _a.fire(ya.LOGIN_STATE_CHANGED,{eventType:ga.SIGN_IN}),[2,n]}})})},e.prototype.signInWithUsername=function(t){var r=t.verificationInfo,n=r===void 0?{verification_id:"",is_user:!1}:r,o=t.verificationCode,i=o===void 0?"":o,a=t.username,u=a===void 0?"":a,l=t.bindInfo,s=l===void 0?void 0:l,c=t.loginType,f=c===void 0?"":c;return Z(this,void 0,void 0,function(){var d,v,g,b,w,_,E,A;return ee(this,function(I){switch(I.label){case 0:return I.trys.push([0,8,,9]),[4,this.oauthInstance.authApi.verify({verification_id:n.verification_id,verification_code:i})];case 1:if(d=I.sent(),d!=null&&d.error_code)throw d;return v=d.verification_token,g="+86 ".concat(u),b={phone_number:g},f==="email"&&(g=u,b={email:g}),n.is_user?[4,this.oauthInstance.authApi.signIn({username:g,verification_token:v})]:[3,5];case 2:if(w=I.sent(),w!=null&&w.error_code)throw w;return s?[4,this.oauthInstance.authApi.bindWithProvider({provider_token:s==null?void 0:s.providerToken})]:[3,4];case 3:if(_=I.sent(),_!=null&&_.error_code)throw _;I.label=4;case 4:return[3,7];case 5:return[4,this.oauthInstance.authApi.signUp(gt(gt({},b),{verification_token:v,provider_token:s==null?void 0:s.providerId}))];case 6:if(E=I.sent(),E!=null&&E.error_code)throw E;I.label=7;case 7:return[2,this.createLoginState()];case 8:throw A=I.sent(),A;case 9:return[2]}})})},Ue([De.catchErrorsDecorator({title:"绑定手机号失败",messages:["请确认以下各项：","  1 - 调用 auth().bindPhoneNumber() 的语法或参数是否正确","  2 - 当前环境是否开通了短信验证码登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],e.prototype,"bindPhoneNumber",null),Ue([De.catchErrorsDecorator({title:"解除三方绑定失败",messages:["请确认以下各项：","  1 - 调用 auth().unbindProvider() 的语法或参数是否正确","  2 - 当前账户是否已经与此登录方式解绑","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],e.prototype,"unbindProvider",null),Ue([De.catchErrorsDecorator({title:"绑定邮箱地址失败",messages:["请确认以下各项：","  1 - 调用 auth().bindEmail() 的语法或参数是否正确","  2 - 当前环境是否开通了邮箱密码登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",void 0)],e.prototype,"bindEmail",null),Ue([De.catchErrorsDecorator({title:"验证码验证失败",messages:["请确认以下各项：","  1 - 调用 auth().verify() 的语法或参数是否正确","  2 - 当前环境是否开通了手机验证码/邮箱登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],e.prototype,"verify",null),Ue([De.catchErrorsDecorator({title:"获取验证码失败",messages:["请确认以下各项：","  1 - 调用 auth().getVerification() 的语法或参数是否正确","  2 - 当前环境是否开通了手机验证码/邮箱登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[Object,Object]),z("design:returntype",Promise)],e.prototype,"getVerification",null),Ue([De.catchErrorsDecorator({title:"获取用户信息失败",messages:["请确认以下各项：","  1 - 调用 auth().getCurrentUser() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[]),z("design:returntype",Promise)],e.prototype,"getCurrentUser",null),Ue([De.catchErrorsDecorator({title:"匿名登录失败",messages:["请确认以下各项：","  1 - 当前环境是否开启了匿名登录","  2 - 调用 auth().signInAnonymously() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],e.prototype,"signInAnonymously",null),Ue([De.catchErrorsDecorator({title:"小程序匿名登录失败",messages:["请确认以下各项：","  1 - 当前环境是否开启了匿名登录","  2 - 调用 auth().signInAnonymouslyInWx() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],e.prototype,"signInAnonymouslyInWx",null),Ue([De.catchErrorsDecorator({title:"小程序绑定OpenID失败",messages:["请确认以下各项：","  1 - 当前环境是否开启了小程序openId静默登录","  2 - 调用 auth().bindOpenId() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[]),z("design:returntype",Promise)],e.prototype,"bindOpenId",null),Ue([De.catchErrorsDecorator({title:"小程序openId静默登录失败",messages:["请确认以下各项：","  1 - 当前环境是否开启了小程序openId静默登录","  2 - 调用 auth().signInWithOpenId() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],e.prototype,"signInWithOpenId",null),Ue([De.catchErrorsDecorator({title:"小程序unionId静默登录失败",messages:["请确认以下各项：","  1 - 当前环境是否开启了小程序unionId静默登录","  2 - 调用 auth().signInWithUnionId() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[]),z("design:returntype",Promise)],e.prototype,"signInWithUnionId",null),Ue([De.catchErrorsDecorator({title:"小程序手机号授权登录失败",messages:["请确认以下各项：","  1 - 当前环境是否开启了小程序手机号授权登录","  2 - 调用 auth().signInWithPhoneAuth() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],e.prototype,"signInWithPhoneAuth",null),Ue([De.catchErrorsDecorator({title:"短信验证码登陆",messages:["请确认以下各项：","  1 - 当前环境是否开启了小程序短信验证码登陆","  2 - 调用 auth().signInWithSms() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],e.prototype,"signInWithSms",null),Ue([De.catchErrorsDecorator({title:"邮箱验证码登陆",messages:["请确认以下各项：","  1 - 当前环境是否开启了邮箱登陆","  2 - 调用 auth().signInWithEmail() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],e.prototype,"signInWithEmail",null),Ue([De.catchErrorsDecorator({title:"自定义登录失败",messages:["请确认以下各项：","  1 - 当前环境是否开启了自定义登录","  2 - 调用 auth().signInWithCustomTicket() 的语法或参数是否正确","  3 - ticket 是否归属于当前环境","  4 - 创建 ticket 的自定义登录私钥是否过期","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[]),z("design:returntype",Promise)],e.prototype,"signInWithCustomTicket",null),Ue([De.catchErrorsDecorator({title:"注册失败",messages:["请确认以下各项：","  1 - 当前环境是否开启了指定登录方式","  2 - 调用 auth().signUp() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],e.prototype,"signUp",null),Ue([De.catchErrorsDecorator({title:"获取用户是否被占用失败",messages:["请确认以下各项：","  1 - 调用 auth().isUsernameRegistered() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[String]),z("design:returntype",Promise)],e.prototype,"isUsernameRegistered",null),Ue([De.catchErrorsDecorator({title:"用户登出失败",messages:["请确认以下各项：","  1 - 调用 auth().signOut() 的语法或参数是否正确","  2 - 当前用户是否为匿名登录（匿名登录不支持signOut）","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],e.prototype,"signOut",null),Ue([De.catchErrorsDecorator({title:"获取本地登录态失败",messages:["请确认以下各项：","  1 - 调用 auth().getLoginState() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[]),z("design:returntype",Promise)],e.prototype,"getLoginState",null),Ue([De.catchErrorsDecorator({title:"获取用户信息失败",messages:["请确认以下各项：","  1 - 是否已登录","  2 - 调用 auth().getUserInfo() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],e.prototype,"getUserInfo",null),Ue([De.catchErrorsDecorator({title:"获取微搭插件用户信息失败",messages:["请确认以下各项：","  1 - 是否已登录","  2 - 调用 auth().getWedaUserInfo() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[]),z("design:returntype",Promise)],e.prototype,"getWedaUserInfo",null),Ue([De.catchErrorsDecorator({title:"绑定第三方登录方式失败",messages:["请确认以下各项：","  1 - 调用 auth().bindWithProvider() 的语法或参数是否正确","  2 - 此账户是否已经绑定此第三方","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],e.prototype,"bindWithProvider",null),Ue([De.catchErrorsDecorator({title:"获取身份源类型",messages:["请确认以下各项：","  1 - 调用 auth().getProviderSubType() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(we.COMMUNITY_SITE_URL)]}),z("design:type",Function),z("design:paramtypes",[]),z("design:returntype",Promise)],e.prototype,"getProviderSubType",null),e}();function IO(e,t){var r=e.region,n=r===void 0?"ap-shanghai":r,o=e.i18n,i=e.publishable_key,a=(t==null?void 0:t.platform)||n0.useDefaultAdapter(),u=a.runtime,l=a.adapter,s=t||{},c=s.env,f=s.clientId,d=s.debug,v=s.cache,g=s.app,b=(t||{}).apiOrigin;b||(b="https://".concat(c,".").concat(n,".tcb-api.tencentcloudapi.com"));var w={env:c,clientId:f,i18n:o,publishable_key:i},_=new EI(_O(gt(gt({},w),{apiOrigin:b,apiPath:(e==null?void 0:e.apiPath)||Fu,storage:e==null?void 0:e.storage,baseRequest:e==null?void 0:e.baseRequest,request:e==null?void 0:e.request,anonymousSignInFunc:e==null?void 0:e.anonymousSignInFunc,captchaOptions:e==null?void 0:e.captchaOptions,wxCloud:e==null?void 0:e.wxCloud,adapter:l,onCredentialsError:wO,headers:e.headers||{}}))),E=new SO(gt(gt({},w),{region:n,persistence:e.persistence,debug:d,cache:v||new r0({persistence:e.persistence,keys:{userInfoKey:"user_info_".concat(c)},platformInfo:a}),runtime:u||"web",_fromApp:g,oauthInstance:_}));return{authInstance:E,oauthInstance:_}}var a0={name:bO,namespace:"auth",entity:function(e){if(e===void 0&&(e={region:"",persistence:"local",apiPath:Fu}),this.authInstance)return za(we.ERRORS.INVALID_OPERATION,"every cloudbase instance should has only one auth object"),this.authInstance;var t=this.platform.adapter,r=e.persistence||t.primaryStorage;r&&r!==this.config.persistence&&this.updateConfig({persistence:r});var n=IO(gt(gt({wxCloud:this.config.wxCloud,storage:this.config.storage},e),{persistence:this.config.persistence,i18n:this.config.i18n,publishable_key:this.config.publishable_key}),{env:this.config.env,clientId:this.config.clientId,apiOrigin:this.request.getBaseEndPoint(),platform:this.platform,cache:this.cache,app:this,debug:this.config.debug}),o=n.authInstance,i=n.oauthInstance;return this.oauthInstance=i,this.authInstance=o,this.authInstance}};try{cloudbase.registerComponent(a0)}catch{}function OO(e){try{e.registerComponent(a0)}catch(t){console.warn(t)}}var Ja=function(){return Ja=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ja.apply(this,arguments)},u0=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},c0=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},np=jt,Pl="cloudrun",TO=function(){function e(){}return e.prototype.callContainer=function(t){return u0(this,void 0,void 0,function(){var r,n,o;return c0(this,function(i){switch(i.label){case 0:if(r=t.name,n=t.data,!r)throw new Error(JSON.stringify({code:np.INVALID_PARAMS,msg:"[".concat(Pl,".callContainer] invalid name")}));try{o=n?JSON.stringify(n):""}catch{throw new Error(JSON.stringify({code:np.INVALID_PARAMS,msg:"[".concat(Pl,".callContainer] invalid data")}))}return[4,l0.call(this,Ja(Ja({},t),{data:o}))];case 1:return[2,i.sent()]}})})},e}();function l0(e){return u0(this,void 0,void 0,function(){var t,r,n,o,i,a,u,l,s,c;return c0(this,function(f){switch(f.label){case 0:return t=e.name,r=e.data,n=e.path,o=n===void 0?"":n,i=e.method,a=e.header,u=a===void 0?{}:a,l="https://".concat(this.config.env,".api.tcloudbasegateway.com/v1/cloudrun/").concat(t),s=o.startsWith("/")?o:"/".concat(o),[4,this.request.fetch({method:i||"POST",headers:Object.assign({},{"Content-Type":"application/json; charset=utf-8"},u),body:r,url:"".concat(l).concat(s)})];case 1:return c=f.sent(),[4,c.data];case 2:return[2,f.sent()]}})})}var AO=new TO,f0={name:Pl,entity:{callContainer:AO.callContainer}};try{cloudbase.registerComponent(f0)}catch{}function RO(e){try{e.registerComponent(f0)}catch(t){console.warn(t)}}var Ya=function(){return Ya=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ya.apply(this,arguments)},CO=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(a=e[u])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},jc=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},xO=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},PO=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},NO=Au,kc=jt,$O=Ru,Io=Ng,DO=Pu,ba="functions",LO=function(){function e(){}return e.prototype.callFunction=function(t,r){var n,o;return xO(this,void 0,void 0,function(){var i,a,u,l,s,c,f,d,v,g,b,w,_,$,E,A,I,R,$,L;return PO(this,function(D){switch(D.label){case 0:if(i=t.name,a=t.data,u=t.query,l=t.parse,s=t.search,c=t.type,f=t.path,d=f===void 0?"":f,v=t.method,g=t.header,b=g===void 0?{}:g,!i)throw new Error(JSON.stringify({code:kc.INVALID_PARAMS,msg:"[".concat(ba,".callFunction] invalid function name")}));try{w=a?JSON.stringify(a):""}catch{throw new Error(JSON.stringify({code:kc.INVALID_PARAMS,msg:"[".concat(ba,".callFunction] invalid data")}))}return c!=="cloudrun"?[3,2]:(_=C1(),[4,l0.call(this,{name:i,data:w,path:d,method:v,header:Ya(Ya({},b),{"X-Request-Id":_})})]);case 1:return $=D.sent(),[2,{result:$,requestId:_}];case 2:E="functions.invokeFunction",A={inQuery:u,parse:l,search:s,function_name:i,request_data:w},I=this.request,D.label=3;case 3:return D.trys.push([3,5,,6]),[4,I.send(E,A,{defaultQuery:!((n=a==null?void 0:a.params)===null||n===void 0)&&n.action?{action:(o=a==null?void 0:a.params)===null||o===void 0?void 0:o.action}:{}})];case 4:if(R=D.sent(),R.code)return[2,Io(r,null,R)];if($=R.data.response_data,l)return[2,Io(r,null,{result:$,requestId:R.requestId})];try{return $=JSON.parse(R.data.response_data),[2,Io(r,null,{result:$,requestId:R.requestId})]}catch{Io(r,new Error("[".concat(NO(),"][").concat(kc.INVALID_PARAMS,"][").concat(ba,".callFunction] response data must be json")))}return[3,6];case 5:return L=D.sent(),Io(r,L),[3,6];case 6:return[2]}})})},CO([DO({customInfo:{},title:"函数调用失败",messages:["请确认以下各项：","  1 - 调用 callFunction() 的语法或参数是否正确","  2 - 当前环境下是否存在此函数","  3 - 函数安全规则是否限制了当前登录状态访问","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat($O)]}),jc("design:type",Function),jc("design:paramtypes",[Object,Function]),jc("design:returntype",Promise)],e.prototype,"callFunction",null),e}(),UO=new LO,d0={name:ba,entity:{callFunction:UO.callFunction}};try{cloudbase.registerComponent(d0)}catch{}function FO(e){try{e.registerComponent(d0)}catch(t){console.warn(t)}}var wn=function(){return wn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},wn.apply(this,arguments)},Oo=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(a=e[u])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},bt=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},To=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Ao=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Nr;(function(e){e.put="put",e.post="post"})(Nr||(Nr={}));var MO=Au,Yr=jt,Ro=Ru,ip=Rg,Co=Cg,BO=T1,Ar=Ng,xo=Pu,xr="storage",jO=function(){function e(){}return e.prototype.uploadFile=function(t,r){return To(this,void 0,void 0,function(){var n,o,i,a,u,l,s,c,f,d,v,g,b,w,_,E,A,I,R,$,L,D,P,k,F,Q;return Ao(this,function(ce){switch(ce.label){case 0:if(n=t.cloudPath,o=t.filePath,i=t.onUploadProgress,a=t.method,u=a===void 0?"put":a,l=t.headers,s=l===void 0?{}:l,!Co(n)||!o)throw new Error(JSON.stringify({code:Yr.INVALID_PARAMS,msg:"[".concat(xr,".uploadFile] invalid params")}));return c={put:Nr.put,post:Nr.post}[u.toLocaleLowerCase()]||Nr.put,f="storage.getUploadMetadata",d=this.request,v={path:n,method:c},c===Nr.put&&(v.headers=s),[4,d.send(f,v)];case 1:return g=ce.sent(),b=g.data,w=b.url,_=b.authorization,E=b.token,A=b.fileId,I=b.cosFileId,R=b.download_url,$=g.requestId,L={url:w,file:o,name:n,onUploadProgress:i},D=wn(wn({},L),{method:Nr.put,headers:wn(wn({},s),{authorization:_,"x-cos-meta-fileid":I,"x-cos-security-token":E})}),P=wn(wn({},L),{method:Nr.post,data:{key:n,signature:_,"x-cos-meta-fileid":I,success_action_status:"201","x-cos-security-token":E}}),k=(Q={},Q[Nr.put]={params:D,isSuccess:function(B){return B>=200&&B<300}},Q[Nr.post]={params:P,isSuccess:function(B){return B===201}},Q),[4,d.upload(k[c].params)];case 2:return F=ce.sent(),k[c].isSuccess(F.statusCode)?[2,Ar(r,null,{fileID:A,download_url:R,requestId:$})]:[2,Ar(r,new Error("[".concat(MO(),"][").concat(Yr.OPERATION_FAIL,"][").concat(xr,"]:").concat(F.data)))]}})})},e.prototype.getUploadMetadata=function(t,r){return To(this,void 0,void 0,function(){var n,o,i,a,u;return Ao(this,function(l){switch(l.label){case 0:if(n=t.cloudPath,!Co(n))throw new Error(JSON.stringify({code:Yr.INVALID_PARAMS,msg:"[".concat(xr,".getUploadMetadata] invalid cloudPath")}));o=this.request,i="storage.getUploadMetadata",l.label=1;case 1:return l.trys.push([1,3,,4]),[4,o.send(i,{path:n})];case 2:return a=l.sent(),[2,Ar(r,null,a)];case 3:return u=l.sent(),[2,Ar(r,u)];case 4:return[2]}})})},e.prototype.deleteFile=function(t,r){return To(this,void 0,void 0,function(){var n,o,i,a,u,l,s,c;return Ao(this,function(f){switch(f.label){case 0:if(n=t.fileList,!n||!ip(n)||n.length===0)throw new Error(JSON.stringify({code:Yr.INVALID_PARAMS,msg:"[".concat(xr,".deleteFile] fileList must not be empty")}));for(o=0,i=n;o<i.length;o++)if(a=i[o],!a||!Co(a))throw new Error(JSON.stringify({code:Yr.INVALID_PARAMS,msg:"[".concat(xr,".deleteFile] fileID must be string")}));return u="storage.batchDeleteFile",l=this.request,[4,l.send(u,{fileid_list:n})];case 1:return s=f.sent(),s.code?[2,Ar(r,null,s)]:(c={fileList:s.data.delete_list,requestId:s.requestId},[2,Ar(r,null,c)])}})})},e.prototype.getTempFileURL=function(t,r){return To(this,void 0,void 0,function(){var n,o,i,a,u,l,s,c;return Ao(this,function(f){switch(f.label){case 0:if(n=t.fileList,!n||!ip(n)||n.length===0)throw new Error(JSON.stringify({code:Yr.INVALID_PARAMS,msg:"[".concat(xr,".getTempFileURL] fileList must not be empty")}));for(o=[],i=0,a=n;i<a.length;i++)if(u=a[i],BO(u)){if(!Object.prototype.hasOwnProperty.call(u,"fileID")||!Object.prototype.hasOwnProperty.call(u,"maxAge"))throw new Error(JSON.stringify({code:Yr.INVALID_PARAMS,msg:"[".concat(xr,".getTempFileURL] file info must include fileID and maxAge")}));o.push({fileid:u.fileID,max_age:u.maxAge})}else if(Co(u))o.push({fileid:u});else throw new Error(JSON.stringify({code:Yr.INVALID_PARAMS,msg:"[".concat(xr,".getTempFileURL] invalid fileList")}));return l="storage.batchGetDownloadUrl",s=this.request,[4,s.send(l,{file_list:o})];case 1:return c=f.sent(),c.code?[2,Ar(r,null,c)]:[2,Ar(r,null,{fileList:c.data.download_list,requestId:c.requestId})]}})})},e.prototype.downloadFile=function(t,r){return To(this,void 0,void 0,function(){var n,o,i,a,u,l;return Ao(this,function(s){switch(s.label){case 0:if(n=t.fileID,!Co(n))throw new Error(JSON.stringify({code:Yr.INVALID_PARAMS,msg:"[".concat(xr,".getTempFileURL] fileID must be string")}));return[4,this.getTempFileURL.call(this,{fileList:[{fileID:n,maxAge:600}]})];case 1:return o=s.sent(),i=o.fileList[0],i.code!=="SUCCESS"?[2,Ar(r,i)]:(a=this.request,u=encodeURI(i.download_url),[4,a.download({url:u})]);case 2:return l=s.sent(),[2,Ar(r,null,l)]}})})},Oo([xo({customInfo:{},title:"上传文件失败",messages:["请确认以下各项：","  1 - 调用 uploadFile() 的语法或参数是否正确","  2 - 当前域名是否在安全域名列表中：https://console.cloud.tencent.com/tcb/env/safety","  3 - 云存储安全规则是否限制了当前登录状态访问","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Ro)]}),bt("design:type",Function),bt("design:paramtypes",[Object,Function]),bt("design:returntype",Promise)],e.prototype,"uploadFile",null),Oo([xo({customInfo:{},title:"获取上传元信息失败",messages:["请确认以下各项：","  1 - 调用 getUploadMetadata() 的语法或参数是否正确","  2 - 当前域名是否在安全域名列表中：https://console.cloud.tencent.com/tcb/env/safety","  3 - 云存储安全规则是否限制了当前登录状态访问","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Ro)]}),bt("design:type",Function),bt("design:paramtypes",[Object,Function]),bt("design:returntype",Promise)],e.prototype,"getUploadMetadata",null),Oo([xo({customInfo:{},title:"删除文件失败",messages:["请确认以下各项：","  1 - 调用 deleteFile() 的语法或参数是否正确","  2 - 当前域名是否在安全域名列表中：https://console.cloud.tencent.com/tcb/env/safety","  3 - 云存储安全规则是否限制了当前登录状态访问","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Ro)]}),bt("design:type",Function),bt("design:paramtypes",[Object,Function]),bt("design:returntype",Promise)],e.prototype,"deleteFile",null),Oo([xo({customInfo:{},title:"获取文件下载链接",messages:["请确认以下各项：","  1 - 调用 getTempFileURL() 的语法或参数是否正确","  2 - 当前域名是否在安全域名列表中：https://console.cloud.tencent.com/tcb/env/safety","  3 - 云存储安全规则是否限制了当前登录状态访问","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Ro)]}),bt("design:type",Function),bt("design:paramtypes",[Object,Function]),bt("design:returntype",Promise)],e.prototype,"getTempFileURL",null),Oo([xo({customInfo:{},title:"下载文件失败",messages:["请确认以下各项：","  1 - 调用 downloadFile() 的语法或参数是否正确","  2 - 当前域名是否在安全域名列表中：https://console.cloud.tencent.com/tcb/env/safety","  3 - 云存储安全规则是否限制了当前登录状态访问","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(Ro)]}),bt("design:type",Function),bt("design:paramtypes",[Object,Function]),bt("design:returntype",Promise)],e.prototype,"downloadFile",null),e}(),Po=new jO,h0={name:xr,entity:{uploadFile:Po.uploadFile,deleteFile:Po.deleteFile,getTempFileURL:Po.getTempFileURL,downloadFile:Po.downloadFile,getUploadMetadata:Po.getUploadMetadata}};try{cloudbase.registerComponent(h0)}catch{}function kO(e){try{e.registerComponent(h0)}catch(t){console.warn(t)}}var qO=typeof ye=="object"&&ye&&ye.Object===Object&&ye,p0=qO,WO=p0,HO=typeof self=="object"&&self&&self.Object===Object&&self,GO=WO||HO||Function("return this")(),Gr=GO,VO=Gr,KO=VO.Symbol,ku=KO,op=ku,v0=Object.prototype,zO=v0.hasOwnProperty,JO=v0.toString,No=op?op.toStringTag:void 0;function YO(e){var t=zO.call(e,No),r=e[No];try{e[No]=void 0;var n=!0}catch{}var o=JO.call(e);return n&&(t?e[No]=r:delete e[No]),o}var QO=YO,XO=Object.prototype,ZO=XO.toString;function eT(e){return ZO.call(e)}var tT=eT,sp=ku,rT=QO,nT=tT,iT="[object Null]",oT="[object Undefined]",ap=sp?sp.toStringTag:void 0;function sT(e){return e==null?e===void 0?oT:iT:ap&&ap in Object(e)?rT(e):nT(e)}var Ds=sT;function aT(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var ao=aT,uT=Ds,cT=ao,lT="[object AsyncFunction]",fT="[object Function]",dT="[object GeneratorFunction]",hT="[object Proxy]";function pT(e){if(!cT(e))return!1;var t=uT(e);return t==fT||t==dT||t==lT||t==hT}var m0=pT,vT=Gr,mT=vT["__core-js_shared__"],gT=mT,qc=gT,up=function(){var e=/[^.]+$/.exec(qc&&qc.keys&&qc.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function yT(e){return!!up&&up in e}var _T=yT,bT=Function.prototype,wT=bT.toString;function ET(e){if(e!=null){try{return wT.call(e)}catch{}try{return e+""}catch{}}return""}var g0=ET,ST=m0,IT=_T,OT=ao,TT=g0,AT=/[\\^$.*+?()[\]{}|]/g,RT=/^\[object .+?Constructor\]$/,CT=Function.prototype,xT=Object.prototype,PT=CT.toString,NT=xT.hasOwnProperty,$T=RegExp("^"+PT.call(NT).replace(AT,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function DT(e){if(!OT(e)||IT(e))return!1;var t=ST(e)?$T:RT;return t.test(TT(e))}var LT=DT;function UT(e,t){return e==null?void 0:e[t]}var FT=UT,MT=LT,BT=FT;function jT(e,t){var r=BT(e,t);return MT(r)?r:void 0}var bi=jT,kT=bi,qT=function(){try{var e=kT(Object,"defineProperty");return e({},"",{}),e}catch{}}(),WT=qT,cp=WT;function HT(e,t,r){t=="__proto__"&&cp?cp(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var y0=HT;function GT(e,t){return e===t||e!==e&&t!==t}var _0=GT,VT=y0,KT=_0,zT=Object.prototype,JT=zT.hasOwnProperty;function YT(e,t,r){var n=e[t];(!(JT.call(e,t)&&KT(n,r))||r===void 0&&!(t in e))&&VT(e,t,r)}var Kf=YT,QT=Array.isArray,uo=QT;function XT(e){return e!=null&&typeof e=="object"}var co=XT,ZT=Ds,eA=co,tA="[object Symbol]";function rA(e){return typeof e=="symbol"||eA(e)&&ZT(e)==tA}var zf=rA,nA=uo,iA=zf,oA=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,sA=/^\w*$/;function aA(e,t){if(nA(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||iA(e)?!0:sA.test(e)||!oA.test(e)||t!=null&&e in Object(t)}var uA=aA,cA=bi,lA=cA(Object,"create"),qu=lA,lp=qu;function fA(){this.__data__=lp?lp(null):{},this.size=0}var dA=fA;function hA(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var pA=hA,vA=qu,mA="__lodash_hash_undefined__",gA=Object.prototype,yA=gA.hasOwnProperty;function _A(e){var t=this.__data__;if(vA){var r=t[e];return r===mA?void 0:r}return yA.call(t,e)?t[e]:void 0}var bA=_A,wA=qu,EA=Object.prototype,SA=EA.hasOwnProperty;function IA(e){var t=this.__data__;return wA?t[e]!==void 0:SA.call(t,e)}var OA=IA,TA=qu,AA="__lodash_hash_undefined__";function RA(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=TA&&t===void 0?AA:t,this}var CA=RA,xA=dA,PA=pA,NA=bA,$A=OA,DA=CA;function lo(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}lo.prototype.clear=xA;lo.prototype.delete=PA;lo.prototype.get=NA;lo.prototype.has=$A;lo.prototype.set=DA;var LA=lo;function UA(){this.__data__=[],this.size=0}var FA=UA,MA=_0;function BA(e,t){for(var r=e.length;r--;)if(MA(e[r][0],t))return r;return-1}var Wu=BA,jA=Wu,kA=Array.prototype,qA=kA.splice;function WA(e){var t=this.__data__,r=jA(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():qA.call(t,r,1),--this.size,!0}var HA=WA,GA=Wu;function VA(e){var t=this.__data__,r=GA(t,e);return r<0?void 0:t[r][1]}var KA=VA,zA=Wu;function JA(e){return zA(this.__data__,e)>-1}var YA=JA,QA=Wu;function XA(e,t){var r=this.__data__,n=QA(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var ZA=XA,eR=FA,tR=HA,rR=KA,nR=YA,iR=ZA;function fo(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}fo.prototype.clear=eR;fo.prototype.delete=tR;fo.prototype.get=rR;fo.prototype.has=nR;fo.prototype.set=iR;var Hu=fo,oR=bi,sR=Gr,aR=oR(sR,"Map"),Jf=aR,fp=LA,uR=Hu,cR=Jf;function lR(){this.size=0,this.__data__={hash:new fp,map:new(cR||uR),string:new fp}}var fR=lR;function dR(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var hR=dR,pR=hR;function vR(e,t){var r=e.__data__;return pR(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Gu=vR,mR=Gu;function gR(e){var t=mR(this,e).delete(e);return this.size-=t?1:0,t}var yR=gR,_R=Gu;function bR(e){return _R(this,e).get(e)}var wR=bR,ER=Gu;function SR(e){return ER(this,e).has(e)}var IR=SR,OR=Gu;function TR(e,t){var r=OR(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var AR=TR,RR=fR,CR=yR,xR=wR,PR=IR,NR=AR;function ho(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ho.prototype.clear=RR;ho.prototype.delete=CR;ho.prototype.get=xR;ho.prototype.has=PR;ho.prototype.set=NR;var b0=ho,w0=b0,$R="Expected a function";function Yf(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError($R);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(Yf.Cache||w0),r}Yf.Cache=w0;var DR=Yf,LR=DR,UR=500;function FR(e){var t=LR(e,function(n){return r.size===UR&&r.clear(),n}),r=t.cache;return t}var MR=FR,BR=MR,jR=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,kR=/\\(\\)?/g,qR=BR(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(jR,function(r,n,o,i){t.push(o?i.replace(kR,"$1"):n||r)}),t}),WR=qR;function HR(e,t){for(var r=-1,n=e==null?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}var GR=HR,dp=ku,VR=GR,KR=uo,zR=zf,hp=dp?dp.prototype:void 0,pp=hp?hp.toString:void 0;function E0(e){if(typeof e=="string")return e;if(KR(e))return VR(e,E0)+"";if(zR(e))return pp?pp.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var JR=E0,YR=JR;function QR(e){return e==null?"":YR(e)}var XR=QR,ZR=uo,eC=uA,tC=WR,rC=XR;function nC(e,t){return ZR(e)?e:eC(e,t)?[e]:tC(rC(e))}var Qf=nC,iC=9007199254740991,oC=/^(?:0|[1-9]\d*)$/;function sC(e,t){var r=typeof e;return t=t??iC,!!t&&(r=="number"||r!="symbol"&&oC.test(e))&&e>-1&&e%1==0&&e<t}var S0=sC,aC=zf;function uC(e){if(typeof e=="string"||aC(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var Xf=uC,cC=Kf,lC=Qf,fC=S0,vp=ao,dC=Xf;function hC(e,t,r,n){if(!vp(e))return e;t=lC(t,e);for(var o=-1,i=t.length,a=i-1,u=e;u!=null&&++o<i;){var l=dC(t[o]),s=r;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(o!=a){var c=u[l];s=n?n(c,l,u):void 0,s===void 0&&(s=vp(c)?c:fC(t[o+1])?[]:{})}cC(u,l,s),u=u[l]}return e}var pC=hC,vC=pC;function mC(e,t,r){return e==null?e:vC(e,t,r)}var gC=mC;const yC=qf(gC);function _C(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var bC=_C,wC=Qf,EC=Xf;function SC(e,t){t=wC(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[EC(t[r++])];return r&&r==n?e:void 0}var IC=SC;function OC(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),r=r>o?o:r,r<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(o);++n<o;)i[n]=e[n+t];return i}var TC=OC,AC=IC,RC=TC;function CC(e,t){return t.length<2?e:AC(e,RC(t,0,-1))}var xC=CC,PC=Qf,NC=bC,$C=xC,DC=Xf;function LC(e,t){return t=PC(t,e),e=$C(e,t),e==null||delete e[DC(NC(t))]}var UC=LC,FC=UC;function MC(e,t){return e==null?!0:FC(e,t)}var BC=MC;const jC=qf(BC);var kC=Hu;function qC(){this.__data__=new kC,this.size=0}var WC=qC;function HC(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var GC=HC;function VC(e){return this.__data__.get(e)}var KC=VC;function zC(e){return this.__data__.has(e)}var JC=zC,YC=Hu,QC=Jf,XC=b0,ZC=200;function ex(e,t){var r=this.__data__;if(r instanceof YC){var n=r.__data__;if(!QC||n.length<ZC-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new XC(n)}return r.set(e,t),this.size=r.size,this}var tx=ex,rx=Hu,nx=WC,ix=GC,ox=KC,sx=JC,ax=tx;function po(e){var t=this.__data__=new rx(e);this.size=t.size}po.prototype.clear=nx;po.prototype.delete=ix;po.prototype.get=ox;po.prototype.has=sx;po.prototype.set=ax;var ux=po;function cx(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var lx=cx,fx=Kf,dx=y0;function hx(e,t,r,n){var o=!r;r||(r={});for(var i=-1,a=t.length;++i<a;){var u=t[i],l=n?n(r[u],e[u],u,r,e):void 0;l===void 0&&(l=e[u]),o?dx(r,u,l):fx(r,u,l)}return r}var Vu=hx;function px(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var vx=px,mx=Ds,gx=co,yx="[object Arguments]";function _x(e){return gx(e)&&mx(e)==yx}var bx=_x,mp=bx,Ex=co,I0=Object.prototype,Sx=I0.hasOwnProperty,Ix=I0.propertyIsEnumerable,Ox=mp(function(){return arguments}())?mp:function(e){return Ex(e)&&Sx.call(e,"callee")&&!Ix.call(e,"callee")},Tx=Ox,Qa={exports:{}};function Ax(){return!1}var Rx=Ax;Qa.exports;(function(e,t){var r=Gr,n=Rx,o=t&&!t.nodeType&&t,i=o&&!0&&e&&!e.nodeType&&e,a=i&&i.exports===o,u=a?r.Buffer:void 0,l=u?u.isBuffer:void 0,s=l||n;e.exports=s})(Qa,Qa.exports);var O0=Qa.exports,Cx=9007199254740991;function xx(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Cx}var T0=xx,Px=Ds,Nx=T0,$x=co,Dx="[object Arguments]",Lx="[object Array]",Ux="[object Boolean]",Fx="[object Date]",Mx="[object Error]",Bx="[object Function]",jx="[object Map]",kx="[object Number]",qx="[object Object]",Wx="[object RegExp]",Hx="[object Set]",Gx="[object String]",Vx="[object WeakMap]",Kx="[object ArrayBuffer]",zx="[object DataView]",Jx="[object Float32Array]",Yx="[object Float64Array]",Qx="[object Int8Array]",Xx="[object Int16Array]",Zx="[object Int32Array]",e2="[object Uint8Array]",t2="[object Uint8ClampedArray]",r2="[object Uint16Array]",n2="[object Uint32Array]",qe={};qe[Jx]=qe[Yx]=qe[Qx]=qe[Xx]=qe[Zx]=qe[e2]=qe[t2]=qe[r2]=qe[n2]=!0;qe[Dx]=qe[Lx]=qe[Kx]=qe[Ux]=qe[zx]=qe[Fx]=qe[Mx]=qe[Bx]=qe[jx]=qe[kx]=qe[qx]=qe[Wx]=qe[Hx]=qe[Gx]=qe[Vx]=!1;function i2(e){return $x(e)&&Nx(e.length)&&!!qe[Px(e)]}var o2=i2;function s2(e){return function(t){return e(t)}}var Zf=s2,Xa={exports:{}};Xa.exports;(function(e,t){var r=p0,n=t&&!t.nodeType&&t,o=n&&!0&&e&&!e.nodeType&&e,i=o&&o.exports===n,a=i&&r.process,u=function(){try{var l=o&&o.require&&o.require("util").types;return l||a&&a.binding&&a.binding("util")}catch{}}();e.exports=u})(Xa,Xa.exports);var ed=Xa.exports,a2=o2,u2=Zf,gp=ed,yp=gp&&gp.isTypedArray,c2=yp?u2(yp):a2,l2=c2,f2=vx,d2=Tx,h2=uo,p2=O0,v2=S0,m2=l2,g2=Object.prototype,y2=g2.hasOwnProperty;function _2(e,t){var r=h2(e),n=!r&&d2(e),o=!r&&!n&&p2(e),i=!r&&!n&&!o&&m2(e),a=r||n||o||i,u=a?f2(e.length,String):[],l=u.length;for(var s in e)(t||y2.call(e,s))&&!(a&&(s=="length"||o&&(s=="offset"||s=="parent")||i&&(s=="buffer"||s=="byteLength"||s=="byteOffset")||v2(s,l)))&&u.push(s);return u}var A0=_2,b2=Object.prototype;function w2(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||b2;return e===r}var td=w2;function E2(e,t){return function(r){return e(t(r))}}var R0=E2,S2=R0,I2=S2(Object.keys,Object),O2=I2,T2=td,A2=O2,R2=Object.prototype,C2=R2.hasOwnProperty;function x2(e){if(!T2(e))return A2(e);var t=[];for(var r in Object(e))C2.call(e,r)&&r!="constructor"&&t.push(r);return t}var P2=x2,N2=m0,$2=T0;function D2(e){return e!=null&&$2(e.length)&&!N2(e)}var C0=D2,L2=A0,U2=P2,F2=C0;function M2(e){return F2(e)?L2(e):U2(e)}var rd=M2,B2=Vu,j2=rd;function k2(e,t){return e&&B2(t,j2(t),e)}var q2=k2;function W2(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var H2=W2,G2=ao,V2=td,K2=H2,z2=Object.prototype,J2=z2.hasOwnProperty;function Y2(e){if(!G2(e))return K2(e);var t=V2(e),r=[];for(var n in e)n=="constructor"&&(t||!J2.call(e,n))||r.push(n);return r}var Q2=Y2,X2=A0,Z2=Q2,eP=C0;function tP(e){return eP(e)?X2(e,!0):Z2(e)}var nd=tP,rP=Vu,nP=nd;function iP(e,t){return e&&rP(t,nP(t),e)}var oP=iP,Za={exports:{}};Za.exports;(function(e,t){var r=Gr,n=t&&!t.nodeType&&t,o=n&&!0&&e&&!e.nodeType&&e,i=o&&o.exports===n,a=i?r.Buffer:void 0,u=a?a.allocUnsafe:void 0;function l(s,c){if(c)return s.slice();var f=s.length,d=u?u(f):new s.constructor(f);return s.copy(d),d}e.exports=l})(Za,Za.exports);var sP=Za.exports;function aP(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var uP=aP;function cP(e,t){for(var r=-1,n=e==null?0:e.length,o=0,i=[];++r<n;){var a=e[r];t(a,r,e)&&(i[o++]=a)}return i}var lP=cP;function fP(){return[]}var x0=fP,dP=lP,hP=x0,pP=Object.prototype,vP=pP.propertyIsEnumerable,_p=Object.getOwnPropertySymbols,mP=_p?function(e){return e==null?[]:(e=Object(e),dP(_p(e),function(t){return vP.call(e,t)}))}:hP,id=mP,gP=Vu,yP=id;function _P(e,t){return gP(e,yP(e),t)}var bP=_P;function wP(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}var P0=wP,EP=R0,SP=EP(Object.getPrototypeOf,Object),N0=SP,IP=P0,OP=N0,TP=id,AP=x0,RP=Object.getOwnPropertySymbols,CP=RP?function(e){for(var t=[];e;)IP(t,TP(e)),e=OP(e);return t}:AP,$0=CP,xP=Vu,PP=$0;function NP(e,t){return xP(e,PP(e),t)}var $P=NP,DP=P0,LP=uo;function UP(e,t,r){var n=t(e);return LP(e)?n:DP(n,r(e))}var D0=UP,FP=D0,MP=id,BP=rd;function jP(e){return FP(e,BP,MP)}var kP=jP,qP=D0,WP=$0,HP=nd;function GP(e){return qP(e,HP,WP)}var VP=GP,KP=bi,zP=Gr,JP=KP(zP,"DataView"),YP=JP,QP=bi,XP=Gr,ZP=QP(XP,"Promise"),eN=ZP,tN=bi,rN=Gr,nN=tN(rN,"Set"),iN=nN,oN=bi,sN=Gr,aN=oN(sN,"WeakMap"),uN=aN,Nl=YP,$l=Jf,Dl=eN,Ll=iN,Ul=uN,L0=Ds,vo=g0,bp="[object Map]",cN="[object Object]",wp="[object Promise]",Ep="[object Set]",Sp="[object WeakMap]",Ip="[object DataView]",lN=vo(Nl),fN=vo($l),dN=vo(Dl),hN=vo(Ll),pN=vo(Ul),Kn=L0;(Nl&&Kn(new Nl(new ArrayBuffer(1)))!=Ip||$l&&Kn(new $l)!=bp||Dl&&Kn(Dl.resolve())!=wp||Ll&&Kn(new Ll)!=Ep||Ul&&Kn(new Ul)!=Sp)&&(Kn=function(e){var t=L0(e),r=t==cN?e.constructor:void 0,n=r?vo(r):"";if(n)switch(n){case lN:return Ip;case fN:return bp;case dN:return wp;case hN:return Ep;case pN:return Sp}return t});var od=Kn,vN=Object.prototype,mN=vN.hasOwnProperty;function gN(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&mN.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var yN=gN,_N=Gr,bN=_N.Uint8Array,wN=bN,Op=wN;function EN(e){var t=new e.constructor(e.byteLength);return new Op(t).set(new Op(e)),t}var sd=EN,SN=sd;function IN(e,t){var r=t?SN(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var ON=IN,TN=/\w*$/;function AN(e){var t=new e.constructor(e.source,TN.exec(e));return t.lastIndex=e.lastIndex,t}var RN=AN,Tp=ku,Ap=Tp?Tp.prototype:void 0,Rp=Ap?Ap.valueOf:void 0;function CN(e){return Rp?Object(Rp.call(e)):{}}var xN=CN,PN=sd;function NN(e,t){var r=t?PN(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var $N=NN,DN=sd,LN=ON,UN=RN,FN=xN,MN=$N,BN="[object Boolean]",jN="[object Date]",kN="[object Map]",qN="[object Number]",WN="[object RegExp]",HN="[object Set]",GN="[object String]",VN="[object Symbol]",KN="[object ArrayBuffer]",zN="[object DataView]",JN="[object Float32Array]",YN="[object Float64Array]",QN="[object Int8Array]",XN="[object Int16Array]",ZN="[object Int32Array]",e$="[object Uint8Array]",t$="[object Uint8ClampedArray]",r$="[object Uint16Array]",n$="[object Uint32Array]";function i$(e,t,r){var n=e.constructor;switch(t){case KN:return DN(e);case BN:case jN:return new n(+e);case zN:return LN(e,r);case JN:case YN:case QN:case XN:case ZN:case e$:case t$:case r$:case n$:return MN(e,r);case kN:return new n;case qN:case GN:return new n(e);case WN:return UN(e);case HN:return new n;case VN:return FN(e)}}var o$=i$,s$=ao,Cp=Object.create,a$=function(){function e(){}return function(t){if(!s$(t))return{};if(Cp)return Cp(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),u$=a$,c$=u$,l$=N0,f$=td;function d$(e){return typeof e.constructor=="function"&&!f$(e)?c$(l$(e)):{}}var h$=d$,p$=od,v$=co,m$="[object Map]";function g$(e){return v$(e)&&p$(e)==m$}var y$=g$,_$=y$,b$=Zf,xp=ed,Pp=xp&&xp.isMap,w$=Pp?b$(Pp):_$,E$=w$,S$=od,I$=co,O$="[object Set]";function T$(e){return I$(e)&&S$(e)==O$}var A$=T$,R$=A$,C$=Zf,Np=ed,$p=Np&&Np.isSet,x$=$p?C$($p):R$,P$=x$,N$=ux,$$=lx,D$=Kf,L$=q2,U$=oP,F$=sP,M$=uP,B$=bP,j$=$P,k$=kP,q$=VP,W$=od,H$=yN,G$=o$,V$=h$,K$=uo,z$=O0,J$=E$,Y$=ao,Q$=P$,X$=rd,Z$=nd,eD=1,tD=2,rD=4,U0="[object Arguments]",nD="[object Array]",iD="[object Boolean]",oD="[object Date]",sD="[object Error]",F0="[object Function]",aD="[object GeneratorFunction]",uD="[object Map]",cD="[object Number]",M0="[object Object]",lD="[object RegExp]",fD="[object Set]",dD="[object String]",hD="[object Symbol]",pD="[object WeakMap]",vD="[object ArrayBuffer]",mD="[object DataView]",gD="[object Float32Array]",yD="[object Float64Array]",_D="[object Int8Array]",bD="[object Int16Array]",wD="[object Int32Array]",ED="[object Uint8Array]",SD="[object Uint8ClampedArray]",ID="[object Uint16Array]",OD="[object Uint32Array]",Me={};Me[U0]=Me[nD]=Me[vD]=Me[mD]=Me[iD]=Me[oD]=Me[gD]=Me[yD]=Me[_D]=Me[bD]=Me[wD]=Me[uD]=Me[cD]=Me[M0]=Me[lD]=Me[fD]=Me[dD]=Me[hD]=Me[ED]=Me[SD]=Me[ID]=Me[OD]=!0;Me[sD]=Me[F0]=Me[pD]=!1;function wa(e,t,r,n,o,i){var a,u=t&eD,l=t&tD,s=t&rD;if(r&&(a=o?r(e,n,o,i):r(e)),a!==void 0)return a;if(!Y$(e))return e;var c=K$(e);if(c){if(a=H$(e),!u)return M$(e,a)}else{var f=W$(e),d=f==F0||f==aD;if(z$(e))return F$(e,u);if(f==M0||f==U0||d&&!o){if(a=l||d?{}:V$(e),!u)return l?j$(e,U$(a,e)):B$(e,L$(a,e))}else{if(!Me[f])return o?e:{};a=G$(e,f,u)}}i||(i=new N$);var v=i.get(e);if(v)return v;i.set(e,a),Q$(e)?e.forEach(function(w){a.add(wa(w,t,r,w,e,i))}):J$(e)&&e.forEach(function(w,_){a.set(_,wa(w,t,r,_,e,i))});var g=s?l?q$:k$:l?Z$:X$,b=c?void 0:g(e);return $$(b||e,function(w,_){b&&(_=w,w=e[_]),D$(a,_,wa(w,t,r,_,e,i))}),a}var TD=wa,AD=TD,RD=1,CD=4;function xD(e){return AD(e,RD|CD)}var PD=xD;const ND=qf(PD);function Ni(e){return e===void 0&&(e=""),"".concat(e?"".concat(e,"_"):"").concat(+new Date,"_").concat(Math.random())}var $D=function(){function e(t){this.close=t.close,this.onChange=t.onChange,this.onError=t.onError,t.debug&&Object.defineProperty(this,"virtualClient",{get:function(){return t.virtualClient}})}return e}(),Dp=function(){function e(t){var r=t.id,n=t.docChanges,o=t.docs,i=t.msgType,a=t.type,u,l;Object.defineProperties(this,{id:{get:function(){return r},enumerable:!0},docChanges:{get:function(){return u||(u=JSON.parse(JSON.stringify(n))),u},enumerable:!0},docs:{get:function(){return l||(l=JSON.parse(JSON.stringify(o))),l},enumerable:!0},msgType:{get:function(){return i},enumerable:!0},type:{get:function(){return a},enumerable:!0}})}return e}(),Ku=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),DD=function(e){Ku(t,e);function t(r){var n=e.call(this,"Watch Error ".concat(JSON.stringify(r.msgData)," (requestid: ").concat(r.requestId,")"))||this;return n.isRealtimeErrorMessageError=!0,n.payload=r,n}return t}(Error),Lp=function(e){return e==null?void 0:e.isRealtimeErrorMessageError},LD=function(e){Ku(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="timeout",r.payload=null,r.generic=!0,r}return t}(Error),UD=function(e){return e.type==="timeout"},FD=function(e){Ku(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="cancelled",r.payload=null,r.generic=!0,r}return t}(Error),MD=function(e){return e.type==="cancelled"},tr=function(e){Ku(t,e);function t(r){var n=e.call(this,r.errMsg)||this;return n.errCode="UNKNOWN_ERROR",Object.defineProperties(n,{message:{get:function(){return"errCode: ".concat(this.errCode," ").concat(Mt[this.errCode]||""," | errMsg: ").concat(this.errMsg)},set:function(o){this.errMsg=o}}}),n.errCode=r.errCode||"UNKNOWN_ERROR",n.errMsg=r.errMsg,n}return Object.defineProperty(t.prototype,"message",{get:function(){return"errCode: ".concat(this.errCode," | errMsg: ").concat(this.errMsg)},set:function(r){this.errMsg=r},enumerable:!1,configurable:!0}),t}(Error),Mt={UNKNOWN_ERROR:"UNKNOWN_ERROR",SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG:"SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG",SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA:"SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA",SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR:"SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR",SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED:"SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED",SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL:"SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL",SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR:"SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR"},Fl=function(e){return e===void 0&&(e=0),new Promise(function(t){return setTimeout(t,e)})},Wt=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},xt=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Up=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},Le;(function(e){e.LOGGINGIN="LOGGINGIN",e.INITING="INITING",e.REBUILDING="REBUILDING",e.ACTIVE="ACTIVE",e.ERRORED="ERRORED",e.CLOSING="CLOSING",e.CLOSED="CLOSED",e.PAUSED="PAUSED",e.RESUMING="RESUMING"})(Le||(Le={}));var BD=100,Qs=2,jD=2,kD=10*1e3,qD=10*1e3,WD=10*1e3,HD=function(){function e(t){var r=this;this.watchStatus=Le.INITING,this.wsLogin=function(n,o){return Wt(r,void 0,void 0,function(){var i;return xt(this,function(a){switch(a.label){case 0:return this.watchStatus=Le.LOGGINGIN,[4,this.login(n,o)];case 1:return i=a.sent(),this.envId||(this.envId=i.envId),[2,i]}})})},this.initWatch=function(n){return Wt(r,void 0,void 0,function(){var o,i=this;return xt(this,function(a){switch(a.label){case 0:if(this.initWatchPromise!==null&&this.initWatchPromise!==void 0)return[2,this.initWatchPromise];this.initWatchPromise=new Promise(function(u,l){(function(){return Wt(i,void 0,void 0,function(){var s,c,f,d,v,g,b,w,_,E,A;return xt(this,function(I){switch(I.label){case 0:return I.trys.push([0,3,,4]),this.watchStatus===Le.PAUSED?(console.log("[realtime] initWatch cancelled on pause"),[2,u()]):[4,this.wsLogin(this.envId,n)];case 1:return s=I.sent().envId,this.watchStatus===Le.PAUSED?(console.log("[realtime] initWatch cancelled on pause"),[2,u()]):(this.watchStatus=Le.INITING,c={watchId:this.watchId,requestId:Ni(),msgType:"INIT_WATCH",msgData:{envId:s,collName:this.collectionName,query:this.query,limit:this.limit,orderBy:this.orderBy}},[4,this.send({msg:c,waitResponse:!0,skipOnMessage:!0,timeout:qD})]);case 2:if(f=I.sent(),d=f.msgData,v=d.events,g=d.currEvent,this.sessionInfo={queryID:f.msgData.queryID,currentEventId:g-1,currentDocs:[]},v.length>0){for(b=0,w=v;b<w.length;b++)_=w[b],_.ID=g;this.handleServerEvents(f)}else this.sessionInfo.currentEventId=g,E=new Dp({id:g,docChanges:[],docs:[],type:"init"}),this.listener.onChange(E),this.scheduleSendACK();return this.onWatchStart(this,this.sessionInfo.queryID),this.watchStatus=Le.ACTIVE,this.availableRetries.INIT_WATCH=Qs,u(),[3,4];case 3:return A=I.sent(),this.handleWatchEstablishmentError(A,{operationName:"INIT_WATCH",resolve:u,reject:l}),[3,4];case 4:return[2]}})})})()}),o=!1,a.label=1;case 1:return a.trys.push([1,,3,4]),[4,this.initWatchPromise];case 2:return a.sent(),o=!0,[3,4];case 3:return this.initWatchPromise=void 0,[7];case 4:return console.log("[realtime] initWatch ".concat(o?"success":"fail")),[2]}})})},this.rebuildWatch=function(n){return Wt(r,void 0,void 0,function(){var o,i=this;return xt(this,function(a){switch(a.label){case 0:if(this.rebuildWatchPromise!==null&&this.rebuildWatchPromise!==void 0)return[2,this.rebuildWatchPromise];this.rebuildWatchPromise=new Promise(function(u,l){(function(){return Wt(i,void 0,void 0,function(){var s,c,f,d;return xt(this,function(v){switch(v.label){case 0:return v.trys.push([0,3,,4]),this.watchStatus===Le.PAUSED?(console.log("[realtime] rebuildWatch cancelled on pause"),[2,u()]):[4,this.wsLogin(this.envId,n)];case 1:if(s=v.sent().envId,!this.sessionInfo)throw new Error("can not rebuildWatch without a successful initWatch (lack of sessionInfo)");return this.watchStatus===Le.PAUSED?(console.log("[realtime] rebuildWatch cancelled on pause"),[2,u()]):(this.watchStatus=Le.REBUILDING,c={watchId:this.watchId,requestId:Ni(),msgType:"REBUILD_WATCH",msgData:{envId:s,collName:this.collectionName,queryID:this.sessionInfo.queryID,eventID:this.sessionInfo.currentEventId}},[4,this.send({msg:c,waitResponse:!0,skipOnMessage:!1,timeout:WD})]);case 2:return f=v.sent(),this.handleServerEvents(f),this.watchStatus=Le.ACTIVE,this.availableRetries.REBUILD_WATCH=Qs,u(),[3,4];case 3:return d=v.sent(),this.handleWatchEstablishmentError(d,{operationName:"REBUILD_WATCH",resolve:u,reject:l}),[3,4];case 4:return[2]}})})})()}),o=!1,a.label=1;case 1:return a.trys.push([1,,3,4]),[4,this.rebuildWatchPromise];case 2:return a.sent(),o=!0,[3,4];case 3:return this.rebuildWatchPromise=void 0,[7];case 4:return console.log("[realtime] rebuildWatch ".concat(o?"success":"fail")),[2]}})})},this.handleWatchEstablishmentError=function(n,o){return Wt(r,void 0,void 0,function(){var i,a,u,l=this;return xt(this,function(s){return i=o.operationName==="INIT_WATCH",a=function(){l.closeWithError(new tr({errCode:i?Mt.SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL:Mt.SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL,errMsg:n})),o.reject(n)},u=function(c){l.useRetryTicket(o.operationName)?i?(l.initWatchPromise=void 0,o.resolve(l.initWatch(c))):(l.rebuildWatchPromise=void 0,o.resolve(l.rebuildWatch(c))):a()},this.handleCommonError(n,{onSignError:function(){return u(!0)},onTimeoutError:function(){return u(!1)},onNotRetryableError:a,onCancelledError:o.reject,onUnknownError:function(){(function(){return Wt(l,void 0,void 0,function(){var c,f=this;return xt(this,function(d){switch(d.label){case 0:return d.trys.push([0,8,,9]),c=function(){return Wt(f,void 0,void 0,function(){return xt(this,function(v){switch(v.label){case 0:return this.pause(),[4,this.onceWSConnected()];case 1:return v.sent(),u(!0),[2]}})})},this.isWSConnected()?[3,2]:[4,c()];case 1:return d.sent(),[3,7];case 2:return[4,Fl(BD)];case 3:return d.sent(),this.watchStatus!==Le.PAUSED?[3,4]:(o.reject(new FD("".concat(o.operationName," cancelled due to pause after unknownError"))),[3,7]);case 4:return this.isWSConnected()?[3,6]:[4,c()];case 5:return d.sent(),[3,7];case 6:u(!1),d.label=7;case 7:return[3,9];case 8:return d.sent(),u(!0),[3,9];case 9:return[2]}})})})()}}),[2]})})},this.closeWatch=function(){return Wt(r,void 0,void 0,function(){var n,o,i;return xt(this,function(a){switch(a.label){case 0:if(n=this.sessionInfo?this.sessionInfo.queryID:"",this.watchStatus!==Le.ACTIVE)return this.watchStatus=Le.CLOSED,this.onWatchClose(this,n),[2];a.label=1;case 1:return a.trys.push([1,3,4,5]),this.watchStatus=Le.CLOSING,o={watchId:this.watchId,requestId:Ni(),msgType:"CLOSE_WATCH",msgData:null},[4,this.send({msg:o})];case 2:return a.sent(),this.sessionInfo=void 0,this.watchStatus=Le.CLOSED,[3,5];case 3:return i=a.sent(),this.closeWithError(new tr({errCode:Mt.SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL,errMsg:i})),[3,5];case 4:return this.onWatchClose(this,n),[7];case 5:return[2]}})})},this.scheduleSendACK=function(){r.clearACKSchedule(),r.ackTimeoutId=setTimeout(function(){r.waitExpectedTimeoutId?r.scheduleSendACK():r.sendACK()},kD)},this.clearACKSchedule=function(){r.ackTimeoutId&&clearTimeout(r.ackTimeoutId)},this.sendACK=function(){return Wt(r,void 0,void 0,function(){var n,o,i;return xt(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),this.watchStatus!==Le.ACTIVE?(this.scheduleSendACK(),[2]):this.sessionInfo?(n={watchId:this.watchId,requestId:Ni(),msgType:"CHECK_LAST",msgData:{queryID:this.sessionInfo.queryID,eventID:this.sessionInfo.currentEventId}},[4,this.send({msg:n})]):(console.warn("[realtime listener] can not send ack without a successful initWatch (lack of sessionInfo)"),[2]);case 1:return a.sent(),this.scheduleSendACK(),[3,3];case 2:if(o=a.sent(),Lp(o))switch(i=o.payload,i.msgData.code){case"CHECK_LOGIN_FAILED":case"SIGN_EXPIRED_ERROR":case"SIGN_INVALID_ERROR":case"SIGN_PARAM_INVALID":return this.rebuildWatch(),[2];case"QUERYID_INVALID_ERROR":case"SYS_ERR":case"INVALIID_ENV":case"COLLECTION_PERMISSION_DENIED":return this.closeWithError(new tr({errCode:Mt.SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL,errMsg:i.msgData.code})),[2]}return this.availableRetries.CHECK_LAST&&this.availableRetries.CHECK_LAST>0?(this.availableRetries.CHECK_LAST-=1,this.scheduleSendACK()):this.closeWithError(new tr({errCode:Mt.SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL,errMsg:o})),[3,3];case 3:return[2]}})})},this.handleCommonError=function(n,o){if(Lp(n)){var i=n.payload;switch(i.msgData.code){case"CHECK_LOGIN_FAILED":case"SIGN_EXPIRED_ERROR":case"SIGN_INVALID_ERROR":case"SIGN_PARAM_INVALID":{o.onSignError(n);return}case"QUERYID_INVALID_ERROR":case"SYS_ERR":case"INVALIID_ENV":case"COLLECTION_PERMISSION_DENIED":{o.onNotRetryableError(n);return}default:{o.onNotRetryableError(n);return}}}else if(UD(n)){o.onTimeoutError(n);return}else if(MD(n)){o.onCancelledError(n);return}o.onUnknownError(n)},this.watchId="watchid_".concat(+new Date,"_").concat(Math.random()),this.envId=t.envId,this.collectionName=t.collectionName,this.query=t.query,this.limit=t.limit,this.orderBy=t.orderBy,this.send=t.send,this.login=t.login,this.isWSConnected=t.isWSConnected,this.onceWSConnected=t.onceWSConnected,this.getWaitExpectedTimeoutLength=t.getWaitExpectedTimeoutLength,this.onWatchStart=t.onWatchStart,this.onWatchClose=t.onWatchClose,this.debug=t.debug,this.availableRetries={INIT_WATCH:Qs,REBUILD_WATCH:Qs,CHECK_LAST:jD},this.listener=new $D({close:function(){r.closeWatch()},onChange:t.onChange,onError:t.onError,debug:this.debug,virtualClient:this}),this.initWatch()}return e.prototype.onMessage=function(t){var r=this;switch(this.watchStatus){case Le.PAUSED:{if(t.msgType!=="ERROR")return;break}case Le.LOGGINGIN:case Le.INITING:case Le.REBUILDING:{console.warn("[realtime listener] internal non-fatal error: unexpected message received while ".concat(this.watchStatus));return}case Le.CLOSED:{console.warn("[realtime listener] internal non-fatal error: unexpected message received when the watch has closed");return}case Le.ERRORED:{console.warn("[realtime listener] internal non-fatal error: unexpected message received when the watch has ended with error");return}}if(!this.sessionInfo){console.warn("[realtime listener] internal non-fatal error: sessionInfo not found while message is received.");return}switch(this.scheduleSendACK(),t.msgType){case"NEXT_EVENT":{console.warn("nextevent ".concat(t.msgData.currEvent," ignored"),t),this.handleServerEvents(t);break}case"CHECK_EVENT":{this.sessionInfo.currentEventId<t.msgData.currEvent&&(this.sessionInfo.expectEventId=t.msgData.currEvent,this.clearWaitExpectedEvent(),this.waitExpectedTimeoutId=setTimeout(function(){r.rebuildWatch()},this.getWaitExpectedTimeoutLength()),console.log("[realtime] waitExpectedTimeoutLength ".concat(this.getWaitExpectedTimeoutLength())));break}case"ERROR":{this.closeWithError(new tr({errCode:Mt.SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG,errMsg:"".concat(t.msgData.code," - ").concat(t.msgData.message)}));break}default:{console.warn("[realtime listener] virtual client receive unexpected msg ".concat(t.msgType,": "),t);break}}},e.prototype.closeWithError=function(t){var r;this.watchStatus=Le.ERRORED,this.clearACKSchedule(),this.listener.onError(t),this.onWatchClose(this,((r=this.sessionInfo)===null||r===void 0?void 0:r.queryID)||""),console.log("[realtime] client closed (".concat(this.collectionName," ").concat(this.query,") (watchId ").concat(this.watchId,")"))},e.prototype.pause=function(){this.watchStatus=Le.PAUSED,console.log("[realtime] client paused (".concat(this.collectionName," ").concat(this.query,") (watchId ").concat(this.watchId,")"))},e.prototype.resume=function(){return Wt(this,void 0,void 0,function(){var t;return xt(this,function(r){switch(r.label){case 0:this.watchStatus=Le.RESUMING,console.log("[realtime] client resuming with ".concat(this.sessionInfo?"REBUILD_WATCH":"INIT_WATCH"," (").concat(this.collectionName," ").concat(this.query,") (").concat(this.watchId,")")),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.sessionInfo?this.rebuildWatch():this.initWatch()];case 2:return r.sent(),console.log("[realtime] client successfully resumed (".concat(this.collectionName," ").concat(this.query,") (").concat(this.watchId,")")),[3,4];case 3:return t=r.sent(),console.error("[realtime] client resume failed (".concat(this.collectionName," ").concat(this.query,") (").concat(this.watchId,")"),t),[3,4];case 4:return[2]}})})},e.prototype.useRetryTicket=function(t){return this.availableRetries[t]&&this.availableRetries[t]>0?(this.availableRetries[t]-=1,console.log("[realtime] ".concat(t," use a retry ticket, now only ").concat(this.availableRetries[t]," retry left")),!0):!1},e.prototype.handleServerEvents=function(t){return Wt(this,void 0,void 0,function(){var r;return xt(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this.scheduleSendACK(),[4,this.handleServerEventsInternel(t)];case 1:return n.sent(),this.postHandleServerEventsValidityCheck(t),[3,3];case 2:throw r=n.sent(),console.error("[realtime listener] internal non-fatal error: handle server events failed with error: ",r),r;case 3:return[2]}})})},e.prototype.handleServerEventsInternel=function(t){return Wt(this,void 0,void 0,function(){var r,n,o,i,a,u,l,s,c,f,d,v;return xt(this,function(g){switch(g.label){case 0:if(r=t.requestId,n=t.msgData.events,o=t.msgType,!n.length||!this.sessionInfo)return[2];i=this.sessionInfo;try{a=n.map(GD)}catch(b){return this.closeWithError(new tr({errCode:Mt.SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA,errMsg:b})),[2]}u=Up([],i.currentDocs,!0),l=!1,s=function(b,w){var _,E,A,I,R,$,D,D,L,L,D,P,P,k,F,Q;return xt(this,function(ce){switch(ce.label){case 0:return _=a[b],i.currentEventId>=_.id?(!a[b-1]||_.id>a[b-1].id?console.warn("[realtime] duplicate event received, cur ".concat(i.currentEventId," but got ").concat(_.id)):console.error("[realtime listener] server non-fatal error: events out of order (the latter event's id is smaller than that of the former) (requestId ".concat(r,")")),[2,"continue"]):[3,1];case 1:if(i.currentEventId!==_.id-1)return[3,2];switch(_.dataType){case"update":{if(!_.doc)switch(_.queueType){case"update":case"dequeue":{if(E=u.find(function(B){return B._id===_.docId}),E){if(A=ND(E),_.updatedFields&&Object.keys(_.updatedFields).forEach(function(B){yC(A,B,_.updatedFields[B])}),_.removedFields)for(I=0,R=_.removedFields;I<R.length;I++)$=R[I],jC(A,$);_.doc=A}else console.error("[realtime listener] internal non-fatal server error: unexpected update dataType event where no doc is associated.");break}case"enqueue":throw D=new tr({errCode:Mt.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="update" and queueType="enqueue" (requestId '.concat(t.requestId,")")}),c.closeWithError(D),D}break}case"replace":{if(!_.doc)throw D=new tr({errCode:Mt.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="replace" (requestId '.concat(t.requestId,")")}),c.closeWithError(D),D;break}case"remove":{L=u.find(function(B){return B._id===_.docId}),L?_.doc=L:console.error("[realtime listener] internal non-fatal server error: unexpected remove event where no doc is associated.");break}case"limit":{if(!_.doc)switch(_.queueType){case"dequeue":{L=u.find(function(B){return B._id===_.docId}),L?_.doc=L:console.error("[realtime listener] internal non-fatal server error: unexpected limit dataType event where no doc is associated.");break}case"enqueue":throw D=new tr({errCode:Mt.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="limit" and queueType="enqueue" (requestId '.concat(t.requestId,")")}),c.closeWithError(D),D}break}}switch(_.queueType){case"init":{l?u.push(_.doc):(l=!0,u=[_.doc]);break}case"enqueue":{u.push(_.doc);break}case"dequeue":{P=u.findIndex(function(B){return B._id===_.docId}),P>-1?u.splice(P,1):console.error("[realtime listener] internal non-fatal server error: unexpected dequeue event where no doc is associated.");break}case"update":{P=u.findIndex(function(B){return B._id===_.docId}),P>-1?u[P]=_.doc:console.error("[realtime listener] internal non-fatal server error: unexpected queueType update event where no doc is associated.");break}}return(b===w-1||a[b+1]&&a[b+1].id!==_.id)&&(k=Up([],u,!0),F=a.slice(0,b+1).filter(function(B){return B.id===_.id}),c.sessionInfo.currentEventId=_.id,c.sessionInfo.currentDocs=u,Q=new Dp({id:_.id,docChanges:F,docs:k,msgType:o}),c.listener.onChange(Q)),[3,4];case 2:return console.warn("[realtime listener] event received is out of order, cur ".concat(c.sessionInfo.currentEventId," but got ").concat(_.id)),[4,c.rebuildWatch()];case 3:return ce.sent(),[2,{value:void 0}];case 4:return[2]}})},c=this,f=0,d=a.length,g.label=1;case 1:return f<d?[5,s(f,d)]:[3,4];case 2:if(v=g.sent(),typeof v=="object")return[2,v.value];g.label=3;case 3:return f++,[3,1];case 4:return[2]}})})},e.prototype.postHandleServerEventsValidityCheck=function(t){if(!this.sessionInfo){console.error("[realtime listener] internal non-fatal error: sessionInfo lost after server event handling, this should never occur");return}if(this.sessionInfo.expectEventId&&this.sessionInfo.currentEventId>=this.sessionInfo.expectEventId&&this.clearWaitExpectedEvent(),this.sessionInfo.currentEventId<t.msgData.currEvent){console.warn("[realtime listener] internal non-fatal error: client eventId does not match with server event id after server event handling");return}},e.prototype.clearWaitExpectedEvent=function(){this.waitExpectedTimeoutId&&(clearTimeout(this.waitExpectedTimeoutId),this.waitExpectedTimeoutId=void 0)},e}();function GD(e){var t={id:e.ID,dataType:e.DataType,queueType:e.QueueType,docId:e.DocID,doc:e.Doc&&e.Doc!=="{}"?JSON.parse(e.Doc):void 0};return e.DataType==="update"&&(e.UpdatedFields&&(t.updatedFields=JSON.parse(e.UpdatedFields)),(e.removedFields||e.RemovedFields)&&(t.removedFields=JSON.parse(e.removedFields))),t}var B0={1e3:{code:1e3,name:"Normal Closure",description:"Normal closure; the connection successfully completed whatever purpose for which it was created."},1001:{code:1001,name:"Going Away",description:"The endpoint is going away, either because of a server failure or because the browser is navigating away from the page that opened the connection."},1002:{code:1002,name:"Protocol Error",description:"The endpoint is terminating the connection due to a protocol error."},1003:{code:1003,name:"Unsupported Data",description:"The connection is being terminated because the endpoint received data of a type it cannot accept (for example, a text-only endpoint received binary data)."},1005:{code:1005,name:"No Status Received",description:"Indicates that no status code was provided even though one was expected."},1006:{code:1006,name:"Abnormal Closure",description:"Used to indicate that a connection was closed abnormally (that is, with no close frame being sent) when a status code is expected."},1007:{code:1007,name:"Invalid frame payload data",description:"The endpoint is terminating the connection because a message was received that contained inconsistent data (e.g., non-UTF-8 data within a text message)."},1008:{code:1008,name:"Policy Violation",description:"The endpoint is terminating the connection because it received a message that violates its policy. This is a generic status code, used when codes 1003 and 1009 are not suitable."},1009:{code:1009,name:"Message too big",description:"The endpoint is terminating the connection because a data frame was received that is too large."},1010:{code:1010,name:"Missing Extension",description:"The client is terminating the connection because it expected the server to negotiate one or more extension, but the server didn't."},1011:{code:1011,name:"Internal Error",description:"The server is terminating the connection because it encountered an unexpected condition that prevented it from fulfilling the request."},1012:{code:1012,name:"Service Restart",description:"The server is terminating the connection because it is restarting."},1013:{code:1013,name:"Try Again Later",description:"The server is terminating the connection due to a temporary condition, e.g. it is overloaded and is casting off some of its clients."},1014:{code:1014,name:"Bad Gateway",description:"The server was acting as a gateway or proxy and received an invalid response from the upstream server. This is similar to 502 HTTP Status Code."},1015:{code:1015,name:"TLS Handshake",description:"Indicates that the connection was closed due to a failure to perform a TLS handshake (e.g., the server certificate can't be verified)."},3e3:{code:3e3,name:"Reconnect WebSocket",description:"The client is terminating the connection because it wants to reconnect"},3001:{code:3001,name:"No Realtime Listeners",description:"The client is terminating the connection because no more realtime listeners exist"},3002:{code:3002,name:"Heartbeat Ping Error",description:"The client is terminating the connection due to its failure in sending heartbeat messages"},3003:{code:3003,name:"Heartbeat Pong Timeout Error",description:"The client is terminating the connection because no heartbeat response is received from the server"},3050:{code:3050,name:"Server Close",description:"The client is terminating the connection because no heartbeat response is received from the server"}},er;(function(e){e[e.NormalClosure=1e3]="NormalClosure",e[e.GoingAway=1001]="GoingAway",e[e.ProtocolError=1002]="ProtocolError",e[e.UnsupportedData=1003]="UnsupportedData",e[e.NoStatusReceived=1005]="NoStatusReceived",e[e.AbnormalClosure=1006]="AbnormalClosure",e[e.InvalidFramePayloadData=1007]="InvalidFramePayloadData",e[e.PolicyViolation=1008]="PolicyViolation",e[e.MessageTooBig=1009]="MessageTooBig",e[e.MissingExtension=1010]="MissingExtension",e[e.InternalError=1011]="InternalError",e[e.ServiceRestart=1012]="ServiceRestart",e[e.TryAgainLater=1013]="TryAgainLater",e[e.BadGateway=1014]="BadGateway",e[e.TLSHandshake=1015]="TLSHandshake",e[e.ReconnectWebSocket=3e3]="ReconnectWebSocket",e[e.NoRealtimeListeners=3001]="NoRealtimeListeners",e[e.HeartbeatPingError=3002]="HeartbeatPingError",e[e.HeartbeatPongTimeoutError=3003]="HeartbeatPongTimeoutError",e[e.NoAuthentication=3050]="NoAuthentication"})(er||(er={}));var Wc=function(e,t){var r=B0[e],n=r?"".concat(r.name,", code ").concat(e,", reason ").concat(t||r.description):"code ".concat(e);return new tr({errCode:Mt.SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED,errMsg:n})},j0=null,k0="web";function VD(){return j0}function KD(e){j0=e}function Fp(){return k0}function zD(e){k0=e}var eu=function(){return eu=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},eu.apply(this,arguments)},fr=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},dr=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Hc={OPEN:1},Mp=3,JD=5e3,YD=1e4,QD=5,XD=1e4,ZD=2,eL=2,tL=5e3,rL=function(){function e(t){var r=this;this.virtualWSClient=new Set,this.queryIdClientMap=new Map,this.watchIdClientMap=new Map,this.pingFailed=0,this.pongMissed=0,this.logins=new Map,this.wsReadySubsribers=[],this.wsResponseWait=new Map,this.rttObserved=[],this.send=function(n){return fr(r,void 0,void 0,function(){var o=this;return dr(this,function(i){return[2,new Promise(function(a,u){(function(){return fr(o,void 0,void 0,function(){var l,s,c,f,d,v,g,b,w=this;return dr(this,function(_){switch(_.label){case 0:s=!1,c=!1,f=function(E){s=!0,l&&clearTimeout(l),a(E)},d=function(E){c=!0,l&&clearTimeout(l),u(E)},n.timeout&&(l=setTimeout(function(){(function(){return fr(w,void 0,void 0,function(){return dr(this,function(E){switch(E.label){case 0:return!s||!c?[4,Fl(0)]:[3,2];case 1:E.sent(),(!s||!c)&&d(new LD("wsclient.send timedout")),E.label=2;case 2:return[2]}})})})()},n.timeout)),_.label=1;case 1:return _.trys.push([1,8,,9]),this.wsInitPromise!==void 0||this.wsInitPromise!==null?[4,this.wsInitPromise]:[3,3];case 2:_.sent(),_.label=3;case 3:if(!this.ws)return d(new Error("invalid state: ws connection not exists, can not send message")),[2];if(this.ws.readyState!==Hc.OPEN)return d(new Error("ws readyState invalid: ".concat(this.ws.readyState,", can not send message"))),[2];n.waitResponse&&(v={resolve:f,reject:d,skipOnMessage:n.skipOnMessage},this.wsResponseWait.set(n.msg.requestId,v)),_.label=4;case 4:return _.trys.push([4,6,,7]),[4,this.ws.send(JSON.stringify(n.msg))];case 5:return _.sent(),n.waitResponse||f(void 0),[3,7];case 6:return g=_.sent(),g&&(d(g),n.waitResponse&&this.wsResponseWait.delete(n.msg.requestId)),[3,7];case 7:return[3,9];case 8:return b=_.sent(),d(b),[3,9];case 9:return[2]}})})})()})]})})},this.closeAllClients=function(n){r.virtualWSClient.forEach(function(o){o.closeWithError(n)})},this.pauseClients=function(n){(n||r.virtualWSClient).forEach(function(o){o.pause()})},this.resumeClients=function(n){(n||r.virtualWSClient).forEach(function(o){o.resume()})},this.initWebSocketConnection=function(n,o){return o===void 0&&(o=r.maxReconnect),fr(r,void 0,void 0,function(){var i=this;return dr(this,function(a){switch(a.label){case 0:if(n&&this.reconnectState)return[2];if(n&&(this.reconnectState=!0),this.wsInitPromise!==void 0&&this.wsInitPromise!==null)return[2,this.wsInitPromise];n&&this.pauseClients(),this.close(er.ReconnectWebSocket),this.wsInitPromise=new Promise(function(u,l){(function(){return fr(i,void 0,void 0,function(){var s,c,f,d=this;return dr(this,function(v){switch(v.label){case 0:return v.trys.push([0,6,,11]),[4,this.getWsSign()];case 1:return s=v.sent(),[4,new Promise(function(g){var b=s.wsUrl||"wss://tcb-ws.tencentcloudapi.com",w=VD();d.ws=w?new w(b):new WebSocket(b),g(void 0)})];case 2:return v.sent(),this.ws.connect?[4,this.ws.connect()]:[3,4];case 3:v.sent(),v.label=4;case 4:return[4,this.initWebSocketEvent()];case 5:return v.sent(),u(),n&&(this.resumeClients(),this.reconnectState=!1),[3,11];case 6:return c=v.sent(),console.error("[realtime] initWebSocketConnection connect fail",c),o>0?(f=!0,this.wsInitPromise=void 0,f?[4,Fl(this.reconnectInterval)]:[3,8]):[3,9];case 7:v.sent(),n&&(this.reconnectState=!1),v.label=8;case 8:return u(this.initWebSocketConnection(n,o-1)),[3,10];case 9:l(c),n&&this.closeAllClients(new tr({errCode:Mt.SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL,errMsg:c})),v.label=10;case 10:return[3,11];case 11:return[2]}})})})()}),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,this.wsInitPromise];case 2:return a.sent(),this.wsReadySubsribers.forEach(function(u){var l=u.resolve;return l()}),[3,5];case 3:return a.sent(),this.wsReadySubsribers.forEach(function(u){var l=u.reject;return l()}),[3,5];case 4:return this.wsInitPromise=void 0,this.wsReadySubsribers=[],[7];case 5:return[2]}})})},this.initWebSocketEvent=function(){return new Promise(function(n,o){if(!r.ws)throw new Error("can not initWebSocketEvent, ws not exists");var i=!1;r.ws.onopen=function(a){console.warn("[realtime] ws event: open",a),i=!0,n()},r.ws.onerror=function(a){r.logins=new Map,i?(console.error("[realtime] ws event: error",a),r.clearHeartbeat(),r.virtualWSClient.forEach(function(u){return u.closeWithError(new tr({errCode:Mt.SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR,errMsg:a}))})):(console.error("[realtime] ws open failed with ws event: error",a),o(a))},r.ws.onclose=function(a){switch(console.warn("[realtime] ws event: close",a),r.logins=new Map,r.clearHeartbeat(),a.code){case er.ReconnectWebSocket:break;case er.NoRealtimeListeners:break;case er.HeartbeatPingError:case er.HeartbeatPongTimeoutError:case er.NormalClosure:case er.AbnormalClosure:{r.maxReconnect>0?r.initWebSocketConnection(!0,r.maxReconnect):r.closeAllClients(Wc(a.code));break}case er.NoAuthentication:{r.closeAllClients(Wc(a.code,a.reason));break}default:r.maxReconnect>0?r.initWebSocketConnection(!0,r.maxReconnect):r.closeAllClients(Wc(a.code))}},r.ws.onmessage=function(a){var u,l=((u=a.data)===null||u===void 0?void 0:u.data)||a.data;r.heartbeat();var s;try{s=typeof l=="string"?JSON.parse(l):l}catch(E){throw new Error("[realtime] onMessage parse res.data error: ".concat(E))}if(s.msgType==="ERROR"){var c=null;r.virtualWSClient.forEach(function(E){E.watchId===s.watchId&&(c=E)}),c&&c.listener.onError(s)}var f=r.wsResponseWait.get(s.requestId);if(f){try{s.msgType==="ERROR"?f.reject(new DD(s)):f.resolve(s)}catch(E){console.error("ws onMessage responseWaitSpec.resolve(msg) errored:",E)}finally{r.wsResponseWait.delete(s.requestId)}if(f.skipOnMessage)return}if(s.msgType==="PONG"){if(r.lastPingSendTS){var d=Date.now()-r.lastPingSendTS;if(d>YD){console.warn("[realtime] untrusted rtt observed: ".concat(d));return}r.rttObserved.length>=Mp&&r.rttObserved.splice(0,r.rttObserved.length-Mp+1),r.rttObserved.push(d)}return}var v=s.watchId&&r.watchIdClientMap.get(s.watchId);if(v)v.onMessage(s);else switch(console.error("[realtime] no realtime listener found responsible for watchId ".concat(s.watchId,": "),s),s.msgType){case"INIT_EVENT":case"NEXT_EVENT":case"CHECK_EVENT":{v=r.queryIdClientMap.get(s.msgData.queryID),v&&v.onMessage(s);break}default:for(var g=0,b=Array.from(r.watchIdClientMap.entries());g<b.length;g++){var w=b[g],_=w[1];_.onMessage(s);break}}},r.heartbeat()})},this.isWSConnected=function(){return!!(r.ws&&r.ws.readyState===Hc.OPEN)},this.onceWSConnected=function(){return fr(r,void 0,void 0,function(){var n=this;return dr(this,function(o){return this.isWSConnected()?[2]:this.wsInitPromise!==null&&this.wsInitPromise!==void 0?[2,this.wsInitPromise]:[2,new Promise(function(i,a){n.wsReadySubsribers.push({resolve:i,reject:a})})]})})},this.webLogin=function(n,o){return fr(r,void 0,void 0,function(){var i,a,u,l,s,c,f,d,v=this;return dr(this,function(g){switch(g.label){case 0:if(!o){if(n){if(i=this.logins.get(n),i){if(i.loggedIn&&i.loginResult)return[2,i.loginResult];if(i.loggingInPromise!==null&&i.loggingInPromise!==void 0)return[2,i.loggingInPromise]}}else if(a=this.logins.get(""),(a==null?void 0:a.loggingInPromise)!==null&&(a==null?void 0:a.loggingInPromise)!==void 0)return[2,a.loggingInPromise]}u=new Promise(function(b,w){(function(){return fr(v,void 0,void 0,function(){var _,E,A,I,R;return dr(this,function($){switch($.label){case 0:return $.trys.push([0,3,,4]),[4,this.getWsSign()];case 1:return _=$.sent(),E={envId:_.envId||"",accessToken:"",referrer:"web",sdkVersion:"",dataVersion:""},A={watchId:void 0,requestId:Ni(),msgType:"LOGIN",msgData:E,exMsgData:{runtime:Fp(),signStr:_.signStr,secretVersion:_.secretVersion}},[4,this.send({msg:A,waitResponse:!0,skipOnMessage:!0,timeout:tL})];case 2:return I=$.sent(),I.msgData.code?w(new Error("".concat(I.msgData.code," ").concat(I.msgData.message))):b({envId:_.envId}),[3,4];case 3:return R=$.sent(),w(R),[3,4];case 4:return[2]}})})})()}),l=n&&this.logins.get(n),s=Date.now(),l?(l.loggedIn=!1,l.loggingInPromise=u,l.loginStartTS=s):(l={loggedIn:!1,loggingInPromise:u,loginStartTS:s},this.logins.set(n||"",l)),g.label=1;case 1:return g.trys.push([1,3,,4]),[4,u];case 2:if(c=g.sent(),f=n&&this.logins.get(n),f&&f===l&&f.loginStartTS===s)return l.loggedIn=!0,l.loggingInPromise=void 0,l.loginStartTS=void 0,l.loginResult=c,[2,c];if(f){if(f.loggedIn&&f.loginResult)return[2,f.loginResult];if(f.loggingInPromise!==null&&f.loggingInPromise!==void 0)return[2,f.loggingInPromise];throw new Error("ws unexpected login info")}else throw new Error("ws login info reset");case 3:throw d=g.sent(),l.loggedIn=!1,l.loggingInPromise=void 0,l.loginStartTS=void 0,l.loginResult=void 0,d;case 4:return[2]}})})},this.getWsSign=function(){return fr(r,void 0,void 0,function(){var n,o,i,a,u,l,s;return dr(this,function(c){switch(c.label){case 0:return this.wsSign&&this.wsSign.expiredTs>Date.now()?[2,this.wsSign]:(n=Date.now()+6e4,[4,this.context.appConfig.request.send("auth.wsWebSign",{runtime:Fp()})]);case 1:if(o=c.sent(),o.code)throw new Error("[tcb-js-sdk] 获取实时数据推送登录票据失败: ".concat(o.code));if(o.data)return i=o.data,a=i.signStr,u=i.wsUrl,l=i.secretVersion,s=i.envId,[2,{signStr:a,wsUrl:u,secretVersion:l,envId:s,expiredTs:n}];throw new Error("[tcb-js-sdk] 获取实时数据推送登录票据失败")}})})},this.getWaitExpectedTimeoutLength=function(){return r.rttObserved.length?r.rttObserved.reduce(function(n,o){return n+o})/r.rttObserved.length*1.5:JD},this.ping=function(){return fr(r,void 0,void 0,function(){var n;return dr(this,function(o){switch(o.label){case 0:return n={watchId:void 0,requestId:Ni(),msgType:"PING",msgData:null},[4,this.send({msg:n})];case 1:return o.sent(),[2]}})})},this.onWatchStart=function(n,o){r.queryIdClientMap.set(o,n)},this.onWatchClose=function(n,o){o&&r.queryIdClientMap.delete(o),r.watchIdClientMap.delete(n.watchId),r.virtualWSClient.delete(n),r.virtualWSClient.size||r.close(er.NoRealtimeListeners)},this.maxReconnect=t.maxReconnect||QD,this.reconnectInterval=t.reconnectInterval||XD,this.context=t.context}return e.prototype.clearHeartbeat=function(){this.pingTimeoutId&&clearTimeout(this.pingTimeoutId),this.pongTimeoutId&&clearTimeout(this.pongTimeoutId)},e.prototype.close=function(t){this.clearHeartbeat(),this.ws&&(this.ws.close(t,B0[t].name),this.ws=void 0)},e.prototype.watch=function(t){!this.ws&&(this.wsInitPromise===void 0||this.wsInitPromise===null)&&this.initWebSocketConnection(!1);var r=new HD(eu(eu({},t),{send:this.send,login:this.webLogin,isWSConnected:this.isWSConnected,onceWSConnected:this.onceWSConnected,getWaitExpectedTimeoutLength:this.getWaitExpectedTimeoutLength,onWatchStart:this.onWatchStart,onWatchClose:this.onWatchClose,debug:!0}));return this.virtualWSClient.add(r),this.watchIdClientMap.set(r.watchId,r),r.listener},e.prototype.heartbeat=function(t){var r=this;this.clearHeartbeat(),this.pingTimeoutId=setTimeout(function(){(function(){return fr(r,void 0,void 0,function(){var n=this;return dr(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),!this.ws||this.ws.readyState!==Hc.OPEN?[2]:(this.lastPingSendTS=Date.now(),[4,this.ping()]);case 1:return o.sent(),this.pingFailed=0,this.pongTimeoutId=setTimeout(function(){console.error("pong timed out"),n.pongMissed<eL?(n.pongMissed+=1,n.heartbeat(!0)):n.initWebSocketConnection(!0)},this.context.appConfig.realtimePongWaitTimeout),[3,3];case 2:return o.sent(),this.pingFailed<ZD?(this.pingFailed+=1,this.heartbeat()):this.close(er.HeartbeatPingError),[3,3];case 3:return[2]}})})})()},t?0:this.context.appConfig.realtimePingInterval)},e}(),q0={target:"database",entity:function(){var e=this.platform,t=e.adapter,r=e.runtime;KD(t.wsClass),zD(r)}},W0={name:"realtime",IIFE:!0,entity:function(){this.prototype.wsClientClass=rL}};try{cloudbase.registerComponent(W0),cloudbase.registerHook(q0)}catch{}function nL(e){try{e.registerComponent(W0),e.registerHook(q0)}catch(t){console.warn(t)}}var iL=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(a=e[u])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},Gc=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},oL=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},sL=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},aL=jt,uL=Ru,cL=Pu,H0="analytics",lL=["mall"];function fL(e){if(Object.prototype.toString.call(e).slice(8,-1)!=="Object")return!1;var t=e.report_data,r=e.report_type;return!(lL.includes(r)===!1||Object.prototype.toString.call(t).slice(8,-1)!=="Object"||t.action_time!==void 0&&!Number.isInteger(t.action_time)||typeof t.action_type!="string")}var dL=function(){function e(){}return e.prototype.analytics=function(t){return oL(this,void 0,void 0,function(){var r,n,o,i,a;return sL(this,function(u){if(!fL(t))throw new Error(JSON.stringify({code:aL.INVALID_PARAMS,msg:"[".concat(H0,".analytics] invalid report data")}));return r="analytics.report",n=t.report_data.action_time===void 0?Math.floor(Date.now()/1e3):t.report_data.action_time,o={analytics_scene:t.report_type,analytics_data:Object.assign({},t.report_data,{action_time:n})},i={requestData:o},a=this.request,a.send(r,i),[2]})})},iL([cL({customInfo:{},title:"上报调用失败",messages:["请确认以下各项：","  1 - 调用 analytics() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助：".concat(uL)]}),Gc("design:type",Function),Gc("design:paramtypes",[Object]),Gc("design:returntype",Promise)],e.prototype,"analytics",null),e}(),hL=new dL,G0={name:H0,entity:{analytics:hL.analytics}};try{cloudbase.registerComponent(G0)}catch{}function pL(e){try{e.registerComponent(G0)}catch(t){console.warn(t)}}var Ml=function(e,t){return Ml=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},Ml(e,t)};function vL(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ml(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var it=function(){return it=Object.assign||function(t){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},it.apply(this,arguments)};function ro(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,[])).next())})}function no(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}var ni=function(e){vL(t,e);function t(r,n){var o=e.call(this,r)||this;return o.name="WxCloudSDKError",o.code=n==null?void 0:n.code,o.requestId=n==null?void 0:n.requestId,o.originError=n==null?void 0:n.originError,o}return t}(Error);function Bl(){return typeof window<"u"&&window||typeof globalThis<"u"&&globalThis}function mL(){try{var e=Bl();return e?typeof wx>"u"?Bl().location.href:e.__wxRoute:void 0}catch{}}function gL(){var e=Bl();if(e!=null&&e.navigator)return e.navigator.userAgent;if(typeof wx<"u"&&wx.getSystemInfo){var t;return wx.getSystemInfo({success:function(r){r&&(t=["brand","model","version","system","platform","SDKVersion","language"].map(function(n){return"".concat(n,": ").concat(r[n])}).join(", "))}}),t}}var yL="1.6.1",_L=function(e){var t=e.dataSourceName,r=e.methodName,n=e.params,o=e.realMethodName,i=e.callFunction,a=e.envType,u=a===void 0?"prod":a,l=e.mode;return ro(void 0,void 0,void 0,function(){var s,c,f,d,v,g;return no(this,function(b){switch(b.label){case 0:s={data:{},requestId:""},b.label=1;case 1:return b.trys.push([1,3,,4]),[4,i({name:"lowcode-datasource",data:{dataSourceName:t,methodName:r,params:n,userAgent:gL(),referrer:mL(),"x-sdk-version":yL,envType:u,mode:l}})];case 2:if(c=b.sent(),f=((v=c==null?void 0:c.result)===null||v===void 0?void 0:v.requestId)||(c==null?void 0:c.requestId)||(c==null?void 0:c.requestID),c!=null&&c.result.code)throw new ni("【错误】".concat(c==null?void 0:c.result.message,`
【操作】调用 models.`).concat(t?"".concat(t,"."):"").concat(o,`
【错误码】`).concat(c==null?void 0:c.result.code,`
【请求ID】`).concat(f||"N/A"),{code:c==null?void 0:c.result.code,requestId:f});return s.data=((g=c==null?void 0:c.result)===null||g===void 0?void 0:g.data)||{},s.requestId=f,[3,4];case 3:throw d=b.sent(),d.name==="WxCloudSDKError"?d:(console.log(d),new ni("【错误】".concat(d.message,`
      【操作】调用 models.`).concat(t?"".concat(t,"."):"").concat(o,`
      【请求ID】N/A`),{code:"UnknownError",originError:d}));case 4:return[2,s]}})})},Bp=function(e){var t=e.sql,r=e.params,n=e.config,o=e.callFunction,i=e.unsafe,a=i===void 0?!1:i;return ro(void 0,void 0,void 0,function(){return no(this,function(u){return[2,_L({realMethodName:"$runSQL",methodName:"callWedaApi",params:{action:"RunMysqlCommand",data:{sqlTemplate:t,config:n,parameter:a?"":Object.entries(r||{}).reduce(function(l,s){var c=s[0],f=s[1];if(f!==void 0){var d="OBJECT",v=typeof f;switch(v){case"boolean":{d="BOOLEAN";break}case"number":{d="NUMBER";break}case"string":{d="STRING";break}default:Array.isArray(f)?d="ARRAY":d="OBJECT"}l.push({key:c,type:d,value:d==="STRING"?f:JSON.stringify(f)})}return l},[])||[]}},callFunction:o,mode:"sdk"})]})})},bL=function(e){return{$runSQL:function(t,r,n){return ro(this,void 0,void 0,function(){var o;return no(this,function(i){switch(i.label){case 0:return[4,Bp({sql:t,params:r,config:it(it({},n),{preparedStatements:!0}),callFunction:e})];case 1:return o=i.sent(),[2,o]}})})},$runSQLRaw:function(t,r){return ro(this,void 0,void 0,function(){var n;return no(this,function(o){switch(o.label){case 0:return[4,Bp({sql:t,params:[],config:it(it({},r),{preparedStatements:!1}),callFunction:e})];case 1:return n=o.sent(),[2,n]}})})}}},jp={filter:{where:{}},select:{$master:!0}};function Qr(e){return{getUrl:function(t){return"".concat(t,"/").concat(e)},method:"post"}}var wL={get:it(it({},Qr("get")),{defaultParams:it({},jp)}),list:it(it({},Qr("list")),{defaultParams:it({},jp)}),create:Qr("create"),createMany:Qr("createMany"),update:it(it({},Qr("update")),{method:"put"}),updateMany:it(it({},Qr("updateMany")),{method:"put"}),upsert:Qr("upsert"),delete:Qr("delete"),deleteMany:Qr("deleteMany")},Xs="Unknown error occurred",kp="NotSupported",EL=function(e,t,r,n){var o=bL(e);return new Proxy({},{get:function(i,a){if(typeof a=="string")return Object.prototype.hasOwnProperty.call(o,a)?o[a]:SL(r,a,t,n)}})},qp=function(e,t,r,n,o){return new ni("【错误】".concat(e,`
【操作】调用 models.`).concat(t,".").concat(r,`
【错误码】`).concat(n,`
【请求ID】`).concat(o),{code:n,requestId:o})},SL=function(e,t,r,n){var o=new Proxy({},{get:function(i,a){if(a!=="runSQLTemplate"){var u=wL[a];if(!u){var l=new Error("不支持的操作: ".concat(a));throw new ni(l.message||Xs,{originError:l,code:kp,requestId:"N/A"})}return function(s){return s===void 0&&(s={}),ro(void 0,void 0,void 0,function(){var c,f,d,v,g,b,w,_,E,A;return no(this,function(I){switch(I.label){case 0:c=u.getUrl,f=u.method,d=u.defaultParams,v=d===void 0?{}:d,g=Object.assign({},v,s),b=g.envType==="pre"?"pre":"prod",w=[e,b,c(t)].join("/"),I.label=1;case 1:return I.trys.push([1,3,,4]),[4,r({url:w,body:JSON.stringify(g),method:f})];case 2:if(_=I.sent(),_.code)throw qp(_==null?void 0:_.message,t,a,_==null?void 0:_.code,_==null?void 0:_.requestId);return a==="get"&&Object.assign(_,{data:(A=_.data.record)!==null&&A!==void 0?A:_.data}),[2,_];case 3:throw E=I.sent(),new ni((E==null?void 0:E.message)||Xs,{originError:E});case 4:return[2]}})})}}else{if(!(n!=null&&n.sqlBaseUrl)){var l=new Error("不支持的操作: ".concat(a));throw new ni(l.message||Xs,{originError:l,code:kp,requestId:"N/A"})}return function(s){return ro(void 0,void 0,void 0,function(){var c,f,d,v,g,b,w,_,E,A,I,R,$,L,D,P;return no(this,function(k){switch(k.label){case 0:c=s.params,f=s.templateName,d=s.envType,v=d==="pre"?"pre":"prod",g=[n.sqlBaseUrl,v,f,"run"].join("/"),b=Object.entries(c||{}).reduce(function(F,Q){var ce=Q[0],B=Q[1];if(B!==void 0){var fe="OBJECT",re=typeof B;switch(re){case"boolean":{fe="BOOLEAN";break}case"number":{fe="NUMBER";break}case"string":{fe="STRING";break}default:Array.isArray(B)?fe="ARRAY":fe="OBJECT"}F.push({key:ce,type:fe,value:fe==="STRING"?B:JSON.stringify(B)})}return F},[]),k.label=1;case 1:return k.trys.push([1,3,,4]),[4,r({url:g,body:JSON.stringify({parameter:b}),method:"POST"})];case 2:if(w=k.sent(),!((E=w==null?void 0:w.Response)===null||E===void 0)&&E.Error)throw qp((I=(A=w==null?void 0:w.Response)===null||A===void 0?void 0:A.Error)===null||I===void 0?void 0:I.Message,t,a,($=(R=w==null?void 0:w.Response)===null||R===void 0?void 0:R.Error)===null||$===void 0?void 0:$.Code,(L=w==null?void 0:w.Response)===null||L===void 0?void 0:L.RequestId);return[2,it(it({},(D=w==null?void 0:w.Response)!==null&&D!==void 0?D:{}),{data:(P=w==null?void 0:w.Response)===null||P===void 0?void 0:P.Data})];case 3:throw _=k.sent(),new ni((_==null?void 0:_.message)||Xs,{originError:_});case 4:return[2]}})})}}}});return o},ns=function(){return ns=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ns.apply(this,arguments)},IL=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},OL=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},TL=Dg,Wp="models";function AL(e){var t=this,r=e.callFunction.bind(e),n=e.request.fetch.bind(e.request),o=function(f){return IL(t,void 0,void 0,function(){var d;return OL(this,function(v){switch(v.label){case 0:return[4,n(ns(ns({},f),{headers:ns({"Content-Type":"application/json"},f.headers)}))];case 1:return d=v.sent(),[4,d.data];case 2:return[2,v.sent()]}})})},i=e.getEndPointWithKey("GATEWAY"),a=i.BASE_URL,u=i.PROTOCOL,l="".concat(u).concat(a,"/model"),s="".concat(u).concat(a,"/sql"),c=EL(r,o,l,{sqlBaseUrl:s});return c}var Hp=new WeakMap;function RL(e){return new Proxy({},{get:function(t,r){var n=Hp.get(e);return n||(n=AL(e),Hp.set(e,n)),n[r]}})}var V0="cloudbase_init",K0=new TL;K0.on(V0,function(e){var t=e.data;Object.assign(t,{models:RL(t)})});var z0={name:Wp,namespace:Wp,entity:new Proxy({},{get:function(e,t){console.warn("【deprecated】Accessing Cloudbase.prototype.models.".concat(t,"."))}}),injectEvents:{bus:K0,events:[V0]}};try{cloudbase.registerComponent(z0)}catch{}function CL(e){try{e.registerComponent(z0)}catch(t){console.warn(t)}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var jl=function(e,t){return jl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},jl(e,t)};function J0(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");jl(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function io(e){if(!e)throw new TypeError("Assertion failed")}function xL(){}function PL(e){return typeof e=="object"&&e!==null||typeof e=="function"}function NL(e){if(typeof e!="function")return!1;var t=!1;try{new e({start:function(){t=!0}})}catch{}return t}function Y0(e){return!(!PL(e)||typeof e.getReader!="function")}function $L(e){return!(!NL(e)||!Y0(new e))}function Q0(e){try{var t=e.getReader({mode:"byob"});return t.releaseLock(),!0}catch{return!1}}function DL(e){try{return new e({type:"bytes"}),!0}catch{return!1}}function LL(e){io($L(e));var t=DL(e);return function(r,n){var o=n===void 0?{}:n,i=o.type;if(i=X0(i),i==="bytes"&&!t&&(i=void 0),r.constructor===e&&(i!=="bytes"||Q0(r)))return r;if(i==="bytes"){var a=Gp(r,{type:i});return new e(a)}else{var a=Gp(r);return new e(a)}}}function Gp(e,t){var r=t===void 0?{}:t,n=r.type;io(Y0(e)),io(e.locked===!1),n=X0(n);var o;return n==="bytes"?o=new ML(e):o=new UL(e),o}function X0(e){var t=String(e);if(t==="bytes")return t;if(e===void 0)return e;throw new RangeError("Invalid type is specified")}var Z0=function(){function e(t){this._underlyingReader=void 0,this._readerMode=void 0,this._readableStreamController=void 0,this._pendingRead=void 0,this._underlyingStream=t,this._attachDefaultReader()}return e.prototype.start=function(t){this._readableStreamController=t},e.prototype.cancel=function(t){return io(this._underlyingReader!==void 0),this._underlyingReader.cancel(t)},e.prototype._attachDefaultReader=function(){if(this._readerMode!=="default"){this._detachReader();var t=this._underlyingStream.getReader();this._readerMode="default",this._attachReader(t)}},e.prototype._attachReader=function(t){var r=this;io(this._underlyingReader===void 0),this._underlyingReader=t;var n=this._underlyingReader.closed;n&&n.then(function(){return r._finishPendingRead()}).then(function(){t===r._underlyingReader&&r._readableStreamController.close()},function(o){t===r._underlyingReader&&r._readableStreamController.error(o)}).catch(xL)},e.prototype._detachReader=function(){this._underlyingReader!==void 0&&(this._underlyingReader.releaseLock(),this._underlyingReader=void 0,this._readerMode=void 0)},e.prototype._pullWithDefaultReader=function(){var t=this;this._attachDefaultReader();var r=this._underlyingReader.read().then(function(n){var o=t._readableStreamController;n.done?t._tryClose():o.enqueue(n.value)});return this._setPendingRead(r),r},e.prototype._tryClose=function(){try{this._readableStreamController.close()}catch{}},e.prototype._setPendingRead=function(t){var r=this,n,o=function(){r._pendingRead===n&&(r._pendingRead=void 0)};this._pendingRead=n=t.then(o,o)},e.prototype._finishPendingRead=function(){var t=this;if(this._pendingRead){var r=function(){return t._finishPendingRead()};return this._pendingRead.then(r,r)}},e}(),UL=function(e){J0(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.pull=function(){return this._pullWithDefaultReader()},t}(Z0);function Vp(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function FL(e,t){var r=Vp(e),n=Vp(t);n.set(r,0)}var ML=function(e){J0(t,e);function t(r){var n=this,o=Q0(r);return n=e.call(this,r)||this,n._supportsByob=o,n}return Object.defineProperty(t.prototype,"type",{get:function(){return"bytes"},enumerable:!1,configurable:!0}),t.prototype._attachByobReader=function(){if(this._readerMode!=="byob"){io(this._supportsByob),this._detachReader();var r=this._underlyingStream.getReader({mode:"byob"});this._readerMode="byob",this._attachReader(r)}},t.prototype.pull=function(){if(this._supportsByob){var r=this._readableStreamController.byobRequest;if(r)return this._pullWithByobRequest(r)}return this._pullWithDefaultReader()},t.prototype._pullWithByobRequest=function(r){var n=this;this._attachByobReader();var o=new Uint8Array(r.view.byteLength),i=this._underlyingReader.read(o).then(function(a){n._readableStreamController,a.done?(n._tryClose(),r.respond(0)):(FL(a.value,r.view),r.respond(a.value.byteLength))});return this._setPendingRead(i),i},t}(Z0);function BL(e){var t,r,n,o,i,a,u;return l(),{feed:s,reset:l};function l(){t=!0,r="",n=0,o=-1,i=void 0,a=void 0,u=""}function s(f){r=r?r+f:f,t&&jL(r)&&(r=r.slice(e_.length)),t=!1;for(var d=r.length,v=0,g=!1;v<d;){g&&(r[v]===`
`&&(v+=1),g=!1);for(var b=-1,w=o,_=void 0,E=n;b<0&&E<d;E++)_=r[E],_===":"&&w<0?w=E-v:_==="\r"?(g=!0,b=E-v):_===`
`&&(b=E-v);if(b<0){n=d-v,o=w;break}else n=0,o=-1;c(r,v,w,b),v+=b+1}v===d?r="":v>0&&(r=r.slice(v))}function c(f,d,v,g){if(g===0){u.length>0&&(e({type:"event",id:i,event:a||void 0,data:u.slice(0,-1)}),u="",i=void 0),a=void 0;return}var b=v<0,w=f.slice(d,d+(b?g:v)),_=0;b?_=g:f[d+v+1]===" "?_=v+2:_=v+1;var E=d+_,A=g-_,I=f.slice(E,E+A).toString();if(w==="data")u+=I?"".concat(I,`
`):`
`;else if(w==="event")a=I;else if(w==="id"&&!I.includes("\0"))i=I;else if(w==="retry"){var R=parseInt(I,10);Number.isNaN(R)||e({type:"reconnect-interval",value:R})}}}var e_=[239,187,191];function jL(e){return e_.every(function(t,r){return e.charCodeAt(r)===t})}var t_={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(ye,function(){var r=typeof ye<"u"?ye:self;if(typeof r.TextEncoder<"u"&&typeof r.TextDecoder<"u")return{TextEncoder:r.TextEncoder,TextDecoder:r.TextDecoder};var n=["utf8","utf-8","unicode-1-1-utf-8"],o=function(a){if(n.indexOf(a)<0&&typeof a<"u"&&a!==null)throw new RangeError("Invalid encoding type. Only utf-8 is supported");this.encoding="utf-8",this.encode=function(u){if(typeof u!="string")throw new TypeError("passed argument must be of type string");var l=unescape(encodeURIComponent(u)),s=new Uint8Array(l.length);return l.split("").forEach(function(c,f){s[f]=c.charCodeAt(0)}),s}},i=function(a,u){if(n.indexOf(a)<0&&typeof a<"u"&&a!==null)throw new RangeError("Invalid encoding type. Only utf-8 is supported");if(this.encoding="utf-8",this.ignoreBOM=!1,this.fatal=typeof u<"u"&&"fatal"in u?u.fatal:!1,typeof this.fatal!="boolean")throw new TypeError("fatal flag must be boolean");this.decode=function(l,s){if(typeof l>"u")return"";var c=typeof s<"u"&&"stream"in s?s.stream:!1;if(typeof c!="boolean")throw new TypeError("stream option must be boolean");if(ArrayBuffer.isView(l)){var f=new Uint8Array(l.buffer,l.byteOffset,l.byteLength),d=new Array(f.length);return f.forEach(function(v,g){d[g]=String.fromCharCode(v)}),decodeURIComponent(escape(d.join("")))}else throw new TypeError("passed argument must be an array buffer view")}};return{TextEncoder:o,TextDecoder:i}})})(t_);var kL=t_.exports,r_=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},n_=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},qL=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=e[i]&&function(a){return new Promise(function(u,l){a=e[i](a),o(u,l,a.done,a.value)})}}function o(i,a,u,l){Promise.resolve(l).then(function(s){i({value:s,done:u})},a)}},WL=st,Ye=ja,i_=function(){var e;return new Ye({start:function(t){e=BL(function(r){r.type==="event"&&t.enqueue(r)})},transform:function(t){e.feed(t)}})},Qt=LL(WL),ad=function(){function e(t,r){t===void 0&&(t="utf-8"),r===void 0&&(r={});var n=this;this.transform=new Ye({transform:function(o,i){var a=n.handle.decode(new Uint8Array(o),{stream:!0});a&&i.enqueue(a)},flush:function(o){var i=n.handle.decode();i&&o.enqueue(i),o.terminate()}}),this.handle=new kL.TextDecoder(t,r)}return Object.defineProperty(e.prototype,"encoding",{get:function(){return this.handle.encoding},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fatal",{get:function(){return this.handle.fatal},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ignoreBOM",{get:function(){return this.handle.ignoreBOM},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"readable",{get:function(){return this.transform.readable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"writable",{get:function(){return this.transform.writable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return"TextDecoderStream"},enumerable:!1,configurable:!0}),e}();function He(e){var t=e;return t[Symbol.asyncIterator]=function(){var r=e.getReader();return{next:function(){return r_(this,void 0,void 0,function(){var n,o,i;return n_(this,function(a){switch(a.label){case 0:return[4,r.read()];case 1:return n=a.sent(),o=n.done,i=n.value,[2,o?{done:!0,value:void 0}:{done:!1,value:i}]}})})}}},t}function Er(e){return He(e.pipeThrough(new ad).pipeThrough(i_()).pipeThrough(new Ye({transform:function(t,r){try{var n=JSON.parse(t.data);r.enqueue(n)}catch(o){t.data!=="[DONE]"?console.warn("Error when transforming event source data to json",o,t):r.terminate()}}})))}function HL(e){return He(Qt(e).pipeThrough(new ad))}function GL(e){var t,r,n,o;return r_(this,void 0,void 0,function(){var i,a,u,l,s,c,f;return n_(this,function(d){switch(d.label){case 0:i=HL(e),a="",d.label=1;case 1:d.trys.push([1,6,7,12]),u=!0,l=qL(i),d.label=2;case 2:return[4,l.next()];case 3:if(s=d.sent(),t=s.done,!!t)return[3,5];o=s.value,u=!1;try{c=o,a+=c}finally{u=!0}d.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return f=d.sent(),r={error:f},[3,12];case 7:return d.trys.push([7,,10,11]),!u&&!t&&(n=l.return)?[4,n.call(l)]:[3,9];case 8:d.sent(),d.label=9;case 9:return[3,11];case 10:if(r)throw r.error;return[7];case 11:return[7];case 12:return[2,JSON.parse(a)]}})})}function Kp(){var e,t,r=new Promise(function(n,o){e=n,t=o});return{promise:r,res:e,rej:t}}function lr(e){var t;return e.role==="assistant"&&"tool_calls"in e&&((t=e.tool_calls)===null||t===void 0?void 0:t[0])!=null}function VL(e){return{type:"function",function:{description:e.description,name:e.name,parameters:e.parameters}}}var En=function(){return En=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},En.apply(this,arguments)},hr=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},pr=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Zs=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},KL=function(){function e(t,r){this.baseUrl=r;var n=arguments[2];typeof n=="string"?this.req=function(o){var i=o.headers,a=i===void 0?{}:i,u=Zs(o,["headers"]);return t(En(En({},u),{headers:En(En({},a),{Authorization:"Bearer ".concat(n)})}))}:this.req=t}return e.prototype.list=function(t,r){return this.req({method:"get",url:this.join("bots"),data:t,timeout:r==null?void 0:r.timeout})},e.prototype.create=function(t,r){var n=t.botInfo;return this.req({method:"post",url:this.join("bots"),data:n,timeout:r==null?void 0:r.timeout})},e.prototype.get=function(t,r){var n=t.botId;return this.req({method:"get",url:this.join("bots/".concat(n)),timeout:r==null?void 0:r.timeout})},e.prototype.update=function(t,r){var n=t.botId,o=t.botInfo;return this.req({method:"PATCH",url:this.join("bots/".concat(n)),data:o,timeout:r==null?void 0:r.timeout})},e.prototype.delete=function(t,r){var n=t.botId;return this.req({method:"delete",url:this.join("bots/".concat(n)),timeout:r==null?void 0:r.timeout})},e.prototype.getChatRecords=function(t,r){return this.req({method:"get",url:this.join("bots/".concat(t.botId,"/records")),data:t,timeout:r==null?void 0:r.timeout})},e.prototype.sendFeedback=function(t,r){var n=t.userFeedback;return this.req({method:"post",url:this.join("bots/".concat(n.botId,"/feedback")),data:n,timeout:r==null?void 0:r.timeout})},e.prototype.getFeedback=function(t,r){return this.req({method:"get",url:this.join("bots/".concat(t.botId,"/feedback")),data:t,timeout:r==null?void 0:r.timeout})},e.prototype.uploadFiles=function(t,r){return hr(this,void 0,void 0,function(){return pr(this,function(n){return[2,this.req({method:"post",url:this.join("bots/".concat(t.botId,"/files")),data:t,timeout:r==null?void 0:r.timeout})]})})},e.prototype.createConversation=function(t,r){var n=t.botId,o=Zs(t,["botId"]);return hr(this,void 0,void 0,function(){return pr(this,function(i){return[2,this.req({method:"post",url:this.join("bots/".concat(n,"/conversation")),data:o,timeout:r==null?void 0:r.timeout})]})})},e.prototype.getConversation=function(t,r){var n=t.pageSize,o=n===void 0?10:n,i=t.pageNumber,a=i===void 0?1:i,u=t.botId,l=Zs(t,["pageSize","pageNumber","botId"]);return hr(this,void 0,void 0,function(){var s,c;return pr(this,function(f){if(a<1)throw new Error("pageNumber must be greater than 0");return s=o*(a-1),c=o,[2,this.req({method:"get",url:this.join("bots/".concat(u,"/conversation")),data:En(En({},l),{offset:s,limit:c}),timeout:r==null?void 0:r.timeout})]})})},e.prototype.deleteConversation=function(t,r){var n=t.botId,o=t.conversationId,i=Zs(t,["botId","conversationId"]);return hr(this,void 0,void 0,function(){return pr(this,function(a){return[2,this.req({method:"delete",url:this.join("bots/".concat(n,"/conversation/").concat(o)),data:i,timeout:r==null?void 0:r.timeout})]})})},e.prototype.speechToText=function(t,r){return hr(this,void 0,void 0,function(){return pr(this,function(n){return[2,this.req({method:"post",url:this.join("bots/".concat(t.botId,"/speech-to-text")),data:t,timeout:r==null?void 0:r.timeout})]})})},e.prototype.textToSpeech=function(t,r){return hr(this,void 0,void 0,function(){return pr(this,function(n){return[2,this.req({method:"post",url:this.join("bots/".concat(t.botId,"/text-to-speech")),data:t,timeout:r==null?void 0:r.timeout})]})})},e.prototype.getTextToSpeechResult=function(t,r){return hr(this,void 0,void 0,function(){return pr(this,function(n){return[2,this.req({method:"get",url:this.join("bots/".concat(t.botId,"/text-to-speech")),data:t,timeout:r==null?void 0:r.timeout})]})})},e.prototype.getRecommendQuestions=function(t,r){return hr(this,void 0,void 0,function(){var n;return pr(this,function(o){switch(o.label){case 0:return[4,this.req({method:"post",url:this.join("bots/".concat(t.botId,"/recommend-questions")),data:t,stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,new ea(n)]}})})},e.prototype.generateBot=function(t,r){return hr(this,void 0,void 0,function(){var n;return pr(this,function(o){switch(o.label){case 0:return[4,this.req({method:"post",url:this.join("generate-bot"),data:t,stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,new ea(n)]}})})},e.prototype.getPreview=function(t,r){return hr(this,void 0,void 0,function(){var n;return pr(this,function(o){switch(o.label){case 0:return[4,this.req({method:"post",url:this.join("preview"),data:t,stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,new ea(n)]}})})},e.prototype.generateImage=function(t,r){return this.req({method:"post",url:this.join("generate-image"),data:t,timeout:r==null?void 0:r.timeout})},e.prototype.sendMessage=function(t,r){return hr(this,void 0,void 0,function(){var n;return pr(this,function(o){switch(o.label){case 0:return[4,this.req({method:"post",url:this.join("bots/".concat(t.botId,"/send-message")),data:t,stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,new ea(n)]}})})},e.prototype.join=function(t){return"".concat(this.baseUrl,"/").concat(t)},e}(),ea=function(){function e(t){var r=Qt(t);this._eventSourceStream=r.pipeThrough(new ad).pipeThrough(i_())}return Object.defineProperty(e.prototype,"teeedStream",{get:function(){var t=this._eventSourceStream.tee(),r=t[0],n=t[1];return this._eventSourceStream=n,r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"eventSourceStream",{get:function(){return He(this.teeedStream)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataStream",{get:function(){return He(this.eventSourceStream.pipeThrough(new Ye({transform:function(t,r){try{var n=JSON.parse(t.data);r.enqueue(n)}catch(o){t.data!=="[DONE]"?console.warn("Error when transforming event source data to json",o,t):r.terminate()}}})))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textStream",{get:function(){return He(this.dataStream.pipeThrough(new Ye({transform:function(t,r){var n;r.enqueue((n=t==null?void 0:t.content)!==null&&n!==void 0?n:"")}})))},enumerable:!1,configurable:!0}),e}(),ft=function(){return ft=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ft.apply(this,arguments)},zp=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Jp=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function Yp(e){var t=e.messages,r=e.model,n=e.temperature,o=e.tool_choice,i=e.tools,a=e.top_p,u=function(){return o&&o!=="auto"&&console.warn("`tool_choice` is not 'auto'"),o};return ft(ft({},e),{messages:t,model:r,temperature:n,tool_choice:u(),tools:i,top_p:a})}var o_=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="zhipu/api/paas/v4/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t,r){return zp(this,void 0,void 0,function(){var n,o;return Jp(this,function(i){switch(i.label){case 0:return n=Yp(t),[4,this.req({url:this.url,data:ft(ft({},n),{stream:!1}),stream:!1,timeout:r==null?void 0:r.timeout})];case 1:return o=i.sent(),[2,ft(ft({},o),{rawResponse:o})]}})})},e.prototype.doStream=function(t,r){return zp(this,void 0,void 0,function(){var n,o,i,a,u,l;return Jp(this,function(s){switch(s.label){case 0:return n=Yp(t),o=null,[4,this.req({url:this.url,data:ft(ft({},n),{stream:!0}),stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return i=s.sent(),a=Qt(i),u=Er(a),l=u.pipeThrough(new Ye({transform:function(c,f){var d=c.choices.map(function(g){var b=g.delta;return o==null&&(o=lr(b)),o?ft(ft({},g),{finish_reason:"tool_calls",delta:b}):g}),v=ft(ft({},c),{choices:d});f.enqueue(ft(ft({},v),{rawResponse:c}))}})),[2,He(l)]}})})},e}(),tu=function(){return tu=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},tu.apply(this,arguments)};function gi(e){var t=e.messages,r=e.model,n=e.temperature,o=e.tool_choice,i=e.tools,a=e.top_p,u=function(){if(i)return i.forEach(function(s){s.type!=="function"&&console.warn("`type` in tool is not 'function'",s)}),i},l=function(){return t.forEach(function(s){"tool_calls"in s&&s.tool_calls.filter(function(c){return c.type!=="function"}).forEach(function(c){return console.warn("`type` in tool_call is not 'function'",c,s)})}),t};return tu(tu({},e),{messages:l(),model:r,tools:u(),top_p:a,tool_choice:o,temperature:n})}function ru(e){if(typeof e!="object"||e==null)return e;if(Array.isArray(e))return e.map(function(r){return ru(r)});return Object.entries(e).reduce(function(r,n){var o=n[0],i=n[1],a=t(o);return r[a]=typeof i=="object"?ru(i):i,r},{});function t(r){var n=r.replace(/[A-Z]/g,function(o){return"_".concat(o.toLowerCase())});return n.charAt(0)==="_"?n.slice(1):n}}var Pt=function(){return Pt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Pt.apply(this,arguments)},Qp=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Xp=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},s_=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="hunyuan-beta/openapi/v1/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t,r){return Qp(this,void 0,void 0,function(){var n;return Xp(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:Pt(Pt({},gi(t)),{stream:!1}),stream:!1,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,Pt(Pt({},n),{rawResponse:n})]}})})},e.prototype.doStream=function(t,r){return Qp(this,void 0,void 0,function(){var n,o,i,a,u;return Xp(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:Pt(Pt({},gi(t)),{stream:!0}),stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return o=l.sent(),i=Qt(o),a=Er(i),u=a.pipeThrough(new Ye({transform:function(s,c){var f=s.choices.map(function(v){var g=v.delta;return n==null&&(n=lr(g)),n?Pt(Pt({},v),{finish_reason:"tool_calls",delta:g}):v}),d=Pt(Pt({},s),{choices:f});c.enqueue(Pt(Pt({},d),{rawResponse:s}))}})),[2,He(u)]}})})},e}(),Nt=function(){return Nt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Nt.apply(this,arguments)},Zp=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},ev=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},a_=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="hunyuan",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t,r){return Zp(this,void 0,void 0,function(){var n,o;return ev(this,function(i){switch(i.label){case 0:return[4,this.req({url:this.url,headers:{"X-Tc-Action":"ChatCompletions"},data:Nt(Nt({},gi(t)),{stream:!1}),stream:!1,timeout:r==null?void 0:r.timeout})];case 1:return n=i.sent(),o=ru(n.Response),[2,Nt(Nt({},o),{rawResponse:n})]}})})},e.prototype.doStream=function(t,r){return Zp(this,void 0,void 0,function(){var n,o,i,a,u;return ev(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,headers:{"X-Tc-Action":"ChatCompletions"},data:Nt(Nt({},t),{stream:!0}),stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return o=l.sent(),i=Qt(o),a=Er(i),u=a.pipeThrough(new Ye({transform:function(s,c){var f=ru(s),d=f.choices.map(function(g){var b=g.delta;return n==null&&(n=lr(b)),n?Nt(Nt({},g),{finish_reason:"tool_calls",delta:b}):g}),v=Nt(Nt({},f),{choices:d});c.enqueue(Nt(Nt({},v),{rawResponse:s}))}})),[2,He(u)]}})})},e}(),dt=function(){return dt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},dt.apply(this,arguments)},tv=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},rv=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function nv(e){var t=e.messages,r=e.model,n=e.temperature,o=e.tools,i=e.top_p;return dt(dt({},e),{messages:t,model:r,tools:o,top_p:i,temperature:n})}var u_=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="ark/api/v3/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t,r){return tv(this,void 0,void 0,function(){var n;return rv(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:dt(dt({},nv(t)),{stream:!1}),stream:!1,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,dt(dt({},n),{rawResponse:n})]}})})},e.prototype.doStream=function(t,r){return tv(this,void 0,void 0,function(){var n,o,i,a,u;return rv(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:dt(dt({},nv(t)),{stream:!0}),stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return o=l.sent(),i=Qt(o),a=Er(i),u=a.pipeThrough(new Ye({transform:function(s,c){var f=s.choices.map(function(v){var g=v.delta;return n==null&&(n=lr(g)),n?dt(dt({},v),{finish_reason:"tool_calls",delta:g}):v}),d=dt(dt({},s),{choices:f});c.enqueue(dt(dt({},d),{rawResponse:s}))}})),[2,He(u)]}})})},e}(),rt=function(){return rt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},rt.apply(this,arguments)},iv=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},ov=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function sv(e){var t=e.messages,r=e.model,n=e.temperature,o=e.tools,i=e.top_p;return rt(rt({},e),{messages:t,model:r,tools:o,top_p:i,temperature:n})}var c_=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="dashscope/compatible-mode/v1/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t,r){return iv(this,void 0,void 0,function(){var n;return ov(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:rt(rt({},sv(t)),{stream:!1}),stream:!1,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,rt(rt({},n),{rawResponse:n})]}})})},e.prototype.doStream=function(t,r){return iv(this,void 0,void 0,function(){var n,o,i,a,u;return ov(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:rt(rt({},sv(t)),{stream:!0}),stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return o=l.sent(),i=Qt(o),a=Er(i),u=a.pipeThrough(new Ye({transform:function(s,c){var f=s.choices.map(function(v){var g=Object.assign(v.delta,{role:"assistant"});return n==null&&(n=lr(g)),n?rt(rt({},v),{finish_reason:"tool_calls",delta:g}):rt(rt({},v),{delta:g})}),d=rt(rt({},s),{choices:f});c.enqueue(rt(rt({},d),{rawResponse:s}))}})),[2,He(u)]}})})},e}(),nt=function(){return nt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},nt.apply(this,arguments)},av=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},uv=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function cv(e){var t=e.messages,r=e.model,n=e.temperature,o=e.tools,i=e.top_p;return nt(nt({},e),{messages:t,model:r,tools:o,top_p:i,temperature:n})}var l_=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="01-ai/v1/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t,r){return av(this,void 0,void 0,function(){var n;return uv(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:nt(nt({},cv(t)),{stream:!1}),stream:!1,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,nt(nt({},n),{rawResponse:n})]}})})},e.prototype.doStream=function(t,r){return av(this,void 0,void 0,function(){var n,o,i,a,u;return uv(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:nt(nt({},cv(t)),{stream:!0}),stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return o=l.sent(),i=Qt(o),a=Er(i),u=a.pipeThrough(new Ye({transform:function(s,c){var f,d,v,g,b,w;if(!((v=(d=(f=s==null?void 0:s.choices)===null||f===void 0?void 0:f[0])===null||d===void 0?void 0:d.delta)===null||v===void 0)&&v.content||!((w=(b=(g=s==null?void 0:s.choices)===null||g===void 0?void 0:g[0])===null||b===void 0?void 0:b.delta)===null||w===void 0)&&w.tool_calls){var _=s.choices.map(function(A){var I=Object.assign(A.delta,{role:"assistant"});return n==null&&(n=lr(I)),n?nt(nt({},A),{finish_reason:"tool_calls",delta:I}):nt(nt({},A),{delta:I})}),E=nt(nt({},s),{choices:_});c.enqueue(nt(nt({},E),{rawResponse:s}))}}})),[2,He(u)]}})})},e}(),ht=function(){return ht=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ht.apply(this,arguments)},lv=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},fv=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function dv(e){var t=e.messages,r=e.model,n=e.temperature,o=e.tools,i=e.top_p;return ht(ht({},e),{messages:t,model:r,tools:o,top_p:i,temperature:n})}var f_=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="moonshot/v1/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t,r){return lv(this,void 0,void 0,function(){var n;return fv(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:ht(ht({},dv(t)),{stream:!1}),stream:!1,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,ht(ht({},n),{rawResponse:n})]}})})},e.prototype.doStream=function(t,r){return lv(this,void 0,void 0,function(){var n,o,i,a,u;return fv(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:ht(ht({},dv(t)),{stream:!0}),stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return o=l.sent(),i=Qt(o),a=Er(i),u=a.pipeThrough(new Ye({transform:function(s,c){var f=s.choices.map(function(v){var g=v.delta;return n==null&&(n=lr(g)),n?ht(ht({},v),{finish_reason:"tool_calls",delta:g}):v}),d=ht(ht({},s),{choices:f});c.enqueue(ht(ht({},d),{rawResponse:s}))}})),[2,He(u)]}})})},e}(),$t=function(){return $t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},$t.apply(this,arguments)},hv=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},pv=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},d_=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="hunyuan-exp/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t){return hv(this,void 0,void 0,function(){var r;return pv(this,function(n){switch(n.label){case 0:return[4,this.req({url:this.url,data:$t($t({},gi(t)),{stream:!1}),stream:!1})];case 1:return r=n.sent(),[2,$t($t({},r),{rawResponse:r})]}})})},e.prototype.doStream=function(t){return hv(this,void 0,void 0,function(){var r,n,o,i,a;return pv(this,function(u){switch(u.label){case 0:return r=null,[4,this.req({url:this.url,data:$t($t({},gi(t)),{stream:!0}),stream:!0})];case 1:return n=u.sent(),o=Qt(n),i=Er(o),a=i.pipeThrough(new Ye({transform:function(l,s){var c=l.choices.map(function(d){var v=d.delta;return r==null&&(r=lr(v)),r?$t($t({},d),{finish_reason:"tool_calls",delta:v}):d}),f=$t($t({},l),{choices:c});s.enqueue($t($t({},f),{rawResponse:l}))}})),[2,He(a)]}})})},e}(),Dt=function(){return Dt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Dt.apply(this,arguments)},vv=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},mv=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},h_=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="hunyuan-open/v1/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t,r){return vv(this,void 0,void 0,function(){var n;return mv(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:Dt(Dt({},gi(t)),{stream:!1}),stream:!1,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,Dt(Dt({},n),{rawResponse:n})]}})})},e.prototype.doStream=function(t,r){return vv(this,void 0,void 0,function(){var n,o,i,a,u;return mv(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:Dt(Dt({},gi(t)),{stream:!0}),stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return o=l.sent(),i=Qt(o),a=Er(i),u=a.pipeThrough(new Ye({transform:function(s,c){var f=s.choices.map(function(v){var g=v.delta;return n==null&&(n=lr(g)),n?Dt(Dt({},v),{finish_reason:"tool_calls",delta:g}):v}),d=Dt(Dt({},s),{choices:f});c.enqueue(Dt(Dt({},d),{rawResponse:s}))}})),[2,He(u)]}})})},e}(),Lt=function(){return Lt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Lt.apply(this,arguments)},gv=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},yv=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},zL=function(){function e(t,r,n){this.req=t,this.baseUrl=r,this.subUrl="deepseek/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t,r){return gv(this,void 0,void 0,function(){var n;return yv(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:Lt(Lt({},t),{stream:!1}),stream:!1,timeout:r==null?void 0:r.timeout})];case 1:return n=o.sent(),[2,Lt(Lt({},n),{rawResponse:n})]}})})},e.prototype.doStream=function(t,r){return gv(this,void 0,void 0,function(){var n,o,i,a,u;return yv(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:Lt(Lt({},t),{stream:!0}),stream:!0,timeout:r==null?void 0:r.timeout})];case 1:return o=l.sent(),i=Qt(o),a=Er(i),u=a.pipeThrough(new Ye({transform:function(s,c){var f=s.choices.map(function(v){var g=v.delta;return n==null&&(n=lr(g)),n?Lt(Lt({},v),{finish_reason:"tool_calls",delta:g}):v}),d=Lt(Lt({},s),{choices:f});c.enqueue(Lt(Lt({},d),{rawResponse:s}))}})),[2,He(u)]}})})},e}(),Ut=function(){return Ut=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ut.apply(this,arguments)},_v=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},bv=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},p_=function(){function e(t,r,n){n===void 0&&(n=""),this.req=t,this.baseUrl=r,this.subUrl=n}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(t){return _v(this,void 0,void 0,function(){var r;return bv(this,function(n){switch(n.label){case 0:return[4,this.req({url:this.url,data:Ut(Ut({},t),{stream:!1}),stream:!1})];case 1:return r=n.sent(),[2,Ut(Ut({},r),{rawResponse:r})]}})})},e.prototype.doStream=function(t){return _v(this,void 0,void 0,function(){var r,n,o,i,a;return bv(this,function(u){switch(u.label){case 0:return r=null,[4,this.req({url:this.url,data:Ut(Ut({},t),{stream:!0}),stream:!0})];case 1:return n=u.sent(),o=Qt(n),i=Er(o),a=i.pipeThrough(new Ye({transform:function(l,s){var c=l.choices.map(function(d){var v=d.delta;return r==null&&(r=lr(v)),r?Ut(Ut({},d),{finish_reason:"tool_calls",delta:v}):d}),f=Ut(Ut({},l),{choices:c});s.enqueue(Ut(Ut({},f),{rawResponse:l}))}})),[2,He(a)]}})})},e}(),nu=function(){return nu=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},nu.apply(this,arguments)},kl=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},ql=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},JL=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},YL=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=e[i]&&function(a){return new Promise(function(u,l){a=e[i](a),o(u,l,a.done,a.value)})}}function o(i,a,u,l){Promise.resolve(l).then(function(s){i({value:s,done:u})},a)}},Rr=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))};function wv(e){var t,r=e.onStepFinish,n=e.abortSignal,o=e.maxSteps,i=e.topP,a=e.toolChoice,u=JL(e,["onStepFinish","abortSignal","maxSteps","topP","toolChoice"]);if(o!=null&&o<1)throw new Error("`maxSteps` muse be greater than 0.");return[{onStepFinish:r,abortSignal:n,maxSteps:o},nu(nu({},u),{tools:(t=u.tools)===null||t===void 0?void 0:t.map(function(l){return"fn"in l?VL(l):l}),top_p:i??u.top_p,tool_choice:a??u.tool_choice})]}var v_=function(){function e(t){this.model=t}return e.prototype.generateText=function(t,r){var n,o;return kl(this,void 0,void 0,function(){var i,a,u,l,s,c,f,d,v,g,b,w,_,E,A,I,R,$,L,D,P,k=this;return ql(this,function(F){switch(F.label){case 0:return i=[],a={completion_tokens:0,prompt_tokens:0,total_tokens:0},u=wv(t),l=u[0],s=l.onStepFinish,c=l.maxSteps,f=c===void 0?10:c,d=u[1],v=function(){return k.model.doGenerate(d,r)},[4,v()];case 1:g=F.sent(),b=1,g.rawResponse&&i.push(g.rawResponse),w=null,F.label=2;case 2:if(!(b<f&&(w=Ev(g))!=null))return[3,9];_=Ov(g.usage),$o(a,_),F.label=3;case 3:return F.trys.push([3,7,,8]),[4,Iv(w)];case 4:return E=F.sent(),A=g.choices[0],[4,s==null?void 0:s({finishReason:A.finish_reason,messages:d.messages.slice(),text:A.message.content,toolCall:w,toolResult:E,stepUsage:_,totalUsage:Object.assign({},a)})];case 5:return F.sent(),Sv(d.messages,A.message,E),[4,v()];case 6:return g=F.sent(),g.rawResponse&&i.push(g.rawResponse),b+=1,[3,8];case 7:return I=F.sent(),[2,{text:"",messages:d.messages,usage:a,error:I,rawResponses:i}];case 8:return[3,2];case 9:return R=(n=g==null?void 0:g.choices)===null||n===void 0?void 0:n[0],$=R==null?void 0:R.message,L=(o=$==null?void 0:$.content)!==null&&o!==void 0?o:"",D=$?Rr(Rr([],d.messages,!0),[$],!1):d.messages,P=Ov(g.usage),$o(a,P),[4,s==null?void 0:s({finishReason:R.finish_reason,messages:D.slice(),text:L,toolCall:Ev(g),toolResult:null,stepUsage:P,totalUsage:Object.assign({},a)})];case 10:return F.sent(),[2,{text:L,messages:D,usage:a,rawResponses:i}]}})})},e.prototype.streamText=function(t,r){var n;return kl(this,void 0,void 0,function(){var o,i,a,u,l,s,c,f,d,v,g,b,w,_,E,A,I,R,$,L,D,P,k,F,Q,ce,B,fe,re,X,M,W,te,ne,be,et,Rt=this;return ql(this,function(Qe){switch(Qe.label){case 0:return o={completion_tokens:0,prompt_tokens:0,total_tokens:0},i=wv(t),a=i[0],u=a.onStepFinish,l=a.maxSteps,s=l===void 0?10:l,c=i[1],f=function(){return Rt.model.doStream(c,r)},[4,f()];case 1:d=Qe.sent(),v=1,g=null,b=function(){var de=d.tee(),U=de[0],K=de[1];return d=He(U),QL(K)},Qe.label=2;case 2:return w=v<s,w?[4,b()]:[3,4];case 3:w=(g=Qe.sent())!=null,Qe.label=4;case 4:if(!w)return[3,11];_=g.message,E=g.usage,$o(o,E),A=(n=_.tool_calls)===null||n===void 0?void 0:n[0],Qe.label=5;case 5:return Qe.trys.push([5,9,,10]),[4,Iv(A)];case 6:return I=Qe.sent(),[4,u==null?void 0:u({finishReason:"tool_calls",messages:c.messages.slice(),text:_.content,toolCall:A,toolResult:I,stepUsage:E,totalUsage:Object.assign({},o)})];case 7:return Qe.sent(),Sv(c.messages,_,I),[4,f()];case 8:return d=Qe.sent(),[3,10];case 9:return R=Qe.sent(),$=d.tee(),L=$[0],D=$[1],[2,{messages:Promise.resolve(c.messages),dataStream:He(L),textStream:He(D.pipeThrough(new Ye({transform:function(de,U){var K,G,Y,ge=(Y=(G=(K=de==null?void 0:de.choices)===null||K===void 0?void 0:K[0])===null||G===void 0?void 0:G.delta)===null||Y===void 0?void 0:Y.content;typeof ge=="string"&&U.enqueue(ge)}}))),usage:Promise.resolve(o),error:R}];case 10:return[3,2];case 11:return[4,b()];case 12:return g=Qe.sent(),g?(P=g.message,k=g.usage,$o(o,k),F=Rr(Rr([],c.messages,!0),[P],!1),u({messages:F.slice(),finishReason:"tool_call",stepUsage:k,text:P.content,toolCall:P.tool_calls[0],totalUsage:Object.assign({},o)}),Q=d.tee(),ce=Q[0],B=Q[1],[2,{messages:Promise.resolve(Rr(Rr([],c.messages,!0),[P],!1)),dataStream:He(ce),textStream:He(B.pipeThrough(new Ye({transform:function(de,U){var K,G,Y,ge=(Y=(G=(K=de==null?void 0:de.choices)===null||K===void 0?void 0:K[0])===null||G===void 0?void 0:G.delta)===null||Y===void 0?void 0:Y.content;typeof ge=="string"&&U.enqueue(ge)}}))),usage:Promise.resolve(o)}]):(fe=Kp(),re=Kp(),X={role:"assistant",content:""},M="",W={completion_tokens:0,prompt_tokens:0,total_tokens:0},te=d.pipeThrough(new Ye({transform:function(de,U){var K,G,Y,ge,S,T,N,m,h=(Y=(G=(K=de==null?void 0:de.choices)===null||K===void 0?void 0:K[0])===null||G===void 0?void 0:G.delta)===null||Y===void 0?void 0:Y.content;typeof h=="string"&&(X.content+=h);var p=(S=(ge=de==null?void 0:de.choices)===null||ge===void 0?void 0:ge[0])===null||S===void 0?void 0:S.finish_reason;p&&(M=p),!((T=de==null?void 0:de.usage)===null||T===void 0)&&T.completion_tokens&&(W.completion_tokens=de.usage.completion_tokens),!((N=de==null?void 0:de.usage)===null||N===void 0)&&N.prompt_tokens&&(W.prompt_tokens=de.usage.prompt_tokens),!((m=de==null?void 0:de.usage)===null||m===void 0)&&m.total_tokens&&(W.total_tokens=de.usage.total_tokens),U.enqueue(de)},flush:function(){fe.res(Rr(Rr([],c.messages,!0),[X],!1)),$o(o,W),re.res(Object.assign({},o)),u==null||u({messages:Rr(Rr([],c.messages,!0),[X],!1),finishReason:M,text:X.content,stepUsage:W,totalUsage:Object.assign({},o)})}})),ne=te.tee(),be=ne[0],et=ne[1],[2,{messages:fe.promise,dataStream:He(be),textStream:He(et.pipeThrough(new Ye({transform:function(de,U){var K,G,Y,ge=(Y=(G=(K=de==null?void 0:de.choices)===null||K===void 0?void 0:K[0])===null||G===void 0?void 0:G.delta)===null||Y===void 0?void 0:Y.content;typeof ge=="string"&&U.enqueue(ge)}}))),usage:re.promise}])}})})},e}();function Ev(e){var t,r=(t=e==null?void 0:e.choices)===null||t===void 0?void 0:t[0];if(!r)return null;var n=r.finish_reason,o=r.message;return n!=="tool_calls"||!o||!lr(o)?null:o.tool_calls[0]}function Sv(e,t,r){e.push(t,{role:"tool",tool_call_id:t.tool_calls[0].id,content:JSON.stringify(r)})}function QL(e){var t,r,n,o,i,a,u,l,s,c;return kl(this,void 0,void 0,function(){var f,d,v,g,b,w,_,E,A,I,R,$,L;return ql(this,function(D){switch(D.label){case 0:f={completion_tokens:0,prompt_tokens:0,total_tokens:0},d=He(e),v={id:"",function:{name:"",arguments:""},type:""},g={role:"assistant",content:"",tool_calls:[v]},D.label=1;case 1:D.trys.push([1,6,7,12]),b=!0,w=YL(d),D.label=2;case 2:return[4,w.next()];case 3:if(_=D.sent(),t=_.done,!!t)return[3,5];o=_.value,b=!1;try{if(E=o,A=E==null?void 0:E.choices[0],!A)return[2,null];if(I=A.finish_reason,R=A.delta,I!=="tool_calls")return[2,null];if(!R)return[3,4];if(R.content&&(g.content+=R.content),!("tool_calls"in R))return[3,4];$=(i=R==null?void 0:R.tool_calls)===null||i===void 0?void 0:i[0],$!=null&&$.id&&(v.id=$.id),$!=null&&$.type&&(v.type=$.type),!((a=$==null?void 0:$.function)===null||a===void 0)&&a.name&&(v.function.name=$.function.name),!((u=$==null?void 0:$.function)===null||u===void 0)&&u.arguments&&(v.function.arguments+=$.function.arguments),!((l=E==null?void 0:E.usage)===null||l===void 0)&&l.completion_tokens&&(f.completion_tokens=E.usage.completion_tokens),!((s=E==null?void 0:E.usage)===null||s===void 0)&&s.prompt_tokens&&(f.prompt_tokens=E.usage.prompt_tokens),!((c=E==null?void 0:E.usage)===null||c===void 0)&&c.total_tokens&&(f.total_tokens=E.usage.total_tokens)}finally{b=!0}D.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return L=D.sent(),r={error:L},[3,12];case 7:return D.trys.push([7,,10,11]),!b&&!t&&(n=w.return)?[4,n.call(w)]:[3,9];case 8:D.sent(),D.label=9;case 9:return[3,11];case 10:if(r)throw r.error;return[7];case 11:return[7];case 12:return[2,{message:g,usage:f}]}})})}var iu=new Map;function Iv(e){return iu.get(e.function.name)(JSON.parse(e.function.arguments))}function Ov(e){var t,r,n;return{completion_tokens:(t=e==null?void 0:e.completion_tokens)!==null&&t!==void 0?t:0,prompt_tokens:(r=e==null?void 0:e.prompt_tokens)!==null&&r!==void 0?r:0,total_tokens:(n=e==null?void 0:e.total_tokens)!==null&&n!==void 0?n:0}}function $o(e,t){e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens}var m_={hunyuan:a_,"hunyuan-beta":s_,ark:u_,dashscope:c_,"01-ai":l_,moonshot:f_,zhipu:o_,"hunyuan-exp":d_,"hunyuan-open":h_,deepseek:zL};const XL=Object.freeze(Object.defineProperty({__proto__:null,ArkSimpleModel:u_,DSSimpleModel:c_,DefaultSimpleModel:p_,HunYuanBetaSimpleModel:s_,HunYuanExpSimpleModel:d_,HunYuanOpenSimpleModel:h_,HunYuanSimpleModel:a_,MODELS:m_,MoonshotSimpleModel:f_,ReactModel:v_,YiSimpleModel:l_,ZhiPuSimpleModel:o_,toolMap:iu},Symbol.toStringTag,{value:"Module"}));var $i=function(){return $i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},$i.apply(this,arguments)},Vc=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Kc=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},zc=m_,ZL=function(){function e(t,r,n){var o=this;this.req=t,this.baseUrl=r,this.modelRequest=function(i){var a=i.url,u=i.data,l=i.headers,s=i.stream,c=i.timeout;return Vc(o,void 0,void 0,function(){var f,d,v,g,b,w,_;return Kc(this,function(E){switch(E.label){case 0:return f={"Content-Type":"application/json"},s&&Object.assign(f,{Accept:"text/event-stream"}),[4,this.req.fetch({method:"post",headers:$i($i((b={},b[(w=this.i18n)===null||w===void 0?void 0:w.LANG_HEADER_KEY]=(_=this.i18n)===null||_===void 0?void 0:_.lang,b),f),l),body:JSON.stringify(u),url:a,stream:s,timeout:c})];case 1:return d=E.sent(),v=d.data,g=d.header,[2,this.handleResponseData(v,g)]}})})},this.botRequest=function(i){var a=i.method,u=i.url,l=i.data,s=l===void 0?{}:l,c=i.headers,f=i.stream,d=i.timeout;return Vc(o,void 0,void 0,function(){function v($){return Object.entries($).map(function(L){var D=L[0],P=L[1];return"".concat(D,"=").concat(P)}).join("&")}var g,b,w,_,E,A,I,R;return Kc(this,function($){switch($.label){case 0:return a!=="get"?[3,2]:(g=this.handleResponseData,[4,this.req.fetch({url:"".concat(u,"?").concat(v(s)),method:a,headers:c,stream:f,timeout:d})]);case 1:return[2,g.apply(this,[$.sent().data])];case 2:return b={"Content-Type":"application/json"},f&&Object.assign(b,{Accept:"text/event-stream"}),[4,this.req.fetch({url:u,body:JSON.stringify(s),headers:$i($i((A={},A[(I=this.i18n)===null||I===void 0?void 0:I.LANG_HEADER_KEY]=(R=this.i18n)===null||R===void 0?void 0:R.lang,A),b),c),stream:f,method:a,timeout:d})];case 3:return w=$.sent(),_=w.data,E=w.header,[2,this.handleResponseData(_,E)]}})})},this.aiBaseUrl="".concat(r,"/ai"),this.aiBotBaseUrl="".concat(r,"/aibot"),this.bot=new KL(this.botRequest,this.aiBotBaseUrl),this.i18n=n,Cu.on(xu,function(i){var a;o.i18n=((a=i.data)===null||a===void 0?void 0:a.i18n)||o.i18n})}return e.prototype.handleResponseData=function(t,r){var n,o;return Vc(this,void 0,void 0,function(){var i,a,a;return Kc(this,function(u){switch(u.label){case 0:return i="".concat(this.i18n.t("请检查调用方式，或前往云开发 AI+ 首页查看文档"),"：https://tcb.cloud.tencent.com/dev#/ai"),typeof t=="object"&&t&&"then"in t?[4,t]:[3,2];case 1:if(a=u.sent(),typeof a=="object"&&a&&"code"in a&&a.code!=="NORMAL")throw new Error("".concat(this.i18n.t("AI+ 请求出错，错误码"),"：").concat(a.code,"，").concat(this.i18n.t("错误信息"),"：").concat(a.message,`
`).concat(i,`
`).concat(JSON.stringify(a,null,2)));return[2,t];case 2:return!((o=(n=r==null?void 0:r.get)===null||n===void 0?void 0:n.call(r,"content-type"))===null||o===void 0)&&o.includes("application/json")?[4,GL(t)]:[3,4];case 3:if(a=u.sent(),typeof a=="object"&&a&&"code"in a&&a.code!=="NORMAL")throw new Error("".concat(this.i18n.t("AI+ 请求出错，错误码"),"：").concat(a.code,"，").concat(this.i18n.t("错误信息"),"：").concat(a.message,`
`).concat(i,`
`).concat(JSON.stringify(a,null,2)));u.label=4;case 4:return[2,t]}})})},e.prototype.createModel=function(t,r){var n,o=zc[t];if(o)n=new o(this.modelRequest,this.aiBaseUrl);else{var i=typeof(r==null?void 0:r.defaultModelSubUrl)=="string"?r.defaultModelSubUrl:"/chat/completions";n=new p_(this.modelRequest,this.aiBaseUrl,"".concat(t).concat(i))}var a=new v_(n);return a},e.prototype.registerModel=function(t,r){if(zc[t]!=null){console.warn("AI model ".concat(t," already exists!"));return}zc[t]=r},e.prototype.registerFunctionTool=function(t){iu.has(t.name)&&console.warn("AI function tool ".concat(t.name," already exists and will be overwritten!")),iu.set(t.name,t.fn)},e}(),ou=function(){return ou=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ou.apply(this,arguments)},e3=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},t3=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},g_=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},r3="ai";g_(XL,["MODELS"]);var n3=function(e){var t=e.getAccessToken,r=e.req,n=function(o){return e3(void 0,void 0,void 0,function(){var i,a,u,l,s;return t3(this,function(c){switch(c.label){case 0:if(typeof r.fetch!="function")throw new Error("req.fetch is not a function");return i=o.token,a=o.headers,u=a===void 0?{}:a,l=g_(o,["token","headers"]),i==null?[3,1]:(s=i,[3,3]);case 1:return[4,t()];case 2:s=c.sent().accessToken,c.label=3;case 3:return[2,r.fetch(ou({headers:ou({Authorization:"Bearer ".concat(s)},u)},l))]}})})};return{download:r.download,post:r.post,upload:r.upload,fetch:n}};function i3(e){var t=e.env,r=e.baseUrl,n=e.req,o=e.getAccessToken,i=e.handleReqInstance,a=e.i18n,u=function(){if(r!=null)return r;if(t==null)throw new Error("`env` is required when `baseUrl` is not provided!");return"https://".concat(t,".api.tcloudbasegateway.com/v1")},l=function(){if(i==null){if(o==null)throw new Error("`getAccessToken` is required when `handleReqInstance` is not provided!");return n3({req:n,getAccessToken:o})}return i({req:n})};return new ZL(l(),u(),a)}function o3(e){var t=this,r,n=this.request;if(n.fetch==null)throw new Error("cloudbase.request.fetch() unimplemented!");var o=function(){var a=t.getEndPointWithKey("GATEWAY"),u=a.BASE_URL,l=a.PROTOCOL;return"".concat(l).concat(u)},i=(r=e==null?void 0:e.baseUrl)!==null&&r!==void 0?r:o();return i3({req:n,baseUrl:i,handleReqInstance:function(a){var u=a.req;return u},i18n:this.config.i18n})}var s3={name:r3,entity:{ai:o3}};function a3(e){try{e.registerComponent(s3)}catch(t){console.warn(t)}}var Hn,nn;(function(e){e.DocIDError="文档ID不合法",e.CollNameError="集合名称不合法",e.OpStrError="操作符不合法",e.DirectionError="排序字符不合法",e.IntergerError="must be integer",e.QueryParamTypeError="查询参数必须为对象",e.QueryParamValueError="查询参数对象值不能均为undefined"})(nn||(nn={}));var ke={Number:"Number",Object:"Object",Array:"Array",GeoPoint:"GeoPoint",GeoLineString:"GeoLineString",GeoPolygon:"GeoPolygon",GeoMultiPoint:"GeoMultiPoint",GeoMultiLineString:"GeoMultiLineString",GeoMultiPolygon:"GeoMultiPolygon",Timestamp:"Date",ServerDate:"ServerDate",BsonDate:"BsonDate"},u3=["desc","asc"],c3=["<","<=","==",">=",">"],ei;(function(e){e.lt="<",e.gt=">",e.lte="<=",e.gte=">=",e.eq="=="})(ei||(ei={}));Hn={},Hn[ei.eq]="$eq",Hn[ei.lt]="$lt",Hn[ei.lte]="$lte",Hn[ei.gt]="$gt",Hn[ei.gte]="$gte";var Br;(function(e){e.WHERE="WHERE",e.DOC="DOC"})(Br||(Br={}));var l3=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ta=[],Tv={},f3=function(){function e(t){Object.defineProperties(this,{target:{enumerable:!1,writable:!1,configurable:!1,value:t}})}return e}(),Xt=function(e){l3(t,e);function t(r,n){var o=this;if(n!==Tv)throw new TypeError("InternalSymbol cannot be constructed with new operator");return o=e.call(this,r)||this,o}return t.for=function(r){for(var n=0,o=ta.length;n<o;n++)if(ta[n].target===r)return ta[n].instance;var i=new t(r,Tv);return ta.push({target:r,instance:i}),i},t}(f3),Es=Xt.for("UNSET_FIELD_NAME"),y_=Xt.for("UPDATE_COMMAND"),__=Xt.for("QUERY_COMMAND"),b_=Xt.for("LOGIC_COMMAND"),w_=Xt.for("GEO_POINT"),d3=Xt.for("SYMBOL_GEO_LINE_STRING"),h3=Xt.for("SYMBOL_GEO_POLYGON"),p3=Xt.for("SYMBOL_GEO_MULTI_POINT"),v3=Xt.for("SYMBOL_GEO_MULTI_LINE_STRING"),m3=Xt.for("SYMBOL_GEO_MULTI_POLYGON"),E_=Xt.for("SERVER_DATE"),S_=Xt.for("REGEXP"),I_=function(){function e(t){var r=(t===void 0?{}:t).offset,n=r===void 0?0:r;this.offset=n}return Object.defineProperty(e.prototype,"_internalType",{get:function(){return E_},enumerable:!0,configurable:!0}),e.prototype.parse=function(){return{$date:{offset:this.offset}}},e}();function g3(e){return new I_(e)}var Jc=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(u){a={error:u}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},zu=function(){function e(){}return e.formatResDocumentData=function(t){return t.map(function(r){return e.formatField(r)})},e.formatField=function(t){var r=Object.keys(t),n={};return Array.isArray(t)&&(n=[]),r.forEach(function(o){var i=t[o],a=e.whichType(i),u;switch(a){case ke.GeoPoint:u=new Bt(i.coordinates[0],i.coordinates[1]);break;case ke.GeoLineString:u=new Lr(i.coordinates.map(function(l){return new Bt(l[0],l[1])}));break;case ke.GeoPolygon:u=new ui(i.coordinates.map(function(l){return new Lr(l.map(function(s){var c=Jc(s,2),f=c[0],d=c[1];return new Bt(f,d)}))}));break;case ke.GeoMultiPoint:u=new su(i.coordinates.map(function(l){return new Bt(l[0],l[1])}));break;case ke.GeoMultiLineString:u=new au(i.coordinates.map(function(l){return new Lr(l.map(function(s){var c=Jc(s,2),f=c[0],d=c[1];return new Bt(f,d)}))}));break;case ke.GeoMultiPolygon:u=new Ss(i.coordinates.map(function(l){return new ui(l.map(function(s){return new Lr(s.map(function(c){var f=Jc(c,2),d=f[0],v=f[1];return new Bt(d,v)}))}))}));break;case ke.Timestamp:u=new Date(i.$timestamp*1e3);break;case ke.Object:case ke.Array:u=e.formatField(i);break;case ke.ServerDate:u=new Date(i.$date);break;default:u=i}Array.isArray(n)?n.push(u):n[o]=u}),n},e.whichType=function(t){var r=Object.prototype.toString.call(t).slice(8,-1);if(r===ke.Timestamp)return ke.BsonDate;if(r===ke.Object){if(t instanceof Bt)return ke.GeoPoint;if(t instanceof Date)return ke.Timestamp;if(t instanceof I_)return ke.ServerDate;t.$timestamp?r=ke.Timestamp:t.$date?r=ke.ServerDate:Bt.validate(t)?r=ke.GeoPoint:Lr.validate(t)?r=ke.GeoLineString:ui.validate(t)?r=ke.GeoPolygon:su.validate(t)?r=ke.GeoMultiPoint:au.validate(t)?r=ke.GeoMultiLineString:Ss.validate(t)&&(r=ke.GeoMultiPolygon)}return r},e.generateDocId=function(){for(var t="ABCDEFabcdef0123456789",r="",n=0;n<24;n++)r+=t.charAt(Math.floor(Math.random()*t.length));return r},e}(),Rn=function(){function e(){}return e.isGeopoint=function(t,r){if(zu.whichType(r)!==ke.Number)throw new Error("Geo Point must be number type");var n=Math.abs(r);if(t==="latitude"&&n>90)throw new Error("latitude should be a number ranges from -90 to 90");if(t==="longitude"&&n>180)throw new Error("longitude should be a number ranges from -180 to 180");return!0},e.isInteger=function(t,r){if(!Number.isInteger(r))throw new Error(t+nn.IntergerError);return!0},e.isFieldOrder=function(t){if(u3.indexOf(t)===-1)throw new Error(nn.DirectionError);return!0},e.isFieldPath=function(t){if(!/^[a-zA-Z0-9-_\.]/.test(t))throw new Error;return!0},e.isOperator=function(t){if(c3.indexOf(t)===-1)throw new Error(nn.OpStrError);return!0},e.isCollName=function(t){if(!/^[a-zA-Z0-9]([a-zA-Z0-9-_]){1,32}$/.test(t))throw new Error(nn.CollNameError);return!0},e.isDocID=function(t){if(!/^([a-fA-F0-9]){24}$/.test(t))throw new Error(nn.DocIDError);return!0},e}(),Hr=function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},Pn=function(e){return Hr(e)==="object"},y3=function(e){return Hr(e)==="string"},sr=function(e){return Hr(e)==="number"},Ve=function(e){return Array.isArray(e)},O_=function(e){return Hr(e)==="date"},ud=function(e){return Hr(e)==="regexp"},T_=function(e){return e&&e._internalType instanceof Xt},Bt=function(){function e(t,r){Rn.isGeopoint("longitude",t),Rn.isGeopoint("latitude",r),this.longitude=t,this.latitude=r}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"Point",coordinates:[this.longitude,this.latitude]},r},e.prototype.toJSON=function(){return{type:"Point",coordinates:[this.longitude,this.latitude]}},e.prototype.toReadableString=function(){return"["+this.longitude+","+this.latitude+"]"},e.validate=function(t){return t.type==="Point"&&Ve(t.coordinates)&&Rn.isGeopoint("longitude",t.coordinates[0])&&Rn.isGeopoint("latitude",t.coordinates[1])},Object.defineProperty(e.prototype,"_internalType",{get:function(){return w_},enumerable:!0,configurable:!0}),e}(),_3=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Lr=function(){function e(t){if(!Ve(t))throw new TypeError('"points" must be of type Point[]. Received type '+typeof t);if(t.length<2)throw new Error('"points" must contain 2 points at least');t.forEach(function(r){if(!(r instanceof Bt))throw new TypeError('"points" must be of type Point[]. Received type '+typeof r+"[]")}),this.points=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"LineString",coordinates:this.points.map(function(n){return n.toJSON().coordinates})},r},e.prototype.toJSON=function(){return{type:"LineString",coordinates:this.points.map(function(t){return t.toJSON().coordinates})}},e.validate=function(t){var r,n;if(t.type!=="LineString"||!Ve(t.coordinates))return!1;try{for(var o=_3(t.coordinates),i=o.next();!i.done;i=o.next()){var a=i.value;if(!sr(a[0])||!sr(a[1]))return!1}}catch(u){r={error:u}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!0},e.isClosed=function(t){var r=t.points[0],n=t.points[t.points.length-1];if(r.latitude===n.latitude&&r.longitude===n.longitude)return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return d3},enumerable:!0,configurable:!0}),e}(),Av=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ui=function(){function e(t){if(!Ve(t))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof t);if(t.length===0)throw new Error("Polygon must contain 1 linestring at least");t.forEach(function(r){if(!(r instanceof Lr))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof r+"[]");if(!Lr.isClosed(r))throw new Error("LineString "+r.points.map(function(n){return n.toReadableString()})+" is not a closed cycle")}),this.lines=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"Polygon",coordinates:this.lines.map(function(n){return n.points.map(function(o){return[o.longitude,o.latitude]})})},r},e.prototype.toJSON=function(){return{type:"Polygon",coordinates:this.lines.map(function(t){return t.points.map(function(r){return[r.longitude,r.latitude]})})}},e.validate=function(t){var r,n,o,i;if(t.type!=="Polygon"||!Ve(t.coordinates))return!1;try{for(var a=Av(t.coordinates),u=a.next();!u.done;u=a.next()){var l=u.value;if(!this.isCloseLineString(l))return!1;try{for(var s=(o=void 0,Av(l)),c=s.next();!c.done;c=s.next()){var f=c.value;if(!sr(f[0])||!sr(f[1]))return!1}}catch(d){o={error:d}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}}}catch(d){r={error:d}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return!0},e.isCloseLineString=function(t){var r=t[0],n=t[t.length-1];return!(r[0]!==n[0]||r[1]!==n[1])},Object.defineProperty(e.prototype,"_internalType",{get:function(){return m3},enumerable:!0,configurable:!0}),e}(),b3=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},su=function(){function e(t){if(!Ve(t))throw new TypeError('"points" must be of type Point[]. Received type '+typeof t);if(t.length===0)throw new Error('"points" must contain 1 point at least');t.forEach(function(r){if(!(r instanceof Bt))throw new TypeError('"points" must be of type Point[]. Received type '+typeof r+"[]")}),this.points=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"MultiPoint",coordinates:this.points.map(function(n){return n.toJSON().coordinates})},r},e.prototype.toJSON=function(){return{type:"MultiPoint",coordinates:this.points.map(function(t){return t.toJSON().coordinates})}},e.validate=function(t){var r,n;if(t.type!=="MultiPoint"||!Ve(t.coordinates))return!1;try{for(var o=b3(t.coordinates),i=o.next();!i.done;i=o.next()){var a=i.value;if(!sr(a[0])||!sr(a[1]))return!1}}catch(u){r={error:u}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return p3},enumerable:!0,configurable:!0}),e}(),Rv=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},au=function(){function e(t){if(!Ve(t))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof t);if(t.length===0)throw new Error("Polygon must contain 1 linestring at least");t.forEach(function(r){if(!(r instanceof Lr))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof r+"[]")}),this.lines=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"MultiLineString",coordinates:this.lines.map(function(n){return n.points.map(function(o){return[o.longitude,o.latitude]})})},r},e.prototype.toJSON=function(){return{type:"MultiLineString",coordinates:this.lines.map(function(t){return t.points.map(function(r){return[r.longitude,r.latitude]})})}},e.validate=function(t){var r,n,o,i;if(t.type!=="MultiLineString"||!Ve(t.coordinates))return!1;try{for(var a=Rv(t.coordinates),u=a.next();!u.done;u=a.next()){var l=u.value;try{for(var s=(o=void 0,Rv(l)),c=s.next();!c.done;c=s.next()){var f=c.value;if(!sr(f[0])||!sr(f[1]))return!1}}catch(d){o={error:d}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}}}catch(d){r={error:d}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return v3},enumerable:!0,configurable:!0}),e}(),ra=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ss=function(){function e(t){var r,n;if(!Ve(t))throw new TypeError('"polygons" must be of type Polygon[]. Received type '+typeof t);if(t.length===0)throw new Error("MultiPolygon must contain 1 polygon at least");try{for(var o=ra(t),i=o.next();!i.done;i=o.next()){var a=i.value;if(!(a instanceof ui))throw new TypeError('"polygon" must be of type Polygon[]. Received type '+typeof a+"[]")}}catch(u){r={error:u}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}this.polygons=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"MultiPolygon",coordinates:this.polygons.map(function(n){return n.lines.map(function(o){return o.points.map(function(i){return[i.longitude,i.latitude]})})})},r},e.prototype.toJSON=function(){return{type:"MultiPolygon",coordinates:this.polygons.map(function(t){return t.lines.map(function(r){return r.points.map(function(n){return[n.longitude,n.latitude]})})})}},e.validate=function(t){var r,n,o,i,a,u;if(t.type!=="MultiPolygon"||!Ve(t.coordinates))return!1;try{for(var l=ra(t.coordinates),s=l.next();!s.done;s=l.next()){var c=s.value;try{for(var f=(o=void 0,ra(c)),d=f.next();!d.done;d=f.next()){var v=d.value;try{for(var g=(a=void 0,ra(v)),b=g.next();!b.done;b=g.next()){var w=b.value;if(!sr(w[0])||!sr(w[1]))return!1}}catch(_){a={error:_}}finally{try{b&&!b.done&&(u=g.return)&&u.call(g)}finally{if(a)throw a.error}}}}catch(_){o={error:_}}finally{try{d&&!d.done&&(i=f.return)&&i.call(f)}finally{if(o)throw o.error}}}}catch(_){r={error:_}}finally{try{s&&!s.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return h3},enumerable:!0,configurable:!0}),e}();const w3=Object.freeze(Object.defineProperty({__proto__:null,LineString:Lr,MultiLineString:au,MultiPoint:su,MultiPolygon:Ss,Point:Bt,Polygon:ui},Symbol.toStringTag,{value:"Module"}));var on=function(){var e;if(!Promise){e=function(){},e.promise={};var t=function(){throw new Error('Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.')};return Object.defineProperty(e.promise,"then",{get:t}),Object.defineProperty(e.promise,"catch",{get:t}),e}var r=new Promise(function(n,o){e=function(i,a){return i?o(i):n(a)}});return e.promise=r,e},Ie;(function(e){e.SET="set",e.REMOVE="remove",e.INC="inc",e.MUL="mul",e.PUSH="push",e.PULL="pull",e.PULL_ALL="pullAll",e.POP="pop",e.SHIFT="shift",e.UNSHIFT="unshift",e.ADD_TO_SET="addToSet",e.BIT="bit",e.RENAME="rename",e.MAX="max",e.MIN="min"})(Ie||(Ie={}));var Xe=function(){function e(t,r,n){this._internalType=y_,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.operator=t,this.operands=r,this.fieldName=n||Es}return e.prototype._setFieldName=function(t){var r=new e(this.operator,this.operands,t);return r},e}();function Cv(e){return e&&e instanceof Xe&&e._internalType===y_}var Yt;(function(e){e.AND="and",e.OR="or",e.NOT="not",e.NOR="nor"})(Yt||(Yt={}));var ii=function(){function e(t,r,n){if(this._internalType=b_,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.operator=t,this.operands=r,this.fieldName=n||Es,this.fieldName!==Es)if(Array.isArray(r)){r=r.slice(),this.operands=r;for(var o=0,i=r.length;o<i;o++){var a=r[o];(uu(a)||cu(a))&&(r[o]=a._setFieldName(this.fieldName))}}else{var a=r;(uu(a)||cu(a))&&(r=a._setFieldName(this.fieldName))}}return e.prototype._setFieldName=function(t){var r=this.operands.map(function(o){return o instanceof e?o._setFieldName(t):o}),n=new e(this.operator,r,t);return n},e.prototype.and=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.from(arguments);return t.unshift(this),new e(Yt.AND,t,this.fieldName)},e.prototype.or=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.from(arguments);return t.unshift(this),new e(Yt.OR,t,this.fieldName)},e}();function uu(e){return e&&e instanceof ii&&e._internalType===b_}var E3=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),he;(function(e){e.EQ="eq",e.NEQ="neq",e.GT="gt",e.GTE="gte",e.LT="lt",e.LTE="lte",e.IN="in",e.NIN="nin",e.ALL="all",e.ELEM_MATCH="elemMatch",e.EXISTS="exists",e.SIZE="size",e.MOD="mod",e.GEO_NEAR="geoNear",e.GEO_WITHIN="geoWithin",e.GEO_INTERSECTS="geoIntersects"})(he||(he={}));var tt=function(e){E3(t,e);function t(r,n,o){var i=e.call(this,r,n,o)||this;return i.operator=r,i._internalType=__,i}return t.prototype.toJSON=function(){var r,n;switch(this.operator){case he.IN:case he.NIN:return r={},r["$"+this.operator]=this.operands,r;default:return n={},n["$"+this.operator]=this.operands[0],n}},t.prototype._setFieldName=function(r){var n=new t(this.operator,this.operands,r);return n},t.prototype.eq=function(r){var n=new t(he.EQ,[r],this.fieldName);return this.and(n)},t.prototype.neq=function(r){var n=new t(he.NEQ,[r],this.fieldName);return this.and(n)},t.prototype.gt=function(r){var n=new t(he.GT,[r],this.fieldName);return this.and(n)},t.prototype.gte=function(r){var n=new t(he.GTE,[r],this.fieldName);return this.and(n)},t.prototype.lt=function(r){var n=new t(he.LT,[r],this.fieldName);return this.and(n)},t.prototype.lte=function(r){var n=new t(he.LTE,[r],this.fieldName);return this.and(n)},t.prototype.in=function(r){var n=new t(he.IN,r,this.fieldName);return this.and(n)},t.prototype.nin=function(r){var n=new t(he.NIN,r,this.fieldName);return this.and(n)},t.prototype.geoNear=function(r){if(!(r.geometry instanceof Bt))throw new TypeError('"geometry" must be of type Point. Received type '+typeof r.geometry);if(r.maxDistance!==void 0&&!sr(r.maxDistance))throw new TypeError('"maxDistance" must be of type Number. Received type '+typeof r.maxDistance);if(r.minDistance!==void 0&&!sr(r.minDistance))throw new TypeError('"minDistance" must be of type Number. Received type '+typeof r.minDistance);var n=new t(he.GEO_NEAR,[r],this.fieldName);return this.and(n)},t.prototype.geoWithin=function(r){if(!(r.geometry instanceof Ss)&&!(r.geometry instanceof ui))throw new TypeError('"geometry" must be of type Polygon or MultiPolygon. Received type '+typeof r.geometry);var n=new t(he.GEO_WITHIN,[r],this.fieldName);return this.and(n)},t.prototype.geoIntersects=function(r){if(!(r.geometry instanceof Bt)&&!(r.geometry instanceof Lr)&&!(r.geometry instanceof ui)&&!(r.geometry instanceof su)&&!(r.geometry instanceof au)&&!(r.geometry instanceof Ss))throw new TypeError('"geometry" must be of type Point, LineString, Polygon, MultiPoint, MultiLineString or MultiPolygon. Received type '+typeof r.geometry);var n=new t(he.GEO_INTERSECTS,[r],this.fieldName);return this.and(n)},t}(ii);function cu(e){return e&&e instanceof tt&&e._internalType===__}function xv(e){return cu(e)}var Mn={};for(var Ln in he)Mn[Ln]="$"+Ln;for(var Ln in Yt)Mn[Ln]="$"+Ln;for(var Ln in Ie)Mn[Ln]="$"+Ln;Mn[he.NEQ]="$ne";Mn[Ie.REMOVE]="$unset";Mn[Ie.SHIFT]="$pop";Mn[Ie.UNSHIFT]="$push";function Di(e){return Mn[e]||"$"+e}var Wl=function(){return Wl=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Wl.apply(this,arguments)},S3=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(u){a={error:u}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Pv=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(S3(arguments[t]));return e};function Is(e){return Hl(e,[e])}function Hl(e,t){if(T_(e))switch(e._internalType){case w_:return e.toJSON();case E_:return e.parse();case S_:return e.parse();default:return e.toJSON?e.toJSON():e}else{if(O_(e))return{$date:+e};if(ud(e))return{$regex:e.source,$options:e.flags};if(Ve(e))return e.map(function(o){if(t.indexOf(o)>-1)throw new Error("Cannot convert circular structure to JSON");return Hl(o,Pv(t,[o]))});if(Pn(e)){var r=Wl({},e);for(var n in r){if(t.indexOf(r[n])>-1)throw new Error("Cannot convert circular structure to JSON");r[n]=Hl(r[n],Pv(t,[r[n]]))}return r}else return e}}var Gl=function(){return Gl=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Gl.apply(this,arguments)},I3=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(u){a={error:u}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Nv=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(I3(arguments[t]));return e};function A_(e,t,r,n){var o=Gl({},e);for(var i in e)if(!/^\$/.test(i)){var a=e[i];if(a&&Pn(a)&&!t(a)){if(n.indexOf(a)>-1)throw new Error("Cannot convert circular structure to JSON");var u=Nv(r,[i]),l=Nv(n,[a]),s=A_(a,t,u,l);o[i]=s;var c=!1;for(var f in s)/^\$/.test(f)?c=!0:(o[i+"."+f]=s[f],delete o[i][f]);c||delete o[i]}}return o}function R_(e){return A_(e,Vl,[],[e])}function $v(e,t,r){t[r]||delete e[r];for(var n in t)e[n]?Ve(e[n])?e[n].push(t[n]):Pn(e[n])?Pn(t[n])?Object.assign(e[n],t[n]):(console.warn("unmergable condition, query is object but condition is "+Hr(t)+", can only overwrite",t,r),e[n]=t[n]):(console.warn("to-merge query is of type "+Hr(e)+", can only overwrite",e,t,r),e[n]=t[n]):e[n]=t[n]}function Vl(e){return T_(e)||O_(e)||ud(e)}function Cn(e){return Is(e)}var cd=function(){function e(){}return e.encode=function(t){var r=new e;return r.encodeUpdate(t)},e.prototype.encodeUpdate=function(t){return Cv(t)?this.encodeUpdateCommand(t):Hr(t)==="object"?this.encodeUpdateObject(t):t},e.prototype.encodeUpdateCommand=function(t){if(t.fieldName===Es)throw new Error("Cannot encode a comparison command with unset field name");switch(t.operator){case Ie.PUSH:case Ie.PULL:case Ie.PULL_ALL:case Ie.POP:case Ie.SHIFT:case Ie.UNSHIFT:case Ie.ADD_TO_SET:return this.encodeArrayUpdateCommand(t);default:return this.encodeFieldUpdateCommand(t)}},e.prototype.encodeFieldUpdateCommand=function(t){var r,n,o,i,a=Di(t.operator);switch(t.operator){case Ie.REMOVE:return r={},r[a]=(n={},n[t.fieldName]="",n),r;default:return o={},o[a]=(i={},i[t.fieldName]=t.operands[0],i),o}},e.prototype.encodeArrayUpdateCommand=function(t){var r,n,o,i,a,u,l,s,c,f,d=Di(t.operator);switch(t.operator){case Ie.PUSH:{var v=void 0;return Ve(t.operands)?v={$each:t.operands.map(Cn)}:v=t.operands,r={},r[d]=(n={},n[t.fieldName]=v,n),r}case Ie.UNSHIFT:{var v={$each:t.operands.map(Cn),$position:0};return o={},o[d]=(i={},i[t.fieldName]=v,i),o}case Ie.POP:return a={},a[d]=(u={},u[t.fieldName]=1,u),a;case Ie.SHIFT:return l={},l[d]=(s={},s[t.fieldName]=-1,s),l;default:return c={},c[d]=(f={},f[t.fieldName]=Cn(t.operands),f),c}},e.prototype.encodeUpdateObject=function(t){var r=R_(t);for(var n in r)if(!/^\$/.test(n)){var o=r[n];if(Cv(o)){r[n]=o._setFieldName(n);var i=this.encodeUpdateCommand(r[n]);$v(r,i,n)}else{r[n]=o=Cn(o);var a=new Xe(Ie.SET,[o],n),i=this.encodeUpdateCommand(a);$v(r,i,n)}}return r},e}(),Yc={};function C_(e){if(!Et.wsClientClass)throw new Error("to use realtime you must import realtime module first");var t=e.config.env;return Yc[t]||(Yc[t]=new Et.wsClientClass({context:{appConfig:{docSizeLimit:1e3,realtimePingInterval:1e4,realtimePongWaitTimeout:5e3,request:new Et.reqClass(e.config)}}})),Yc[t]}var lu=function(){return lu=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},lu.apply(this,arguments)},Dv=function(){function e(t,r,n,o){var i=this;o===void 0&&(o={}),this.watch=function(a){var u=C_(i._db);return u.watch(lu(lu({},a),{envId:i._db.config.env,collectionName:i._coll,query:JSON.stringify({_id:i.id})}))},this._db=t,this._coll=r,this.id=n,this.request=new Et.reqClass(this._db.config),this.projection=o}return e.prototype.create=function(t,r){r=r||on();var n={collectionName:this._coll,data:Is(t)};return this.id&&(n._id=this.id),this.request.send("database.addDocument",n).then(function(o){o.code?r(0,o):r(0,{id:o.data._id,requestId:o.requestId})}).catch(function(o){r(o)}),r.promise},e.prototype.set=function(t,r){if(r=r||on(),!this.id)return Promise.resolve({code:"INVALID_PARAM",message:"docId不能为空"});if(!t||typeof t!="object")return Promise.resolve({code:"INVALID_PARAM",message:"参数必需是非空对象"});if(t.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"不能更新_id的值"});var n=!1,o=function(u){if(typeof u=="object")for(var l in u)u[l]instanceof Xe?n=!0:typeof u[l]=="object"&&o(u[l])};if(o(t),n)return Promise.resolve({code:"DATABASE_REQUEST_FAILED",message:"update operator complicit"});var i=!1,a={collectionName:this._coll,queryType:Br.DOC,data:Is(t),multi:!1,merge:i,upsert:!0};return this.id&&(a.query={_id:this.id}),this.request.send("database.updateDocument",a).then(function(u){u.code?r(0,u):r(0,{updated:u.data.updated,upsertedId:u.data.upserted_id,requestId:u.requestId})}).catch(function(u){r(u)}),r.promise},e.prototype.update=function(t,r){if(r=r||on(),!t||typeof t!="object")return Promise.resolve({code:"INVALID_PARAM",message:"参数必需是非空对象"});if(t.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"不能更新_id的值"});var n={_id:this.id},o=!0,i={collectionName:this._coll,data:cd.encode(t),query:n,queryType:Br.DOC,multi:!1,merge:o,upsert:!1};return this.request.send("database.updateDocument",i).then(function(a){a.code?r(0,a):r(0,{updated:a.data.updated,upsertedId:a.data.upserted_id,requestId:a.requestId})}).catch(function(a){r(a)}),r.promise},e.prototype.remove=function(t){t=t||on();var r={_id:this.id},n={collectionName:this._coll,query:r,queryType:Br.DOC,multi:!1};return this.request.send("database.deleteDocument",n).then(function(o){o.code?t(0,o):t(0,{deleted:o.data.deleted,requestId:o.requestId})}).catch(function(o){t(o)}),t.promise},e.prototype.get=function(t){t=t||on();var r={_id:this.id},n={collectionName:this._coll,query:r,queryType:Br.DOC,multi:!1,projection:this.projection};return this.request.send("database.queryDocument",n).then(function(o){if(o.code)t(0,o);else{var i=zu.formatResDocumentData(o.data.list);t(0,{data:i,requestId:o.requestId})}}).catch(function(o){t(o)}),t.promise},e.prototype.field=function(t){for(var r in t)t[r]?t[r]=1:t[r]=0;return new e(this._db,this._coll,this.id,t)},e}(),fu=function(){function e(){}return e.encode=function(t){var r=new O3;return r.encodeQuery(t)},e}(),O3=function(){function e(){}return e.prototype.encodeQuery=function(t,r){var n;return Vl(t)?uu(t)?this.encodeLogicCommand(t):cu(t)?this.encodeQueryCommand(t):(n={},n[r]=this.encodeQueryObject(t),n):Pn(t)?this.encodeQueryObject(t):t},e.prototype.encodeRegExp=function(t){return{$regex:t.source,$options:t.flags}},e.prototype.encodeLogicCommand=function(t){var r,n,o,i,a,u,l,s=this;switch(t.operator){case Yt.NOR:case Yt.AND:case Yt.OR:{var c=Di(t.operator),f=t.operands.map(function(g){return s.encodeQuery(g,t.fieldName)});return r={},r[c]=f,r}case Yt.NOT:{var c=Di(t.operator),d=t.operands[0];if(ud(d))return n={},n[t.fieldName]=(o={},o[c]=this.encodeRegExp(d),o),n;var f=this.encodeQuery(d)[t.fieldName];return i={},i[t.fieldName]=(a={},a[c]=f,a),i}default:{var c=Di(t.operator);if(t.operands.length===1){var v=this.encodeQuery(t.operands[0]);return u={},u[c]=v,u}else{var f=t.operands.map(this.encodeQuery.bind(this));return l={},l[c]=f,l}}}},e.prototype.encodeQueryCommand=function(t){return xv(t)?this.encodeComparisonCommand(t):this.encodeComparisonCommand(t)},e.prototype.encodeComparisonCommand=function(t){var r,n,o,i,a,u,l,s,c;if(t.fieldName===Es)throw new Error("Cannot encode a comparison command with unset field name");var f=Di(t.operator);switch(t.operator){case he.EQ:case he.NEQ:case he.LT:case he.LTE:case he.GT:case he.GTE:case he.ELEM_MATCH:case he.EXISTS:case he.SIZE:case he.MOD:return r={},r[t.fieldName]=(n={},n[f]=Cn(t.operands[0]),n),r;case he.IN:case he.NIN:case he.ALL:return o={},o[t.fieldName]=(i={},i[f]=Cn(t.operands),i),o;case he.GEO_NEAR:{var d=t.operands[0];return a={},a[t.fieldName]={$nearSphere:{$geometry:d.geometry.toJSON(),$maxDistance:d.maxDistance,$minDistance:d.minDistance}},a}case he.GEO_WITHIN:{var d=t.operands[0];return u={},u[t.fieldName]={$geoWithin:{$geometry:d.geometry.toJSON()}},u}case he.GEO_INTERSECTS:{var d=t.operands[0];return l={},l[t.fieldName]={$geoIntersects:{$geometry:d.geometry.toJSON()}},l}default:return s={},s[t.fieldName]=(c={},c[f]=Cn(t.operands[0]),c),s}},e.prototype.encodeQueryObject=function(t){var r=R_(t);for(var n in r){var o=r[n];if(uu(o)){r[n]=o._setFieldName(n);var i=this.encodeLogicCommand(r[n]);this.mergeConditionAfterEncode(r,i,n)}else if(xv(o)){r[n]=o._setFieldName(n);var i=this.encodeComparisonCommand(r[n]);this.mergeConditionAfterEncode(r,i,n)}else Vl(o)&&(r[n]=Cn(o))}return r},e.prototype.mergeConditionAfterEncode=function(t,r,n){r[n]||delete t[n];for(var o in r)t[o]?Ve(t[o])?t[o]=t[o].concat(r[o]):Pn(t[o])?Pn(r[o])?Object.assign(t,r):(console.warn("unmergable condition, query is object but condition is "+Hr(r)+", can only overwrite",r,n),t[o]=r[o]):(console.warn("to-merge query is of type "+Hr(t)+", can only overwrite",t,r,n),t[o]=r[o]):t[o]=r[o]},e}(),ti=function(){return ti=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ti.apply(this,arguments)},T3=function(){function e(t,r,n,o,i){var a=this;this.watch=function(u){var l=C_(a._db);return l.watch(ti(ti({},u),{envId:a._db.config.env,collectionName:a._coll,query:JSON.stringify(a._fieldFilters||{}),limit:a._queryOptions.limit,orderBy:a._fieldOrders?a._fieldOrders.reduce(function(s,c){return s[c.field]=c.direction,s},{}):void 0}))},this._db=t,this._coll=r,this._fieldFilters=n,this._fieldOrders=o||[],this._queryOptions=i||{},this._request=new Et.reqClass(this._db.config)}return e.prototype.get=function(t){t=t||on();var r=[];this._fieldOrders&&this._fieldOrders.forEach(function(o){r.push(o)});var n={collectionName:this._coll,queryType:Br.WHERE};return this._fieldFilters&&(n.query=this._fieldFilters),r.length>0&&(n.order=r),this._queryOptions.offset&&(n.offset=this._queryOptions.offset),this._queryOptions.limit?n.limit=this._queryOptions.limit<1e3?this._queryOptions.limit:1e3:n.limit=100,this._queryOptions.projection&&(n.projection=this._queryOptions.projection),this._request.send("database.queryDocument",n).then(function(o){if(o.code)t(0,o);else{var i=zu.formatResDocumentData(o.data.list),a={data:i,requestId:o.requestId};o.total&&(a.total=o.total),o.limit&&(a.limit=o.limit),o.offset&&(a.offset=o.offset),t(0,a)}}).catch(function(o){t(o)}),t.promise},e.prototype.count=function(t){t=t||on();var r={collectionName:this._coll,queryType:Br.WHERE};return this._fieldFilters&&(r.query=this._fieldFilters),this._request.send("database.countDocument",r).then(function(n){n.code?t(0,n):t(0,{requestId:n.requestId,total:n.data.total})}).catch(function(n){t(n)}),t.promise},e.prototype.where=function(t){if(Object.prototype.toString.call(t).slice(8,-1)!=="Object")throw Error(nn.QueryParamTypeError);var r=Object.keys(t),n=r.some(function(o){return t[o]!==void 0});if(r.length&&!n)throw Error(nn.QueryParamValueError);return new e(this._db,this._coll,fu.encode(t),this._fieldOrders,this._queryOptions)},e.prototype.orderBy=function(t,r){Rn.isFieldPath(t),Rn.isFieldOrder(r);var n={field:t,direction:r},o=this._fieldOrders.concat(n);return new e(this._db,this._coll,this._fieldFilters,o,this._queryOptions)},e.prototype.limit=function(t){Rn.isInteger("limit",t);var r=ti({},this._queryOptions);return r.limit=t,new e(this._db,this._coll,this._fieldFilters,this._fieldOrders,r)},e.prototype.skip=function(t){Rn.isInteger("offset",t);var r=ti({},this._queryOptions);return r.offset=t,new e(this._db,this._coll,this._fieldFilters,this._fieldOrders,r)},e.prototype.update=function(t,r){if(r=r||on(),!t||typeof t!="object")return Promise.resolve({code:"INVALID_PARAM",message:"参数必需是非空对象"});if(t.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"不能更新_id的值"});var n={collectionName:this._coll,query:this._fieldFilters,queryType:Br.WHERE,multi:!0,merge:!0,upsert:!1,data:cd.encode(t)};return this._request.send("database.updateDocument",n).then(function(o){o.code?r(0,o):r(0,{requestId:o.requestId,updated:o.data.updated,upsertId:o.data.upsert_id})}).catch(function(o){r(o)}),r.promise},e.prototype.field=function(t){for(var r in t)t[r]?typeof t[r]!="object"&&(t[r]=1):t[r]=0;var n=ti({},this._queryOptions);return n.projection=t,new e(this._db,this._coll,this._fieldFilters,this._fieldOrders,n)},e.prototype.remove=function(t){t=t||on(),Object.keys(this._queryOptions).length>0&&console.warn("`offset`, `limit` and `projection` are not supported in remove() operation"),this._fieldOrders.length>0&&console.warn("`orderBy` is not supported in remove() operation");var r={collectionName:this._coll,query:fu.encode(this._fieldFilters),queryType:Br.WHERE,multi:!0};return this._request.send("database.deleteDocument",r).then(function(n){n.code?t(0,n):t(0,{requestId:n.requestId,deleted:n.data.deleted})}).catch(function(n){t(n)}),t.promise},e}();function A3(e,t){return t={exports:{}},e(t,t.exports),t.exports}var R3=$3,C3=L3,x3=M3,Ur=[],rr=[],P3=typeof Uint8Array<"u"?Uint8Array:Array,Qc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Ii=0,N3=Qc.length;Ii<N3;++Ii)Ur[Ii]=Qc[Ii],rr[Qc.charCodeAt(Ii)]=Ii;rr[45]=62;rr[95]=63;function x_(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");r===-1&&(r=t);var n=r===t?0:4-r%4;return[r,n]}function $3(e){var t=x_(e),r=t[0],n=t[1];return(r+n)*3/4-n}function D3(e,t,r){return(t+r)*3/4-r}function L3(e){var t,r=x_(e),n=r[0],o=r[1],i=new P3(D3(e,n,o)),a=0,u=o>0?n-4:n,l;for(l=0;l<u;l+=4)t=rr[e.charCodeAt(l)]<<18|rr[e.charCodeAt(l+1)]<<12|rr[e.charCodeAt(l+2)]<<6|rr[e.charCodeAt(l+3)],i[a++]=t>>16&255,i[a++]=t>>8&255,i[a++]=t&255;return o===2&&(t=rr[e.charCodeAt(l)]<<2|rr[e.charCodeAt(l+1)]>>4,i[a++]=t&255),o===1&&(t=rr[e.charCodeAt(l)]<<10|rr[e.charCodeAt(l+1)]<<4|rr[e.charCodeAt(l+2)]>>2,i[a++]=t>>8&255,i[a++]=t&255),i}function U3(e){return Ur[e>>18&63]+Ur[e>>12&63]+Ur[e>>6&63]+Ur[e&63]}function F3(e,t,r){for(var n,o=[],i=t;i<r;i+=3)n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255),o.push(U3(n));return o.join("")}function M3(e){for(var t,r=e.length,n=r%3,o=[],i=16383,a=0,u=r-n;a<u;a+=i)o.push(F3(e,a,a+i>u?u:a+i));return n===1?(t=e[r-1],o.push(Ur[t>>2]+Ur[t<<4&63]+"==")):n===2&&(t=(e[r-2]<<8)+e[r-1],o.push(Ur[t>>10]+Ur[t>>4&63]+Ur[t<<2&63]+"=")),o.join("")}var Xc={byteLength:R3,toByteArray:C3,fromByteArray:x3};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var B3=function(t,r,n,o,i){var a,u,l=i*8-o-1,s=(1<<l)-1,c=s>>1,f=-7,d=n?i-1:0,v=n?-1:1,g=t[r+d];for(d+=v,a=g&(1<<-f)-1,g>>=-f,f+=l;f>0;a=a*256+t[r+d],d+=v,f-=8);for(u=a&(1<<-f)-1,a>>=-f,f+=o;f>0;u=u*256+t[r+d],d+=v,f-=8);if(a===0)a=1-c;else{if(a===s)return u?NaN:(g?-1:1)*(1/0);u=u+Math.pow(2,o),a=a-c}return(g?-1:1)*u*Math.pow(2,a-o)},j3=function(t,r,n,o,i,a){var u,l,s,c=a*8-i-1,f=(1<<c)-1,d=f>>1,v=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=o?0:a-1,b=o?1:-1,w=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(l=isNaN(r)?1:0,u=f):(u=Math.floor(Math.log(r)/Math.LN2),r*(s=Math.pow(2,-u))<1&&(u--,s*=2),u+d>=1?r+=v/s:r+=v*Math.pow(2,1-d),r*s>=2&&(u++,s/=2),u+d>=f?(l=0,u=f):u+d>=1?(l=(r*s-1)*Math.pow(2,i),u=u+d):(l=r*Math.pow(2,d-1)*Math.pow(2,i),u=0));i>=8;t[n+g]=l&255,g+=b,l/=256,i-=8);for(u=u<<i|l,c+=i;c>0;t[n+g]=u&255,g+=b,u/=256,c-=8);t[n+g-b]|=w*128},Oi={read:B3,write:j3},Ju=A3(function(e,t){var r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=_,t.INSPECT_MAX_BYTES=50;var n=2147483647;t.kMaxLength=n,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{var m=new Uint8Array(1),h={foo:function(){return 42}};return Object.setPrototypeOf(h,Uint8Array.prototype),Object.setPrototypeOf(m,h),m.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function i(m){if(m>n)throw new RangeError('The value "'+m+'" is invalid for option "size"');var h=new Uint8Array(m);return Object.setPrototypeOf(h,a.prototype),h}function a(m,h,p){if(typeof m=="number"){if(typeof h=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return c(m)}return u(m,h,p)}a.poolSize=8192;function u(m,h,p){if(typeof m=="string")return f(m,h);if(ArrayBuffer.isView(m))return v(m);if(m==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(m));if(S(m,ArrayBuffer)||m&&S(m.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(S(m,SharedArrayBuffer)||m&&S(m.buffer,SharedArrayBuffer)))return g(m,h,p);if(typeof m=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var y=m.valueOf&&m.valueOf();if(y!=null&&y!==m)return a.from(y,h,p);var O=b(m);if(O)return O;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof m[Symbol.toPrimitive]=="function")return a.from(m[Symbol.toPrimitive]("string"),h,p);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(m))}a.from=function(m,h,p){return u(m,h,p)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(m){if(typeof m!="number")throw new TypeError('"size" argument must be of type number');if(m<0)throw new RangeError('The value "'+m+'" is invalid for option "size"')}function s(m,h,p){return l(m),m<=0?i(m):h!==void 0?typeof p=="string"?i(m).fill(h,p):i(m).fill(h):i(m)}a.alloc=function(m,h,p){return s(m,h,p)};function c(m){return l(m),i(m<0?0:w(m)|0)}a.allocUnsafe=function(m){return c(m)},a.allocUnsafeSlow=function(m){return c(m)};function f(m,h){if((typeof h!="string"||h==="")&&(h="utf8"),!a.isEncoding(h))throw new TypeError("Unknown encoding: "+h);var p=E(m,h)|0,y=i(p),O=y.write(m,h);return O!==p&&(y=y.slice(0,O)),y}function d(m){for(var h=m.length<0?0:w(m.length)|0,p=i(h),y=0;y<h;y+=1)p[y]=m[y]&255;return p}function v(m){if(S(m,Uint8Array)){var h=new Uint8Array(m);return g(h.buffer,h.byteOffset,h.byteLength)}return d(m)}function g(m,h,p){if(h<0||m.byteLength<h)throw new RangeError('"offset" is outside of buffer bounds');if(m.byteLength<h+(p||0))throw new RangeError('"length" is outside of buffer bounds');var y;return h===void 0&&p===void 0?y=new Uint8Array(m):p===void 0?y=new Uint8Array(m,h):y=new Uint8Array(m,h,p),Object.setPrototypeOf(y,a.prototype),y}function b(m){if(a.isBuffer(m)){var h=w(m.length)|0,p=i(h);return p.length===0||m.copy(p,0,0,h),p}if(m.length!==void 0)return typeof m.length!="number"||T(m.length)?i(0):d(m);if(m.type==="Buffer"&&Array.isArray(m.data))return d(m.data)}function w(m){if(m>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return m|0}function _(m){return+m!=m&&(m=0),a.alloc(+m)}a.isBuffer=function(h){return h!=null&&h._isBuffer===!0&&h!==a.prototype},a.compare=function(h,p){if(S(h,Uint8Array)&&(h=a.from(h,h.offset,h.byteLength)),S(p,Uint8Array)&&(p=a.from(p,p.offset,p.byteLength)),!a.isBuffer(h)||!a.isBuffer(p))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(h===p)return 0;for(var y=h.length,O=p.length,x=0,C=Math.min(y,O);x<C;++x)if(h[x]!==p[x]){y=h[x],O=p[x];break}return y<O?-1:O<y?1:0},a.isEncoding=function(h){switch(String(h).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(h,p){if(!Array.isArray(h))throw new TypeError('"list" argument must be an Array of Buffers');if(h.length===0)return a.alloc(0);var y;if(p===void 0)for(p=0,y=0;y<h.length;++y)p+=h[y].length;var O=a.allocUnsafe(p),x=0;for(y=0;y<h.length;++y){var C=h[y];if(S(C,Uint8Array))x+C.length>O.length?a.from(C).copy(O,x):Uint8Array.prototype.set.call(O,C,x);else if(a.isBuffer(C))C.copy(O,x);else throw new TypeError('"list" argument must be an Array of Buffers');x+=C.length}return O};function E(m,h){if(a.isBuffer(m))return m.length;if(ArrayBuffer.isView(m)||S(m,ArrayBuffer))return m.byteLength;if(typeof m!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+babelHelpers.typeof(m));var p=m.length,y=arguments.length>2&&arguments[2]===!0;if(!y&&p===0)return 0;for(var O=!1;;)switch(h){case"ascii":case"latin1":case"binary":return p;case"utf8":case"utf-8":return U(m).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return p*2;case"hex":return p>>>1;case"base64":return Y(m).length;default:if(O)return y?-1:U(m).length;h=(""+h).toLowerCase(),O=!0}}a.byteLength=E;function A(m,h,p){var y=!1;if((h===void 0||h<0)&&(h=0),h>this.length||((p===void 0||p>this.length)&&(p=this.length),p<=0)||(p>>>=0,h>>>=0,p<=h))return"";for(m||(m="utf8");;)switch(m){case"hex":return M(this,h,p);case"utf8":case"utf-8":return ce(this,h,p);case"ascii":return re(this,h,p);case"latin1":case"binary":return X(this,h,p);case"base64":return Q(this,h,p);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W(this,h,p);default:if(y)throw new TypeError("Unknown encoding: "+m);m=(m+"").toLowerCase(),y=!0}}a.prototype._isBuffer=!0;function I(m,h,p){var y=m[h];m[h]=m[p],m[p]=y}a.prototype.swap16=function(){var h=this.length;if(h%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var p=0;p<h;p+=2)I(this,p,p+1);return this},a.prototype.swap32=function(){var h=this.length;if(h%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var p=0;p<h;p+=4)I(this,p,p+3),I(this,p+1,p+2);return this},a.prototype.swap64=function(){var h=this.length;if(h%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var p=0;p<h;p+=8)I(this,p,p+7),I(this,p+1,p+6),I(this,p+2,p+5),I(this,p+3,p+4);return this},a.prototype.toString=function(){var h=this.length;return h===0?"":arguments.length===0?ce(this,0,h):A.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(h){if(!a.isBuffer(h))throw new TypeError("Argument must be a Buffer");return this===h?!0:a.compare(this,h)===0},a.prototype.inspect=function(){var h="",p=t.INSPECT_MAX_BYTES;return h=this.toString("hex",0,p).replace(/(.{2})/g,"$1 ").trim(),this.length>p&&(h+=" ... "),"<Buffer "+h+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(h,p,y,O,x){if(S(h,Uint8Array)&&(h=a.from(h,h.offset,h.byteLength)),!a.isBuffer(h))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+babelHelpers.typeof(h));if(p===void 0&&(p=0),y===void 0&&(y=h?h.length:0),O===void 0&&(O=0),x===void 0&&(x=this.length),p<0||y>h.length||O<0||x>this.length)throw new RangeError("out of range index");if(O>=x&&p>=y)return 0;if(O>=x)return-1;if(p>=y)return 1;if(p>>>=0,y>>>=0,O>>>=0,x>>>=0,this===h)return 0;for(var C=x-O,V=y-p,q=Math.min(C,V),J=this.slice(O,x),ie=h.slice(p,y),se=0;se<q;++se)if(J[se]!==ie[se]){C=J[se],V=ie[se];break}return C<V?-1:V<C?1:0};function R(m,h,p,y,O){if(m.length===0)return-1;if(typeof p=="string"?(y=p,p=0):p>2147483647?p=2147483647:p<-2147483648&&(p=-2147483648),p=+p,T(p)&&(p=O?0:m.length-1),p<0&&(p=m.length+p),p>=m.length){if(O)return-1;p=m.length-1}else if(p<0)if(O)p=0;else return-1;if(typeof h=="string"&&(h=a.from(h,y)),a.isBuffer(h))return h.length===0?-1:$(m,h,p,y,O);if(typeof h=="number")return h=h&255,typeof Uint8Array.prototype.indexOf=="function"?O?Uint8Array.prototype.indexOf.call(m,h,p):Uint8Array.prototype.lastIndexOf.call(m,h,p):$(m,[h],p,y,O);throw new TypeError("val must be string, number or Buffer")}function $(m,h,p,y,O){var x=1,C=m.length,V=h.length;if(y!==void 0&&(y=String(y).toLowerCase(),y==="ucs2"||y==="ucs-2"||y==="utf16le"||y==="utf-16le")){if(m.length<2||h.length<2)return-1;x=2,C/=2,V/=2,p/=2}function q(Ae,ot){return x===1?Ae[ot]:Ae.readUInt16BE(ot*x)}var J;if(O){var ie=-1;for(J=p;J<C;J++)if(q(m,J)===q(h,ie===-1?0:J-ie)){if(ie===-1&&(ie=J),J-ie+1===V)return ie*x}else ie!==-1&&(J-=J-ie),ie=-1}else for(p+V>C&&(p=C-V),J=p;J>=0;J--){for(var se=!0,Ce=0;Ce<V;Ce++)if(q(m,J+Ce)!==q(h,Ce)){se=!1;break}if(se)return J}return-1}a.prototype.includes=function(h,p,y){return this.indexOf(h,p,y)!==-1},a.prototype.indexOf=function(h,p,y){return R(this,h,p,y,!0)},a.prototype.lastIndexOf=function(h,p,y){return R(this,h,p,y,!1)};function L(m,h,p,y){p=Number(p)||0;var O=m.length-p;y?(y=Number(y),y>O&&(y=O)):y=O;var x=h.length;y>x/2&&(y=x/2);for(var C=0;C<y;++C){var V=parseInt(h.substr(C*2,2),16);if(T(V))return C;m[p+C]=V}return C}function D(m,h,p,y){return ge(U(h,m.length-p),m,p,y)}function P(m,h,p,y){return ge(K(h),m,p,y)}function k(m,h,p,y){return ge(Y(h),m,p,y)}function F(m,h,p,y){return ge(G(h,m.length-p),m,p,y)}a.prototype.write=function(h,p,y,O){if(p===void 0)O="utf8",y=this.length,p=0;else if(y===void 0&&typeof p=="string")O=p,y=this.length,p=0;else if(isFinite(p))p=p>>>0,isFinite(y)?(y=y>>>0,O===void 0&&(O="utf8")):(O=y,y=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var x=this.length-p;if((y===void 0||y>x)&&(y=x),h.length>0&&(y<0||p<0)||p>this.length)throw new RangeError("Attempt to write outside buffer bounds");O||(O="utf8");for(var C=!1;;)switch(O){case"hex":return L(this,h,p,y);case"utf8":case"utf-8":return D(this,h,p,y);case"ascii":case"latin1":case"binary":return P(this,h,p,y);case"base64":return k(this,h,p,y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,h,p,y);default:if(C)throw new TypeError("Unknown encoding: "+O);O=(""+O).toLowerCase(),C=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Q(m,h,p){return h===0&&p===m.length?Xc.fromByteArray(m):Xc.fromByteArray(m.slice(h,p))}function ce(m,h,p){p=Math.min(m.length,p);for(var y=[],O=h;O<p;){var x=m[O],C=null,V=x>239?4:x>223?3:x>191?2:1;if(O+V<=p){var q,J,ie,se;switch(V){case 1:x<128&&(C=x);break;case 2:q=m[O+1],(q&192)===128&&(se=(x&31)<<6|q&63,se>127&&(C=se));break;case 3:q=m[O+1],J=m[O+2],(q&192)===128&&(J&192)===128&&(se=(x&15)<<12|(q&63)<<6|J&63,se>2047&&(se<55296||se>57343)&&(C=se));break;case 4:q=m[O+1],J=m[O+2],ie=m[O+3],(q&192)===128&&(J&192)===128&&(ie&192)===128&&(se=(x&15)<<18|(q&63)<<12|(J&63)<<6|ie&63,se>65535&&se<1114112&&(C=se))}}C===null?(C=65533,V=1):C>65535&&(C-=65536,y.push(C>>>10&1023|55296),C=56320|C&1023),y.push(C),O+=V}return fe(y)}var B=4096;function fe(m){var h=m.length;if(h<=B)return String.fromCharCode.apply(String,m);for(var p="",y=0;y<h;)p+=String.fromCharCode.apply(String,m.slice(y,y+=B));return p}function re(m,h,p){var y="";p=Math.min(m.length,p);for(var O=h;O<p;++O)y+=String.fromCharCode(m[O]&127);return y}function X(m,h,p){var y="";p=Math.min(m.length,p);for(var O=h;O<p;++O)y+=String.fromCharCode(m[O]);return y}function M(m,h,p){var y=m.length;(!h||h<0)&&(h=0),(!p||p<0||p>y)&&(p=y);for(var O="",x=h;x<p;++x)O+=N[m[x]];return O}function W(m,h,p){for(var y=m.slice(h,p),O="",x=0;x<y.length-1;x+=2)O+=String.fromCharCode(y[x]+y[x+1]*256);return O}a.prototype.slice=function(h,p){var y=this.length;h=~~h,p=p===void 0?y:~~p,h<0?(h+=y,h<0&&(h=0)):h>y&&(h=y),p<0?(p+=y,p<0&&(p=0)):p>y&&(p=y),p<h&&(p=h);var O=this.subarray(h,p);return Object.setPrototypeOf(O,a.prototype),O};function te(m,h,p){if(m%1!==0||m<0)throw new RangeError("offset is not uint");if(m+h>p)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(h,p,y){h=h>>>0,p=p>>>0,y||te(h,p,this.length);for(var O=this[h],x=1,C=0;++C<p&&(x*=256);)O+=this[h+C]*x;return O},a.prototype.readUintBE=a.prototype.readUIntBE=function(h,p,y){h=h>>>0,p=p>>>0,y||te(h,p,this.length);for(var O=this[h+--p],x=1;p>0&&(x*=256);)O+=this[h+--p]*x;return O},a.prototype.readUint8=a.prototype.readUInt8=function(h,p){return h=h>>>0,p||te(h,1,this.length),this[h]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(h,p){return h=h>>>0,p||te(h,2,this.length),this[h]|this[h+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(h,p){return h=h>>>0,p||te(h,2,this.length),this[h]<<8|this[h+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(h,p){return h=h>>>0,p||te(h,4,this.length),(this[h]|this[h+1]<<8|this[h+2]<<16)+this[h+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(h,p){return h=h>>>0,p||te(h,4,this.length),this[h]*16777216+(this[h+1]<<16|this[h+2]<<8|this[h+3])},a.prototype.readIntLE=function(h,p,y){h=h>>>0,p=p>>>0,y||te(h,p,this.length);for(var O=this[h],x=1,C=0;++C<p&&(x*=256);)O+=this[h+C]*x;return x*=128,O>=x&&(O-=Math.pow(2,8*p)),O},a.prototype.readIntBE=function(h,p,y){h=h>>>0,p=p>>>0,y||te(h,p,this.length);for(var O=p,x=1,C=this[h+--O];O>0&&(x*=256);)C+=this[h+--O]*x;return x*=128,C>=x&&(C-=Math.pow(2,8*p)),C},a.prototype.readInt8=function(h,p){return h=h>>>0,p||te(h,1,this.length),this[h]&128?(255-this[h]+1)*-1:this[h]},a.prototype.readInt16LE=function(h,p){h=h>>>0,p||te(h,2,this.length);var y=this[h]|this[h+1]<<8;return y&32768?y|4294901760:y},a.prototype.readInt16BE=function(h,p){h=h>>>0,p||te(h,2,this.length);var y=this[h+1]|this[h]<<8;return y&32768?y|4294901760:y},a.prototype.readInt32LE=function(h,p){return h=h>>>0,p||te(h,4,this.length),this[h]|this[h+1]<<8|this[h+2]<<16|this[h+3]<<24},a.prototype.readInt32BE=function(h,p){return h=h>>>0,p||te(h,4,this.length),this[h]<<24|this[h+1]<<16|this[h+2]<<8|this[h+3]},a.prototype.readFloatLE=function(h,p){return h=h>>>0,p||te(h,4,this.length),Oi.read(this,h,!0,23,4)},a.prototype.readFloatBE=function(h,p){return h=h>>>0,p||te(h,4,this.length),Oi.read(this,h,!1,23,4)},a.prototype.readDoubleLE=function(h,p){return h=h>>>0,p||te(h,8,this.length),Oi.read(this,h,!0,52,8)},a.prototype.readDoubleBE=function(h,p){return h=h>>>0,p||te(h,8,this.length),Oi.read(this,h,!1,52,8)};function ne(m,h,p,y,O,x){if(!a.isBuffer(m))throw new TypeError('"buffer" argument must be a Buffer instance');if(h>O||h<x)throw new RangeError('"value" argument is out of bounds');if(p+y>m.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(h,p,y,O){if(h=+h,p=p>>>0,y=y>>>0,!O){var x=Math.pow(2,8*y)-1;ne(this,h,p,y,x,0)}var C=1,V=0;for(this[p]=h&255;++V<y&&(C*=256);)this[p+V]=h/C&255;return p+y},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(h,p,y,O){if(h=+h,p=p>>>0,y=y>>>0,!O){var x=Math.pow(2,8*y)-1;ne(this,h,p,y,x,0)}var C=y-1,V=1;for(this[p+C]=h&255;--C>=0&&(V*=256);)this[p+C]=h/V&255;return p+y},a.prototype.writeUint8=a.prototype.writeUInt8=function(h,p,y){return h=+h,p=p>>>0,y||ne(this,h,p,1,255,0),this[p]=h&255,p+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(h,p,y){return h=+h,p=p>>>0,y||ne(this,h,p,2,65535,0),this[p]=h&255,this[p+1]=h>>>8,p+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(h,p,y){return h=+h,p=p>>>0,y||ne(this,h,p,2,65535,0),this[p]=h>>>8,this[p+1]=h&255,p+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(h,p,y){return h=+h,p=p>>>0,y||ne(this,h,p,4,4294967295,0),this[p+3]=h>>>24,this[p+2]=h>>>16,this[p+1]=h>>>8,this[p]=h&255,p+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(h,p,y){return h=+h,p=p>>>0,y||ne(this,h,p,4,4294967295,0),this[p]=h>>>24,this[p+1]=h>>>16,this[p+2]=h>>>8,this[p+3]=h&255,p+4},a.prototype.writeIntLE=function(h,p,y,O){if(h=+h,p=p>>>0,!O){var x=Math.pow(2,8*y-1);ne(this,h,p,y,x-1,-x)}var C=0,V=1,q=0;for(this[p]=h&255;++C<y&&(V*=256);)h<0&&q===0&&this[p+C-1]!==0&&(q=1),this[p+C]=(h/V>>0)-q&255;return p+y},a.prototype.writeIntBE=function(h,p,y,O){if(h=+h,p=p>>>0,!O){var x=Math.pow(2,8*y-1);ne(this,h,p,y,x-1,-x)}var C=y-1,V=1,q=0;for(this[p+C]=h&255;--C>=0&&(V*=256);)h<0&&q===0&&this[p+C+1]!==0&&(q=1),this[p+C]=(h/V>>0)-q&255;return p+y},a.prototype.writeInt8=function(h,p,y){return h=+h,p=p>>>0,y||ne(this,h,p,1,127,-128),h<0&&(h=255+h+1),this[p]=h&255,p+1},a.prototype.writeInt16LE=function(h,p,y){return h=+h,p=p>>>0,y||ne(this,h,p,2,32767,-32768),this[p]=h&255,this[p+1]=h>>>8,p+2},a.prototype.writeInt16BE=function(h,p,y){return h=+h,p=p>>>0,y||ne(this,h,p,2,32767,-32768),this[p]=h>>>8,this[p+1]=h&255,p+2},a.prototype.writeInt32LE=function(h,p,y){return h=+h,p=p>>>0,y||ne(this,h,p,4,2147483647,-2147483648),this[p]=h&255,this[p+1]=h>>>8,this[p+2]=h>>>16,this[p+3]=h>>>24,p+4},a.prototype.writeInt32BE=function(h,p,y){return h=+h,p=p>>>0,y||ne(this,h,p,4,2147483647,-2147483648),h<0&&(h=4294967295+h+1),this[p]=h>>>24,this[p+1]=h>>>16,this[p+2]=h>>>8,this[p+3]=h&255,p+4};function be(m,h,p,y,O,x){if(p+y>m.length)throw new RangeError("Index out of range");if(p<0)throw new RangeError("Index out of range")}function et(m,h,p,y,O){return h=+h,p=p>>>0,O||be(m,h,p,4),Oi.write(m,h,p,y,23,4),p+4}a.prototype.writeFloatLE=function(h,p,y){return et(this,h,p,!0,y)},a.prototype.writeFloatBE=function(h,p,y){return et(this,h,p,!1,y)};function Rt(m,h,p,y,O){return h=+h,p=p>>>0,O||be(m,h,p,8),Oi.write(m,h,p,y,52,8),p+8}a.prototype.writeDoubleLE=function(h,p,y){return Rt(this,h,p,!0,y)},a.prototype.writeDoubleBE=function(h,p,y){return Rt(this,h,p,!1,y)},a.prototype.copy=function(h,p,y,O){if(!a.isBuffer(h))throw new TypeError("argument should be a Buffer");if(y||(y=0),!O&&O!==0&&(O=this.length),p>=h.length&&(p=h.length),p||(p=0),O>0&&O<y&&(O=y),O===y||h.length===0||this.length===0)return 0;if(p<0)throw new RangeError("targetStart out of bounds");if(y<0||y>=this.length)throw new RangeError("Index out of range");if(O<0)throw new RangeError("sourceEnd out of bounds");O>this.length&&(O=this.length),h.length-p<O-y&&(O=h.length-p+y);var x=O-y;return this===h&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(p,y,O):Uint8Array.prototype.set.call(h,this.subarray(y,O),p),x},a.prototype.fill=function(h,p,y,O){if(typeof h=="string"){if(typeof p=="string"?(O=p,p=0,y=this.length):typeof y=="string"&&(O=y,y=this.length),O!==void 0&&typeof O!="string")throw new TypeError("encoding must be a string");if(typeof O=="string"&&!a.isEncoding(O))throw new TypeError("Unknown encoding: "+O);if(h.length===1){var x=h.charCodeAt(0);(O==="utf8"&&x<128||O==="latin1")&&(h=x)}}else typeof h=="number"?h=h&255:typeof h=="boolean"&&(h=Number(h));if(p<0||this.length<p||this.length<y)throw new RangeError("Out of range index");if(y<=p)return this;p=p>>>0,y=y===void 0?this.length:y>>>0,h||(h=0);var C;if(typeof h=="number")for(C=p;C<y;++C)this[C]=h;else{var V=a.isBuffer(h)?h:a.from(h,O),q=V.length;if(q===0)throw new TypeError('The value "'+h+'" is invalid for argument "value"');for(C=0;C<y-p;++C)this[C+p]=V[C%q]}return this};var Qe=/[^+/0-9A-Za-z-_]/g;function de(m){if(m=m.split("=")[0],m=m.trim().replace(Qe,""),m.length<2)return"";for(;m.length%4!==0;)m=m+"=";return m}function U(m,h){h=h||1/0;for(var p,y=m.length,O=null,x=[],C=0;C<y;++C){if(p=m.charCodeAt(C),p>55295&&p<57344){if(!O){if(p>56319){(h-=3)>-1&&x.push(239,191,189);continue}else if(C+1===y){(h-=3)>-1&&x.push(239,191,189);continue}O=p;continue}if(p<56320){(h-=3)>-1&&x.push(239,191,189),O=p;continue}p=(O-55296<<10|p-56320)+65536}else O&&(h-=3)>-1&&x.push(239,191,189);if(O=null,p<128){if((h-=1)<0)break;x.push(p)}else if(p<2048){if((h-=2)<0)break;x.push(p>>6|192,p&63|128)}else if(p<65536){if((h-=3)<0)break;x.push(p>>12|224,p>>6&63|128,p&63|128)}else if(p<1114112){if((h-=4)<0)break;x.push(p>>18|240,p>>12&63|128,p>>6&63|128,p&63|128)}else throw new Error("Invalid code point")}return x}function K(m){for(var h=[],p=0;p<m.length;++p)h.push(m.charCodeAt(p)&255);return h}function G(m,h){for(var p,y,O,x=[],C=0;C<m.length&&!((h-=2)<0);++C)p=m.charCodeAt(C),y=p>>8,O=p%256,x.push(O),x.push(y);return x}function Y(m){return Xc.toByteArray(de(m))}function ge(m,h,p,y){for(var O=0;O<y&&!(O+p>=h.length||O>=m.length);++O)h[O+p]=m[O];return O}function S(m,h){return m instanceof h||m!=null&&m.constructor!=null&&m.constructor.name!=null&&m.constructor.name===h.name}function T(m){return m!==m}var N=function(){for(var m="0123456789abcdef",h=new Array(256),p=0;p<16;++p)for(var y=p*16,O=0;O<16;++O)h[y+O]=m[p]+m[O];return h}()}),xe=Ju.Buffer;Ju.SlowBuffer;Ju.INSPECT_MAX_BYTES;Ju.kMaxLength;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Kl=function(t,r){return Kl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},Kl(t,r)};function Yu(e,t){Kl(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var ci=function(e){Yu(t,e);function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return Object.defineProperty(t.prototype,"name",{get:function(){return"BSONError"},enumerable:!1,configurable:!0}),t}(Error),Ge=function(e){Yu(t,e);function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return Object.defineProperty(t.prototype,"name",{get:function(){return"BSONTypeError"},enumerable:!1,configurable:!0}),t}(TypeError);function na(e){return e&&e.Math==Math&&e}function P_(){return na(typeof globalThis=="object"&&globalThis)||na(typeof window=="object"&&window)||na(typeof self=="object"&&self)||na(typeof global=="object"&&global)||Function("return this")()}function k3(){var e=P_();return typeof e.navigator=="object"&&e.navigator.product==="ReactNative"}var q3=function(t){var r=k3()?"BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.":"BSON: No cryptographic implementation for random bytes present, falling back to a less secure implementation.";console.warn(r);for(var n=xe.alloc(t),o=0;o<t;++o)n[o]=Math.floor(Math.random()*256);return n},W3=function(){{if(typeof window<"u"){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues)return function(t){return e.getRandomValues(xe.alloc(t))}}return typeof global<"u"&&global.crypto&&global.crypto.getRandomValues?function(t){return global.crypto.getRandomValues(xe.alloc(t))}:q3}},N_=W3();function H3(e){return["[object ArrayBuffer]","[object SharedArrayBuffer]"].includes(Object.prototype.toString.call(e))}function ld(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}function G3(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function V3(e){return Ls(e)&&Object.prototype.toString.call(e)==="[object Date]"}function Ls(e){return typeof e=="object"&&e!==null}function Qu(e,t){var r=!1;function n(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return r||(console.warn(t),r=!0),e.apply(this,o)}return n}function du(e){if(ArrayBuffer.isView(e))return xe.from(e.buffer,e.byteOffset,e.byteLength);if(H3(e))return xe.from(e);throw new Ge("Must use either Buffer or TypedArray")}var K3=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|[0-9a-f]{12}4[0-9a-f]{3}[89ab][0-9a-f]{15})$/i,$_=function(e){return typeof e=="string"&&K3.test(e)},zl=function(e){if(!$_(e))throw new Ge('UUID string representations must be a 32 or 36 character hex string (dashes excluded/included). Format: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" or "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".');var t=e.replace(/-/g,"");return xe.from(t,"hex")},Lv=function(e,t){return t===void 0&&(t=!0),t?e.toString("hex",0,4)+"-"+e.toString("hex",4,6)+"-"+e.toString("hex",6,8)+"-"+e.toString("hex",8,10)+"-"+e.toString("hex",10,16):e.toString("hex")},z3=Math.pow(2,53),J3=-Math.pow(2,53),D_=4,li=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);if(t!=null&&typeof t!="string"&&!ArrayBuffer.isView(t)&&!(t instanceof ArrayBuffer)&&!Array.isArray(t))throw new Ge("Binary can only be constructed from string, Buffer, TypedArray, or Array<number>");this.sub_type=r??e.BSON_BINARY_SUBTYPE_DEFAULT,t==null?(this.buffer=xe.alloc(e.BUFFER_SIZE),this.position=0):(typeof t=="string"?this.buffer=xe.from(t,"binary"):Array.isArray(t)?this.buffer=xe.from(t):this.buffer=du(t),this.position=this.buffer.byteLength)}return e.prototype.put=function(t){if(typeof t=="string"&&t.length!==1)throw new Ge("only accepts single character String");if(typeof t!="number"&&t.length!==1)throw new Ge("only accepts single character Uint8Array or Array");var r;if(typeof t=="string"?r=t.charCodeAt(0):typeof t=="number"?r=t:r=t[0],r<0||r>255)throw new Ge("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.length>this.position)this.buffer[this.position++]=r;else{var n=xe.alloc(e.BUFFER_SIZE+this.buffer.length);this.buffer.copy(n,0,0,this.buffer.length),this.buffer=n,this.buffer[this.position++]=r}},e.prototype.write=function(t,r){if(r=typeof r=="number"?r:this.position,this.buffer.length<r+t.length){var n=xe.alloc(this.buffer.length+t.length);this.buffer.copy(n,0,0,this.buffer.length),this.buffer=n}ArrayBuffer.isView(t)?(this.buffer.set(du(t),r),this.position=r+t.byteLength>this.position?r+t.length:this.position):typeof t=="string"&&(this.buffer.write(t,r,t.length,"binary"),this.position=r+t.length>this.position?r+t.length:this.position)},e.prototype.read=function(t,r){return r=r&&r>0?r:this.position,this.buffer.slice(t,t+r)},e.prototype.value=function(t){return t=!!t,t&&this.buffer.length===this.position?this.buffer:t?this.buffer.slice(0,this.position):this.buffer.toString("binary",0,this.position)},e.prototype.length=function(){return this.position},e.prototype.toJSON=function(){return this.buffer.toString("base64")},e.prototype.toString=function(t){return this.buffer.toString(t)},e.prototype.toExtendedJSON=function(t){t=t||{};var r=this.buffer.toString("base64"),n=Number(this.sub_type).toString(16);return t.legacy?{$binary:r,$type:n.length===1?"0"+n:n}:{$binary:{base64:r,subType:n.length===1?"0"+n:n}}},e.prototype.toUUID=function(){if(this.sub_type===e.SUBTYPE_UUID)return new Uv(this.buffer.slice(0,this.position));throw new ci('Binary sub_type "'.concat(this.sub_type,'" is not supported for converting to UUID. Only "').concat(e.SUBTYPE_UUID,'" is currently supported.'))},e.fromExtendedJSON=function(t,r){r=r||{};var n,o;if("$binary"in t?r.legacy&&typeof t.$binary=="string"&&"$type"in t?(o=t.$type?parseInt(t.$type,16):0,n=xe.from(t.$binary,"base64")):typeof t.$binary!="string"&&(o=t.$binary.subType?parseInt(t.$binary.subType,16):0,n=xe.from(t.$binary.base64,"base64")):"$uuid"in t&&(o=4,n=zl(t.$uuid)),!n)throw new Ge("Unexpected Binary Extended JSON format ".concat(JSON.stringify(t)));return o===D_?new Uv(n):new e(n,o)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.value(!0);return'new Binary(Buffer.from("'.concat(t.toString("hex"),'", "hex"), ').concat(this.sub_type,")")},e.BSON_BINARY_SUBTYPE_DEFAULT=0,e.BUFFER_SIZE=256,e.SUBTYPE_DEFAULT=0,e.SUBTYPE_FUNCTION=1,e.SUBTYPE_BYTE_ARRAY=2,e.SUBTYPE_UUID_OLD=3,e.SUBTYPE_UUID=4,e.SUBTYPE_MD5=5,e.SUBTYPE_ENCRYPTED=6,e.SUBTYPE_COLUMN=7,e.SUBTYPE_USER_DEFINED=128,e}();Object.defineProperty(li.prototype,"_bsontype",{value:"Binary"});var Zc=16,Uv=function(e){Yu(t,e);function t(r){var n=this,o,i;if(r==null)o=t.generate();else if(r instanceof t)o=xe.from(r.buffer),i=r.__id;else if(ArrayBuffer.isView(r)&&r.byteLength===Zc)o=du(r);else if(typeof r=="string")o=zl(r);else throw new Ge("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");return n=e.call(this,o,D_)||this,n.__id=i,n}return Object.defineProperty(t.prototype,"id",{get:function(){return this.buffer},set:function(r){this.buffer=r,t.cacheHexString&&(this.__id=Lv(r))},enumerable:!1,configurable:!0}),t.prototype.toHexString=function(r){if(r===void 0&&(r=!0),t.cacheHexString&&this.__id)return this.__id;var n=Lv(this.id,r);return t.cacheHexString&&(this.__id=n),n},t.prototype.toString=function(r){return r?this.id.toString(r):this.toHexString()},t.prototype.toJSON=function(){return this.toHexString()},t.prototype.equals=function(r){if(!r)return!1;if(r instanceof t)return r.id.equals(this.id);try{return new t(r).id.equals(this.id)}catch{return!1}},t.prototype.toBinary=function(){return new li(this.id,li.SUBTYPE_UUID)},t.generate=function(){var r=N_(Zc);return r[6]=r[6]&15|64,r[8]=r[8]&63|128,xe.from(r)},t.isValid=function(r){return r?r instanceof t?!0:typeof r=="string"?$_(r):ld(r)?r.length!==Zc?!1:(r[6]&240)===64&&(r[8]&128)===128:!1:!1},t.createFromHexString=function(r){var n=zl(r);return new t(n)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new UUID("'.concat(this.toHexString(),'")')},t}(li),Xu=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);this.code=t,this.scope=r}return e.prototype.toJSON=function(){return{code:this.code,scope:this.scope}},e.prototype.toExtendedJSON=function(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}},e.fromExtendedJSON=function(t){return new e(t.$code,t.$scope)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.toJSON();return'new Code("'.concat(String(t.code),'"').concat(t.scope?", ".concat(JSON.stringify(t.scope)):"",")")},e}();Object.defineProperty(Xu.prototype,"_bsontype",{value:"Code"});function Y3(e){return Ls(e)&&e.$id!=null&&typeof e.$ref=="string"&&(e.$db==null||typeof e.$db=="string")}var Os=function(){function e(t,r,n,o){if(!(this instanceof e))return new e(t,r,n,o);var i=t.split(".");i.length===2&&(n=i.shift(),t=i.shift()),this.collection=t,this.oid=r,this.db=n,this.fields=o||{}}return Object.defineProperty(e.prototype,"namespace",{get:function(){return this.collection},set:function(t){this.collection=t},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){var t=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return this.db!=null&&(t.$db=this.db),t},e.prototype.toExtendedJSON=function(t){t=t||{};var r={$ref:this.collection,$id:this.oid};return t.legacy||(this.db&&(r.$db=this.db),r=Object.assign(r,this.fields)),r},e.fromExtendedJSON=function(t){var r=Object.assign({},t);return delete r.$ref,delete r.$id,delete r.$db,new e(t.$ref,t.$id,t.$db,r)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.oid===void 0||this.oid.toString===void 0?this.oid:this.oid.toString();return'new DBRef("'.concat(this.namespace,'", new ObjectId("').concat(String(t),'")').concat(this.db?', "'.concat(this.db,'"'):"",")")},e}();Object.defineProperty(Os.prototype,"_bsontype",{value:"DBRef"});var Zt=void 0;try{Zt=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}var Fv=65536,Q3=1<<24,Li=Fv*Fv,L_=Li*Li,Mv=L_/2,Bv={},jv={},ae=function(){function e(t,r,n){if(t===void 0&&(t=0),!(this instanceof e))return new e(t,r,n);typeof t=="bigint"?Object.assign(this,e.fromBigInt(t,!!r)):typeof t=="string"?Object.assign(this,e.fromString(t,!!r)):(this.low=t|0,this.high=r|0,this.unsigned=!!n),Object.defineProperty(this,"__isLong__",{value:!0,configurable:!1,writable:!1,enumerable:!1})}return e.fromBits=function(t,r,n){return new e(t,r,n)},e.fromInt=function(t,r){var n,o,i;return r?(t>>>=0,(i=0<=t&&t<256)&&(o=jv[t],o)?o:(n=e.fromBits(t,(t|0)<0?-1:0,!0),i&&(jv[t]=n),n)):(t|=0,(i=-128<=t&&t<128)&&(o=Bv[t],o)?o:(n=e.fromBits(t,t<0?-1:0,!1),i&&(Bv[t]=n),n))},e.fromNumber=function(t,r){if(isNaN(t))return r?e.UZERO:e.ZERO;if(r){if(t<0)return e.UZERO;if(t>=L_)return e.MAX_UNSIGNED_VALUE}else{if(t<=-Mv)return e.MIN_VALUE;if(t+1>=Mv)return e.MAX_VALUE}return t<0?e.fromNumber(-t,r).neg():e.fromBits(t%Li|0,t/Li|0,r)},e.fromBigInt=function(t,r){return e.fromString(t.toString(),r)},e.fromString=function(t,r,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return e.ZERO;if(typeof r=="number"?(n=r,r=!1):r=!!r,n=n||10,n<2||36<n)throw RangeError("radix");var o;if((o=t.indexOf("-"))>0)throw Error("interior hyphen");if(o===0)return e.fromString(t.substring(1),r,n).neg();for(var i=e.fromNumber(Math.pow(n,8)),a=e.ZERO,u=0;u<t.length;u+=8){var l=Math.min(8,t.length-u),s=parseInt(t.substring(u,u+l),n);if(l<8){var c=e.fromNumber(Math.pow(n,l));a=a.mul(c).add(e.fromNumber(s))}else a=a.mul(i),a=a.add(e.fromNumber(s))}return a.unsigned=r,a},e.fromBytes=function(t,r,n){return n?e.fromBytesLE(t,r):e.fromBytesBE(t,r)},e.fromBytesLE=function(t,r){return new e(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,r)},e.fromBytesBE=function(t,r){return new e(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],r)},e.isLong=function(t){return Ls(t)&&t.__isLong__===!0},e.fromValue=function(t,r){return typeof t=="number"?e.fromNumber(t,r):typeof t=="string"?e.fromString(t,r):e.fromBits(t.low,t.high,typeof r=="boolean"?r:t.unsigned)},e.prototype.add=function(t){e.isLong(t)||(t=e.fromValue(t));var r=this.high>>>16,n=this.high&65535,o=this.low>>>16,i=this.low&65535,a=t.high>>>16,u=t.high&65535,l=t.low>>>16,s=t.low&65535,c=0,f=0,d=0,v=0;return v+=i+s,d+=v>>>16,v&=65535,d+=o+l,f+=d>>>16,d&=65535,f+=n+u,c+=f>>>16,f&=65535,c+=r+a,c&=65535,e.fromBits(d<<16|v,c<<16|f,this.unsigned)},e.prototype.and=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low&t.low,this.high&t.high,this.unsigned)},e.prototype.compare=function(t){if(e.isLong(t)||(t=e.fromValue(t)),this.eq(t))return 0;var r=this.isNegative(),n=t.isNegative();return r&&!n?-1:!r&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},e.prototype.comp=function(t){return this.compare(t)},e.prototype.divide=function(t){if(e.isLong(t)||(t=e.fromValue(t)),t.isZero())throw Error("division by zero");if(Zt){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var r=(this.unsigned?Zt.div_u:Zt.div_s)(this.low,this.high,t.low,t.high);return e.fromBits(r,Zt.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?e.UZERO:e.ZERO;var n,o,i;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return e.UZERO;if(t.gt(this.shru(1)))return e.UONE;i=e.UZERO}else{if(this.eq(e.MIN_VALUE)){if(t.eq(e.ONE)||t.eq(e.NEG_ONE))return e.MIN_VALUE;if(t.eq(e.MIN_VALUE))return e.ONE;var a=this.shr(1);return n=a.div(t).shl(1),n.eq(e.ZERO)?t.isNegative()?e.ONE:e.NEG_ONE:(o=this.sub(t.mul(n)),i=n.add(o.div(t)),i)}else if(t.eq(e.MIN_VALUE))return this.unsigned?e.UZERO:e.ZERO;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=e.ZERO}for(o=this;o.gte(t);){n=Math.max(1,Math.floor(o.toNumber()/t.toNumber()));for(var u=Math.ceil(Math.log(n)/Math.LN2),l=u<=48?1:Math.pow(2,u-48),s=e.fromNumber(n),c=s.mul(t);c.isNegative()||c.gt(o);)n-=l,s=e.fromNumber(n,this.unsigned),c=s.mul(t);s.isZero()&&(s=e.ONE),i=i.add(s),o=o.sub(c)}return i},e.prototype.div=function(t){return this.divide(t)},e.prototype.equals=function(t){return e.isLong(t)||(t=e.fromValue(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low},e.prototype.eq=function(t){return this.equals(t)},e.prototype.getHighBits=function(){return this.high},e.prototype.getHighBitsUnsigned=function(){return this.high>>>0},e.prototype.getLowBits=function(){return this.low},e.prototype.getLowBitsUnsigned=function(){return this.low>>>0},e.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(e.MIN_VALUE)?64:this.neg().getNumBitsAbs();var t=this.high!==0?this.high:this.low,r;for(r=31;r>0&&!(t&1<<r);r--);return this.high!==0?r+33:r+1},e.prototype.greaterThan=function(t){return this.comp(t)>0},e.prototype.gt=function(t){return this.greaterThan(t)},e.prototype.greaterThanOrEqual=function(t){return this.comp(t)>=0},e.prototype.gte=function(t){return this.greaterThanOrEqual(t)},e.prototype.ge=function(t){return this.greaterThanOrEqual(t)},e.prototype.isEven=function(){return(this.low&1)===0},e.prototype.isNegative=function(){return!this.unsigned&&this.high<0},e.prototype.isOdd=function(){return(this.low&1)===1},e.prototype.isPositive=function(){return this.unsigned||this.high>=0},e.prototype.isZero=function(){return this.high===0&&this.low===0},e.prototype.lessThan=function(t){return this.comp(t)<0},e.prototype.lt=function(t){return this.lessThan(t)},e.prototype.lessThanOrEqual=function(t){return this.comp(t)<=0},e.prototype.lte=function(t){return this.lessThanOrEqual(t)},e.prototype.modulo=function(t){if(e.isLong(t)||(t=e.fromValue(t)),Zt){var r=(this.unsigned?Zt.rem_u:Zt.rem_s)(this.low,this.high,t.low,t.high);return e.fromBits(r,Zt.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))},e.prototype.mod=function(t){return this.modulo(t)},e.prototype.rem=function(t){return this.modulo(t)},e.prototype.multiply=function(t){if(this.isZero())return e.ZERO;if(e.isLong(t)||(t=e.fromValue(t)),Zt){var r=Zt.mul(this.low,this.high,t.low,t.high);return e.fromBits(r,Zt.get_high(),this.unsigned)}if(t.isZero())return e.ZERO;if(this.eq(e.MIN_VALUE))return t.isOdd()?e.MIN_VALUE:e.ZERO;if(t.eq(e.MIN_VALUE))return this.isOdd()?e.MIN_VALUE:e.ZERO;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(e.TWO_PWR_24)&&t.lt(e.TWO_PWR_24))return e.fromNumber(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,o=this.high&65535,i=this.low>>>16,a=this.low&65535,u=t.high>>>16,l=t.high&65535,s=t.low>>>16,c=t.low&65535,f=0,d=0,v=0,g=0;return g+=a*c,v+=g>>>16,g&=65535,v+=i*c,d+=v>>>16,v&=65535,v+=a*s,d+=v>>>16,v&=65535,d+=o*c,f+=d>>>16,d&=65535,d+=i*s,f+=d>>>16,d&=65535,d+=a*l,f+=d>>>16,d&=65535,f+=n*c+o*s+i*l+a*u,f&=65535,e.fromBits(v<<16|g,f<<16|d,this.unsigned)},e.prototype.mul=function(t){return this.multiply(t)},e.prototype.negate=function(){return!this.unsigned&&this.eq(e.MIN_VALUE)?e.MIN_VALUE:this.not().add(e.ONE)},e.prototype.neg=function(){return this.negate()},e.prototype.not=function(){return e.fromBits(~this.low,~this.high,this.unsigned)},e.prototype.notEquals=function(t){return!this.equals(t)},e.prototype.neq=function(t){return this.notEquals(t)},e.prototype.ne=function(t){return this.notEquals(t)},e.prototype.or=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low|t.low,this.high|t.high,this.unsigned)},e.prototype.shiftLeft=function(t){return e.isLong(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?e.fromBits(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):e.fromBits(0,this.low<<t-32,this.unsigned)},e.prototype.shl=function(t){return this.shiftLeft(t)},e.prototype.shiftRight=function(t){return e.isLong(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?e.fromBits(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):e.fromBits(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},e.prototype.shr=function(t){return this.shiftRight(t)},e.prototype.shiftRightUnsigned=function(t){if(e.isLong(t)&&(t=t.toInt()),t&=63,t===0)return this;var r=this.high;if(t<32){var n=this.low;return e.fromBits(n>>>t|r<<32-t,r>>>t,this.unsigned)}else return t===32?e.fromBits(r,0,this.unsigned):e.fromBits(r>>>t-32,0,this.unsigned)},e.prototype.shr_u=function(t){return this.shiftRightUnsigned(t)},e.prototype.shru=function(t){return this.shiftRightUnsigned(t)},e.prototype.subtract=function(t){return e.isLong(t)||(t=e.fromValue(t)),this.add(t.neg())},e.prototype.sub=function(t){return this.subtract(t)},e.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},e.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*Li+(this.low>>>0):this.high*Li+(this.low>>>0)},e.prototype.toBigInt=function(){return BigInt(this.toString())},e.prototype.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},e.prototype.toBytesLE=function(){var t=this.high,r=this.low;return[r&255,r>>>8&255,r>>>16&255,r>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]},e.prototype.toBytesBE=function(){var t=this.high,r=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,r>>>24,r>>>16&255,r>>>8&255,r&255]},e.prototype.toSigned=function(){return this.unsigned?e.fromBits(this.low,this.high,!1):this},e.prototype.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(e.MIN_VALUE)){var r=e.fromNumber(t),n=this.div(r),o=n.mul(r).sub(this);return n.toString(t)+o.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var i=e.fromNumber(Math.pow(t,6),this.unsigned),a=this,u="";;){var l=a.div(i),s=a.sub(l.mul(i)).toInt()>>>0,c=s.toString(t);if(a=l,a.isZero())return c+u;for(;c.length<6;)c="0"+c;u=""+c+u}},e.prototype.toUnsigned=function(){return this.unsigned?this:e.fromBits(this.low,this.high,!0)},e.prototype.xor=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low^t.low,this.high^t.high,this.unsigned)},e.prototype.eqz=function(){return this.isZero()},e.prototype.le=function(t){return this.lessThanOrEqual(t)},e.prototype.toExtendedJSON=function(t){return t&&t.relaxed?this.toNumber():{$numberLong:this.toString()}},e.fromExtendedJSON=function(t,r){var n=e.fromString(t.$numberLong);return r&&r.relaxed?n.toNumber():n},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new Long("'.concat(this.toString(),'"').concat(this.unsigned?", true":"",")")},e.TWO_PWR_24=e.fromInt(Q3),e.MAX_UNSIGNED_VALUE=e.fromBits(-1,-1,!0),e.ZERO=e.fromInt(0),e.UZERO=e.fromInt(0,!0),e.ONE=e.fromInt(1),e.UONE=e.fromInt(1,!0),e.NEG_ONE=e.fromInt(-1),e.MAX_VALUE=e.fromBits(-1,2147483647,!1),e.MIN_VALUE=e.fromBits(0,-2147483648,!1),e}();Object.defineProperty(ae.prototype,"__isLong__",{value:!0});Object.defineProperty(ae.prototype,"_bsontype",{value:"Long"});var X3=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,Z3=/^(\+|-)?(Infinity|inf)$/i,eU=/^(\+|-)?NaN$/i,Do=6111,el=-6176,kv=6176,tU=34,tl=[124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),qv=[248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),Wv=[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),rU=/^([-+])?(\d+)?$/,nU=31,Hv=16383,iU=30,oU=31;function Gv(e){return!isNaN(parseInt(e,10))}function sU(e){var t=ae.fromNumber(1e9),r=ae.fromNumber(0);if(!e.parts[0]&&!e.parts[1]&&!e.parts[2]&&!e.parts[3])return{quotient:e,rem:r};for(var n=0;n<=3;n++)r=r.shiftLeft(32),r=r.add(new ae(e.parts[n],0)),e.parts[n]=r.div(t).low,r=r.modulo(t);return{quotient:e,rem:r}}function aU(e,t){if(!e&&!t)return{high:ae.fromNumber(0),low:ae.fromNumber(0)};var r=e.shiftRightUnsigned(32),n=new ae(e.getLowBits(),0),o=t.shiftRightUnsigned(32),i=new ae(t.getLowBits(),0),a=r.multiply(o),u=r.multiply(i),l=n.multiply(o),s=n.multiply(i);return a=a.add(u.shiftRightUnsigned(32)),u=new ae(u.getLowBits(),0).add(l).add(s.shiftRightUnsigned(32)),a=a.add(u.shiftRightUnsigned(32)),s=u.shiftLeft(32).add(new ae(s.getLowBits(),0)),{high:a,low:s}}function uU(e,t){var r=e.high>>>0,n=t.high>>>0;if(r<n)return!0;if(r===n){var o=e.low>>>0,i=t.low>>>0;if(o<i)return!0}return!1}function Ti(e,t){throw new Ge('"'.concat(e,'" is not a valid Decimal128 string - ').concat(t))}var fd=function(){function e(t){if(!(this instanceof e))return new e(t);if(typeof t=="string")this.bytes=e.fromString(t).bytes;else if(ld(t)){if(t.byteLength!==16)throw new Ge("Decimal128 must take a Buffer of 16 bytes");this.bytes=t}else throw new Ge("Decimal128 must take a Buffer or string")}return e.fromString=function(t){var r=!1,n=!1,o=!1,i=0,a=0,u=0,l=0,s=0,c=[0],f=0,d=0,v=0,g=0,b=0,w=0,_=new ae(0,0),E=new ae(0,0),A=0,I=0;if(t.length>=7e3)throw new Ge(""+t+" not a valid Decimal128 string");var R=t.match(X3),$=t.match(Z3),L=t.match(eU);if(!R&&!$&&!L||t.length===0)throw new Ge(""+t+" not a valid Decimal128 string");if(R){var D=R[2],P=R[4],k=R[5],F=R[6];P&&F===void 0&&Ti(t,"missing exponent power"),P&&D===void 0&&Ti(t,"missing exponent base"),P===void 0&&(k||F)&&Ti(t,"missing e before exponent")}if((t[I]==="+"||t[I]==="-")&&(r=t[I++]==="-"),!Gv(t[I])&&t[I]!=="."){if(t[I]==="i"||t[I]==="I")return new e(xe.from(r?qv:Wv));if(t[I]==="N")return new e(xe.from(tl))}for(;Gv(t[I])||t[I]===".";){if(t[I]==="."){n&&Ti(t,"contains multiple periods"),n=!0,I=I+1;continue}f<34&&(t[I]!=="0"||o)&&(o||(s=a),o=!0,c[d++]=parseInt(t[I],10),f=f+1),o&&(u=u+1),n&&(l=l+1),a=a+1,I=I+1}if(n&&!a)throw new Ge(""+t+" not a valid Decimal128 string");if(t[I]==="e"||t[I]==="E"){var Q=t.substr(++I).match(rU);if(!Q||!Q[2])return new e(xe.from(tl));b=parseInt(Q[0],10),I=I+Q[0].length}if(t[I])return new e(xe.from(tl));if(v=0,!f)v=0,g=0,c[0]=0,u=1,f=1,i=0;else if(g=f-1,i=u,i!==1)for(;c[s+i-1]===0;)i=i-1;for(b<=l&&l-b>16384?b=el:b=b-l;b>Do;){if(g=g+1,g-v>tU){var ce=c.join("");if(ce.match(/^0+$/)){b=Do;break}Ti(t,"overflow")}b=b-1}for(;b<el||f<u;){if(g===0&&i<f){b=el,i=0;break}if(f<u?u=u-1:g=g-1,b<Do)b=b+1;else{var ce=c.join("");if(ce.match(/^0+$/)){b=Do;break}Ti(t,"overflow")}}if(g-v+1<i){var B=a;n&&(s=s+1,B=B+1),r&&(s=s+1,B=B+1);var fe=parseInt(t[s+g+1],10),re=0;if(fe>=5&&(re=1,fe===5)){for(re=c[g]%2===1?1:0,w=s+g+2;w<B;w++)if(parseInt(t[w],10)){re=1;break}}if(re){for(var X=g;X>=0;X--)if(++c[X]>9&&(c[X]=0,X===0))if(b<Do)b=b+1,c[X]=1;else return new e(xe.from(r?qv:Wv))}}if(_=ae.fromNumber(0),E=ae.fromNumber(0),i===0)_=ae.fromNumber(0),E=ae.fromNumber(0);else if(g-v<17){var X=v;for(E=ae.fromNumber(c[X++]),_=new ae(0,0);X<=g;X++)E=E.multiply(ae.fromNumber(10)),E=E.add(ae.fromNumber(c[X]))}else{var X=v;for(_=ae.fromNumber(c[X++]);X<=g-17;X++)_=_.multiply(ae.fromNumber(10)),_=_.add(ae.fromNumber(c[X]));for(E=ae.fromNumber(c[X++]);X<=g;X++)E=E.multiply(ae.fromNumber(10)),E=E.add(ae.fromNumber(c[X]))}var M=aU(_,ae.fromString("100000000000000000"));M.low=M.low.add(E),uU(M.low,E)&&(M.high=M.high.add(ae.fromNumber(1))),A=b+kv;var W={low:ae.fromNumber(0),high:ae.fromNumber(0)};M.high.shiftRightUnsigned(49).and(ae.fromNumber(1)).equals(ae.fromNumber(1))?(W.high=W.high.or(ae.fromNumber(3).shiftLeft(61)),W.high=W.high.or(ae.fromNumber(A).and(ae.fromNumber(16383).shiftLeft(47))),W.high=W.high.or(M.high.and(ae.fromNumber(0x7fffffffffff)))):(W.high=W.high.or(ae.fromNumber(A&16383).shiftLeft(49)),W.high=W.high.or(M.high.and(ae.fromNumber(562949953421311)))),W.low=M.low,r&&(W.high=W.high.or(ae.fromString("9223372036854775808")));var te=xe.alloc(16);return I=0,te[I++]=W.low.low&255,te[I++]=W.low.low>>8&255,te[I++]=W.low.low>>16&255,te[I++]=W.low.low>>24&255,te[I++]=W.low.high&255,te[I++]=W.low.high>>8&255,te[I++]=W.low.high>>16&255,te[I++]=W.low.high>>24&255,te[I++]=W.high.low&255,te[I++]=W.high.low>>8&255,te[I++]=W.high.low>>16&255,te[I++]=W.high.low>>24&255,te[I++]=W.high.high&255,te[I++]=W.high.high>>8&255,te[I++]=W.high.high>>16&255,te[I++]=W.high.high>>24&255,new e(te)},e.prototype.toString=function(){for(var t,r=0,n=new Array(36),o=0;o<n.length;o++)n[o]=0;var i=0,a=!1,u,l={parts:[0,0,0,0]},s,c,f=[];i=0;var d=this.bytes,v=d[i++]|d[i++]<<8|d[i++]<<16|d[i++]<<24,g=d[i++]|d[i++]<<8|d[i++]<<16|d[i++]<<24,b=d[i++]|d[i++]<<8|d[i++]<<16|d[i++]<<24,w=d[i++]|d[i++]<<8|d[i++]<<16|d[i++]<<24;i=0;var _={low:new ae(v,g),high:new ae(b,w)};_.high.lessThan(ae.ZERO)&&f.push("-");var E=w>>26&nU;if(E>>3===3){if(E===iU)return f.join("")+"Infinity";if(E===oU)return"NaN";t=w>>15&Hv,u=8+(w>>14&1)}else u=w>>14&7,t=w>>17&Hv;var A=t-kv;if(l.parts[0]=(w&16383)+((u&15)<<14),l.parts[1]=b,l.parts[2]=g,l.parts[3]=v,l.parts[0]===0&&l.parts[1]===0&&l.parts[2]===0&&l.parts[3]===0)a=!0;else for(c=3;c>=0;c--){var I=0,R=sU(l);if(l=R.quotient,I=R.rem.low,!!I)for(s=8;s>=0;s--)n[c*9+s]=I%10,I=Math.floor(I/10)}if(a)r=1,n[i]=0;else for(r=36;!n[i];)r=r-1,i=i+1;var $=r-1+A;if($>=34||$<=-7||A>0){if(r>34)return f.push("".concat(0)),A>0?f.push("E+".concat(A)):A<0&&f.push("E".concat(A)),f.join("");f.push("".concat(n[i++])),r=r-1,r&&f.push(".");for(var o=0;o<r;o++)f.push("".concat(n[i++]));f.push("E"),$>0?f.push("+".concat($)):f.push("".concat($))}else if(A>=0)for(var o=0;o<r;o++)f.push("".concat(n[i++]));else{var L=r+A;if(L>0)for(var o=0;o<L;o++)f.push("".concat(n[i++]));else f.push("0");for(f.push(".");L++<0;)f.push("0");for(var o=0;o<r-Math.max(L-1,0);o++)f.push("".concat(n[i++]))}return f.join("")},e.prototype.toJSON=function(){return{$numberDecimal:this.toString()}},e.prototype.toExtendedJSON=function(){return{$numberDecimal:this.toString()}},e.fromExtendedJSON=function(t){return e.fromString(t.$numberDecimal)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new Decimal128("'.concat(this.toString(),'")')},e}();Object.defineProperty(fd.prototype,"_bsontype",{value:"Decimal128"});var Zu=function(){function e(t){if(!(this instanceof e))return new e(t);t instanceof Number&&(t=t.valueOf()),this.value=+t}return e.prototype.valueOf=function(){return this.value},e.prototype.toJSON=function(){return this.value},e.prototype.toString=function(t){return this.value.toString(t)},e.prototype.toExtendedJSON=function(t){return t&&(t.legacy||t.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-".concat(this.value.toFixed(1))}:{$numberDouble:Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}},e.fromExtendedJSON=function(t,r){var n=parseFloat(t.$numberDouble);return r&&r.relaxed?n:new e(n)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.toExtendedJSON();return"new Double(".concat(t.$numberDouble,")")},e}();Object.defineProperty(Zu.prototype,"_bsontype",{value:"Double"});var ec=function(){function e(t){if(!(this instanceof e))return new e(t);t instanceof Number&&(t=t.valueOf()),this.value=+t|0}return e.prototype.valueOf=function(){return this.value},e.prototype.toString=function(t){return this.value.toString(t)},e.prototype.toJSON=function(){return this.value},e.prototype.toExtendedJSON=function(t){return t&&(t.relaxed||t.legacy)?this.value:{$numberInt:this.value.toString()}},e.fromExtendedJSON=function(t,r){return r&&r.relaxed?parseInt(t.$numberInt,10):new e(t.$numberInt)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new Int32(".concat(this.valueOf(),")")},e}();Object.defineProperty(ec.prototype,"_bsontype",{value:"Int32"});var dd=function(){function e(){if(!(this instanceof e))return new e}return e.prototype.toExtendedJSON=function(){return{$maxKey:1}},e.fromExtendedJSON=function(){return new e},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new MaxKey()"},e}();Object.defineProperty(dd.prototype,"_bsontype",{value:"MaxKey"});var hd=function(){function e(){if(!(this instanceof e))return new e}return e.prototype.toExtendedJSON=function(){return{$minKey:1}},e.fromExtendedJSON=function(){return new e},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new MinKey()"},e}();Object.defineProperty(hd.prototype,"_bsontype",{value:"MinKey"});var cU=new RegExp("^[0-9a-fA-F]{24}$"),Gn=null,Cr=Symbol("id"),ar=function(){function e(t){if(!(this instanceof e))return new e(t);var r;if(typeof t=="object"&&t&&"id"in t){if(typeof t.id!="string"&&!ArrayBuffer.isView(t.id))throw new Ge("Argument passed in must have an id that is of type string or Buffer");"toHexString"in t&&typeof t.toHexString=="function"?r=xe.from(t.toHexString(),"hex"):r=t.id}else r=t;if(r==null||typeof r=="number")this[Cr]=e.generate(typeof r=="number"?r:void 0);else if(ArrayBuffer.isView(r)&&r.byteLength===12)this[Cr]=r instanceof xe?r:du(r);else if(typeof r=="string")if(r.length===12){var n=xe.from(r);if(n.byteLength===12)this[Cr]=n;else throw new Ge("Argument passed in must be a string of 12 bytes")}else if(r.length===24&&cU.test(r))this[Cr]=xe.from(r,"hex");else throw new Ge("Argument passed in must be a string of 12 bytes or a string of 24 hex characters or an integer");else throw new Ge("Argument passed in does not match the accepted types");e.cacheHexString&&(this.__id=this.id.toString("hex"))}return Object.defineProperty(e.prototype,"id",{get:function(){return this[Cr]},set:function(t){this[Cr]=t,e.cacheHexString&&(this.__id=t.toString("hex"))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"generationTime",{get:function(){return this.id.readInt32BE(0)},set:function(t){this.id.writeUInt32BE(t,0)},enumerable:!1,configurable:!0}),e.prototype.toHexString=function(){if(e.cacheHexString&&this.__id)return this.__id;var t=this.id.toString("hex");return e.cacheHexString&&!this.__id&&(this.__id=t),t},e.getInc=function(){return e.index=(e.index+1)%16777215},e.generate=function(t){typeof t!="number"&&(t=Math.floor(Date.now()/1e3));var r=e.getInc(),n=xe.alloc(12);return n.writeUInt32BE(t,0),Gn===null&&(Gn=N_(5)),n[4]=Gn[0],n[5]=Gn[1],n[6]=Gn[2],n[7]=Gn[3],n[8]=Gn[4],n[11]=r&255,n[10]=r>>8&255,n[9]=r>>16&255,n},e.prototype.toString=function(t){return t?this.id.toString(t):this.toHexString()},e.prototype.toJSON=function(){return this.toHexString()},e.prototype.equals=function(t){if(t==null)return!1;if(t instanceof e)return this[Cr][11]===t[Cr][11]&&this[Cr].equals(t[Cr]);if(typeof t=="string"&&e.isValid(t)&&t.length===12&&ld(this.id))return t===xe.prototype.toString.call(this.id,"latin1");if(typeof t=="string"&&e.isValid(t)&&t.length===24)return t.toLowerCase()===this.toHexString();if(typeof t=="string"&&e.isValid(t)&&t.length===12)return xe.from(t).equals(this.id);if(typeof t=="object"&&"toHexString"in t&&typeof t.toHexString=="function"){var r=t.toHexString(),n=this.toHexString().toLowerCase();return typeof r=="string"&&r.toLowerCase()===n}return!1},e.prototype.getTimestamp=function(){var t=new Date,r=this.id.readUInt32BE(0);return t.setTime(Math.floor(r)*1e3),t},e.createPk=function(){return new e},e.createFromTime=function(t){var r=xe.from([0,0,0,0,0,0,0,0,0,0,0,0]);return r.writeUInt32BE(t,0),new e(r)},e.createFromHexString=function(t){if(typeof t>"u"||t!=null&&t.length!==24)throw new Ge("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");return new e(xe.from(t,"hex"))},e.isValid=function(t){if(t==null)return!1;try{return new e(t),!0}catch{return!1}},e.prototype.toExtendedJSON=function(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}},e.fromExtendedJSON=function(t){return new e(t.$oid)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new ObjectId("'.concat(this.toHexString(),'")')},e.index=Math.floor(Math.random()*16777215),e}();Object.defineProperty(ar.prototype,"generate",{value:Qu(function(e){return ar.generate(e)},"Please use the static `ObjectId.generate(time)` instead")});Object.defineProperty(ar.prototype,"getInc",{value:Qu(function(){return ar.getInc()},"Please use the static `ObjectId.getInc()` instead")});Object.defineProperty(ar.prototype,"get_inc",{value:Qu(function(){return ar.getInc()},"Please use the static `ObjectId.getInc()` instead")});Object.defineProperty(ar,"get_inc",{value:Qu(function(){return ar.getInc()},"Please use the static `ObjectId.getInc()` instead")});Object.defineProperty(ar.prototype,"_bsontype",{value:"ObjectID"});function lU(e){return e.split("").sort().join("")}var Ts=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);if(this.pattern=t,this.options=lU(r??""),this.pattern.indexOf("\0")!==-1)throw new ci("BSON Regex patterns cannot contain null bytes, found: ".concat(JSON.stringify(this.pattern)));if(this.options.indexOf("\0")!==-1)throw new ci("BSON Regex options cannot contain null bytes, found: ".concat(JSON.stringify(this.options)));for(var n=0;n<this.options.length;n++)if(!(this.options[n]==="i"||this.options[n]==="m"||this.options[n]==="x"||this.options[n]==="l"||this.options[n]==="s"||this.options[n]==="u"))throw new ci("The regular expression option [".concat(this.options[n],"] is not supported"))}return e.parseOptions=function(t){return t?t.split("").sort().join(""):""},e.prototype.toExtendedJSON=function(t){return t=t||{},t.legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}},e.fromExtendedJSON=function(t){if("$regex"in t)if(typeof t.$regex!="string"){if(t.$regex._bsontype==="BSONRegExp")return t}else return new e(t.$regex,e.parseOptions(t.$options));if("$regularExpression"in t)return new e(t.$regularExpression.pattern,e.parseOptions(t.$regularExpression.options));throw new Ge("Unexpected BSONRegExp EJSON object form: ".concat(JSON.stringify(t)))},e}();Object.defineProperty(Ts.prototype,"_bsontype",{value:"BSONRegExp"});var pd=function(){function e(t){if(!(this instanceof e))return new e(t);this.value=t}return e.prototype.valueOf=function(){return this.value},e.prototype.toString=function(){return this.value},e.prototype.inspect=function(){return'new BSONSymbol("'.concat(this.value,'")')},e.prototype.toJSON=function(){return this.value},e.prototype.toExtendedJSON=function(){return{$symbol:this.value}},e.fromExtendedJSON=function(t){return new e(t.$symbol)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e}();Object.defineProperty(pd.prototype,"_bsontype",{value:"Symbol"});var fU=ae,U_=function(e){Yu(t,e);function t(r,n){var o=this;return o instanceof t?(ae.isLong(r)?o=e.call(this,r.low,r.high,!0)||this:Ls(r)&&typeof r.t<"u"&&typeof r.i<"u"?o=e.call(this,r.i,r.t,!0)||this:o=e.call(this,r,n,!0)||this,Object.defineProperty(o,"_bsontype",{value:"Timestamp",writable:!1,configurable:!1,enumerable:!1}),o):new t(r,n)}return t.prototype.toJSON=function(){return{$timestamp:this.toString()}},t.fromInt=function(r){return new t(ae.fromInt(r,!0))},t.fromNumber=function(r){return new t(ae.fromNumber(r,!0))},t.fromBits=function(r,n){return new t(r,n)},t.fromString=function(r,n){return new t(ae.fromString(r,!0,n))},t.prototype.toExtendedJSON=function(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}},t.fromExtendedJSON=function(r){return new t(r.$timestamp)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new Timestamp({ t: ".concat(this.getHighBits(),", i: ").concat(this.getLowBits()," })")},t.MAX_VALUE=ae.MAX_UNSIGNED_VALUE,t}(fU);function dU(e){return Ls(e)&&Reflect.has(e,"_bsontype")&&typeof e._bsontype=="string"}var F_=2147483647,M_=-2147483648,B_=9223372036854776e3,j_=-9223372036854776e3,hU={$oid:ar,$binary:li,$uuid:li,$symbol:pd,$numberInt:ec,$numberDecimal:fd,$numberDouble:Zu,$numberLong:ae,$minKey:hd,$maxKey:dd,$regex:Ts,$regularExpression:Ts,$timestamp:U_};function k_(e,t){if(t===void 0&&(t={}),typeof e=="number"){if(t.relaxed||t.legacy)return e;if(Math.floor(e)===e){if(e>=M_&&e<=F_)return new ec(e);if(e>=j_&&e<=B_)return ae.fromNumber(e)}return new Zu(e)}if(e==null||typeof e!="object")return e;if(e.$undefined)return null;for(var r=Object.keys(e).filter(function(f){return f.startsWith("$")&&e[f]!=null}),n=0;n<r.length;n++){var o=hU[r[n]];if(o)return o.fromExtendedJSON(e,t)}if(e.$date!=null){var i=e.$date,a=new Date;return t.legacy?typeof i=="number"?a.setTime(i):typeof i=="string"&&a.setTime(Date.parse(i)):typeof i=="string"?a.setTime(Date.parse(i)):ae.isLong(i)?a.setTime(i.toNumber()):typeof i=="number"&&t.relaxed&&a.setTime(i),a}if(e.$code!=null){var u=Object.assign({},e);return e.$scope&&(u.$scope=k_(e.$scope)),Xu.fromExtendedJSON(e)}if(Y3(e)||e.$dbPointer){var l=e.$ref?e:e.$dbPointer;if(l instanceof Os)return l;var s=Object.keys(l).filter(function(f){return f.startsWith("$")}),c=!0;if(s.forEach(function(f){["$ref","$id","$db"].indexOf(f)===-1&&(c=!1)}),c)return Os.fromExtendedJSON(l)}return e}function pU(e,t){return e.map(function(r,n){t.seenObjects.push({propertyName:"index ".concat(n),obj:null});try{return Sn(r,t)}finally{t.seenObjects.pop()}})}function Vv(e){var t=e.toISOString();return e.getUTCMilliseconds()!==0?t:t.slice(0,-5)+"Z"}function Sn(e,t){if((typeof e=="object"||typeof e=="function")&&e!==null){var r=t.seenObjects.findIndex(function(_){return _.obj===e});if(r!==-1){var n=t.seenObjects.map(function(_){return _.propertyName}),o=n.slice(0,r).map(function(_){return"".concat(_," -> ")}).join(""),i=n[r],a=" -> "+n.slice(r+1,n.length-1).map(function(_){return"".concat(_," -> ")}).join(""),u=n[n.length-1],l=" ".repeat(o.length+i.length/2),s="-".repeat(a.length+(i.length+u.length)/2-1);throw new Ge(`Converting circular structure to EJSON:
`+"    ".concat(o).concat(i).concat(a).concat(u,`
`)+"    ".concat(l,"\\").concat(s,"/"))}t.seenObjects[t.seenObjects.length-1].obj=e}if(Array.isArray(e))return pU(e,t);if(e===void 0)return null;if(e instanceof Date||V3(e)){var c=e.getTime(),f=c>-1&&c<2534023188e5;return t.legacy?t.relaxed&&f?{$date:e.getTime()}:{$date:Vv(e)}:t.relaxed&&f?{$date:Vv(e)}:{$date:{$numberLong:e.getTime().toString()}}}if(typeof e=="number"&&(!t.relaxed||!isFinite(e))){if(Math.floor(e)===e){var d=e>=M_&&e<=F_,v=e>=j_&&e<=B_;if(d)return{$numberInt:e.toString()};if(v)return{$numberLong:e.toString()}}return{$numberDouble:e.toString()}}if(e instanceof RegExp||G3(e)){var g=e.flags;if(g===void 0){var b=e.toString().match(/[gimuy]*$/);b&&(g=b[0])}var w=new Ts(e.source,g);return w.toExtendedJSON(t)}return e!=null&&typeof e=="object"?mU(e,t):e}var vU={Binary:function(e){return new li(e.value(),e.sub_type)},Code:function(e){return new Xu(e.code,e.scope)},DBRef:function(e){return new Os(e.collection||e.namespace,e.oid,e.db,e.fields)},Decimal128:function(e){return new fd(e.bytes)},Double:function(e){return new Zu(e.value)},Int32:function(e){return new ec(e.value)},Long:function(e){return ae.fromBits(e.low!=null?e.low:e.low_,e.low!=null?e.high:e.high_,e.low!=null?e.unsigned:e.unsigned_)},MaxKey:function(){return new dd},MinKey:function(){return new hd},ObjectID:function(e){return new ar(e)},ObjectId:function(e){return new ar(e)},BSONRegExp:function(e){return new Ts(e.pattern,e.options)},Symbol:function(e){return new pd(e.value)},Timestamp:function(e){return U_.fromBits(e.low,e.high)}};function mU(e,t){if(e==null||typeof e!="object")throw new ci("not an object instance");var r=e._bsontype;if(typeof r>"u"){var n={};for(var o in e){t.seenObjects.push({propertyName:o,obj:null});try{var i=Sn(e[o],t);o==="__proto__"?Object.defineProperty(n,o,{value:i,writable:!0,enumerable:!0,configurable:!0}):n[o]=i}finally{t.seenObjects.pop()}}return n}else if(dU(e)){var a=e;if(typeof a.toExtendedJSON!="function"){var u=vU[e._bsontype];if(!u)throw new Ge("Unrecognized or invalid _bsontype: "+e._bsontype);a=u(a)}return r==="Code"&&a.scope?a=new Xu(a.code,Sn(a.scope,t)):r==="DBRef"&&a.oid&&(a=new Os(Sn(a.collection,t),Sn(a.oid,t),Sn(a.db,t),Sn(a.fields,t))),a.toExtendedJSON(t)}else throw new ci("_bsontype must be a string, but was: "+typeof r)}var Gt;(function(e){function t(i,a){var u=Object.assign({},{relaxed:!0,legacy:!1},a);return typeof u.relaxed=="boolean"&&(u.strict=!u.relaxed),typeof u.strict=="boolean"&&(u.relaxed=!u.strict),JSON.parse(i,function(l,s){if(l.indexOf("\0")!==-1)throw new ci("BSON Document field names cannot contain null bytes, found: ".concat(JSON.stringify(l)));return k_(s,u)})}e.parse=t;function r(i,a,u,l){u!=null&&typeof u=="object"&&(l=u,u=0),a!=null&&typeof a=="object"&&!Array.isArray(a)&&(l=a,a=void 0,u=0);var s=Object.assign({relaxed:!0,legacy:!1},l,{seenObjects:[{propertyName:"(root)",obj:null}]}),c=Sn(i,s);return JSON.stringify(c,a,u)}e.stringify=r;function n(i,a){return a=a||{},JSON.parse(r(i,a))}e.serialize=n;function o(i,a){return a=a||{},t(JSON.stringify(i),a)}e.deserialize=o})(Gt||(Gt={}));var Kv=P_();Kv.Map?Kv.Map:function(){function e(t){t===void 0&&(t=[]),this._keys=[],this._values={};for(var r=0;r<t.length;r++)if(t[r]!=null){var n=t[r],o=n[0],i=n[1];this._keys.push(o),this._values[o]={v:i,i:this._keys.length-1}}}return e.prototype.clear=function(){this._keys=[],this._values={}},e.prototype.delete=function(t){var r=this._values[t];return r==null?!1:(delete this._values[t],this._keys.splice(r.i,1),!0)},e.prototype.entries=function(){var t=this,r=0;return{next:function(){var n=t._keys[r++];return{value:n!==void 0?[n,t._values[n].v]:void 0,done:n===void 0}}}},e.prototype.forEach=function(t,r){r=r||this;for(var n=0;n<this._keys.length;n++){var o=this._keys[n];t.call(r,this._values[o].v,o,r)}},e.prototype.get=function(t){return this._values[t]?this._values[t].v:void 0},e.prototype.has=function(t){return this._values[t]!=null},e.prototype.keys=function(){var t=this,r=0;return{next:function(){var n=t._keys[r++];return{value:n!==void 0?n:void 0,done:n===void 0}}}},e.prototype.set=function(t,r){return this._values[t]?(this._values[t].v=r,this):(this._keys.push(t),this._values[t]={v:r,i:this._keys.length-1},this)},e.prototype.values=function(){var t=this,r=0;return{next:function(){var n=t._keys[r++];return{value:n!==void 0?t._values[n].v:void 0,done:n===void 0}}}},Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!1,configurable:!0}),e}();ae.fromNumber(z3);ae.fromNumber(J3);var rl=new Uint8Array(8);new DataView(rl.buffer,rl.byteOffset,rl.byteLength);var gU=1024*1024*17;xe.alloc(gU);var yU=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},_U=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},q_=function(){function e(t,r){this._stages=[],t&&r&&(this._db=t,this._request=new Et.reqClass(this._db.config),this._collectionName=r)}return e.prototype.end=function(){return yU(this,void 0,void 0,function(){var t;return _U(this,function(r){switch(r.label){case 0:if(!this._collectionName||!this._db)throw new Error("Aggregation pipeline cannot send request");return[4,this._request.send("database.aggregate",{collectionName:this._collectionName,stages:this._stages})];case 1:return t=r.sent(),t&&t.data&&t.data.list?[2,{requestId:t.requestId,data:JSON.parse(t.data.list).map(Gt.parse)}]:[2,t]}})})},e.prototype.unwrap=function(){return this._stages},e.prototype.done=function(){return this._stages.map(function(t){var r,n=t.stageKey,o=t.stageValue;return r={},r[n]=JSON.parse(o),r})},e.prototype._pipe=function(t,r){return this._stages.push({stageKey:"$"+t,stageValue:JSON.stringify(r)}),this},e.prototype.addFields=function(t){return this._pipe("addFields",t)},e.prototype.bucket=function(t){return this._pipe("bucket",t)},e.prototype.bucketAuto=function(t){return this._pipe("bucketAuto",t)},e.prototype.count=function(t){return this._pipe("count",t)},e.prototype.geoNear=function(t){return t.query&&(t.query=fu.encode(t.query)),t.distanceMultiplier&&typeof t.distanceMultiplier=="number"&&(t.distanceMultiplier=t.distanceMultiplier),t.near&&(t.near=new Bt(t.near.longitude,t.near.latitude).toJSON()),this._pipe("geoNear",t)},e.prototype.group=function(t){return this._pipe("group",t)},e.prototype.limit=function(t){return this._pipe("limit",t)},e.prototype.match=function(t){return this._pipe("match",fu.encode(t))},e.prototype.project=function(t){return this._pipe("project",t)},e.prototype.lookup=function(t){return this._pipe("lookup",t)},e.prototype.replaceRoot=function(t){return this._pipe("replaceRoot",t)},e.prototype.sample=function(t){return this._pipe("sample",t)},e.prototype.skip=function(t){return this._pipe("skip",t)},e.prototype.sort=function(t){return this._pipe("sort",t)},e.prototype.sortByCount=function(t){return this._pipe("sortByCount",t)},e.prototype.unwind=function(t){return this._pipe("unwind",t)},e}(),bU=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),wU=function(e){bU(t,e);function t(r,n){return e.call(this,r,n)||this}return Object.defineProperty(t.prototype,"name",{get:function(){return this._coll},enumerable:!0,configurable:!0}),t.prototype.doc=function(r){if(typeof r!="string"&&typeof r!="number")throw new Error("docId必须为字符串或数字");return new Dv(this._db,this._coll,r)},t.prototype.add=function(r,n){var o=new Dv(this._db,this._coll,void 0);return o.create(r,n)},t.prototype.aggregate=function(){return new q_(this._db,this._coll)},t}(T3),EU={eq:function(e){return new tt(he.EQ,[e])},neq:function(e){return new tt(he.NEQ,[e])},lt:function(e){return new tt(he.LT,[e])},lte:function(e){return new tt(he.LTE,[e])},gt:function(e){return new tt(he.GT,[e])},gte:function(e){return new tt(he.GTE,[e])},in:function(e){return new tt(he.IN,e)},nin:function(e){return new tt(he.NIN,e)},all:function(e){return new tt(he.ALL,e)},elemMatch:function(e){return new tt(he.ELEM_MATCH,[e])},exists:function(e){return new tt(he.EXISTS,[e])},size:function(e){return new tt(he.SIZE,[e])},mod:function(e){return new tt(he.MOD,[e])},geoNear:function(e){return new tt(he.GEO_NEAR,[e])},geoWithin:function(e){return new tt(he.GEO_WITHIN,[e])},geoIntersects:function(e){return new tt(he.GEO_INTERSECTS,[e])},and:function(){var e=Ve(arguments[0])?arguments[0]:Array.from(arguments);return new ii(Yt.AND,e)},nor:function(){var e=Ve(arguments[0])?arguments[0]:Array.from(arguments);return new ii(Yt.NOR,e)},or:function(){var e=Ve(arguments[0])?arguments[0]:Array.from(arguments);return new ii(Yt.OR,e)},not:function(){var e=Ve(arguments[0])?arguments[0]:Array.from(arguments);return new ii(Yt.NOT,e)},set:function(e){return new Xe(Ie.SET,[e])},remove:function(){return new Xe(Ie.REMOVE,[])},inc:function(e){return new Xe(Ie.INC,[e])},mul:function(e){return new Xe(Ie.MUL,[e])},push:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r;if(Pn(e[0])&&e[0].hasOwnProperty("each")){var n=e[0];r={$each:n.each,$position:n.position,$sort:n.sort,$slice:n.slice}}else Ve(e[0])?r=e[0]:r=Array.from(e);return new Xe(Ie.PUSH,r)},pull:function(e){return new Xe(Ie.PULL,e)},pullAll:function(e){return new Xe(Ie.PULL_ALL,e)},pop:function(){return new Xe(Ie.POP,[])},shift:function(){return new Xe(Ie.SHIFT,[])},unshift:function(){var e=Ve(arguments[0])?arguments[0]:Array.from(arguments);return new Xe(Ie.UNSHIFT,e)},addToSet:function(e){return new Xe(Ie.ADD_TO_SET,e)},rename:function(e){return new Xe(Ie.RENAME,[e])},bit:function(e){return new Xe(Ie.BIT,[e])},max:function(e){return new Xe(Ie.MAX,[e])},min:function(e){return new Xe(Ie.MIN,[e])},expr:function(e){return{$expr:e}},jsonSchema:function(e){return{$jsonSchema:e}},text:function(e){return y3(e)?{$search:e.search}:{$search:e.search,$language:e.language,$caseSensitive:e.caseSensitive,$diacriticSensitive:e.diacriticSensitive}},aggregate:{pipeline:function(){return new q_},abs:function(e){return new H("abs",e)},add:function(e){return new H("add",e)},ceil:function(e){return new H("ceil",e)},divide:function(e){return new H("divide",e)},exp:function(e){return new H("exp",e)},floor:function(e){return new H("floor",e)},ln:function(e){return new H("ln",e)},log:function(e){return new H("log",e)},log10:function(e){return new H("log10",e)},mod:function(e){return new H("mod",e)},multiply:function(e){return new H("multiply",e)},pow:function(e){return new H("pow",e)},sqrt:function(e){return new H("sqrt",e)},subtract:function(e){return new H("subtract",e)},trunc:function(e){return new H("trunc",e)},arrayElemAt:function(e){return new H("arrayElemAt",e)},arrayToObject:function(e){return new H("arrayToObject",e)},concatArrays:function(e){return new H("concatArrays",e)},filter:function(e){return new H("filter",e)},in:function(e){return new H("in",e)},indexOfArray:function(e){return new H("indexOfArray",e)},isArray:function(e){return new H("isArray",e)},map:function(e){return new H("map",e)},range:function(e){return new H("range",e)},reduce:function(e){return new H("reduce",e)},reverseArray:function(e){return new H("reverseArray",e)},size:function(e){return new H("size",e)},slice:function(e){return new H("slice",e)},zip:function(e){return new H("zip",e)},and:function(e){return new H("and",e)},not:function(e){return new H("not",e)},or:function(e){return new H("or",e)},cmp:function(e){return new H("cmp",e)},eq:function(e){return new H("eq",e)},gt:function(e){return new H("gt",e)},gte:function(e){return new H("gte",e)},lt:function(e){return new H("lt",e)},lte:function(e){return new H("lte",e)},neq:function(e){return new H("ne",e)},cond:function(e){return new H("cond",e)},ifNull:function(e){return new H("ifNull",e)},switch:function(e){return new H("switch",e)},dateFromParts:function(e){return new H("dateFromParts",e)},dateFromString:function(e){return new H("dateFromString",e)},dayOfMonth:function(e){return new H("dayOfMonth",e)},dayOfWeek:function(e){return new H("dayOfWeek",e)},dayOfYear:function(e){return new H("dayOfYear",e)},isoDayOfWeek:function(e){return new H("isoDayOfWeek",e)},isoWeek:function(e){return new H("isoWeek",e)},isoWeekYear:function(e){return new H("isoWeekYear",e)},millisecond:function(e){return new H("millisecond",e)},minute:function(e){return new H("minute",e)},month:function(e){return new H("month",e)},second:function(e){return new H("second",e)},hour:function(e){return new H("hour",e)},week:function(e){return new H("week",e)},year:function(e){return new H("year",e)},literal:function(e){return new H("literal",e)},mergeObjects:function(e){return new H("mergeObjects",e)},objectToArray:function(e){return new H("objectToArray",e)},allElementsTrue:function(e){return new H("allElementsTrue",e)},anyElementTrue:function(e){return new H("anyElementTrue",e)},setDifference:function(e){return new H("setDifference",e)},setEquals:function(e){return new H("setEquals",e)},setIntersection:function(e){return new H("setIntersection",e)},setIsSubset:function(e){return new H("setIsSubset",e)},setUnion:function(e){return new H("setUnion",e)},concat:function(e){return new H("concat",e)},dateToString:function(e){return new H("dateToString",e)},indexOfBytes:function(e){return new H("indexOfBytes",e)},indexOfCP:function(e){return new H("indexOfCP",e)},split:function(e){return new H("split",e)},strLenBytes:function(e){return new H("strLenBytes",e)},strLenCP:function(e){return new H("strLenCP",e)},strcasecmp:function(e){return new H("strcasecmp",e)},substr:function(e){return new H("substr",e)},substrBytes:function(e){return new H("substrBytes",e)},substrCP:function(e){return new H("substrCP",e)},toLower:function(e){return new H("toLower",e)},toUpper:function(e){return new H("toUpper",e)},meta:function(e){return new H("meta",e)},addToSet:function(e){return new H("addToSet",e)},avg:function(e){return new H("avg",e)},first:function(e){return new H("first",e)},last:function(e){return new H("last",e)},max:function(e){return new H("max",e)},min:function(e){return new H("min",e)},push:function(e){return new H("push",e)},stdDevPop:function(e){return new H("stdDevPop",e)},stdDevSamp:function(e){return new H("stdDevSamp",e)},sum:function(e){return new H("sum",e)},let:function(e){return new H("let",e)}},project:{slice:function(e){return new zv("slice",e)},elemMatch:function(e){return new zv("elemMatch",e)}}},H=function(){function e(t,r){this["$"+t]=r}return e}(),zv=function(){function e(t,r){this["$"+t]=r}return e}(),SU=function(){function e(t){var r=t.regexp,n=t.options;if(!r)throw new TypeError("regexp must be a string");this.$regex=r,this.$options=n}return e.prototype.parse=function(){return{$regex:this.$regex,$options:this.$options}},Object.defineProperty(e.prototype,"_internalType",{get:function(){return S_},enumerable:!0,configurable:!0}),e}();function IU(e){return new SU(e)}var W_={INSERT_DOC_FAIL:{message:"insert document failed"},DATABASE_TRANSACTION_CONFLICT:{code:"DATABASE_TRANSACTION_CONFLICT"}},$r=function(){return $r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},$r.apply(this,arguments)},Lo=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},Uo=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},OU="database.getInTransaction",Jv="database.updateDocInTransaction",TU="database.deleteDocInTransaction",AU="database.insertDocInTransaction",Yv=function(){function e(t,r,n){this._coll=r,this.id=n,this._transaction=t,this._request=this._transaction.getRequestMethod(),this._transactionId=this._transaction.getTransactionId()}return e.prototype.create=function(t){return Lo(this,void 0,void 0,function(){var r,n,o,i;return Uo(this,function(a){switch(a.label){case 0:return r={collectionName:this._coll,transactionId:this._transactionId,data:Gt.stringify(Is(t),{relaxed:!1})},this.id&&(r._id=this.id),[4,this._request.send(AU,r)];case 1:if(n=a.sent(),n.code)throw n;if(o=Gt.parse(n.inserted),i=Gt.parse(n.ok),i==1&&o==1)return[2,$r($r({},n),{ok:i,inserted:o})];throw new Error(W_.INSERT_DOC_FAIL.message)}})})},e.prototype.get=function(){return Lo(this,void 0,void 0,function(){var t,r;return Uo(this,function(n){switch(n.label){case 0:return t={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}}},[4,this._request.send(OU,t)];case 1:if(r=n.sent(),r.code)throw r;return[2,{data:r.data!=="null"?zu.formatField(Gt.parse(r.data)):Gt.parse(r.data),requestId:r.requestId}]}})})},e.prototype.set=function(t){return Lo(this,void 0,void 0,function(){var r,n;return Uo(this,function(o){switch(o.label){case 0:return r={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}},data:Gt.stringify(Is(t),{relaxed:!1}),upsert:!0},[4,this._request.send(Jv,r)];case 1:if(n=o.sent(),n.code)throw n;return[2,$r($r({},n),{updated:Gt.parse(n.updated),upserted:n.upserted?JSON.parse(n.upserted):null})]}})})},e.prototype.update=function(t){return Lo(this,void 0,void 0,function(){var r,n;return Uo(this,function(o){switch(o.label){case 0:return r={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}},data:Gt.stringify(cd.encode(t),{relaxed:!1})},[4,this._request.send(Jv,r)];case 1:if(n=o.sent(),n.code)throw n;return[2,$r($r({},n),{updated:Gt.parse(n.updated)})]}})})},e.prototype.delete=function(){return Lo(this,void 0,void 0,function(){var t,r;return Uo(this,function(n){switch(n.label){case 0:return t={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}}},[4,this._request.send(TU,t)];case 1:if(r=n.sent(),r.code)throw r;return[2,$r($r({},r),{deleted:Gt.parse(r.deleted)})]}})})},e}(),RU=function(){function e(t,r){this._coll=r,this._transaction=t}return e}(),CU=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),xU=function(e){CU(t,e);function t(r,n){return e.call(this,r,n)||this}return Object.defineProperty(t.prototype,"name",{get:function(){return this._coll},enumerable:!0,configurable:!0}),t.prototype.doc=function(r){if(typeof r!="string"&&typeof r!="number")throw new Error("docId必须为字符串或数字");return new Yv(this._transaction,this._coll,r)},t.prototype.add=function(r){var n;r._id!==void 0&&(n=r._id);var o=new Yv(this._transaction,this._coll,n);return o.create(r)},t}(RU),Ki=function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(c){try{s(n.next(c))}catch(f){a(f)}}function l(c){try{s(n.throw(c))}catch(f){a(f)}}function s(c){c.done?i(c.value):o(c.value).then(u,l)}s((n=n.apply(e,t||[])).next())})},zi=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(c){return l([s,c])}}function l(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(c){s=[6,c],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},PU="database.startTransaction",NU="database.commitTransaction",$U="database.abortTransaction",H_=function(){function e(t){this._db=t,this._request=new Et.reqClass(this._db.config),this.aborted=!1,this.commited=!1,this.inited=!1}return e.prototype.init=function(){return Ki(this,void 0,void 0,function(){var t;return zi(this,function(r){switch(r.label){case 0:return[4,this._request.send(PU)];case 1:if(t=r.sent(),t.code)throw t;return this.inited=!0,this._id=t.transactionId,[2]}})})},e.prototype.collection=function(t){if(!t)throw new Error("Collection name is required");return new xU(this,t)},e.prototype.getTransactionId=function(){return this._id},e.prototype.getRequestMethod=function(){return this._request},e.prototype.commit=function(){return Ki(this,void 0,void 0,function(){var t,r;return zi(this,function(n){switch(n.label){case 0:return t={transactionId:this._id},[4,this._request.send(NU,t)];case 1:if(r=n.sent(),r.code)throw r;return this.commited=!0,[2,r]}})})},e.prototype.rollback=function(t){return Ki(this,void 0,void 0,function(){var r,n;return zi(this,function(o){switch(o.label){case 0:return r={transactionId:this._id},[4,this._request.send($U,r)];case 1:if(n=o.sent(),n.code)throw n;return this.aborted=!0,this.abortReason=t,[2,n]}})})},e}();function DU(){return Ki(this,void 0,void 0,function(){var e;return zi(this,function(t){switch(t.label){case 0:return e=new H_(this),[4,e.init()];case 1:return t.sent(),[2,e]}})})}function G_(e,t){return t===void 0&&(t=3),Ki(this,void 0,void 0,function(){var r,n,o,i,a=this;return zi(this,function(u){switch(u.label){case 0:return u.trys.push([0,4,,10]),r=new H_(this),[4,r.init()];case 1:return u.sent(),[4,e(r)];case 2:if(n=u.sent(),r.aborted===!0)throw r.abortReason;return[4,r.commit()];case 3:return u.sent(),[2,n];case 4:if(o=u.sent(),r.inited===!1)throw o;return i=function(l){return Ki(a,void 0,void 0,function(){return zi(this,function(s){switch(s.label){case 0:if(!(!r.aborted&&!r.commited))return[3,5];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r.rollback()];case 2:return s.sent(),[3,4];case 3:return s.sent(),[3,4];case 4:throw l;case 5:throw r.aborted===!0?r.abortReason:l}})})},t<=0?[4,i(o)]:[3,6];case 5:u.sent(),u.label=6;case 6:return o&&o.code===W_.DATABASE_TRANSACTION_CONFLICT.code?[4,G_.bind(this)(e,--t)]:[3,8];case 7:return[2,u.sent()];case 8:return[4,i(o)];case 9:return u.sent(),[3,10];case 10:return[2]}})})}var Et=function(){function e(t){this.config=t,this.Geo=w3,this.serverDate=g3,this.command=EU,this.RegExp=IU,this.startTransaction=DU,this.runTransaction=G_,this.logicCommand=ii,this.updateCommand=Xe,this.queryCommand=tt}return e.prototype.collection=function(t){if(!t)throw new Error("Collection name is required");return new wU(this,t)},e.prototype.createCollection=function(t){var r=new e.reqClass(this.config),n={collectionName:t};return r.send("database.addCollection",n)},e}(),is=function(){return is=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},is.apply(this,arguments)},LU="database";function UU(e){var t=this.platform,r=t.adapter,n=t.runtime;return Et.reqClass=this.request.constructor,Et.getAccessToken=this.authInstance?this.authInstance.getAccessToken.bind(this.authInstance):function(){return""},Et.runtime=n,this.wsClientClass&&(Et.wsClass=r.wsClass,Et.wsClientClass=this.wsClientClass),Et.ws||(Et.ws=null),new Et(is(is(is({},this.config),{_fromApp:this}),e))}var V_={name:LU,entity:{database:UU}};try{cloudbase.registerComponent(V_)}catch{}function FU(e){try{e.registerComponent(V_)}catch(t){console.warn(t)}}const MU="4.0.0",BU={version:MU};var jU=BU.version;Vt.registerVersion(jU);try{OO(Vt),FO(Vt),kO(Vt),FU(Vt),nL(Vt),pL(Vt),CL(Vt),a3(Vt),RO(Vt)}catch{}try{window.cloudbase=Vt}catch{}var rm,nm;const kU=((nm=(rm=import.meta)==null?void 0:rm.env)==null?void 0:nm.VITE_CLOUD_ENV_ID)||"cloud1-3gbydxui8864f9aa",K_=Vt.init({env:kU}),tc=K_.auth({persistence:"local"}),pt=K_.database();async function qU(e,t){if(!e||!t)throw new Error("请输入用户名和密码");return console.log("使用 auth.signIn 方法登录"),tc.signIn({username:e,password:t})}async function WU(){return tc.signOut()}async function mo(){const e=await tc.getLoginState();if(!e)throw new Error("未登录");return e}async function vd(e){const{collection:t,pageNo:r,pageSize:n,keyword:o,typeFilter:i}=e;if(await mo(),t==="sites")return await HU({pageNo:r,pageSize:n,keyword:o,typeFilter:i});if(t==="feedback"){const f={};if(o){const w=pt.RegExp({regexp:o,options:"i"}),_={地点反馈:["point"],意见建议:["suggestion"],问题反馈:["bug"],投诉:["complaint"],表扬:["praise"],其他:["other"]};let E=[];for(const[A,I]of Object.entries(_))(A.includes(o)||o.includes(A))&&E.push(...I.map(R=>({type:pt.RegExp({regexp:R,options:"i"})})));E.length>0?f.$or=[...E,{content:w},{phoneNumber:w},{nickName:w},{selectedPoint:w}]:f.$or=[{type:w},{content:w},{phoneNumber:w},{nickName:w},{selectedPoint:w}]}console.log("feedback where:",f);const d=(r-1)*n,v=await pt.collection(t).where(f).count(),g=(v==null?void 0:v.total)||0;return{list:(await pt.collection(t).where(f).orderBy("createTime","desc").skip(d).limit(n).get()).data||[],total:g}}const a={};if(o){const f=pt.RegExp({regexp:o,options:"i"});a.$or=[{name:f},{phone:f},{address:f}]}console.log("where:",a);const u=(r-1)*n,l=await pt.collection(t).where(a).count(),s=(l==null?void 0:l.total)||0;return{list:(await pt.collection(t).where(a).orderBy("name","asc").skip(u).limit(n).get()).data||[],total:s}}async function HU(e){const{pageNo:t,pageSize:r,keyword:n,typeFilter:o}=e;await mo();const a=o?[o]:["toilet","warm","sinopec","partner","relay"],u={};if(n){const g=pt.RegExp({regexp:n,options:"i"});u.$or=[{name:g},{address:g},{serviceContent:g}]}const l=a.map(async g=>{try{return((await pt.collection(g).where(u).get()).data||[]).map(w=>({...w,_collection:g,type:g}))}catch{return[]}}),c=(await Promise.all(l)).flat().sort((g,b)=>(g.name||"").localeCompare(b.name||"")),f=c.length,d=(t-1)*r;return{list:c.slice(d,d+r),total:f}}async function z_(e,t,r){await mo();const n={...r};delete n._id,delete n._collection,delete n._openid;const o=await pt.collection(e).doc(t).update(n);if(!o.updated||o.updated===0)throw new Error("未更新任何数据");return o}async function J_(e,t){if(await mo(),e==="sites"){const i=t.type;if(!i)throw new Error("创建点位时必须指定type字段");delete t._collection;const a=await pt.collection(i).add(t),u=(a==null?void 0:a.id)||(a==null?void 0:a._id)||(a==null?void 0:a.insertedId)||(Array.isArray(a==null?void 0:a.ids)?a.ids[0]:void 0)||(Array.isArray(a==null?void 0:a.insertedIds)?a.insertedIds[0]:void 0);if(u)return u;const l=`${i}_${Date.now()}_${Math.random().toString(36).slice(2,8)}`;return await pt.collection(i).doc(l).set(t),l}const r=await pt.collection(e).add(t),n=(r==null?void 0:r.id)||(r==null?void 0:r._id)||(r==null?void 0:r.insertedId)||(Array.isArray(r==null?void 0:r.ids)?r.ids[0]:void 0)||(Array.isArray(r==null?void 0:r.insertedIds)?r.insertedIds[0]:void 0);if(n)return n;const o=`${e}_${Date.now()}_${Math.random().toString(36).slice(2,8)}`;return await pt.collection(e).doc(o).set(t),o}async function Y_(e,t,r){if(await mo(),e==="sites"&&r){const o=r._collection||r.type;if(!o)throw new Error("无法确定要删除的集合");const{deleted:i}=await pt.collection(o).doc(t).remove();if(!i)throw new Error("未删除任何数据");return}const{deleted:n}=await pt.collection(e).doc(t).remove();if(!n)throw new Error("未删除任何数据")}function GU(){return tc}const os={contact:{key:"contact",title:"联系信息",collection:"contact",searchFields:["name","phone","address"],fallbackFields:["name","phone","address","latitude","longitude","photoUrl","serviceContent","serviceTime"]},emergency:{key:"emergency",title:"紧急服务",collection:"emergency",searchFields:["name","phone","address"],fallbackFields:["name","phone","address"]},sites:{key:"sites",title:"点位修改",collection:"sites",searchFields:["name","address","serviceContent"],fallbackFields:["id","name","address","latitude","longitude","type","photoUrl","serviceContent","serviceTime"],siteTypes:{toilet:{name:"公共厕所",collection:"toilet"},warm:{name:"暖心服务站",collection:"warm"},sinopec:{name:"爱心驿站",collection:"sinopec"},partner:{name:"合作商户",collection:"partner"},relay:{name:"接力站",collection:"relay"}}},reservations:{key:"reservations",title:"预约管理",collection:"reservations",searchFields:["name","phone","address"],fallbackFields:["id","name","phone"]},feedback:{key:"feedback",title:"用户反馈",collection:"feedback",searchFields:["userName","phone","content","type"],fallbackFields:["userName","phone","content","type","createTime","status"]}},VU="contact",KU={class:"page-header"},zU={class:"header-actions"},JU={class:"layout"},YU={class:"sidebar"},QU=["onClick"],XU=Un({__name:"App",setup(e){const t=Ps(),r=Ee(!0),n=Ee(""),o=Object.values(os),i=Ke(()=>{const d=t.currentRoute.value;return console.log("当前路由:",d),d.name==="module"?d.params.module||VU:d.name==="venue-reservations"||d.name==="event-registrations"?"reservations":d.name});mo().catch(()=>t.replace({name:"login"}));function a(){r.value=!r.value}function u(){var v;t.currentRoute.value.name==="sites"?t.push({name:"sites",query:{keyword:n.value}}):(v=f.value)==null||v.reload({pageNo:1,keyword:n.value})}function l(){var d;(d=f.value)==null||d.openCreate()}async function s(){await WU(),t.replace({name:"login"})}function c(d){console.log("switch:",d),d==="sites"?t.push({name:"sites"}):d==="reservations"?(console.log("switch to reservations"),t.push({name:"reservations",params:{module:d}})):d==="feedback"?t.push({name:"feedback"}):t.push({name:"module",params:{module:d}})}const f=Ee();return(d,v)=>{const g=Bm("router-view");return le(),ve(We,null,[j("header",KU,[j("button",{class:"icon-btn",onClick:a,"aria-label":"展开/收起导航"},"☰"),v[1]||(v[1]=j("h1",null,"安新联系 · 管理后台",-1)),j("div",zU,[ut(j("input",{"onUpdate:modelValue":v[0]||(v[0]=b=>n.value=b),type:"text",placeholder:"搜索关键词"},null,512),[[Dn,n.value,void 0,{trim:!0}]]),j("button",{class:"btn",onClick:u},"搜索"),j("button",{class:"btn primary",onClick:l},"新建"),j("button",{class:"btn danger",onClick:s},"退出")])]),j("div",JU,[ut(j("aside",YU,[j("nav",null,[(le(!0),ve(We,null,Ot(kr(o),b=>(le(),ve("a",{key:b.key,href:"javascript:void(0)",class:cn({active:b.key===i.value}),onClick:w=>c(b.key)},Se(b.title),11,QU))),128))])],512),[[fi,r.value]]),At(g,null,{default:$m(({Component:b})=>[(le(),sg(tw(b),{ref_key:"pageRef",ref:f,keyword:n.value,class:"content"},null,8,["keyword"]))]),_:1})])],64)}}}),ZU="modulepreload",eF=function(e){return"/"+e},Qv={},Xv=function(t,r,n){let o=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),u=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));o=Promise.allSettled(r.map(l=>{if(l=eF(l),l in Qv)return;Qv[l]=!0;const s=l.endsWith(".css"),c=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const f=document.createElement("link");if(f.rel=s?"stylesheet":ZU,s||(f.as="script"),f.crossOrigin="",f.href=l,u&&f.setAttribute("nonce",u),document.head.appendChild(f),s)return new Promise((d,v)=>{f.addEventListener("load",d),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=a,window.dispatchEvent(u),!u.defaultPrevented)throw a}return o.then(a=>{for(const u of a||[])u.status==="rejected"&&i(u.reason);return t().catch(i)})},tF={class:"login-page"},rF={class:"login-container"},nF={class:"form-item"},iF={class:"form-item"},oF=["disabled"],sF={key:0,class:"error-text"},aF=Un({__name:"Login",setup(e){const t=Ps(),r=Ee(""),n=Ee(""),o=Ee(!1),i=Ee("");GU().getLoginState().then(u=>{u&&t.replace({name:"module",params:{module:"contact"}})});async function a(){i.value="",o.value=!0;try{await qU(r.value,n.value),t.replace({name:"module",params:{module:"contact"}})}catch(u){i.value=(u==null?void 0:u.message)||"登录失败"}finally{o.value=!1}}return(u,l)=>(le(),ve("div",tF,[j("div",rF,[l[4]||(l[4]=j("h2",null,"登录管理系统",-1)),j("div",nF,[l[2]||(l[2]=j("label",null,"用户名",-1)),ut(j("input",{"onUpdate:modelValue":l[0]||(l[0]=s=>r.value=s),type:"text",placeholder:"请输入用户名"},null,512),[[Dn,r.value,void 0,{trim:!0}]])]),j("div",iF,[l[3]||(l[3]=j("label",null,"密码",-1)),ut(j("input",{"onUpdate:modelValue":l[1]||(l[1]=s=>n.value=s),type:"password",placeholder:"请输入密码"},null,512),[[Dn,n.value]])]),j("button",{class:"btn primary",disabled:o.value,onClick:a},Se(o.value?"登录中...":"登录"),9,oF),i.value?(le(),ve("div",sF,Se(i.value),1)):Yi("",!0)])]))}}),uF={class:"table-wrapper"},cF={class:"actions-cell"},lF=["onClick"],fF=["onClick"],dF={key:0,class:"empty-tip"},hF={class:"pagination"},pF=["disabled"],vF=["disabled"],mF={class:"modal",role:"dialog","aria-modal":"true"},gF={class:"modal-header"},yF={class:"modal-body"},_F=["for"],bF=["id","onUpdate:modelValue"],wF=["id","onUpdate:modelValue"],EF={key:0,class:"error-text"},SF={class:"modal-footer"},IF=["disabled"],Zv=10,OF=Un({__name:"ModulePage",props:{keyword:{}},setup(e,{expose:t}){const r=e,n=gf(),o=Ps(),i=Ee(1),a=Ee(0),u=Ee([]),l=Ee(!1),s=Ee([]),c=Ee(""),f=Ee(!1),d=Ee(!1),v=oo({}),g=Ee(!1),b=Ke(()=>n.params.module),w=Ke(()=>os[b.value]),_=Ke(()=>Math.max(1,Math.ceil(a.value/Zv)));function E(B){const fe=new Set(["_id","_openid","remark"]),re=new Set;B.forEach(W=>Object.keys(W||{}).forEach(te=>{fe.has(te)||re.add(te)}));const X=["name","phone","address"].filter(W=>re.has(W)),M=Array.from(re).filter(W=>!X.includes(W)).sort();return[...X,...M]}function A(B){return B==null?"":typeof B=="object"?JSON.stringify(B):String(B)}function I(B){return["latitude","longitude","rphotoUrl","photoUrl","imageUrl"].includes(B)?"cell-small":/url/i.test(B)?"cell-url":""}async function R(){l.value=!0,c.value="";try{const{list:B,total:fe}=await vd({collection:w.value.collection,pageNo:i.value,pageSize:Zv,keyword:r.keyword});u.value=B,a.value=fe,s.value=B.length?E(B):w.value.fallbackFields}catch(B){c.value=(B==null?void 0:B.message)||"加载失败",/未登录|登录已过期/.test(c.value)&&o.replace({name:"login"})}finally{l.value=!1}}function $(B){B>=1&&B<=_.value&&(i.value=B,R())}function L(){d.value=!0,Object.keys(v).forEach(B=>delete v[B]),(w.value.fallbackFields||[]).forEach(B=>v[B]=""),f.value=!0}function D(B){d.value=!1,Object.keys(v).forEach(re=>delete v[re]),E([B]).forEach(re=>v[re]=B[re]??""),v._id=B._id,f.value=!0}function P(){f.value=!1}function k(B){return typeof B=="string"&&B.length>60}const F=Ke(()=>Object.keys(v).filter(B=>B!=="_id"));async function Q(){g.value=!0;try{if(!v.name)throw new Error("名称不能为空");if(d.value)await J_(w.value.collection,{...v});else{const B=v._id;if(!B)throw new Error("未选择记录");const fe={...v};delete fe._id,await z_(w.value.collection,B,fe)}P(),R()}catch(B){c.value=(B==null?void 0:B.message)||"保存失败"}g.value=!1}async function ce(B){if(confirm("确认删除该记录？该操作不可恢复。"))try{await Y_(w.value.collection,B._id),R()}catch(fe){alert((fe==null?void 0:fe.message)||"删除失败")}}return Cs(R),si(()=>[b.value,r.keyword],()=>{i.value=1,R()}),t({reload:R,openCreate:L}),(B,fe)=>(le(),ve("div",null,[j("div",uF,[j("table",null,[j("thead",null,[j("tr",null,[(le(!0),ve(We,null,Ot(s.value,re=>(le(),ve("th",{key:re},Se(re),1))),128)),fe[2]||(fe[2]=j("th",{style:{width:"160px"}},"操作",-1))])]),j("tbody",null,[(le(!0),ve(We,null,Ot(u.value,re=>(le(),ve("tr",{key:re._id},[(le(!0),ve(We,null,Ot(s.value,X=>(le(),ve("td",{key:X,class:cn(I(X))},Se(A(re[X])),3))),128)),j("td",cF,[j("button",{class:"btn sm primary",onClick:X=>D(re)},"编辑",8,lF),j("button",{class:"btn sm danger",onClick:X=>ce(re)},"删除",8,fF)])]))),128))])]),!l.value&&u.value.length===0?(le(),ve("div",dF,"暂无数据")):Yi("",!0),j("div",hF,[j("button",{class:"btn",disabled:i.value<=1,onClick:fe[0]||(fe[0]=re=>$(i.value-1))},"上一页",8,pF),j("span",null,"第 "+Se(i.value)+" / "+Se(_.value)+" 页（共 "+Se(a.value)+" 条）",1),j("button",{class:"btn",disabled:i.value>=_.value,onClick:fe[1]||(fe[1]=re=>$(i.value+1))},"下一页",8,vF)])]),ut(j("div",{class:"modal-mask",onClick:pf(P,["self"])},null,512),[[fi,f.value]]),ut(j("div",mF,[j("div",gF,[j("h3",null,Se(d.value?"新建信息":"编辑信息"),1),j("button",{class:"icon-btn",onClick:P},"✕")]),j("div",yF,[(le(!0),ve(We,null,Ot(F.value,re=>(le(),ve("div",{class:"form-item",key:re},[j("label",{for:"form-"+re},Se(re),9,_F),k(v[re])?ut((le(),ve("textarea",{key:0,id:"form-"+re,rows:"3","onUpdate:modelValue":X=>v[re]=X},null,8,bF)),[[Dn,v[re],void 0,{trim:!0}]]):ut((le(),ve("input",{key:1,type:"text",id:"form-"+re,"onUpdate:modelValue":X=>v[re]=X},null,8,wF)),[[Dn,v[re],void 0,{trim:!0}]])]))),128)),c.value?(le(),ve("div",EF,Se(c.value),1)):Yi("",!0)]),j("div",SF,[j("button",{class:"btn",onClick:P},"取消"),j("button",{class:"btn primary",disabled:g.value,onClick:Q},Se(g.value?"保存中...":"保存"),9,IF)])],512),[[fi,f.value]])]))}}),TF={class:"filter-bar"},AF=["value"],RF={class:"filter-info"},CF={class:"table-wrapper"},xF={class:"actions-cell"},PF=["onClick"],NF=["onClick"],$F={key:0,class:"empty-tip"},DF={class:"pagination"},LF=["disabled"],UF=["disabled"],FF={class:"modal",role:"dialog","aria-modal":"true"},MF={class:"modal-header"},BF={class:"modal-body"},jF={class:"form-item"},kF=["disabled"],qF=["value"],WF=["for"],HF=["id","onUpdate:modelValue"],GF=["id","onUpdate:modelValue","required"],VF={key:0,class:"error-text"},KF={class:"modal-footer"},zF=["disabled"],em=10,JF=Un({__name:"SitesPage",setup(e,{expose:t}){const r=gf(),n=Ps(),o=Ke(()=>r.query.keyword||""),i=Ee(1),a=Ee(0),u=Ee([]),l=Ee(!1),s=Ee([]),c=Ee(""),f=Ee(""),d=Ee(!1),v=Ee(!1),g=oo({}),b=Ee(!1),w=os.sites.siteTypes||{},_=Ke(()=>Math.max(1,Math.ceil(a.value/em))),E={id:"ID",name:"名称",address:"地址",latitude:"纬度",longitude:"经度",type:"类型",photoUrl:"图片链接",serviceContent:"服务内容",serviceTime:"服务时间",_collection:"所属集合"};function A(M){return E[M]||M}function I(M){return E[M]||M}function R(M){const W=new Set(["_id","_openid","remark","_collection"]),te=new Set;M.forEach(et=>Object.keys(et||{}).forEach(Rt=>{W.has(Rt)||te.add(Rt)}));const ne=["name","type","address","serviceTime"].filter(et=>te.has(et)),be=Array.from(te).filter(et=>!ne.includes(et)).sort();return[...ne,...be]}function $(M){return M==null?"":typeof M=="object"?JSON.stringify(M):typeof M=="string"&&w[M]?w[M].name:String(M)}function L(M){return["id","latitude","longitude","photoUrl"].includes(M)?"cell-small":/url/i.test(M)?"cell-url":""}async function D(){l.value=!0,c.value="";try{const{list:M,total:W}=await vd({collection:"sites",pageNo:i.value,pageSize:em,keyword:o.value,typeFilter:f.value});u.value=M,a.value=W,s.value=M.length?R(M):os.sites.fallbackFields}catch(M){c.value=(M==null?void 0:M.message)||"加载失败",/未登录|登录已过期/.test(c.value)&&n.replace({name:"login"})}finally{l.value=!1}}function P(M){M>=1&&M<=_.value&&(i.value=M,D())}function k(){i.value=1,D()}function F(){v.value=!0,Object.keys(g).forEach(M=>delete g[M]),os.sites.fallbackFields.forEach(M=>g[M]=""),g.type=f.value||"",d.value=!0}function Q(M){v.value=!1,Object.keys(g).forEach(te=>delete g[te]),R([M]).forEach(te=>g[te]=M[te]??""),g._id=M._id,g._collection=M._collection||M.type,d.value=!0}function ce(){d.value=!1,b.value=!1,c.value=""}function B(M){return typeof M=="string"&&M.length>60}const fe=Ke(()=>Object.keys(g).filter(M=>!["_id","_collection"].includes(M)));async function re(){b.value=!0,c.value="";try{if(!g.name)throw new Error("名称不能为空");if(!g.type)throw new Error("请选择点位类型");if(v.value){const M=g.type;if(!M)throw new Error("请选择点位类型");const W={...g};delete W._id,delete W._collection,await J_(M,W)}else{const M=g._id;if(!M)throw new Error("未选择记录");const W=g._collection||g.type;if(!W)throw new Error("无法确定要更新的集合");const te={...g};delete te._id,delete te._collection,await z_(W,M,te)}ce(),D()}catch(M){c.value=(M==null?void 0:M.message)||"保存失败"}finally{b.value=!1}}async function X(M){if(confirm(`确认删除点位"${M.name}"？该操作不可恢复。`))try{const W=M._collection||M.type;if(!W)throw new Error("无法确定要删除的集合");await Y_(W,M._id),D()}catch(W){alert((W==null?void 0:W.message)||"删除失败")}}return Cs(D),si(()=>[o.value],()=>{i.value=1,D()}),t({reload:D,openCreate:F}),(M,W)=>{var te;return le(),ve("div",null,[j("div",TF,[W[5]||(W[5]=j("label",null,"点位类型：",-1)),ut(j("select",{"onUpdate:modelValue":W[0]||(W[0]=ne=>f.value=ne),onChange:k,class:"filter-select"},[W[4]||(W[4]=j("option",{value:""},"全部类型",-1)),(le(!0),ve(We,null,Ot(kr(w),(ne,be)=>(le(),ve("option",{key:be,value:be},Se(ne.name),9,AF))),128))],544),[[Kd,f.value]]),j("span",RF,"共 "+Se(a.value)+" 个点位",1)]),j("div",CF,[j("table",null,[j("thead",null,[j("tr",null,[(le(!0),ve(We,null,Ot(s.value,ne=>(le(),ve("th",{key:ne},Se(A(ne)),1))),128)),W[6]||(W[6]=j("th",{style:{width:"160px"}},"操作",-1))])]),j("tbody",null,[(le(!0),ve(We,null,Ot(u.value,ne=>(le(),ve("tr",{key:ne._id},[(le(!0),ve(We,null,Ot(s.value,be=>(le(),ve("td",{key:be,class:cn(L(be))},Se($(ne[be])),3))),128)),j("td",xF,[j("button",{class:"btn sm primary",onClick:be=>Q(ne)},"编辑",8,PF),j("button",{class:"btn sm danger",onClick:be=>X(ne)},"删除",8,NF)])]))),128))])]),!l.value&&u.value.length===0?(le(),ve("div",$F,Se(f.value?`暂无${((te=kr(w)[f.value])==null?void 0:te.name)||"该类型"}点位`:"暂无点位数据"),1)):Yi("",!0),j("div",DF,[j("button",{class:"btn",disabled:i.value<=1,onClick:W[1]||(W[1]=ne=>P(i.value-1))},"上一页",8,LF),j("span",null,"第 "+Se(i.value)+" / "+Se(_.value)+" 页（共 "+Se(a.value)+" 条）",1),j("button",{class:"btn",disabled:i.value>=_.value,onClick:W[2]||(W[2]=ne=>P(i.value+1))},"下一页",8,UF)])]),ut(j("div",{class:"modal-mask",onClick:pf(ce,["self"])},null,512),[[fi,d.value]]),ut(j("div",FF,[j("div",MF,[j("h3",null,Se(v.value?"新建点位":"编辑点位"),1),j("button",{class:"icon-btn",onClick:ce},"✕")]),j("div",BF,[j("div",jF,[W[8]||(W[8]=j("label",{for:"form-type"},"点位类型 *",-1)),ut(j("select",{id:"form-type","onUpdate:modelValue":W[3]||(W[3]=ne=>g.type=ne),disabled:!v.value,required:""},[W[7]||(W[7]=j("option",{value:""},"请选择点位类型",-1)),(le(!0),ve(We,null,Ot(kr(w),(ne,be)=>(le(),ve("option",{key:be,value:be},Se(ne.name),9,qF))),128))],8,kF),[[Kd,g.type]])]),(le(!0),ve(We,null,Ot(fe.value,ne=>(le(),ve("div",{class:"form-item",key:ne},[j("label",{for:"form-"+ne},Se(I(ne))+" "+Se(ne==="name"?"*":""),9,WF),B(g[ne])?ut((le(),ve("textarea",{key:0,id:"form-"+ne,rows:"3","onUpdate:modelValue":be=>g[ne]=be},null,8,HF)),[[Dn,g[ne],void 0,{trim:!0}]]):ut((le(),ve("input",{key:1,type:"text",id:"form-"+ne,"onUpdate:modelValue":be=>g[ne]=be,required:ne==="name"},null,8,GF)),[[Dn,g[ne],void 0,{trim:!0}]])]))),128)),c.value?(le(),ve("div",VF,Se(c.value),1)):Yi("",!0)]),j("div",KF,[j("button",{class:"btn",onClick:ce},"取消"),j("button",{class:"btn primary",disabled:b.value,onClick:re},Se(b.value?"保存中...":"保存"),9,zF)])],512),[[fi,d.value]])])}}}),Q_=(e,t)=>{const r=e.__vccOpts||e;for(const[n,o]of t)r[n]=o;return r},YF=Q_(JF,[["__scopeId","data-v-1252f516"]]),QF={class:"page-wrapper"},XF={class:"nav-bar"},ZF=Un({__name:"Reservations",setup(e){const t=Ps(),r=gf(),n=Ee("venue");function o(){r.name==="event-registrations"?n.value="event":n.value="venue"}o(),si(()=>r.name,()=>{o()});function i(){n.value="venue",t.push({name:"venue-reservations"})}function a(){n.value="event",t.push({name:"event-registrations"})}return Cs(()=>{r.name==="reservations"&&r.fullPath==="/module/reservations"&&t.replace({name:"venue-reservations"})}),(u,l)=>{const s=Bm("router-view");return le(),ve("div",QF,[j("nav",XF,[j("button",{class:cn(["btn",{active:n.value==="venue"}]),onClick:i},"场馆预约",2),j("button",{class:cn(["btn",{active:n.value==="event"}]),onClick:a},"活动报名",2)]),At(s)])}}}),eM=Q_(ZF,[["__scopeId","data-v-965e55fd"]]),tM={class:"search-bar"},rM={class:"table-wrapper"},nM={class:"actions-cell"},iM=["onClick"],oM={key:0,class:"empty-tip"},sM={class:"pagination"},aM=["disabled"],uM=["disabled"],cM={class:"modal",role:"dialog","aria-modal":"true"},lM={class:"modal-body"},fM={class:"detail-label"},dM={class:"detail-value"},hM={key:0,class:"feedback-content"},pM={key:1},tm=10,vM=Un({__name:"FeedbackPage",setup(e){const t=Ee(1),r=Ee(0),n=Ee([]),o=Ee(!1),i=Ee([]),a=Ee(""),u=Ee(),l=Ee(!1),s=Ee({}),c=Ke(()=>Math.max(1,Math.ceil(r.value/tm))),f={type:"反馈类型",content:"反馈内容",createTime:"提交时间",nickName:"用户名",contact:"联系方式",selectedPoint:"选择定位",userName:"用户名",phone:"手机号",status:"状态",address:"地址",email:"邮箱"};function d(P){return f[P]||P}const v=["type","content","createTime","nickName","contact","selectedPoint"];function g(P,k,F){if(console.log(`displayValue被调用 - key: ${k}, v:`,P,"row:",F),k==="contact"){if(console.log("=== 处理联系方式字段 ==="),console.log("key:",k),console.log("v:",P),console.log("row:",F),F&&(console.log("行数据中的字段:",Object.keys(F)),console.log("phoneNumber:",F.phoneNumber),F.phoneNumber))return F.phoneNumber;if(P&&typeof P=="object"){const Q=[];return P.userName&&Q.push(`姓名: ${P.userName}`),P.phone&&Q.push(`电话: ${P.phone}`),P.email&&Q.push(`邮箱: ${P.email}`),Q.length>0?Q.join(", "):"无联系方式"}return P&&typeof P=="string"?P:(console.log("未找到联系方式信息，返回默认值"),"未提供")}if(P==null||P==="")return b(k);if(k==="createTime")try{return new Date(P).toLocaleString("zh-CN")}catch{return"时间格式错误"}if(k==="type")return{bug:"问题反馈",suggestion:"意见建议",complaint:"投诉",praise:"表扬",point:"地点反馈",other:"其他"}[P]||P;if(k==="selectedPoint"){if(P&&typeof P=="object"){if(P.latitude&&P.longitude)return`${P.latitude.toFixed(6)}, ${P.longitude.toFixed(6)}`;if(P.address)return P.address}return P||"未选择位置"}return k==="content"?typeof P=="string"&&P.length>50?P.substring(0,50)+"...":P:typeof P=="object"?JSON.stringify(P):String(P)}function b(P){return{type:"未分类",content:"暂无内容",createTime:"时间未知",contact:"未提供",selectedPoint:"未选择位置"}[P]||"暂无数据"}function w(P){return P==="content"?"cell-content":P==="createTime"?"cell-time":P==="status"?"cell-status":""}function _(){u.value&&clearTimeout(u.value),u.value=setTimeout(()=>{E()},500)}function E(){t.value=1,D()}function A(){a.value="",t.value=1,D()}function I(P){t.value=P,D()}function R(P){s.value=P,l.value=!0}function $(){l.value=!1,s.value={}}const L=Ke(()=>v);async function D(){o.value=!0;try{const{list:P,total:k}=await vd({collection:"feedback",pageNo:t.value,pageSize:tm,keyword:a.value});console.log("从数据库获取的原始数据:",P),console.log("数据字段:",P.length>0?Object.keys(P[0]):[]),n.value=P,r.value=k,i.value=v}catch(P){console.error("加载反馈数据失败:",P),i.value=v}finally{o.value=!1}}return Cs(()=>{D()}),(P,k)=>(le(),ve("div",null,[j("div",tM,[ut(j("input",{"onUpdate:modelValue":k[0]||(k[0]=F=>a.value=F),placeholder:"搜索反馈类型、内容、用户名、电话号码或位置...",class:"search-input",onInput:_},null,544),[[Dn,a.value]]),j("button",{class:"btn primary",onClick:E},"搜索"),j("button",{class:"btn",onClick:A},"清空")]),j("div",rM,[j("table",null,[j("thead",null,[j("tr",null,[(le(!0),ve(We,null,Ot(i.value,F=>(le(),ve("th",{key:F},Se(d(F)),1))),128)),k[3]||(k[3]=j("th",{style:{width:"120px"}},"操作",-1))])]),j("tbody",null,[(le(!0),ve(We,null,Ot(n.value,F=>(le(),ve("tr",{key:F._id},[(le(!0),ve(We,null,Ot(i.value,Q=>(le(),ve("td",{key:Q,class:cn(w(Q))},Se(g(F[Q],Q,F)),3))),128)),j("td",nM,[j("button",{class:"btn sm primary",onClick:Q=>R(F)},"查看详情",8,iM)])]))),128))])]),!o.value&&n.value.length===0?(le(),ve("div",oM,"暂无反馈数据")):Yi("",!0),j("div",sM,[j("button",{class:"btn",disabled:t.value<=1,onClick:k[1]||(k[1]=F=>I(t.value-1))},"上一页",8,aM),j("span",null,"第 "+Se(t.value)+" / "+Se(c.value)+" 页（共 "+Se(r.value)+" 条）",1),j("button",{class:"btn",disabled:t.value>=c.value,onClick:k[2]||(k[2]=F=>I(t.value+1))},"下一页",8,uM)])]),ut(j("div",{class:"modal-mask",onClick:pf($,["self"])},null,512),[[fi,l.value]]),ut(j("div",cM,[j("div",{class:"modal-header"},[k[4]||(k[4]=j("h3",null,"反馈详情",-1)),j("button",{class:"icon-btn",onClick:$},"✕")]),j("div",lM,[(le(!0),ve(We,null,Ot(L.value,F=>(le(),ve("div",{class:"detail-item",key:F},[j("label",fM,Se(d(F))+"：",1),j("div",dM,[F==="content"?(le(),ve("span",hM,Se(s.value[F]),1)):(le(),ve("span",pM,Se(g(s.value[F],F,s.value)),1))])]))),128))]),j("div",{class:"modal-footer"},[j("button",{class:"btn",onClick:$},"关闭")])],512),[[fi,l.value]])]))}}),mM=b1({history:JE(),routes:[{path:"/",redirect:{name:"module",params:{module:"contact"}}},{name:"login",path:"/login",component:aF},{name:"module",path:"/module/:module",component:OF,props:!0},{name:"sites",path:"/module/sites",component:YF,props:e=>({keyword:e.query.keyword})},{name:"reservations",path:"/module/reservations",component:eM,props:!0,children:[{name:"venue-reservations",path:"venue",component:()=>Xv(()=>import("./VenueReservations-C2Ysditi.js"),__vite__mapDeps([0,1]))},{name:"event-registrations",path:"event",component:()=>Xv(()=>import("./EventRegistrations-CcE8pR0o.js"),__vite__mapDeps([2,1]))},{path:"",redirect:{name:"venue-reservations"}}]},{name:"feedback",path:"/feedback",component:vM}]});vE(XU).use(mM).mount("#app");export{We as F,ve as a,j as b,ye as c,Un as d,Yi as e,Ot as f,Kd as g,pf as h,Dn as i,le as j,Vt as k,Cs as o,Ee as r,Se as t,fi as v,ut as w};
